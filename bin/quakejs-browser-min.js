//     Underscore.js 1.4.1
//     http://underscorejs.org
//     (c) 2009-2012 Jeremy Ashkenas, DocumentCloud Inc.
//     Underscore may be freely distributed under the MIT license.

/* Copyright (c) 2012, Brandon Jones. All rights reserved.

Redistribution and use in source and binary forms, with or without modification,
are permitted provided that the following conditions are met:

  * Redistributions of source code must retain the above copyright notice, this
    list of conditions and the following disclaimer.
  * Redistributions in binary form must reproduce the above copyright notice,
    this list of conditions and the following disclaimer in the documentation 
    and/or other materials provided with the distribution.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE 
DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR
ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. */

/*
 * Copyright (c) 2012 Brandon Jones, Colin MacKenzie IV
 *
 * This software is provided 'as-is', without any express or implied
 * warranty. In no event will the authors be held liable for any damages
 * arising from the use of this software.
 *
 * Permission is granted to anyone to use this software for any purpose,
 * including commercial applications, and to alter it and redistribute it
 * freely, subject to the following restrictions:
 *
 *    1. The origin of this software must not be misrepresented; you must not
 *    claim that you wrote the original software. If you use this software
 *    in a product, an acknowledgment in the product documentation would be
 *    appreciated but is not required.
 *
 *    2. Altered source versions must be plainly marked as such, and must not
 *    be misrepresented as being the original software.
 *
 *    3. This notice may not be removed or altered from any source
 *    distribution.
 */

/**
 * ByteBuffer v0.0.1
 * Copyright (c) 2012 Tim Kurvers <http://moonsphere.net>
 *
 * Wrapper for ArrayBuffer/DataView maintaining index and default endianness.
 * Supports arbitrary reading/writing, implicit growth, clipping, cloning and
 * reversing as well as UTF-8 characters and NULL-terminated C-strings.
 *
 * The contents of this file are subject to the MIT License, under which
 * this library is licensed. See the LICENSE file for the full license.
 */

/**
 * EventEmitter v4.0.4 - git.io/ee
 * Oliver Caldwell
 * MIT license
 * @preserve
 */

/*!
 * jQuery JavaScript Library v1.8.2
 * http://jquery.com/
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright 2012 jQuery Foundation and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: Thu Sep 20 2012 21:13:05 GMT-0400 (Eastern Daylight Time)
 */

/*!
 * Sizzle CSS Selector Engine
 * Copyright 2012 jQuery Foundation and other contributors
 * Released under the MIT license
 * http://sizzlejs.com/
 */

//     (c) 2010-2012 Jeremy Ashkenas, DocumentCloud Inc.
//     Backbone may be freely distributed under the MIT license.
//     For all details and documentation:
//     http://backbonejs.org

(function(){var e=this,t=e._,n={},r=Array.prototype,i=Object.prototype,s=Function.prototype,o=r.push,u=r.slice,a=r.concat,f=r.unshift,l=i.toString,c=i.hasOwnProperty,h=r.forEach,p=r.map,d=r.reduce,v=r.reduceRight,m=r.filter,g=r.every,y=r.some,b=r.indexOf,w=r.lastIndexOf,E=Array.isArray,S=Object.keys,x=s.bind,T=function(e){if(e instanceof T)return e;if(!(this instanceof T))return new T(e);this._wrapped=e};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=T),exports._=T):e._=T,T.VERSION="1.4.1";var N=T.each=T.forEach=function(e,t,r){if(h&&e.forEach===h)e.forEach(t,r);else if(e.length===+e.length){for(var i=0,s=e.length;i<s;i++)if(t.call(r,e[i],i,e)===n)return}else for(var o in e)if(T.has(e,o)&&t.call(r,e[o],o,e)===n)return};T.map=T.collect=function(e,t,n){var r=[];return p&&e.map===p?e.map(t,n):(N(e,function(e,i,s){r[r.length]=t.call(n,e,i,s)}),r)},T.reduce=T.foldl=T.inject=function(e,t,n,r){var i=arguments.length>2;if(d&&e.reduce===d)return r&&(t=T.bind(t,r)),i?e.reduce(t,n):e.reduce(t);N(e,function(e,s,o){i?n=t.call(r,n,e,s,o):(n=e,i=!0)});if(!i)throw new TypeError("Reduce of empty array with no initial value");return n},T.reduceRight=T.foldr=function(e,t,n,r){var i=arguments.length>2;if(v&&e.reduceRight===v)return r&&(t=T.bind(t,r)),arguments.length>2?e.reduceRight(t,n):e.reduceRight(t);var s=e.length;if(s!==+s){var o=T.keys(e);s=o.length}N(e,function(u,a,f){a=o?o[--s]:--s,i?n=t.call(r,n,e[a],a,f):(n=e[a],i=!0)});if(!i)throw new TypeError("Reduce of empty array with no initial value");return n},T.find=T.detect=function(e,t,n){var r;return C(e,function(e,i,s){if(t.call(n,e,i,s))return r=e,!0}),r},T.filter=T.select=function(e,t,n){var r=[];return m&&e.filter===m?e.filter(t,n):(N(e,function(e,i,s){t.call(n,e,i,s)&&(r[r.length]=e)}),r)},T.reject=function(e,t,n){var r=[];return N(e,function(e,i,s){t.call(n,e,i,s)||(r[r.length]=e)}),r},T.every=T.all=function(e,t,r){t||(t=T.identity);var i=!0;return g&&e.every===g?e.every(t,r):(N(e,function(e,s,o){if(!(i=i&&t.call(r,e,s,o)))return n}),!!i)};var C=T.some=T.any=function(e,t,r){t||(t=T.identity);var i=!1;return y&&e.some===y?e.some(t,r):(N(e,function(e,s,o){if(i||(i=t.call(r,e,s,o)))return n}),!!i)};T.contains=T.include=function(e,t){var n=!1;return b&&e.indexOf===b?e.indexOf(t)!=-1:(n=C(e,function(e){return e===t}),n)},T.invoke=function(e,t){var n=u.call(arguments,2);return T.map(e,function(e){return(T.isFunction(t)?t:e[t]).apply(e,n)})},T.pluck=function(e,t){return T.map(e,function(e){return e[t]})},T.where=function(e,t){return T.isEmpty(t)?[]:T.filter(e,function(e){for(var n in t)if(t[n]!==e[n])return!1;return!0})},T.max=function(e,t,n){if(!t&&T.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!t&&T.isEmpty(e))return-Infinity;var r={computed:-Infinity};return N(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o>=r.computed&&(r={value:e,computed:o})}),r.value},T.min=function(e,t,n){if(!t&&T.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!t&&T.isEmpty(e))return Infinity;var r={computed:Infinity};return N(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o<r.computed&&(r={value:e,computed:o})}),r.value},T.shuffle=function(e){var t,n=0,r=[];return N(e,function(e){t=T.random(n++),r[n-1]=r[t],r[t]=e}),r};var k=function(e){return T.isFunction(e)?e:function(t){return t[e]}};T.sortBy=function(e,t,n){var r=k(t);return T.pluck(T.map(e,function(e,t,i){return{value:e,index:t,criteria:r.call(n,e,t,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||n===void 0)return 1;if(n<r||r===void 0)return-1}return e.index<t.index?-1:1}),"value")};var L=function(e,t,n,r){var i={},s=k(t);return N(e,function(t,o){var u=s.call(n,t,o,e);r(i,u,t)}),i};T.groupBy=function(e,t,n){return L(e,t,n,function(e,t,n){(T.has(e,t)?e[t]:e[t]=[]).push(n)})},T.countBy=function(e,t,n){return L(e,t,n,function(e,t,n){T.has(e,t)||(e[t]=0),e[t]++})},T.sortedIndex=function(e,t,n,r){n=n==null?T.identity:k(n);var i=n.call(r,t),s=0,o=e.length;while(s<o){var u=s+o>>>1;n.call(r,e[u])<i?s=u+1:o=u}return s},T.toArray=function(e){return e?e.length===+e.length?u.call(e):T.values(e):[]},T.size=function(e){return e.length===+e.length?e.length:T.keys(e).length},T.first=T.head=T.take=function(e,t,n){return t!=null&&!n?u.call(e,0,t):e[0]},T.initial=function(e,t,n){return u.call(e,0,e.length-(t==null||n?1:t))},T.last=function(e,t,n){return t!=null&&!n?u.call(e,Math.max(e.length-t,0)):e[e.length-1]},T.rest=T.tail=T.drop=function(e,t,n){return u.call(e,t==null||n?1:t)},T.compact=function(e){return T.filter(e,function(e){return!!e})};var A=function(e,t,n){return N(e,function(e){T.isArray(e)?t?o.apply(n,e):A(e,t,n):n.push(e)}),n};T.flatten=function(e,t){return A(e,t,[])},T.without=function(e){return T.difference(e,u.call(arguments,1))},T.uniq=T.unique=function(e,t,n,r){var i=n?T.map(e,n,r):e,s=[],o=[];return N(i,function(n,r){if(t?!r||o[o.length-1]!==n:!T.contains(o,n))o.push(n),s.push(e[r])}),s},T.union=function(){return T.uniq(a.apply(r,arguments))},T.intersection=function(e){var t=u.call(arguments,1);return T.filter(T.uniq(e),function(e){return T.every(t,function(t){return T.indexOf(t,e)>=0})})},T.difference=function(e){var t=a.apply(r,u.call(arguments,1));return T.filter(e,function(e){return!T.contains(t,e)})},T.zip=function(){var e=u.call(arguments),t=T.max(T.pluck(e,"length")),n=new Array(t);for(var r=0;r<t;r++)n[r]=T.pluck(e,""+r);return n},T.object=function(e,t){var n={};for(var r=0,i=e.length;r<i;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},T.indexOf=function(e,t,n){var r=0,i=e.length;if(n){if(typeof n!="number")return r=T.sortedIndex(e,t),e[r]===t?r:-1;r=n<0?Math.max(0,i+n):n}if(b&&e.indexOf===b)return e.indexOf(t,n);for(;r<i;r++)if(e[r]===t)return r;return-1},T.lastIndexOf=function(e,t,n){var r=n!=null;if(w&&e.lastIndexOf===w)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);var i=r?n:e.length;while(i--)if(e[i]===t)return i;return-1},T.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=new Array(r);while(i<r)s[i++]=e,e+=n;return s};var O=function(){};T.bind=function(t,n){var r,i;if(t.bind===x&&x)return x.apply(t,u.call(arguments,1));if(!T.isFunction(t))throw new TypeError;return i=u.call(arguments,2),r=function(){if(this instanceof r){O.prototype=t.prototype;var e=new O,s=t.apply(e,i.concat(u.call(arguments)));return Object(s)===s?s:e}return t.apply(n,i.concat(u.call(arguments)))}},T.bindAll=function(e){var t=u.call(arguments,1);return t.length==0&&(t=T.functions(e)),N(t,function(t){e[t]=T.bind(e[t],e)}),e},T.memoize=function(e,t){var n={};return t||(t=T.identity),function(){var r=t.apply(this,arguments);return T.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},T.delay=function(e,t){var n=u.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},T.defer=function(e){return T.delay.apply(T,[e,1].concat(u.call(arguments,1)))},T.throttle=function(e,t){var n,r,i,s,o,u,a=T.debounce(function(){o=s=!1},t);return function(){n=this,r=arguments;var f=function(){i=null,o&&(u=e.apply(n,r)),a()};return i||(i=setTimeout(f,t)),s?o=!0:(s=!0,u=e.apply(n,r)),a(),u}},T.debounce=function(e,t,n){var r,i;return function(){var s=this,o=arguments,u=function(){r=null,n||(i=e.apply(s,o))},a=n&&!r;return clearTimeout(r),r=setTimeout(u,t),a&&(i=e.apply(s,o)),i}},T.once=function(e){var t=!1,n;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}},T.wrap=function(e,t){return function(){var n=[e];return o.apply(n,arguments),t.apply(this,n)}},T.compose=function(){var e=arguments;return function(){var t=arguments;for(var n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},T.after=function(e,t){return e<=0?t():function(){if(--e<1)return t.apply(this,arguments)}},T.keys=S||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)T.has(e,n)&&(t[t.length]=n);return t},T.values=function(e){var t=[];for(var n in e)T.has(e,n)&&t.push(e[n]);return t},T.pairs=function(e){var t=[];for(var n in e)T.has(e,n)&&t.push([n,e[n]]);return t},T.invert=function(e){var t={};for(var n in e)T.has(e,n)&&(t[e[n]]=n);return t},T.functions=T.methods=function(e){var t=[];for(var n in e)T.isFunction(e[n])&&t.push(n);return t.sort()},T.extend=function(e){return N(u.call(arguments,1),function(t){for(var n in t)e[n]=t[n]}),e},T.pick=function(e){var t={},n=a.apply(r,u.call(arguments,1));return N(n,function(n){n in e&&(t[n]=e[n])}),t},T.omit=function(e){var t={},n=a.apply(r,u.call(arguments,1));for(var i in e)T.contains(n,i)||(t[i]=e[i]);return t},T.defaults=function(e){return N(u.call(arguments,1),function(t){for(var n in t)e[n]==null&&(e[n]=t[n])}),e},T.clone=function(e){return T.isObject(e)?T.isArray(e)?e.slice():T.extend({},e):e},T.tap=function(e,t){return t(e),e};var M=function(e,t,n,r){if(e===t)return e!==0||1/e==1/t;if(e==null||t==null)return e===t;e instanceof T&&(e=e._wrapped),t instanceof T&&(t=t._wrapped);var i=l.call(e);if(i!=l.call(t))return!1;switch(i){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if(typeof e!="object"||typeof t!="object")return!1;var s=n.length;while(s--)if(n[s]==e)return r[s]==t;n.push(e),r.push(t);var o=0,u=!0;if(i=="[object Array]"){o=e.length,u=o==t.length;if(u)while(o--)if(!(u=M(e[o],t[o],n,r)))break}else{var a=e.constructor,f=t.constructor;if(a!==f&&!(T.isFunction(a)&&a instanceof a&&T.isFunction(f)&&f instanceof f))return!1;for(var c in e)if(T.has(e,c)){o++;if(!(u=T.has(t,c)&&M(e[c],t[c],n,r)))break}if(u){for(c in t)if(T.has(t,c)&&!(o--))break;u=!o}}return n.pop(),r.pop(),u};T.isEqual=function(e,t){return M(e,t,[],[])},T.isEmpty=function(e){if(e==null)return!0;if(T.isArray(e)||T.isString(e))return e.length===0;for(var t in e)if(T.has(e,t))return!1;return!0},T.isElement=function(e){return!!e&&e.nodeType===1},T.isArray=E||function(e){return l.call(e)=="[object Array]"},T.isObject=function(e){return e===Object(e)},N(["Arguments","Function","String","Number","Date","RegExp"],function(e){T["is"+e]=function(t){return l.call(t)=="[object "+e+"]"}}),T.isArguments(arguments)||(T.isArguments=function(e){return!!e&&!!T.has(e,"callee")}),typeof /./!="function"&&(T.isFunction=function(e){return typeof e=="function"}),T.isFinite=function(e){return T.isNumber(e)&&isFinite(e)},T.isNaN=function(e){return T.isNumber(e)&&e!=+e},T.isBoolean=function(e){return e===!0||e===!1||l.call(e)=="[object Boolean]"},T.isNull=function(e){return e===null},T.isUndefined=function(e){return e===void 0},T.has=function(e,t){return c.call(e,t)},T.noConflict=function(){return e._=t,this},T.identity=function(e){return e},T.times=function(e,t,n){for(var r=0;r<e;r++)t.call(n,r)},T.random=function(e,t){return t==null&&(t=e,e=0),e+(0|Math.random()*(t-e+1))};var _={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};_.unescape=T.invert(_.escape);var D={escape:new RegExp("["+T.keys(_.escape).join("")+"]","g"),unescape:new RegExp("("+T.keys(_.unescape).join("|")+")","g")};T.each(["escape","unescape"],function(e){T[e]=function(t){return t==null?"":(""+t).replace(D[e],function(t){return _[e][t]})}}),T.result=function(e,t){if(e==null)return null;var n=e[t];return T.isFunction(n)?n.call(e):n},T.mixin=function(e){N(T.functions(e),function(t){var n=T[t]=e[t];T.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),F.call(this,n.apply(T,e))}})};var P=0;T.uniqueId=function(e){var t=P++;return e?e+t:t},T.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var H=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},j=/\\|'|\r|\n|\t|\u2028|\u2029/g;T.template=function(e,t,n){n=T.defaults({},n,T.templateSettings);var r=new RegExp([(n.escape||H).source,(n.interpolate||H).source,(n.evaluate||H).source].join("|")+"|$","g"),i=0,s="__p+='";e.replace(r,function(t,n,r,o,u){s+=e.slice(i,u).replace(j,function(e){return"\\"+B[e]}),s+=n?"'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?"'+\n((__t=("+r+"))==null?'':__t)+\n'":o?"';\n"+o+"\n__p+='":"",i=u+t.length}),s+="';\n",n.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{var o=new Function(n.variable||"obj","_",s)}catch(u){throw u.source=s,u}if(t)return o(t,T);var a=function(e){return o.call(this,e,T)};return a.source="function("+(n.variable||"obj")+"){\n"+s+"}",a},T.chain=function(e){return T(e).chain()};var F=function(e){return this._chain?T(e).chain():e};T.mixin(T),N(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];T.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),(e=="shift"||e=="splice")&&n.length===0&&delete n[0],F.call(this,n)}}),N(["concat","join","slice"],function(e){var t=r[e];T.prototype[e]=function(){return F.call(this,t.apply(this._wrapped,arguments))}}),T.extend(T.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),typeof define=="function"&&define.amd&&define("underscore",[],function(){return T})}).call(this),function(e){function i(e){var t=document.createEvent("CustomEvent");t.initCustomEvent("fullscreenchange",!0,!1,null),document.dispatchEvent(t)}function s(e){var t=document.createEvent("CustomEvent");t.initCustomEvent("fullscreenerror",!0,!1,null),document.dispatchEvent(t)}function u(e){var t=document.createEvent("CustomEvent");t.initCustomEvent("pointerlockchange",!0,!1,null),document.dispatchEvent(t)}function a(e){var t=document.createEvent("CustomEvent");t.initCustomEvent("pointerlockerror",!0,!1,null),document.dispatchEvent(t)}var t=(e.HTMLElement||e.Element).prototype,n,r=e.GameShim={supports:{fullscreen:!0,pointerLock:!0,gamepad:!0,highResTimer:!0}};(function(){var e=0,t=["webkit","moz","ms","o"],r;for(r=0;r<t.length&&!window.requestAnimationFrame;++r)window.requestAnimationFrame=window[t[r]+"RequestAnimationFrame"];window.cancelAnimationFrame=window.cancelAnimationFrame||window.cancelRequestAnimationFrame;for(r=0;r<t.length&&!window.cancelAnimationFrame;++r)window.cancelAnimationFrame=window[t[r]+"CancelAnimationFrame"]||window[t[r]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,n){var r=Date.now(),i=Math.max(0,16-(r-e)),s=window.setTimeout(function(){t(r+i)},i);return e=r+i,s}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)}),window.animationStartTime||(n=function(){for(r=0;r<t.length;++r)if(window[t[r]+"AnimationStartTime"])return function(){return window[t[r]+"AnimationStartTime"]};return function(){return Date.now()}}(),Object.defineProperty(window,"animationStartTime",{enumerable:!0,configurable:!1,writeable:!1,get:n}))})(),document.hasOwnProperty("fullscreenEnabled")||(n=function(){return"webkitIsFullScreen"in document?function(){return document.webkitFullscreenEnabled}:"mozFullScreenEnabled"in document?function(){return document.mozFullScreenEnabled}:(r.supports.fullscreen=!1,function(){return!1})}(),Object.defineProperty(document,"fullscreenEnabled",{enumerable:!0,configurable:!1,writeable:!1,get:n})),document.hasOwnProperty("fullscreenElement")||(n=function(){var e=0,t=["webkitCurrentFullScreenElement","webkitFullscreenElement","mozFullScreenElement"];for(;e<t.length;e++)if(t[e]in document)return function(){return document[t[e]]};return function(){return null}}(),Object.defineProperty(document,"fullscreenElement",{enumerable:!0,configurable:!1,writeable:!1,get:n})),document.addEventListener("webkitfullscreenchange",i,!1),document.addEventListener("mozfullscreenchange",i,!1),document.addEventListener("webkitfullscreenerror",s,!1),document.addEventListener("mozfullscreenerror",s,!1),t.requestFullScreen||(t.requestFullScreen=function(){return t.webkitRequestFullScreen?function(){this.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT)}:t.mozRequestFullScreen?function(){this.mozRequestFullScreen()}:function(){}}()),document.cancelFullScreen||(document.cancelFullScreen=function(){return document.webkitCancelFullScreen||document.mozCancelFullScreen||function(){}}());var o=e.MouseEvent.prototype;"movementX"in o||Object.defineProperty(o,"movementX",{enumerable:!0,configurable:!1,writeable:!1,get:function(){return this.webkitMovementX||this.mozMovementX||0}}),"movementY"in o||Object.defineProperty(o,"movementY",{enumerable:!0,configurable:!1,writeable:!1,get:function(){return this.webkitMovementY||this.mozMovementY||0}}),navigator.pointer||(navigator.pointer=navigator.webkitPointer||navigator.mozPointer),document.addEventListener("webkitpointerlockchange",u,!1),document.addEventListener("webkitpointerlocklost",u,!1),document.addEventListener("mozpointerlockchange",u,!1),document.addEventListener("mozpointerlocklost",u,!1),document.addEventListener("webkitpointerlockerror",a,!1),document.addEventListener("mozpointerlockerror",a,!1),document.hasOwnProperty("pointerLockElement")||(n=function(){return"webkitPointerLockElement"in document?function(){return document.webkitPointerLockElement}:"mozPointerLockElement"in document?function(){return document.mozPointerLockElement}:function(){return null}}(),Object.defineProperty(document,"pointerLockElement",{enumerable:!0,configurable:!1,writeable:!1,get:n})),t.requestPointerLock||(t.requestPointerLock=function(){return t.webkitRequestPointerLock?function(){this.webkitRequestPointerLock()}:t.mozRequestPointerLock?function(){this.mozRequestPointerLock()}:navigator.pointer?function(){var e=this;navigator.pointer.lock(e,u,a)}:(r.supports.pointerLock=!1,function(){})}()),document.exitPointerLock||(document.exitPointerLock=function(){return document.webkitExitPointerLock||document.mozExitPointerLock||function(){if(navigator.pointer){var e=this;navigator.pointer.unlock()}}}()),navigator.gamepads||(n=function(){if("webkitGamepads"in navigator)return function(){return navigator.webkitGamepads};if("mozGamepads"in navigator)return function(){return navigator.mozGamepads};r.supports.gamepad=!1;var e=[];return function(){return e}}(),Object.defineProperty(navigator,"gamepads",{enumerable:!0,configurable:!1,writeable:!1,get:n})),window.performance||(window.performance={}),window.performance.timing||(window.performance.timing={navigationStart:Date.now()}),window.performance.now||(window.performance.now=function(){return window.performance.webkitNow?window.performance.webkitNow:(r.supports.highResTimer=!1,function(){return Date.now()-window.performance.timing.navigationStart})}())}(typeof exports!="undefined"?global:window),define("gameshim",function(){}),function(e,t){typeof exports=="object"?module.exports=t(global):typeof define=="function"&&define.amd?define("glmatrix",[],function(){return t(e)}):t(e)}(this,function(e){function i(e){return r=e,r}function s(){return r=typeof Float32Array!="undefined"?Float32Array:Array,r}var t=1e-6,n={};(function(){if(typeof Float32Array!="undefined"){var e=new Float32Array(1),t=new Int32Array(e.buffer);n.invsqrt=function(n){var r=n*.5;e[0]=n;var i=1.5;t[0]=1597463007-(t[0]>>1);var s=e[0];return s*(i-r*s*s)}}else n.invsqrt=function(e){return 1/Math.sqrt(e)}})();var r=null;s();var o={};o.create=function(e){var t=new r(3);return e?(t[0]=e[0],t[1]=e[1],t[2]=e[2]):t[0]=t[1]=t[2]=0,t},o.createFrom=function(e,t,n){var i=new r(3);return i[0]=e,i[1]=t,i[2]=n,i},o.set=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},o.equal=function(e,n){return e===n||Math.abs(e[0]-n[0])<t&&Math.abs(e[1]-n[1])<t&&Math.abs(e[2]-n[2])<t},o.add=function(e,t,n){return!n||e===n?(e[0]+=t[0],e[1]+=t[1],e[2]+=t[2],e):(n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n)},o.subtract=function(e,t,n){return!n||e===n?(e[0]-=t[0],e[1]-=t[1],e[2]-=t[2],e):(n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n)},o.multiply=function(e,t,n){return!n||e===n?(e[0]*=t[0],e[1]*=t[1],e[2]*=t[2],e):(n[0]=e[0]*t[0],n[1]=e[1]*t[1],n[2]=e[2]*t[2],n)},o.negate=function(e,t){return t||(t=e),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},o.scale=function(e,t,n){return!n||e===n?(e[0]*=t,e[1]*=t,e[2]*=t,e):(n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n)},o.normalize=function(e,t){t||(t=e);var n=e[0],r=e[1],i=e[2],s=Math.sqrt(n*n+r*r+i*i);return s?s===1?(t[0]=n,t[1]=r,t[2]=i,t):(s=1/s,t[0]=n*s,t[1]=r*s,t[2]=i*s,t):(t[0]=0,t[1]=0,t[2]=0,t)},o.cross=function(e,t,n){n||(n=e);var r=e[0],i=e[1],s=e[2],o=t[0],u=t[1],a=t[2];return n[0]=i*a-s*u,n[1]=s*o-r*a,n[2]=r*u-i*o,n},o.length=function(e){var t=e[0],n=e[1],r=e[2];return Math.sqrt(t*t+n*n+r*r)},o.squaredLength=function(e){var t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r},o.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},o.direction=function(e,t,n){n||(n=e);var r=e[0]-t[0],i=e[1]-t[1],s=e[2]-t[2],o=Math.sqrt(r*r+i*i+s*s);return o?(o=1/o,n[0]=r*o,n[1]=i*o,n[2]=s*o,n):(n[0]=0,n[1]=0,n[2]=0,n)},o.lerp=function(e,t,n,r){return r||(r=e),r[0]=e[0]+n*(t[0]-e[0]),r[1]=e[1]+n*(t[1]-e[1]),r[2]=e[2]+n*(t[2]-e[2]),r},o.dist=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(n*n+r*r+i*i)};var u=null,a=new r(4);o.unproject=function(e,t,n,r,i){i||(i=e),u||(u=d.create());var s=u,o=a;return o[0]=(e[0]-r[0])*2/r[2]-1,o[1]=(e[1]-r[1])*2/r[3]-1,o[2]=2*e[2]-1,o[3]=1,d.multiply(n,t,s),d.inverse(s)?(d.multiplyVec4(s,o),o[3]===0?null:(i[0]=o[0]/o[3],i[1]=o[1]/o[3],i[2]=o[2]/o[3],i)):null};var f=o.createFrom(1,0,0),l=o.createFrom(0,1,0),c=o.createFrom(0,0,1),h=o.create();o.rotationTo=function(e,t,n){n||(n=v.create());var r=o.dot(e,t),i=h;if(r>=1)v.set(m,n);else if(r<1e-6-1)o.cross(f,e,i),o.length(i)<1e-6&&o.cross(l,e,i),o.length(i)<1e-6&&o.cross(c,e,i),o.normalize(i),v.fromAngleAxis(Math.PI,i,n);else{var s=Math.sqrt((1+r)*2),u=1/s;o.cross(e,t,i),n[0]=i[0]*u,n[1]=i[1]*u,n[2]=i[2]*u,n[3]=s*.5,v.normalize(n)}return n[3]>1?n[3]=1:n[3]<-1&&(n[3]=-1),n},o.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+"]"};var p={};p.create=function(e){var t=new r(9);return e?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8]):t[0]=t[1]=t[2]=t[3]=t[4]=t[5]=t[6]=t[7]=t[8]=0,t},p.createFrom=function(e,t,n,i,s,o,u,a,f){var l=new r(9);return l[0]=e,l[1]=t,l[2]=n,l[3]=i,l[4]=s,l[5]=o,l[6]=u,l[7]=a,l[8]=f,l},p.determinant=function(e){var t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],o=e[5],u=e[6],a=e[7],f=e[8];return t*(f*s-o*a)+n*(-f*i+o*u)+r*(a*i-s*u)},p.inverse=function(e,t){var n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],u=e[5],a=e[6],f=e[7],l=e[8],c=l*o-u*f,h=-l*s+u*a,d=f*s-o*a,v=n*c+r*h+i*d,m;return v?(m=1/v,t||(t=p.create()),t[0]=c*m,t[1]=(-l*r+i*f)*m,t[2]=(u*r-i*o)*m,t[3]=h*m,t[4]=(l*n-i*a)*m,t[5]=(-u*n+i*s)*m,t[6]=d*m,t[7]=(-f*n+r*a)*m,t[8]=(o*n-r*s)*m,t):null},p.multiply=function(e,t,n){n||(n=e);var r=e[0],i=e[1],s=e[2],o=e[3],u=e[4],a=e[5],f=e[6],l=e[7],c=e[8],h=t[0],p=t[1],d=t[2],v=t[3],m=t[4],g=t[5],y=t[6],b=t[7],w=t[8];return n[0]=h*r+p*o+d*f,n[1]=h*i+p*u+d*l,n[2]=h*s+p*a+d*c,n[3]=v*r+m*o+g*f,n[4]=v*i+m*u+g*l,n[5]=v*s+m*a+g*c,n[6]=y*r+b*o+w*f,n[7]=y*i+b*u+w*l,n[8]=y*s+b*a+w*c,n},p.multiplyVec2=function(e,t,n){n||(n=t);var r=t[0],i=t[1];return n[0]=r*e[0]+i*e[3]+e[6],n[1]=r*e[1]+i*e[4]+e[7],n},p.multiplyVec3=function(e,t,n){n||(n=t);var r=t[0],i=t[1],s=t[2];return n[0]=r*e[0]+i*e[3]+s*e[6],n[1]=r*e[1]+i*e[4]+s*e[7],n[2]=r*e[2]+i*e[5]+s*e[8],n},p.set=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},p.equal=function(e,n){return e===n||Math.abs(e[0]-n[0])<t&&Math.abs(e[1]-n[1])<t&&Math.abs(e[2]-n[2])<t&&Math.abs(e[3]-n[3])<t&&Math.abs(e[4]-n[4])<t&&Math.abs(e[5]-n[5])<t&&Math.abs(e[6]-n[6])<t&&Math.abs(e[7]-n[7])<t&&Math.abs(e[8]-n[8])<t},p.identity=function(e){return e||(e=p.create()),e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},p.transpose=function(e,t){if(!t||e===t){var n=e[1],r=e[2],i=e[5];return e[1]=e[3],e[2]=e[6],e[3]=n,e[5]=e[7],e[6]=r,e[7]=i,e}return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],t},p.toMat4=function(e,t){return t||(t=d.create()),t[15]=1,t[14]=0,t[13]=0,t[12]=0,t[11]=0,t[10]=e[8],t[9]=e[7],t[8]=e[6],t[7]=0,t[6]=e[5],t[5]=e[4],t[4]=e[3],t[3]=0,t[2]=e[2],t[1]=e[1],t[0]=e[0],t},p.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+"]"};var d={};d.create=function(e){var t=new r(16);return e&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t},d.createFrom=function(e,t,n,i,s,o,u,a,f,l,c,h,p,d,v,m){var g=new r(16);return g[0]=e,g[1]=t,g[2]=n,g[3]=i,g[4]=s,g[5]=o,g[6]=u,g[7]=a,g[8]=f,g[9]=l,g[10]=c,g[11]=h,g[12]=p,g[13]=d,g[14]=v,g[15]=m,g},d.set=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},d.equal=function(e,n){return e===n||Math.abs(e[0]-n[0])<t&&Math.abs(e[1]-n[1])<t&&Math.abs(e[2]-n[2])<t&&Math.abs(e[3]-n[3])<t&&Math.abs(e[4]-n[4])<t&&Math.abs(e[5]-n[5])<t&&Math.abs(e[6]-n[6])<t&&Math.abs(e[7]-n[7])<t&&Math.abs(e[8]-n[8])<t&&Math.abs(e[9]-n[9])<t&&Math.abs(e[10]-n[10])<t&&Math.abs(e[11]-n[11])<t&&Math.abs(e[12]-n[12])<t&&Math.abs(e[13]-n[13])<t&&Math.abs(e[14]-n[14])<t&&Math.abs(e[15]-n[15])<t},d.identity=function(e){return e||(e=d.create()),e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},d.transpose=function(e,t){if(!t||e===t){var n=e[1],r=e[2],i=e[3],s=e[6],o=e[7],u=e[11];return e[1]=e[4],e[2]=e[8],e[3]=e[12],e[4]=n,e[6]=e[9],e[7]=e[13],e[8]=r,e[9]=s,e[11]=e[14],e[12]=i,e[13]=o,e[14]=u,e}return t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15],t},d.determinant=function(e){var t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],o=e[5],u=e[6],a=e[7],f=e[8],l=e[9],c=e[10],h=e[11],p=e[12],d=e[13],v=e[14],m=e[15];return p*l*u*i-f*d*u*i-p*o*c*i+s*d*c*i+f*o*v*i-s*l*v*i-p*l*r*a+f*d*r*a+p*n*c*a-t*d*c*a-f*n*v*a+t*l*v*a+p*o*r*h-s*d*r*h-p*n*u*h+t*d*u*h+s*n*v*h-t*o*v*h-f*o*r*m+s*l*r*m+f*n*u*m-t*l*u*m-s*n*c*m+t*o*c*m},d.inverse=function(e,t){t||(t=e);var n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],u=e[5],a=e[6],f=e[7],l=e[8],c=e[9],h=e[10],p=e[11],d=e[12],v=e[13],m=e[14],g=e[15],y=n*u-r*o,b=n*a-i*o,w=n*f-s*o,E=r*a-i*u,S=r*f-s*u,x=i*f-s*a,T=l*v-c*d,N=l*m-h*d,C=l*g-p*d,k=c*m-h*v,L=c*g-p*v,A=h*g-p*m,O=y*A-b*L+w*k+E*C-S*N+x*T,M;return O?(M=1/O,t[0]=(u*A-a*L+f*k)*M,t[1]=(-r*A+i*L-s*k)*M,t[2]=(v*x-m*S+g*E)*M,t[3]=(-c*x+h*S-p*E)*M,t[4]=(-o*A+a*C-f*N)*M,t[5]=(n*A-i*C+s*N)*M,t[6]=(-d*x+m*w-g*b)*M,t[7]=(l*x-h*w+p*b)*M,t[8]=(o*L-u*C+f*T)*M,t[9]=(-n*L+r*C-s*T)*M,t[10]=(d*S-v*w+g*y)*M,t[11]=(-l*S+c*w-p*y)*M,t[12]=(-o*k+u*N-a*T)*M,t[13]=(n*k-r*N+i*T)*M,t[14]=(-d*E+v*b-m*y)*M,t[15]=(l*E-c*b+h*y)*M,t):null},d.toRotationMat=function(e,t){return t||(t=d.create()),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},d.toMat3=function(e,t){return t||(t=p.create()),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},d.toInverseMat3=function(e,t){var n=e[0],r=e[1],i=e[2],s=e[4],o=e[5],u=e[6],a=e[8],f=e[9],l=e[10],c=l*o-u*f,h=-l*s+u*a,d=f*s-o*a,v=n*c+r*h+i*d,m;return v?(m=1/v,t||(t=p.create()),t[0]=c*m,t[1]=(-l*r+i*f)*m,t[2]=(u*r-i*o)*m,t[3]=h*m,t[4]=(l*n-i*a)*m,t[5]=(-u*n+i*s)*m,t[6]=d*m,t[7]=(-f*n+r*a)*m,t[8]=(o*n-r*s)*m,t):null},d.multiply=function(e,t,n){n||(n=e);var r=e[0],i=e[1],s=e[2],o=e[3],u=e[4],a=e[5],f=e[6],l=e[7],c=e[8],h=e[9],p=e[10],d=e[11],v=e[12],m=e[13],g=e[14],y=e[15],b=t[0],w=t[1],E=t[2],S=t[3];return n[0]=b*r+w*u+E*c+S*v,n[1]=b*i+w*a+E*h+S*m,n[2]=b*s+w*f+E*p+S*g,n[3]=b*o+w*l+E*d+S*y,b=t[4],w=t[5],E=t[6],S=t[7],n[4]=b*r+w*u+E*c+S*v,n[5]=b*i+w*a+E*h+S*m,n[6]=b*s+w*f+E*p+S*g,n[7]=b*o+w*l+E*d+S*y,b=t[8],w=t[9],E=t[10],S=t[11],n[8]=b*r+w*u+E*c+S*v,n[9]=b*i+w*a+E*h+S*m,n[10]=b*s+w*f+E*p+S*g,n[11]=b*o+w*l+E*d+S*y,b=t[12],w=t[13],E=t[14],S=t[15],n[12]=b*r+w*u+E*c+S*v,n[13]=b*i+w*a+E*h+S*m,n[14]=b*s+w*f+E*p+S*g,n[15]=b*o+w*l+E*d+S*y,n},d.multiplyVec3=function(e,t,n){n||(n=t);var r=t[0],i=t[1],s=t[2];return n[0]=e[0]*r+e[4]*i+e[8]*s+e[12],n[1]=e[1]*r+e[5]*i+e[9]*s+e[13],n[2]=e[2]*r+e[6]*i+e[10]*s+e[14],n},d.multiplyVec4=function(e,t,n){n||(n=t);var r=t[0],i=t[1],s=t[2],o=t[3];return n[0]=e[0]*r+e[4]*i+e[8]*s+e[12]*o,n[1]=e[1]*r+e[5]*i+e[9]*s+e[13]*o,n[2]=e[2]*r+e[6]*i+e[10]*s+e[14]*o,n[3]=e[3]*r+e[7]*i+e[11]*s+e[15]*o,n},d.translate=function(e,t,n){var r=t[0],i=t[1],s=t[2],o,u,a,f,l,c,h,p,d,v,m,g;return!n||e===n?(e[12]=e[0]*r+e[4]*i+e[8]*s+e[12],e[13]=e[1]*r+e[5]*i+e[9]*s+e[13],e[14]=e[2]*r+e[6]*i+e[10]*s+e[14],e[15]=e[3]*r+e[7]*i+e[11]*s+e[15],e):(o=e[0],u=e[1],a=e[2],f=e[3],l=e[4],c=e[5],h=e[6],p=e[7],d=e[8],v=e[9],m=e[10],g=e[11],n[0]=o,n[1]=u,n[2]=a,n[3]=f,n[4]=l,n[5]=c,n[6]=h,n[7]=p,n[8]=d,n[9]=v,n[10]=m,n[11]=g,n[12]=o*r+l*i+d*s+e[12],n[13]=u*r+c*i+v*s+e[13],n[14]=a*r+h*i+m*s+e[14],n[15]=f*r+p*i+g*s+e[15],n)},d.scale=function(e,t,n){var r=t[0],i=t[1],s=t[2];return!n||e===n?(e[0]*=r,e[1]*=r,e[2]*=r,e[3]*=r,e[4]*=i,e[5]*=i,e[6]*=i,e[7]*=i,e[8]*=s,e[9]*=s,e[10]*=s,e[11]*=s,e):(n[0]=e[0]*r,n[1]=e[1]*r,n[2]=e[2]*r,n[3]=e[3]*r,n[4]=e[4]*i,n[5]=e[5]*i,n[6]=e[6]*i,n[7]=e[7]*i,n[8]=e[8]*s,n[9]=e[9]*s,n[10]=e[10]*s,n[11]=e[11]*s,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n)},d.rotate=function(e,t,n,r){var i=n[0],s=n[1],o=n[2],u=Math.sqrt(i*i+s*s+o*o),a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M;return u?(u!==1&&(u=1/u,i*=u,s*=u,o*=u),a=Math.sin(t),f=Math.cos(t),l=1-f,c=e[0],h=e[1],p=e[2],d=e[3],v=e[4],m=e[5],g=e[6],y=e[7],b=e[8],w=e[9],E=e[10],S=e[11],x=i*i*l+f,T=s*i*l+o*a,N=o*i*l-s*a,C=i*s*l-o*a,k=s*s*l+f,L=o*s*l+i*a,A=i*o*l+s*a,O=s*o*l-i*a,M=o*o*l+f,r?e!==r&&(r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]):r=e,r[0]=c*x+v*T+b*N,r[1]=h*x+m*T+w*N,r[2]=p*x+g*T+E*N,r[3]=d*x+y*T+S*N,r[4]=c*C+v*k+b*L,r[5]=h*C+m*k+w*L,r[6]=p*C+g*k+E*L,r[7]=d*C+y*k+S*L,r[8]=c*A+v*O+b*M,r[9]=h*A+m*O+w*M,r[10]=p*A+g*O+E*M,r[11]=d*A+y*O+S*M,r):null},d.rotateX=function(e,t,n){var r=Math.sin(t),i=Math.cos(t),s=e[4],o=e[5],u=e[6],a=e[7],f=e[8],l=e[9],c=e[10],h=e[11];return n?e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]):n=e,n[4]=s*i+f*r,n[5]=o*i+l*r,n[6]=u*i+c*r,n[7]=a*i+h*r,n[8]=s*-r+f*i,n[9]=o*-r+l*i,n[10]=u*-r+c*i,n[11]=a*-r+h*i,n},d.rotateY=function(e,t,n){var r=Math.sin(t),i=Math.cos(t),s=e[0],o=e[1],u=e[2],a=e[3],f=e[8],l=e[9],c=e[10],h=e[11];return n?e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]):n=e,n[0]=s*i+f*-r,n[1]=o*i+l*-r,n[2]=u*i+c*-r,n[3]=a*i+h*-r,n[8]=s*r+f*i,n[9]=o*r+l*i,n[10]=u*r+c*i,n[11]=a*r+h*i,n},d.rotateZ=function(e,t,n){var r=Math.sin(t),i=Math.cos(t),s=e[0],o=e[1],u=e[2],a=e[3],f=e[4],l=e[5],c=e[6],h=e[7];return n?e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]):n=e,n[0]=s*i+f*r,n[1]=o*i+l*r,n[2]=u*i+c*r,n[3]=a*i+h*r,n[4]=s*-r+f*i,n[5]=o*-r+l*i,n[6]=u*-r+c*i,n[7]=a*-r+h*i,n},d.frustum=function(e,t,n,r,i,s,o){o||(o=d.create());var u=t-e,a=r-n,f=s-i;return o[0]=i*2/u,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=i*2/a,o[6]=0,o[7]=0,o[8]=(t+e)/u,o[9]=(r+n)/a,o[10]=-(s+i)/f,o[11]=-1,o[12]=0,o[13]=0,o[14]=-(s*i*2)/f,o[15]=0,o},d.perspective=function(e,t,n,r,i){var s=n*Math.tan(e*Math.PI/360),o=s*t;return d.frustum(-o,o,-s,s,n,r,i)},d.ortho=function(e,t,n,r,i,s,o){o||(o=d.create());var u=t-e,a=r-n,f=s-i;return o[0]=2/u,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2/a,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=-2/f,o[11]=0,o[12]=-(e+t)/u,o[13]=-(r+n)/a,o[14]=-(s+i)/f,o[15]=1,o},d.lookAt=function(e,t,n,r){r||(r=d.create());var i,s,o,u,a,f,l,c,h,p,v=e[0],m=e[1],g=e[2],y=n[0],b=n[1],w=n[2],E=t[0],S=t[1],x=t[2];return v===E&&m===S&&g===x?d.identity(r):(l=v-E,c=m-S,h=g-x,p=1/Math.sqrt(l*l+c*c+h*h),l*=p,c*=p,h*=p,i=b*h-w*c,s=w*l-y*h,o=y*c-b*l,p=Math.sqrt(i*i+s*s+o*o),p?(p=1/p,i*=p,s*=p,o*=p):(i=0,s=0,o=0),u=c*o-h*s,a=h*i-l*o,f=l*s-c*i,p=Math.sqrt(u*u+a*a+f*f),p?(p=1/p,u*=p,a*=p,f*=p):(u=0,a=0,f=0),r[0]=i,r[1]=u,r[2]=l,r[3]=0,r[4]=s,r[5]=a,r[6]=c,r[7]=0,r[8]=o,r[9]=f,r[10]=h,r[11]=0,r[12]=-(i*v+s*m+o*g),r[13]=-(u*v+a*m+f*g),r[14]=-(l*v+c*m+h*g),r[15]=1,r)},d.fromRotationTranslation=function(e,t,n){n||(n=d.create());var r=e[0],i=e[1],s=e[2],o=e[3],u=r+r,a=i+i,f=s+s,l=r*u,c=r*a,h=r*f,p=i*a,v=i*f,m=s*f,g=o*u,y=o*a,b=o*f;return n[0]=1-(p+m),n[1]=c+b,n[2]=h-y,n[3]=0,n[4]=c-b,n[5]=1-(l+m),n[6]=v+g,n[7]=0,n[8]=h+y,n[9]=v-g,n[10]=1-(l+p),n[11]=0,n[12]=t[0],n[13]=t[1],n[14]=t[2],n[15]=1,n},d.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+"]"};var v={};v.create=function(e){var t=new r(4);return e?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]):t[0]=t[1]=t[2]=t[3]=0,t},v.createFrom=function(e,t,n,i){var s=new r(4);return s[0]=e,s[1]=t,s[2]=n,s[3]=i,s},v.set=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},v.equal=function(e,n){return e===n||Math.abs(e[0]-n[0])<t&&Math.abs(e[1]-n[1])<t&&Math.abs(e[2]-n[2])<t&&Math.abs(e[3]-n[3])<t},v.identity=function(e){return e||(e=v.create()),e[0]=0,e[1]=0,e[2]=0,e[3]=1,e};var m=v.identity();v.calculateW=function(e,t){var n=e[0],r=e[1],i=e[2];return!t||e===t?(e[3]=-Math.sqrt(Math.abs(1-n*n-r*r-i*i)),e):(t[0]=n,t[1]=r,t[2]=i,t[3]=-Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t)},v.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},v.inverse=function(e,t){var n=e[0],r=e[1],i=e[2],s=e[3],o=n*n+r*r+i*i+s*s,u=o?1/o:0;return!t||e===t?(e[0]*=-u,e[1]*=-u,e[2]*=-u,e[3]*=u,e):(t[0]=-e[0]*u,t[1]=-e[1]*u,t[2]=-e[2]*u,t[3]=e[3]*u,t)},v.conjugate=function(e,t){return!t||e===t?(e[0]*=-1,e[1]*=-1,e[2]*=-1,e):(t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t)},v.length=function(e){var t=e[0],n=e[1],r=e[2],i=e[3];return Math.sqrt(t*t+n*n+r*r+i*i)},v.normalize=function(e,t){t||(t=e);var n=e[0],r=e[1],i=e[2],s=e[3],o=Math.sqrt(n*n+r*r+i*i+s*s);return o===0?(t[0]=0,t[1]=0,t[2]=0,t[3]=0,t):(o=1/o,t[0]=n*o,t[1]=r*o,t[2]=i*o,t[3]=s*o,t)},v.add=function(e,t,n){return!n||e===n?(e[0]+=t[0],e[1]+=t[1],e[2]+=t[2],e[3]+=t[3],e):(n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n)},v.multiply=function(e,t,n){n||(n=e);var r=e[0],i=e[1],s=e[2],o=e[3],u=t[0],a=t[1],f=t[2],l=t[3];return n[0]=r*l+o*u+i*f-s*a,n[1]=i*l+o*a+s*u-r*f,n[2]=s*l+o*f+r*a-i*u,n[3]=o*l-r*u-i*a-s*f,n},v.multiplyVec3=function(e,t,n){n||(n=t);var r=t[0],i=t[1],s=t[2],o=e[0],u=e[1],a=e[2],f=e[3],l=f*r+u*s-a*i,c=f*i+a*r-o*s,h=f*s+o*i-u*r,p=-o*r-u*i-a*s;return n[0]=l*f+p*-o+c*-a-h*-u,n[1]=c*f+p*-u+h*-o-l*-a,n[2]=h*f+p*-a+l*-u-c*-o,n},v.scale=function(e,t,n){return!n||e===n?(e[0]*=t,e[1]*=t,e[2]*=t,e[3]*=t,e):(n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n)},v.toMat3=function(e,t){t||(t=p.create());var n=e[0],r=e[1],i=e[2],s=e[3],o=n+n,u=r+r,a=i+i,f=n*o,l=n*u,c=n*a,h=r*u,d=r*a,v=i*a,m=s*o,g=s*u,y=s*a;return t[0]=1-(h+v),t[1]=l+y,t[2]=c-g,t[3]=l-y,t[4]=1-(f+v),t[5]=d+m,t[6]=c+g,t[7]=d-m,t[8]=1-(f+h),t},v.toMat4=function(e,t){t||(t=d.create());var n=e[0],r=e[1],i=e[2],s=e[3],o=n+n,u=r+r,a=i+i,f=n*o,l=n*u,c=n*a,h=r*u,p=r*a,v=i*a,m=s*o,g=s*u,y=s*a;return t[0]=1-(h+v),t[1]=l+y,t[2]=c-g,t[3]=0,t[4]=l-y,t[5]=1-(f+v),t[6]=p+m,t[7]=0,t[8]=c+g,t[9]=p-m,t[10]=1-(f+h),t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},v.slerp=function(e,t,n,r){r||(r=e);var i=e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3],s,o,u,a;return Math.abs(i)>=1?(r!==e&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3]),r):(s=Math.acos(i),o=Math.sqrt(1-i*i),Math.abs(o)<.001?(r[0]=e[0]*.5+t[0]*.5,r[1]=e[1]*.5+t[1]*.5,r[2]=e[2]*.5+t[2]*.5,r[3]=e[3]*.5+t[3]*.5,r):(u=Math.sin((1-n)*s)/o,a=Math.sin(n*s)/o,r[0]=e[0]*u+t[0]*a,r[1]=e[1]*u+t[1]*a,r[2]=e[2]*u+t[2]*a,r[3]=e[3]*u+t[3]*a,r))},v.fromRotationMatrix=function(e,t){t||(t=v.create());var n=e[0]+e[4]+e[8],r;if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[7]-e[5])*r,t[1]=(e[2]-e[6])*r,t[2]=(e[3]-e[1])*r;else{var i=v.fromRotationMatrix.s_iNext=v.fromRotationMatrix.s_iNext||[1,2,0],s=0;e[4]>e[0]&&(s=1),e[8]>e[s*3+s]&&(s=2);var o=i[s],u=i[o];r=Math.sqrt(e[s*3+s]-e[o*3+o]-e[u*3+u]+1),t[s]=.5*r,r=.5/r,t[3]=(e[u*3+o]-e[o*3+u])*r,t[o]=(e[o*3+s]+e[s*3+o])*r,t[u]=(e[u*3+s]+e[s*3+u])*r}return t},p.toQuat4=v.fromRotationMatrix,function(){var e=p.create();v.fromAxes=function(t,n,r,i){return e[0]=n[0],e[3]=n[1],e[6]=n[2],e[1]=r[0],e[4]=r[1],e[7]=r[2],e[2]=t[0],e[5]=t[1],e[8]=t[2],v.fromRotationMatrix(e,i)}}(),v.identity=function(e){return e||(e=v.create()),e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},v.fromAngleAxis=function(e,t,n){n||(n=v.create());var r=e*.5,i=Math.sin(r);return n[3]=Math.cos(r),n[0]=i*t[0],n[1]=i*t[1],n[2]=i*t[2],n},v.toAngleAxis=function(e,t){t||(t=e);var r=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];if(r>0){t[3]=2*Math.acos(e[3]);var i=n.invsqrt(r);t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i}else t[3]=0,t[0]=1,t[1]=0,t[2]=0;return t},v.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+"]"};var g={};g.create=function(e){var t=new r(2);return e?(t[0]=e[0],t[1]=e[1]):(t[0]=0,t[1]=0),t},g.createFrom=function(e,t){var n=new r(2);return n[0]=e,n[1]=t,n},g.add=function(e,t,n){return n||(n=t),n[0]=e[0]+t[0],n[1]=e[1]+t[1],n},g.subtract=function(e,t,n){return n||(n=t),n[0]=e[0]-t[0],n[1]=e[1]-t[1],n},g.multiply=function(e,t,n){return n||(n=t),n[0]=e[0]*t[0],n[1]=e[1]*t[1],n},g.divide=function(e,t,n){return n||(n=t),n[0]=e[0]/t[0],n[1]=e[1]/t[1],n},g.scale=function(e,t,n){return n||(n=e),n[0]=e[0]*t,n[1]=e[1]*t,n},g.dist=function(e,t){var n=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(n*n+r*r)},g.set=function(e,t){return t[0]=e[0],t[1]=e[1],t},g.equal=function(e,n){return e===n||Math.abs(e[0]-n[0])<t&&Math.abs(e[1]-n[1])<t},g.negate=function(e,t){return t||(t=e),t[0]=-e[0],t[1]=-e[1],t},g.normalize=function(e,t){t||(t=e);var n=e[0]*e[0]+e[1]*e[1];return n>0?(n=Math.sqrt(n),t[0]=e[0]/n,t[1]=e[1]/n):t[0]=t[1]=0,t},g.cross=function(e,t,n){var r=e[0]*t[1]-e[1]*t[0];return n?(n[0]=n[1]=0,n[2]=r,n):r},g.length=function(e){var t=e[0],n=e[1];return Math.sqrt(t*t+n*n)},g.squaredLength=function(e){var t=e[0],n=e[1];return t*t+n*n},g.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},g.direction=function(e,t,n){n||(n=e);var r=e[0]-t[0],i=e[1]-t[1],s=r*r+i*i;return s?(s=1/Math.sqrt(s),n[0]=r*s,n[1]=i*s,n):(n[0]=0,n[1]=0,n[2]=0,n)},g.lerp=function(e,t,n,r){return r||(r=e),r[0]=e[0]+n*(t[0]-e[0]),r[1]=e[1]+n*(t[1]-e[1]),r},g.str=function(e){return"["+e[0]+", "+e[1]+"]"};var y={};y.create=function(e){var t=new r(4);return e?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]):t[0]=t[1]=t[2]=t[3]=0,t},y.createFrom=function(e,t,n,i){var s=new r(4);return s[0]=e,s[1]=t,s[2]=n,s[3]=i,s},y.set=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},y.equal=function(e,n){return e===n||Math.abs(e[0]-n[0])<t&&Math.abs(e[1]-n[1])<t&&Math.abs(e[2]-n[2])<t&&Math.abs(e[3]-n[3])<t},y.identity=function(e){return e||(e=y.create()),e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},y.transpose=function(e,t){if(!t||e===t){var n=e[1];return e[1]=e[2],e[2]=n,e}return t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3],t},y.determinant=function(e){return e[0]*e[3]-e[2]*e[1]},y.inverse=function(e,t){t||(t=e);var n=e[0],r=e[1],i=e[2],s=e[3],o=n*s-i*r;return o?(o=1/o,t[0]=s*o,t[1]=-r*o,t[2]=-i*o,t[3]=n*o,t):null},y.multiply=function(e,t,n){n||(n=e);var r=e[0],i=e[1],s=e[2],o=e[3];return n[0]=r*t[0]+i*t[2],n[1]=r*t[1]+i*t[3],n[2]=s*t[0]+o*t[2],n[3]=s*t[1]+o*t[3],n},y.rotate=function(e,t,n){n||(n=e);var r=e[0],i=e[1],s=e[2],o=e[3],u=Math.sin(t),a=Math.cos(t);return n[0]=r*a+i*u,n[1]=r*-u+i*a,n[2]=s*a+o*u,n[3]=s*-u+o*a,n},y.multiplyVec2=function(e,t,n){n||(n=t);var r=t[0],i=t[1];return n[0]=r*e[0]+i*e[1],n[1]=r*e[2]+i*e[3],n},y.scale=function(e,t,n){n||(n=e);var r=e[0],i=e[1],s=e[2],o=e[3],u=t[0],a=t[1];return n[0]=r*u,n[1]=i*a,n[2]=s*u,n[3]=o*a,n},y.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+"]"};var b={};return b.create=function(e){var t=new r(4);return e?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]):(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t},b.createFrom=function(e,t,n,i){var s=new r(4);return s[0]=e,s[1]=t,s[2]=n,s[3]=i,s},b.add=function(e,t,n){return n||(n=t),n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n},b.subtract=function(e,t,n){return n||(n=t),n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n},b.multiply=function(e,t,n){return n||(n=t),n[0]=e[0]*t[0],n[1]=e[1]*t[1],n[2]=e[2]*t[2],n[3]=e[3]*t[3],n},b.divide=function(e,t,n){return n||(n=t),n[0]=e[0]/t[0],n[1]=e[1]/t[1],n[2]=e[2]/t[2],n[3]=e[3]/t[3],n},b.scale=function(e,t,n){return n||(n=e),n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n},b.set=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},b.equal=function(e,n){return e===n||Math.abs(e[0]-n[0])<t&&Math.abs(e[1]-n[1])<t&&Math.abs(e[2]-n[2])<t&&Math.abs(e[3]-n[3])<t},b.negate=function(e,t){return t||(t=e),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},b.length=function(e){var t=e[0],n=e[1],r=e[2],i=e[3];return Math.sqrt(t*t+n*n+r*r+i*i)},b.squaredLength=function(e){var t=e[0],n=e[1],r=e[2],i=e[3];return t*t+n*n+r*r+i*i},b.lerp=function(e,t,n,r){return r||(r=e),r[0]=e[0]+n*(t[0]-e[0]),r[1]=e[1]+n*(t[1]-e[1]),r[2]=e[2]+n*(t[2]-e[2]),r[3]=e[3]+n*(t[3]-e[3]),r},b.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+"]"},e&&(e.glMatrixArrayType=r,e.MatrixArray=r,e.setMatrixArrayType=i,e.determineMatrixArrayType=s,e.glMath=n,e.vec2=g,e.vec3=o,e.vec4=b,e.mat2=y,e.mat3=p,e.mat4=d,e.quat4=v),{glMatrixArrayType:r,MatrixArray:r,setMatrixArrayType:i,determineMatrixArrayType:s,glMath:n,vec2:g,vec3:o,vec4:b,mat2:y,mat3:p,mat4:d,quat4:v}}),define("common/qmath",["glmatrix"],function(e){function i(e){if(!e)return 0;var t=0,n=0,i;for(var s=0,o=r.length;s<o;s++)i=vec3.dot(e,r[s]),i>n&&(n=i,t=s);return t}function s(e,t){if(e<0||e>=r.length){vec3.create(t);return}vec3.set(r[e],t)}function o(e,t){return Math.random()*(t-e)+e}function u(e,t){return Math.floor(Math.random()*(t-e+1))+e}function a(){return 2*(Math.random()-.5)}function f(e){e[0]=Math.round(e[0]),e[1]=Math.round(e[1]),e[2]=Math.round(e[2])}function l(e,t){var n,r,i=1;for(var n=0,r=0;n<3;n++)Math.abs(e[n])<i&&(r=n,i=Math.abs(e[n]));var s=vec3.create();s[r]=1,X(s,e,t),vec3.normalize(t)}function d(e){return e*Math.PI/180}function v(e){return e*180/Math.PI}function m(e,t){var n=e-t;while(n>180)n-=360;while(n<-180)n+=360;return n}function g(e,t,n){n[0]=m(e[0],t[0]),n[1]=m(e[1],t[1]),n[2]=m(e[2],t[2])}function y(e,t,n){return t-e>180&&(t-=360),t-e<-180&&(t+=360),e+n*(t-e)}function b(e){return e=360/65536*(parseInt(e*(65536/360),10)&65535),e}function w(e){return e=b(e),e>180&&(e-=360),e}function E(e,t,n,r){var i,s,o,u,a,f,l;i=e[h]*(Math.PI*2/360),u=Math.sin(i),l=Math.cos(i),i=e[c]*(Math.PI*2/360),o=Math.sin(i),f=Math.cos(i),i=e[p]*(Math.PI*2/360),s=Math.sin(i),a=Math.cos(i),t&&(t[0]=f*l,t[1]=f*u,t[2]=-o),n&&(n[0]=-1*s*o*l+ -1*a*-u,n[1]=-1*s*o*u+ -1*a*l,n[2]=-1*s*f),r&&(r[0]=a*o*l+ -s*-u,r[1]=a*o*u+ -s*l,r[2]=a*f)}function S(e,t){var n,r,i;e[1]===0&&e[0]===0?(r=0,i=e[2]>0?90:270):(e[0]?r=Math.atan2(e[1],e[0])*180/Math.PI:e[1]>0?r=90:r=270,r<0&&(r+=360),n=Math.sqrt(e[0]*e[0]+e[1]*e[1]),i=Math.atan2(e[2],n)*180/Math.PI,i<0&&(i+=360)),t[c]=-i,t[h]=r,t[p]=0}function x(e){return e*65536/360&65535}function T(e){return e*(360/65536)}function N(e){e[0][0]=1,e[0][1]=0,e[0][2]=0,e[1][0]=0,e[1][1]=1,e[1][2]=0,e[2][0]=0,e[2][1]=0,e[2][2]=1}function C(e,t){vec3.set(e[0],t[0]),vec3.set(e[1],t[1]),vec3.set(e[2],t[2])}function k(e,t){E(e,t[0],t[1],t[2]),vec3.negate(t[1])}function L(e,t,n){n[0][0]=e[0][0]*t[0][0]+e[0][1]*t[1][0]+e[0][2]*t[2][0],n[0][1]=e[0][0]*t[0][1]+e[0][1]*t[1][1]+e[0][2]*t[2][1],n[0][2]=e[0][0]*t[0][2]+e[0][1]*t[1][2]+e[0][2]*t[2][2],n[1][0]=e[1][0]*t[0][0]+e[1][1]*t[1][0]+e[1][2]*t[2][0],n[1][1]=e[1][0]*t[0][1]+e[1][1]*t[1][1]+e[1][2]*t[2][1],n[1][2]=e[1][0]*t[0][2]+e[1][1]*t[1][2]+e[1][2]*t[2][2],n[2][0]=e[2][0]*t[0][0]+e[2][1]*t[1][0]+e[2][2]*t[2][0],n[2][1]=e[2][0]*t[0][1]+e[2][1]*t[1][1]+e[2][2]*t[2][1],n[2][2]=e[2][0]*t[0][2]+e[2][1]*t[1][2]+e[2][2]*t[2][2]}function A(e,t){var n=vec3.create(e);e[0]=vec3.dot(t[0],n),e[1]=vec3.dot(t[1],n),e[2]=vec3.dot(t[2],n)}function O(e,t,n,r){var i=mat4.identity();mat4.rotate(i,d(n),t),mat4.multiplyVec3(i,e,r)}function M(e,t){l(e[0],e[1]);if(t){var n=vec3.create(e[1]);O(n,e[0],t,e[1])}vec3.cross(e[0],e[1],e[2])}function R(e){return e[0]==1?_:e[1]==1?D:e[2]==1?P:H}function U(e){var t=0;for(var n=0;n<3;n++)e[n]<0&&(t|=1<<n);return t}function z(e,t){var n=vec3.dot(e,t.normal)-t.dist;return n>I?B:n<-I?j:F}function W(e,t,n){if(n.type<H)return n.dist<=e[n.type]?B:n.dist>=t[n.type]?j:F;var r=[0,0];if(n.signbits<8)for(var i=0;i<3;i++){var s=n.signbits>>i&1;r[s]+=n.normal[i]*t[i],r[s^1]+=n.normal[i]*e[i]}var o=0;return r[0]>=n.dist&&(o=B),r[1]<n.dist&&(o|=j),o}function X(e,t,n){var r=vec3.scale(t,vec3.dot(t,e),vec3.create());vec3.subtract(e,r,n)}function V(e,t,n){var r=new q,i=vec3.subtract(t,e,vec3.create()),s=vec3.subtract(n,e,vec3.create());return vec3.cross(s,i,r.normal),vec3.normalize(r.normal),vec3.length(r.normal)===0?null:(r.dist=vec3.dot(e,r.normal),r.signbits=U(r.normal),r)}function K(e,t){return Math.abs(e.normal[0]-t.normal[0])<$&&Math.abs(e.normal[1]-t.normal[1])<$&&Math.abs(e.normal[2]-t.normal[2])<$&&Math.abs(e.dist-t.dist)<J?!0:!1}function Z(e,t){var n=-Q,r,i=-1;for(var s=0;s<3;s++)r=Math.abs(e[s]),r>n&&(i=s,n=r);i===-1&&com.Error("BaseWindingForPlane: no axis found");var o=vec3.create(),u=vec3.create(),a=vec3.create();switch(i){case 0:case 1:o[2]=1;break;case 2:o[0]=1}var r=vec3.dot(o,e);vec3.add(o,vec3.scale(e,-r,vec3.create())),vec3.normalize(o),vec3.scale(e,t,u),vec3.cross(o,e,a),vec3.scale(o,Q),vec3.scale(a,Q);var f=new Y;return f.p[0]=vec3.subtract(u,a,vec3.create()),vec3.add(f.p[0],o,f.p[0]),f.p[1]=vec3.add(u,a,vec3.create()),vec3.add(f.p[1],o,f.p[1]),f.p[2]=vec3.add(u,a,vec3.create()),vec3.subtract(f.p[2],o,f.p[2]),f.p[3]=vec3.subtract(u,a,vec3.create()),vec3.subtract(f.p[3],o,f.p[3]),f}function et(e,t,n){var r;t[0]=t[1]=t[2]=Q,n[0]=n[1]=n[2]=-Q;for(var i=0;i<e.p.length;i++)for(var s=0;s<3;s++)r=e.p[i][s],r<t[s]&&(t[s]=r),r>n[s]&&(n[s]=r)}function tt(e,t,n,r){var i,s,o,u,a,f=new Array(G+4),l=new Array(G+4),c=vec3.create(),h=vec3.create(),p=e.clone();for(i=0;i<p.p.length;i++)o=f[i]=vec3.dot(p.p[i],t)-n,o>r?l[i]=B:o<-r?l[i]=j:l[i]=F,c[l[i]]++;l[i]=l[0],f[i]=f[0];if(!c[B])return!1;if(!c[j])return!0;var d=new Y,v=p.p.length+4;for(i=0;i<p.p.length;i++){u=p.p[i];if(l[i]===F){d.p.push(vec3.set(u,vec3.create()));continue}l[i]===B&&d.p.push(vec3.set(u,vec3.create()));if(l[i+1]===F||l[i+1]===l[i])continue;a=p.p[(i+1)%p.p.length],o=f[i]/(f[i]-f[i+1]);for(var s=0;s<3;s++)t[s]===1?h[s]=n:t[s]===-1?h[s]=-n:h[s]=u[s]+o*(a[s]-u[s]);d.p.push(vec3.set(h,vec3.create()))}return d.p.length>v&&com.Error("ClipWinding: points exceeded estimate"),d.p.length>G&&com.Error("ClipWinding: MAX_POINTS_ON_WINDING"),d.clone(e),!0}function nt(e,t){var n,r,i=vec3.create();for(var s=0;s<3;s++)n=Math.abs(e[s]),r=Math.abs(t[s]),i[s]=n>r?n:r;return vec3.length(i)}function rt(e,t){e[0]=e[1]=e[2]=99999,t[0]=t[1]=t[2]=-99999}function it(e,t,n){e[0]<t[0]&&(t[0]=e[0]),e[0]>n[0]&&(n[0]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>n[1]&&(n[1]=e[1]),e[2]<t[2]&&(t[2]=e[2]),e[2]>n[2]&&(n[2]=e[2])}function st(e,t,n,r,i){return i=i||0,t[0]<n[0]-i||t[1]<n[1]-i||t[2]<n[2]-i||e[0]>r[0]+i||e[1]>r[1]+i||e[2]>r[2]+i?!1:!0}function ot(e,t,n,r){return n[0]-r>t[0]||n[0]+r<e[0]||n[1]-r>t[1]||n[1]+r<e[1]||n[2]-r>t[2]||n[2]+r<e[2]?!1:!0}function ut(e,t,n){return n[0]>t[0]||n[0]<e[0]||n[1]>t[1]||n[1]<e[1]||n[2]>t[2]||n[2]<e[2]?!1:!0}function ft(e,t,n,r){var i=r-n,s=new Array(i),o=[].concat(at),u=[].concat(at),a=[].concat(at),f=[].concat(at),l=0,c,h=0,p,d=0,v,m=0,g,y;for(y=n;y<r;y++)c=e[y][t]&255,p=e[y][t]>>8&255,v=e[y][t]>>16&255,g=e[y][t]>>24&255^128,o[c]++,u[p]++,a[v]++,f[g]++;for(y=0;y<256;y++)c=l+o[y],p=h+u[y],v=d+a[y],g=m+f[y],o[y]=l,u[y]=h,a[y]=d,f[y]=m,l=c,h=p,d=v,m=g;for(y=n;y<r;y++)c=e[y][t]&255,s[o[c]]=e[y],o[c]++;for(y=0;y<i;y++)p=s[y][t]>>8&255,e[n+u[p]]=s[y],u[p]++;for(y=n;y<r;y++)v=e[y][t]>>16&255,s[a[v]]=e[y],a[v]++;for(y=0;y<i;y++)g=s[y][t]>>24&255^128,e[n+f[g]]=s[y],f[g]++;return e}var t=vec3.create(),n=[vec3.createFrom(1,0,0),vec3.createFrom(0,1,0),vec3.createFrom(0,0,1)],r=[[-0.525731,0,.850651],[-0.442863,.238856,.864188],[-0.295242,0,.955423],[-0.309017,.5,.809017],[-0.16246,.262866,.951056],[0,0,1],[0,.850651,.525731],[-0.147621,.716567,.681718],[.147621,.716567,.681718],[0,.525731,.850651],[.309017,.5,.809017],[.525731,0,.850651],[.295242,0,.955423],[.442863,.238856,.864188],[.16246,.262866,.951056],[-0.681718,.147621,.716567],[-0.809017,.309017,.5],[-0.587785,.425325,.688191],[-0.850651,.525731,0],[-0.864188,.442863,.238856],[-0.716567,.681718,.147621],[-0.688191,.587785,.425325],[-0.5,.809017,.309017],[-0.238856,.864188,.442863],[-0.425325,.688191,.587785],[-0.716567,.681718,-0.147621],[-0.5,.809017,-0.309017],[-0.525731,.850651,0],[0,.850651,-0.525731],[-0.238856,.864188,-0.442863],[0,.955423,-0.295242],[-0.262866,.951056,-0.16246],[0,1,0],[0,.955423,.295242],[-0.262866,.951056,.16246],[.238856,.864188,.442863],[.262866,.951056,.16246],[.5,.809017,.309017],[.238856,.864188,-0.442863],[.262866,.951056,-0.16246],[.5,.809017,-0.309017],[.850651,.525731,0],[.716567,.681718,.147621],[.716567,.681718,-0.147621],[.525731,.850651,0],[.425325,.688191,.587785],[.864188,.442863,.238856],[.688191,.587785,.425325],[.809017,.309017,.5],[.681718,.147621,.716567],[.587785,.425325,.688191],[.955423,.295242,0],[1,0,0],[.951056,.16246,.262866],[.850651,-0.525731,0],[.955423,-0.295242,0],[.864188,-0.442863,.238856],[.951056,-0.16246,.262866],[.809017,-0.309017,.5],[.681718,-0.147621,.716567],[.850651,0,.525731],[.864188,.442863,-0.238856],[.809017,.309017,-0.5],[.951056,.16246,-0.262866],[.525731,0,-0.850651],[.681718,.147621,-0.716567],[.681718,-0.147621,-0.716567],[.850651,0,-0.525731],[.809017,-0.309017,-0.5],[.864188,-0.442863,-0.238856],[.951056,-0.16246,-0.262866],[.147621,.716567,-0.681718],[.309017,.5,-0.809017],[.425325,.688191,-0.587785],[.442863,.238856,-0.864188],[.587785,.425325,-0.688191],[.688191,.587785,-0.425325],[-0.147621,.716567,-0.681718],[-0.309017,.5,-0.809017],[0,.525731,-0.850651],[-0.525731,0,-0.850651],[-0.442863,.238856,-0.864188],[-0.295242,0,-0.955423],[-0.16246,.262866,-0.951056],[0,0,-1],[.295242,0,-0.955423],[.16246,.262866,-0.951056],[-0.442863,-0.238856,-0.864188],[-0.309017,-0.5,-0.809017],[-0.16246,-0.262866,-0.951056],[0,-0.850651,-0.525731],[-0.147621,-0.716567,-0.681718],[.147621,-0.716567,-0.681718],[0,-0.525731,-0.850651],[.309017,-0.5,-0.809017],[.442863,-0.238856,-0.864188],[.16246,-0.262866,-0.951056],[.238856,-0.864188,-0.442863],[.5,-0.809017,-0.309017],[.425325,-0.688191,-0.587785],[.716567,-0.681718,-0.147621],[.688191,-0.587785,-0.425325],[.587785,-0.425325,-0.688191],[0,-0.955423,-0.295242],[0,-1,0],[.262866,-0.951056,-0.16246],[0,-0.850651,.525731],[0,-0.955423,.295242],[.238856,-0.864188,.442863],[.262866,-0.951056,.16246],[.5,-0.809017,.309017],[.716567,-0.681718,.147621],[.525731,-0.850651,0],[-0.238856,-0.864188,-0.442863],[-0.5,-0.809017,-0.309017],[-0.262866,-0.951056,-0.16246],[-0.850651,-0.525731,0],[-0.716567,-0.681718,-0.147621],[-0.716567,-0.681718,.147621],[-0.525731,-0.850651,0],[-0.5,-0.809017,.309017],[-0.238856,-0.864188,.442863],[-0.262866,-0.951056,.16246],[-0.864188,-0.442863,.238856],[-0.809017,-0.309017,.5],[-0.688191,-0.587785,.425325],[-0.681718,-0.147621,.716567],[-0.442863,-0.238856,.864188],[-0.587785,-0.425325,.688191],[-0.309017,-0.5,.809017],[-0.147621,-0.716567,.681718],[-0.425325,-0.688191,.587785],[-0.16246,-0.262866,.951056],[.442863,-0.238856,.864188],[.16246,-0.262866,.951056],[.309017,-0.5,.809017],[.147621,-0.716567,.681718],[0,-0.525731,.850651],[.425325,-0.688191,.587785],[.587785,-0.425325,.688191],[.688191,-0.587785,.425325],[-0.955423,.295242,0],[-0.951056,.16246,.262866],[-1,0,0],[-0.850651,0,.525731],[-0.955423,-0.295242,0],[-0.951056,-0.16246,.262866],[-0.864188,.442863,-0.238856],[-0.951056,.16246,-0.262866],[-0.809017,.309017,-0.5],[-0.864188,-0.442863,-0.238856],[-0.951056,-0.16246,-0.262866],[-0.809017,-0.309017,-0.5],[-0.681718,.147621,-0.716567],[-0.681718,-0.147621,-0.716567],[-0.850651,0,-0.525731],[-0.688191,.587785,-0.425325],[-0.587785,.425325,-0.688191],[-0.425325,.688191,-0.587785],[-0.425325,-0.688191,-0.587785],[-0.587785,-0.425325,-0.688191],[-0.688191,-0.587785,-0.425325]],c=0,h=1,p=2,_=0,D=1,P=2,H=3,B=1,j=2,F=3,I=.1,q=function(){this.normal=vec3.create(),this.dist=0,this.type=0,this.signbits=0};q.prototype.clone=function(e){return typeof e=="undefined"&&(e=new q),vec3.set(this.normal,e.normal),e.dist=this.dist,e.type=this.type,e.signbits=this.signbits,e};var $=1e-4,J=.02,Q=65535,G=64,Y=function(){this.p=[]};Y.prototype.clone=function(e){typeof e=="undefined"&&(e=new Y),e.p=new Array(this.p.length);for(var t=0;t<this.p.length;t++)e.p[t]=vec3.create(this.p[t]);return e};var at=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];return{vec3origin:t,axisDefault:n,DirToByte:i,ByteToDir:s,rrandom:o,irrandom:u,crandom:a,SnapVector:f,PerpendicularVector:l,PITCH:c,YAW:h,ROLL:p,DEG2RAD:d,RAD2DEG:v,AngleSubtract:m,AnglesSubtract:g,LerpAngle:y,AngleNormalize360:b,AngleNormalize180:w,AnglesToVectors:E,VectorToAngles:S,AngleToShort:x,ShortToAngle:T,AxisClear:N,AxisCopy:C,AnglesToAxis:k,AxisMultiply:L,RotatePoint:A,RotatePointAroundVector:O,RotateAroundDirection:M,PLANE_X:_,PLANE_Y:D,PLANE_Z:P,PLANE_NON_AXIAL:H,SIDE_FRONT:B,SIDE_BACK:j,SIDE_ON:F,Plane:q,PlaneTypeForNormal:R,GetPlaneSignbits:U,PointOnPlaneSide:z,BoxOnPlaneSide:W,ProjectPointOnPlane:X,PlaneFromPoints:V,PlaneEqual:K,MAX_MAP_BOUNDS:Q,BaseWindingForPlane:Z,WindingBounds:et,ChopWindingInPlace:tt,RadiusFromBounds:nt,ClearBounds:rt,AddPointToBounds:it,BoundsIntersect:st,BoundsIntersectSphere:ot,BoundsIntersectPoint:ut,RadixSort:ft}}),define("common/qshared",["common/qmath"],function(e){function H(e){var t=65536,n=e.length,r=e.slice||e.subarray,i;if(n<t)i=String.fromCharCode.apply(String,e);else{var s=[],o=0;while(o<n)s.push(String.fromCharCode.apply(String,r.call(e,o,o+t))),o+=t;i=s.join("")}return btoa(i)}var t=.1033,n=64,r=16777215,i={ARCHIVE:1,CHEAT:2,USERINFO:4,SERVERINFO:8,SYSTEMINFO:16,LATCH:32},s=1,o=2,u=4,a=10,f=32,l=1024,c=256,h=256,p=l-1,d=l-2,v=l-2,m={BAD:0,LOOPBACK:1,IP:2},g={CLIENT:0,SERVER:1},y=function(){this.type=m.BAD,this.ip=null,this.port=0},b={ATTACK:1,TALK:2,USE_HOLDABLE:4,GESTURE:8,WALKING:16,AFFIRMATIVE:32,NEGATIVE:64,GETFLAG:128,GUARDBASE:256,PATROL:512,FOLLOWME:1024,ANY:2048},w=function(){this.serverTime=0,this.angles=vec3.create(),this.forwardmove=0,this.rightmove=0,this.upmove=0,this.buttons=0,this.weapon=0};w.prototype.clone=function(e){return typeof e=="undefined"&&(e=new w),e.serverTime=this.serverTime,vec3.set(this.angles,e.angles),e.forwardmove=this.forwardmove,e.rightmove=this.rightmove,e.upmove=this.upmove,e.buttons=this.buttons,e.weapon=this.weapon,e};var E=16,S=16,x=16,T=16,N=2,C=6,k=function(){this.clientNum=0,this.commandTime=0,this.pm_type=0,this.pm_flags=0,this.origin=vec3.create(),this.velocity=vec3.create(),this.viewangles=vec3.create(),this.viewheight=0,this.delta_angles=vec3.create(),this.speed=0,this.gravity=0,this.groundEntityNum=p,this.bobCycle=0,this.weapon=0,this.weaponState=0,this.weaponTime=0,this.legsTimer=0,this.legsAnim=0,this.torsoTimer=0,this.torsoAnim=0,this.movementDir=0,this.damageEvent=0,this.damageYaw=0,this.damagePitch=0,this.damageCount=0,this.stats=new Array(E),this.persistant=new Array(S),this.powerups=new Array(x),this.ammo=new Array(T),this.eFlags=0,this.eventSequence=0,this.events=new Array(N),this.eventParms=new Array(N),this.externalEvent=0,this.externalEventParm=0,this.externalEventTime=0,this.ping=0,this.jumppad_ent=0,this.jumppad_frame=0,this.pmove_framecount=0,this.entityEventSequence=0;for(var e=0;e<E;e++)this.stats[e]=0;for(var e=0;e<S;e++)this.persistant[e]=0;for(var e=0;e<x;e++)this.powerups[e]=0;for(var e=0;e<T;e++)this.ammo[e]=0};k.prototype.clone=function(e){typeof e=="undefined"&&(e=new k),e.clientNum=this.clientNum,e.commandTime=this.commandTime,e.pm_type=this.pm_type,e.pm_flags=this.pm_flags,vec3.set(this.origin,e.origin),vec3.set(this.velocity,e.velocity),vec3.set(this.viewangles,e.viewangles),e.viewheight=this.viewheight,vec3.set(this.delta_angles,e.delta_angles),e.speed=this.speed,e.gravity=this.gravity,e.groundEntityNum=this.groundEntityNum,e.bobCycle=this.bobCycle,e.weapon=this.weapon,e.weaponState=this.weaponState,e.weaponTime=this.weaponTime,e.legsTimer=this.legsTimer,e.legsAnim=this.legsAnim,e.torsoTimer=this.torsoTimer,e.torsoAnim=this.torsoAnim,e.movementDir=this.movementDir,e.damageEvent=this.damageEvent,e.damageYaw=this.damageYaw,e.damagePitch=this.damagePitch,e.damageCount=this.damageCount;for(var t=0;t<E;t++)e.stats[t]=this.stats[t];for(var t=0;t<S;t++)e.persistant[t]=this.persistant[t];for(var t=0;t<x;t++)e.powerups[t]=this.powerups[t];for(var t=0;t<T;t++)e.ammo[t]=this.ammo[t];e.eFlags=this.eFlags,e.eventSequence=this.eventSequence;for(var t=0;t<N;t++)e.events[t]=this.events[t],e.eventParms[t]=this.eventParms[t];return e.externalEvent=this.externalEvent,e.externalEventParm=this.externalEventParm,e.externalEventTime=this.externalEventTime,e.jumppad_ent=this.jumppad_ent,e.jumppad_frame=this.jumppad_frame,e.pmove_framecount=this.pmove_framecount,e.entityEventSequence=this.entityEventSequence,e};var L={STATIONARY:0,INTERPOLATE:1,LINEAR:2,LINEAR_STOP:3,SINE:4,GRAVITY:5},A=function(){this.trType=0,this.trTime=0,this.trDuration=0,this.trBase=vec3.create(),this.trDelta=vec3.create()};A.prototype.clone=function(e){return typeof e=="undefined"&&(e=new A),e.trType=this.trType,e.trTime=this.trTime,e.trDuration=this.trDuration,vec3.set(this.trBase,e.trBase),vec3.set(this.trDelta,e.trDelta),e};var O=function(){this.origin=vec3.create(),this.axis=[vec3.create(),vec3.create(),vec3.create()],this.viewOrigin=vec3.create(),this.modelMatrix=mat4.create()};O.prototype.clone=function(e){return typeof e=="undefined"&&(e=new O),vec3.set(this.origin,e.origin),vec3.set(this.axis[0],e.axis[0]),vec3.set(this.axis[1],e.axis[1]),vec3.set(this.axis[2],e.axis[2]),vec3.set(this.viewOrigin,e.viewOrigin),mat4.set(this.modelMatrix,e.modelMatrix),e};var M=function(){this.reset()};M.prototype.reset=function(){this.number=0,this.eType=0,this.eFlags=0,this.pos=new A,this.apos=new A,this.time=0,this.time2=0,this.origin=vec3.create(),this.origin2=vec3.create(),this.angles=vec3.create(),this.angles2=vec3.create(),this.otherEntityNum=0,this.otherEntityNum2=0,this.groundEntityNum=p,this.constantLight=0,this.loopSound=0,this.modelIndex=0,this.modelIndex2=0,this.clientNum=0,this.frame=0,this.solid=0,this.event=0,this.eventParm=0,this.powerups=0,this.weapon=0,this.legsAnim=0,this.torsoAnim=0,this.generic1=0},M.prototype.clone=function(e){return typeof e=="undefined"&&(e=new M),e.number=this.number,e.eType=this.eType,e.eFlags=this.eFlags,this.pos.clone(e.pos),this.apos.clone(e.apos),e.time=this.time,e.time2=this.time2,vec3.set(this.origin,e.origin),vec3.set(this.origin2,e.origin2),vec3.set(this.angles,e.angles),vec3.set(this.angles2,e.angles2),e.otherEntityNum=this.otherEntityNum,e.otherEntityNum2=this.otherEntityNum2,e.groundEntityNum=this.groundEntityNum,e.constantLight=this.constantLight,e.loopSound=this.loopSound,e.modelIndex=this.modelIndex,e.modelIndex2=this.modelIndex2,e.clientNum=this.clientNum,e.frame=this.frame,e.solid=this.solid,e.event=this.event,e.eventParm=this.eventParm,e.powerups=this.powerups,e.weapon=this.weapon,e.legsAnim=this.legsAnim,e.torsoAnim=this.torsoAnim,e.generic1=this.generic1,e};var _={NODAMAGE:1,SLICK:2,SKY:4,LADDER:8,NOIMPACT:16,NOMARKS:32,FLESH:64,NODRAW:128,HINT:256,SKIP:512,NOLIGHTMAP:1024,POINTLIGHT:2048,METALSTEPS:4096,NOSTEPS:8192,NONSOLID:16384,LIGHTFILTER:32768,ALPHASHADOW:65536,NODLIGHT:131072,DUST:262144},D={SOLID:1,LAVA:8,SLIME:16,WATER:32,FOG:64,NOTTEAM1:128,NOTTEAM2:256,NOBOTCLIP:512,AREAPORTAL:32768,PLAYERCLIP:65536,MONSTERCLIP:131072,TELEPORTER:262144,JUMPPAD:524288,CLUSTERPORTAL:1048576,DONOTENTER:2097152,BOTCLIP:4194304,MOVER:8388608,ORIGIN:16777216,BODY:33554432,CORPSE:67108864,DETAIL:134217728,STRUCTURAL:268435456,TRANSLUCENT:536870912,TRIGGER:1073741824,NODROP:2147483648},P={ATBASE:0,TAKEN:1,TAKEN_RED:2,TAKEN_BLUE:3,DROPPED:4};return{GAME_VERSION:t,CMD_BACKUP:n,SOLID_BMODEL:r,SNAPFLAG_RATE_DELAYED:s,SNAPFLAG_NOT_ACTIVE:o,SNAPFLAG_SERVERCOUNT:u,GENTITYNUM_BITS:a,MAX_CLIENTS:f,MAX_GENTITIES:l,MAX_MODELS:c,MAX_SOUNDS:h,ENTITYNUM_NONE:p,ENTITYNUM_WORLD:d,ENTITYNUM_MAX_NORMAL:v,MAX_STATS:E,MAX_PERSISTANT:S,MAX_POWERUPS:x,MAX_WEAPONS:T,MAX_PS_EVENTS:N,PMOVEFRAMECOUNTBITS:C,CVF:i,BUTTON:b,TR:L,SURF:_,CONTENTS:D,FLAG:P,NA:m,NS:g,PlayerState:k,Trajectory:A,Orientation:O,EntityState:M,NetAdr:y,UserCmd:w,atob64:H}}),function(e){var t;t=function(){function u(t,n,i,s){var o;t==null&&(t=0),n==null&&(n=r.BIG_ENDIAN),i==null&&(i=!1),s==null&&(s=!1),this._buffer=null,this._raw=null,this._view=null,this._order=!!n,this._implicitGrowth=!!s,this._index=0,o=e(t,i),o||(o=new ArrayBuffer(t)),this.buffer=o}var e,t,n,r,i,s,o=this;return u.LITTLE_ENDIAN=!0,u.BIG_ENDIAN=!1,r=u,t=function(e,t){return Object.defineProperty(u.prototype,e,{get:t,enumerable:!0,configurable:!0})},i=function(e,t){return Object.defineProperty(u.prototype,e,{set:t,enumerable:!0,configurable:!0})},u.prototype._sanitizeIndex=function(){this._index<0&&(this._index=0);if(this._index>this.length)return this._index=this.length},e=function(e,t){t==null&&(t=!1);if(e.byteLength!=null)return e.buffer!=null?t?e.buffer.slice(0):e.buffer:t?e.slice(0):e;if(e.length==null)return null;try{return(new Uint8Array(e)).buffer}catch(n){return null}},t("buffer",function(){return this._buffer}),i("buffer",function(e){return this._buffer=e,this._raw=new Uint8Array(this._buffer),this._view=new DataView(this._buffer),this._sanitizeIndex()}),t("raw",function(){return this._raw}),t("view",function(){return this._view}),t("length",function(){return this._buffer.byteLength}),t("byteLength",function(){return this.length}),t("order",function(){return this._order}),i("order",function(e){return this._order=!!e}),t("implicitGrowth",function(){return this._implicitGrowth}),i("implicitGrowth",function(e){return this._implicitGrowth=!!e}),t("index",function(){return this._index}),i("index",function(e){if(e<0||e>this.length)throw new RangeError("Invalid index "+e+", should be between 0 and "+this.length);return this._index=e}),u.prototype.front=function(){return this._index=0,this},u.prototype.end=function(){return this._index=this.length,this},u.prototype.seek=function(e){return e==null&&(e=1),this.index+=e,this},t("available",function(){return this.length-this._index}),n=function(e,t){return function(n){var r;n==null&&(n=this._order);if(t>this.available)throw new Error("Cannot read "+t+" byte(s), "+this.available+" available");return r=this._view[e](this._index,n),this._index+=t,r}},s=function(e,t){return function(n,r){var i;r==null&&(r=this._order),i=this.available;if(t>i){if(!this._implicitGrowth)throw new Error("Cannot write "+n+" using "+t+" byte(s), "+i+" available");this.append(t-i)}return this._view[e](this._index,n,r),this._index+=t,this}},u.prototype.readByte=n("getInt8",1),u.prototype.readUnsignedByte=n("getUint8",1),u.prototype.readShort=n("getInt16",2),u.prototype.readUnsignedShort=n("getUint16",2),u.prototype.readInt=n("getInt32",4),u.prototype.readUnsignedInt=n("getUint32",4),u.prototype.readFloat=n("getFloat32",4),u.prototype.readDouble=n("getFloat64",8),u.prototype.writeByte=s("setInt8",1),u.prototype.writeUnsignedByte=s("setUint8",1),u.prototype.writeShort=s("setInt16",2),u.prototype.writeUnsignedShort=s("setUint16",2),u.prototype.writeInt=s("setInt32",4),u.prototype.writeUnsignedInt=s("setUint32",4),u.prototype.writeFloat=s("setFloat32",4),u.prototype.writeDouble=s("setFloat64",8),u.prototype.read=function(e){var t;e==null&&(e=this.available);if(e>this.available)throw new Error("Cannot read "+e+" byte(s), "+this.available+" available");if(e<=0)throw new RangeError("Invalid number of bytes "+e);return t=new r(this._buffer.slice(this._index,this._index+e)),this._index+=e,t},u.prototype.write=function(t){var n,r,i;if(t instanceof Uint8Array)i=t;else{r=e(t);if(!r)throw new TypeError("Cannot write "+t+", not a sequence");i=new Uint8Array(r)}n=this.available;if(i.byteLength>n){if(!this._implicitGrowth)throw new Error("Cannot write "+t+" using "+i.byteLength+" byte(s), "+this.available+" available");this.append(i.byteLength-n)}return this._raw.set(i,this._index),this._index+=i.byteLength,this},u.prototype.readString=function(e){var t,n,r,i,s,o,u,a,f,l,c,h,p;e==null&&(e=this.available);if(e>this.available)throw new Error("Cannot read "+e+" byte(s), "+this.available+" available");if(e<=0)throw new RangeError("Invalid number of bytes "+e);h=this._raw,u=[],s=0,t=n=r=i=null,p=this._index+e;while(this._index<p){t=h[this._index];if(t<128)u[s++]=t,this._index++;else{if(t<194)throw new Error("Unexpected continuation byte");if(t<224){n=h[this._index+1];if(n<128||n>191)throw new Error("Bad continuation byte");u[s++]=((t&31)<<6)+(n&63),this._index+=2}else if(t<240){n=h[this._index+1];if(n<128||n>191)throw new Error("Bad continuation byte");r=h[this._index+2];if(r<128||r>191)throw new Error("Bad continuation byte");u[s++]=((t&15)<<12)+((n&63)<<6)+(r&63),this._index+=3}else{if(!(t<245))throw new Error("Illegal byte");n=h[this._index+1];if(n<128||n>191)throw new Error("Bad continuation byte");r=h[this._index+2];if(r<128||r>191)throw new Error("Bad continuation byte");i=h[this._index+3];if(i<128||i>191)throw new Error("Bad continuation byte");a=((t&7)<<18)+((n&63)<<12)+((r&63)<<6)+(i&63),a-=65536,u[s++]=55296+((a&1047552)>>>10),u[s++]=56320+(a&1023),this._index+=4}}}c=65536,l=u.length;if(l<c)return String.fromCharCode.apply(String,u);o=[],f=0;while(f<l)o.push(String.fromCharCode.apply(String,u.slice(f,f+c))),f+=c;return o.join("")},u.prototype.writeString=function(e){var t,n,r,i,s,o,u;n=[],u=e.length,o=0,t=0;while(o<u){r=e.charCodeAt(o);if(r<=127)n[t++]=r;else if(r<=2047)n[t++]=192|(r&1984)>>>6,n[t++]=128|r&63;else if(r<=55295||r>=57344&&r<=65535)n[t++]=224|(r&61440)>>>12,n[t++]=128|(r&4032)>>>6,n[t++]=128|r&63;else{if(o===u-1)throw new Error("Unpaired surrogate "+e[o]+" (index "+o+")");s=e.charCodeAt(++o);if(r<55296||r>56319||s<56320||s>57343)throw new Error("Unpaired surrogate "+e[o]+" (index "+o+")");i=((r&1023)<<10)+(s&1023)+65536,n[t++]=240|(i&1835008)>>>18,n[t++]=128|(i&258048)>>>12,n[t++]=128|(i&4032)>>>6,n[t++]=128|i&63}++o}return this.write(n),n.length},u.prototype.readUTFChars=u.prototype.readString,u.prototype.writeUTFChars=u.prototype.writeString,u.prototype.readCString=function(){var e,t,n,r;e=this._raw,n=e.length,t=this._index;while(e[t]!==0&&t<n)++t;return n=t-this._index,n>0?(r=this.readString(n),this.readByte(),r):null},u.prototype.writeCString=function(e){var t;return t=this.writeString(e),this.writeByte(0),++t},u.prototype.readASCIIString=function(e){var t,n,r,i,s,o;if(e>this.available)throw new Error("Cannot read "+e+" byte(s), "+this.available+" available");if(e<=0)throw new RangeError("Invalid number of bytes "+e);t=0,s=[],n=!1;while(t<e)r=this.readByte(),r===0?n=!0:n||s.push(r),t++;e=s.length,i=65536;if(e<i)return String.fromCharCode.apply(String,s);o=[],t=0;while(t<e)o.push(String.fromCharCode.apply(String,s.slice(t,t+i))),t+=i;return o.join("")},u.prototype.writeASCIIString=function(e,t){var n,r,i,s;n=this._raw,r=0,i=t||e.length,s=[];while(r<i)s[r++]=r<e.length?e.charCodeAt(r):0;return this.write(s),i},u.prototype.prepend=function(e){var t;if(e<=0)throw new RangeError("Invalid number of bytes "+e);return t=new Uint8Array(this.length+e),t.set(this._raw,e),this._index+=e,this.buffer=t.buffer,this},u.prototype.append=function(e){var t;if(e<=0)throw new RangeError("Invalid number of bytes "+e);return t=new Uint8Array(this.length+e),t.set(this._raw,0),this.buffer=t.buffer,this},u.prototype.clip=function(e,t){var n;return e==null&&(e=this._index),t==null&&(t=this.length),e<0&&(e=this.length+e),n=this._buffer.slice(e,t),this._index-=e,this.buffer=n,this},u.prototype.slice=function(e,t){var n;return e==null&&(e=0),t==null&&(t=this.length),n=new r(this._buffer.slice(e,t)),n},u.prototype.clone=function(){var e;return e=new r(this._buffer.slice(0)),e.index=this._index,e},u.prototype.reverse=function(){return Array.prototype.reverse.call(this._raw),this._index=0,this},u.prototype.toArray=function(){return Array.prototype.slice.call(this._raw,0)},u.prototype.toString=function(){var e;return e=this._order===r.BIG_ENDIAN?"big-endian":"little-endian","[ByteBuffer; Order: "+e+"; Length: "+this.length+"; Index: "+this._index+"; Available: "+this.available+"]"},u.prototype.toHex=function(e){return e==null&&(e=" "),Array.prototype.map.call(this._raw,function(e){return("00"+e.toString(16).toUpperCase()).slice(-2)}).join(e)},u.prototype.toASCII=function(e,t,n){var r;return e==null&&(e=" "),t==null&&(t=!0),n==null&&(n=""),r=t?" ":"",Array.prototype.map.call(this._raw,function(e){return e<32||e>126?r+n:r+String.fromCharCode(e)}).join(e)},u}.call(this),typeof define=="function"&&define.amd?define("ByteBuffer",[],function(){return t}):e.ByteBuffer=t}(this),define("common/bsp-serializer",["ByteBuffer","common/qmath"],function(e,t){function y(t){var n=new e(t,e.LITTLE_ENDIAN),i=new o;i.ident=n.readASCIIString(4),i.version=n.readInt();for(var u=0;u<r.NUM_LUMPS;u++)i.lumps[u].fileofs=n.readInt(),i.lumps[u].filelen=n.readInt();if(i.ident!=="IBSP"&&i.version!==46)return callback(new Error("Invalid BSP version: "+i.version));var a=new s;return b(a,t,i.lumps[r.ENTITIES]),w(a,t,i.lumps[r.SHADERS]),E(a,t,i.lumps[r.PLANES]),S(a,t,i.lumps[r.NODES]),x(a,t,i.lumps[r.LEAFS]),T(a,t,i.lumps[r.LEAFSURFACES]),N(a,t,i.lumps[r.LEAFBRUSHES]),C(a,t,i.lumps[r.MODELS]),k(a,t,i.lumps[r.BRUSHES]),L(a,t,i.lumps[r.BRUSHSIDES]),A(a,t,i.lumps[r.DRAWVERTS]),O(a,t,i.lumps[r.DRAWINDEXES]),M(a,t,i.lumps[r.FOGS]),_(a,t,i.lumps[r.SURFACES]),D(a,t,i.lumps[r.LIGHTMAPS]),P(a,t,i.lumps[r.LIGHTGRID]),H(a,t,i.lumps[r.VISIBILITY]),a}function b(t,n,r){var i=new e(n,e.LITTLE_ENDIAN);i.index=r.fileofs;var s=i.readASCIIString(r.filelen),o=t.entities=[];s.replace(/\{([^}]*)\}/mg,function(e,t){var n={classname:"unknown"};t.replace(/"(.+)" "(.+)"$/mg,function(e,t,r){n[t]=r}),o.push(n)});var u=o[0];if(u.classname!=="worldspawn"){error("worldspawn isn't the first entity");return}if(u.gridsize){var a=u.gridsize.split(" ");t.lightGridSize[0]=parseFloat(a[0]),t.lightGridSize[1]=parseFloat(a[1]),t.lightGridSize[2]=parseFloat(a[2])}}function w(t,r,i){var s=new e(r,e.LITTLE_ENDIAN);s.index=i.fileofs;var o=t.shaders=new Array(i.filelen/f.size);for(var u=0;u<o.length;u++){var a=o[u]=new f;a.shaderName=s.readASCIIString(n),a.surfaceFlags=s.readInt(),a.contents=s.readInt()}}function E(n,r,i){var s=new e(r,e.LITTLE_ENDIAN);s.index=i.fileofs;var o=n.planes=new Array(i.filelen/l.size);for(var u=0;u<o.length;u++){var a=o[u]=new t.Plane;a.normal[0]=s.readFloat(),a.normal[1]=s.readFloat(),a.normal[2]=s.readFloat(),a.dist=s.readFloat(),a.signbits=t.GetPlaneSignbits(a.normal),a.type=t.PlaneTypeForNormal(a.normal)}}function S(t,n,r){var i=new e(n,e.LITTLE_ENDIAN);i.index=r.fileofs;var s=t.nodes=new Array(r.filelen/c.size);for(var o=0;o<s.length;o++){var u=s[o]=new c;u.planeNum=i.readInt(),u.childrenNum[0]=i.readInt(),u.childrenNum[1]=i.readInt(),u.mins[0]=i.readInt(),u.mins[1]=i.readInt(),u.mins[2]=i.readInt(),u.maxs[0]=i.readInt(),u.maxs[1]=i.readInt(),u.maxs[2]=i.readInt()}}function x(t,n,r){var i=new e(n,e.LITTLE_ENDIAN);i.index=r.fileofs;var s=t.leafs=new Array(r.filelen/h.size);for(var o=0;o<s.length;o++){var u=s[o]=new h;u.cluster=i.readInt(),u.area=i.readInt(),u.mins[0]=i.readInt(),u.mins[1]=i.readInt(),u.mins[2]=i.readInt(),u.maxs[0]=i.readInt(),u.maxs[1]=i.readInt(),u.maxs[2]=i.readInt(),u.firstLeafSurface=i.readInt(),u.numLeafSurfaces=i.readInt(),u.firstLeafBrush=i.readInt(),u.numLeafBrushes=i.readInt()}}function T(t,n,r){var i=new e(n,e.LITTLE_ENDIAN);i.index=r.fileofs;var s=t.leafSurfaces=new Array(r.filelen/4);for(var o=0;o<s.length;o++)s[o]=i.readInt()}function N(t,n,r){var i=new e(n,e.LITTLE_ENDIAN);i.index=r.fileofs;var s=t.leafBrushes=new Array(r.filelen/4);for(var o=0;o<s.length;o++)s[o]=i.readInt()}function C(t,n,r){var i=new e(n,e.LITTLE_ENDIAN);i.index=r.fileofs;var s=t.bmodels=new Array(r.filelen/a.size);for(var o=0;o<s.length;o++){var u=s[o]=new a;u.bounds[0][0]=i.readFloat(),u.bounds[0][1]=i.readFloat(),u.bounds[0][2]=i.readFloat(),u.bounds[1][0]=i.readFloat(),u.bounds[1][1]=i.readFloat(),u.bounds[1][2]=i.readFloat(),u.firstSurface=i.readInt(),u.numSurfaces=i.readInt(),u.firstBrush=i.readInt(),u.numBrushes=i.readInt()}}function k(t,n,r){var i=new e(n,e.LITTLE_ENDIAN);i.index=r.fileofs;var s=t.brushes=new Array(r.filelen/d.size);for(var o=0;o<s.length;o++){var u=s[o]=new d;u.side=i.readInt(),u.numSides=i.readInt(),u.shaderNum=i.readInt()}}function L(t,n,r){var i=new e(n,e.LITTLE_ENDIAN);i.index=r.fileofs;var s=t.brushSides=new Array(r.filelen/p.size);for(var o=0;o<s.length;o++){var u=s[o]=new p;u.planeNum=i.readInt(),u.shaderNum=i.readInt()}}function A(t,n,r){var i=new e(n,e.LITTLE_ENDIAN);i.index=r.fileofs;var s=t.verts=new Array(r.filelen/m.size);for(var o=0;o<s.length;o++){var u=s[o]=new m;u.pos[0]=i.readFloat(),u.pos[1]=i.readFloat(),u.pos[2]=i.readFloat(),u.texCoord[0]=i.readFloat(),u.texCoord[1]=i.readFloat(),u.lmCoord[0]=i.readFloat(),u.lmCoord[1]=i.readFloat(),u.normal[0]=i.readFloat(),u.normal[1]=i.readFloat(),u.normal[2]=i.readFloat(),u.color[0]=i.readUnsignedByte(),u.color[1]=i.readUnsignedByte(),u.color[2]=i.readUnsignedByte(),u.color[3]=i.readUnsignedByte()}}function O(t,n,r){var i=new e(n,e.LITTLE_ENDIAN);i.index=r.fileofs;var s=t.indexes=new Array(r.filelen/4);for(var o=0;o<s.length;o++)s[o]=i.readInt()}function M(t,r,i){var s=new e(r,e.LITTLE_ENDIAN);s.index=i.fileofs;var o=t.fogs=new Array(i.filelen/v.size);for(var u=0;u<o.length;u++){var a=o[u]=new v;a.shaderName=s.readASCIIString(n),a.brushNum=s.readInt(),a.visibleSide=s.readInt()}}function _(t,n,r){var i=new e(n,e.LITTLE_ENDIAN);i.index=r.fileofs;var s=t.surfaces=new Array(r.filelen/g.size);for(var o=0;o<s.length;o++){var u=s[o]=new g;u.shaderNum=i.readInt(),u.fogNum=i.readInt(),u.surfaceType=i.readInt(),u.vertex=i.readInt(),u.vertCount=i.readInt(),u.meshVert=i.readInt(),u.meshVertCount=i.readInt(),u.lightmapNum=i.readInt(),u.lightmapX=i.readInt(),u.lightmapY=i.readInt(),u.lightmapWidth=i.readInt(),u.lightmapHeight=i.readInt(),u.lightmapOrigin[0]=i.readFloat(),u.lightmapOrigin[1]=i.readFloat(),u.lightmapOrigin[2]=i.readFloat(),u.lightmapVecs[0][0]=i.readFloat(),u.lightmapVecs[0][1]=i.readFloat(),u.lightmapVecs[0][2]=i.readFloat(),u.lightmapVecs[1][0]=i.readFloat(),u.lightmapVecs[1][1]=i.readFloat(),u.lightmapVecs[1][2]=i.readFloat(),u.lightmapVecs[2][0]=i.readFloat(),u.lightmapVecs[2][1]=i.readFloat(),u.lightmapVecs[2][2]=i.readFloat(),u.patchWidth=i.readInt(),u.patchHeight=i.readInt()}}function D(t,n,r){var i=new e(n,e.LITTLE_ENDIAN);i.index=r.fileofs,t.lightmaps=new Uint8Array(r.filelen);for(var s=0;s<r.filelen;s++)t.lightmaps[s]=i.readUnsignedByte()}function P(t,n,r){t.lightGridInverseSize[0]=1/t.lightGridSize[0],t.lightGridInverseSize[1]=1/t.lightGridSize[1],t.lightGridInverseSize[2]=1/t.lightGridSize[2];var i=t.bmodels[0].bounds[0],s=t.bmodels[0].bounds[1];for(var o=0;o<3;o++){t.lightGridOrigin[o]=t.lightGridSize[o]*Math.ceil(i[o]/t.lightGridSize[o]);var u=t.lightGridSize[o]*Math.floor(s[o]/t.lightGridSize[o]);t.lightGridBounds[o]=(u-t.lightGridOrigin[o])/t.lightGridSize[o]+1}var a=t.lightGridBounds[0]*t.lightGridBounds[1]*t.lightGridBounds[2];if(r.filelen!==a*8){log("WARNING: light grid mismatch",r.filelen,a*8),t.lightGridData=null;return}var f=new e(n,e.LITTLE_ENDIAN);f.index=r.fileofs,t.lightGridData=new Uint8Array(r.filelen);for(var o=0;o<r.filelen;o++)t.lightGridData[o]=f.readUnsignedByte()}function H(t,n,r){var i=new e(n,e.LITTLE_ENDIAN);i.index=r.fileofs,t.numClusters=i.readInt(),t.clusterBytes=i.readInt();var s=t.numClusters*t.clusterBytes;t.vis=new Uint8Array(s);for(var o=0;o<s;o++)t.vis[o]=i.readUnsignedByte()}var n=64,r={ENTITIES:0,SHADERS:1,PLANES:2,NODES:3,LEAFS:4,LEAFSURFACES:5,LEAFBRUSHES:6,MODELS:7,BRUSHES:8,BRUSHSIDES:9,DRAWVERTS:10,DRAWINDEXES:11,FOGS:12,SURFACES:13,LIGHTMAPS:14,LIGHTGRID:15,VISIBILITY:16,NUM_LUMPS:17},i={BAD:0,PLANAR:1,PATCH:2,TRIANGLE_SOUP:3,FLARE:4},s=function(){this.entities={},this.shaders=null,this.planes=null,this.nodes=null,this.leafs=null,this.leafSurfaces=null,this.leafBrushes=null,this.bmodels=null,this.brushes=null,this.brushSides=null,this.verts=null,this.indexes=null,this.fogs=null,this.surfaces=null,this.lightmaps=null,this.lightGridOrigin=vec3.create(),this.lightGridSize=vec3.createFrom(64,64,128),this.lightGridInverseSize=vec3.create(),this.lightGridBounds=vec3.create(),this.lightGridData=null,this.numClusters=0,this.clusterBytes=0,this.vis=null},o=function(){this.ident=null,this.version=0,this.lumps=new Array(r.NUM_LUMPS);for(var e=0;e<r.NUM_LUMPS;e++)this.lumps[e]=new u},u=function(){this.fileofs=0,this.filelen=0},a=function(){this.bounds=[vec3.create(),vec3.create()],this.firstSurface=0,this.numSurfaces=0,this.firstBrush=0,this.numBrushes=0};a.size=40;var f=function(){this.shaderName=null,this.surfaceFlags=0,this.contents=0};f.size=72;var l=function(){this.normal=vec3.create(),this.dist=0};l.size=16;var c=function(){this.planeNum=0,this.childrenNum=[0,0],this.mins=vec3.create(),this.maxs=vec3.create()};c.size=36;var h=function(){this.cluster=0,this.area=0,this.mins=vec3.create(),this.maxs=vec3.create(),this.firstLeafSurface=0,this.numLeafSurfaces=0,this.firstLeafBrush=0,this.numLeafBrushes=0};h.size=48;var p=function(){this.planeNum=0,this.shaderNum=0};p.size=8;var d=function(){this.side=0,this.numSides=0,this.shaderNum=0};d.size=12;var v=function(){this.shaderName=null,this.brushNum=0,this.visibleSide=0};v.size=72;var m=function(){this.pos=vec3.create(),this.texCoord=[0,0],this.lmCoord=[0,0],this.normal=vec3.create(),this.color=[0,0,0,0]};m.size=44;var g=function(){this.shaderNum=0,this.fogNum=0,this.surfaceType=0,this.vertex=0,this.vertCount=0,this.meshVert=0,this.meshVertCount=0,this.lightmapNum=0,this.lightmapX=0,this.lightmapY=0,this.lightmapWidth=0,this.lightmapHeight=0,this.lightmapOrigin=vec3.create(),this.lightmapVecs=[vec3.create(),vec3.create(),vec3.create()],this.patchWidth=0,this.patchHeight=0};return g.size=104,{MST:i,Bsp:s,dmodel_t:a,dshader_t:f,dplane_t:l,dnode_t:c,dleaf_t:h,dbrushside_t:p,dbrush_t:d,dfog_t:v,drawVert_t:m,dsurface_t:g,deserialize:y}}),define("common/text-tokenizer",[],function(){var e=function(e){e=e.replace(/\/\/.*$/mg,""),e=e.replace(/\/\*[^*\/]*\*\//mg,""),this.tokens=[];var t=/([^\s\n\r\"]+)|"([^\"]+)"/mg,n;while((n=t.exec(e))!==null)this.tokens.push(n[1]||n[2]);this.offset=0};return e.prototype.EOF=function(){if(this.tokens===null)return!0;var e=this.tokens[this.offset];while(e===""&&this.offset<this.tokens.length)this.offset++,e=this.tokens[this.offset];return this.offset>=this.tokens.length},e.prototype.next=function(){if(this.tokens===null)return;var e="";while(e===""&&this.offset<this.tokens.length)e=this.tokens[this.offset++];return e},e.prototype.prev=function(){if(this.tokens===null)return;var e="";while(e===""&&this.offset>=0)e=this.tokens[this.offset--];return e},e}),define("common/map-serializer",["common/text-tokenizer","common/qmath"],function(e,t){function a(t){var r=new n,i=new e(t);while(!i.EOF()){var s=i.next();switch(s){case"{":var o=f(i);if(!o)return null;r.entities.push(o)}}return r}function f(e){var t=new r;while(!e.EOF()){var n=e.next();if(n=="}")break;if(n==="{"){var i=l(e);if(!i)return null;t.brushes.push(i)}else{var s=n,o=e.next();t.properties[s]=o}}return t}function l(e){var t=new i;while(!e.EOF()){var n=e.next();if(n=="}")break;if(n==="patchDef2"){e.next();var r=h(e);if(r===null)return null;t.patch=r}else if(n==="("){var s=c(e);if(s===null)return null;t.sides||(t.sides=[]),t.sides.push(s)}}return t}function c(e){var n=new s,r=vec3.createFrom(parseFloat(e.next()),parseFloat(e.next()),parseFloat(e.next()));if(e.next()!==")"||e.next()!=="(")return console.log("ParseBrushSide invalid token"),null;var i=vec3.createFrom(parseFloat(e.next()),parseFloat(e.next()),parseFloat(e.next()));if(e.next()!==")"||e.next()!=="(")return console.log("ParseBrushSide invalid token"),null;var o=vec3.createFrom(parseFloat(e.next()),parseFloat(e.next()),parseFloat(e.next()));return e.next()!==")"?(console.log("ParseBrushSide invalid token"),null):(n.plane=t.PlaneFromPoints(o,i,r),n.shaderName=e.next(),n.xShift=e.next(),n.yShift=e.next(),n.rotation=e.next(),n.xScale=e.next(),n.yScale=e.next(),n.contentFlags=parseInt(e.next(),10),n.surfaceFlags=parseInt(e.next(),10),n.unused=parseInt(e.next(),10),n)}function h(e){var t=new o;t.shaderName=e.next();if(e.next()!=="(")return console.log("ParsePatch invalid token",e.prev()),null;t.height=parseInt(e.next(),10),t.width=parseInt(e.next(),10);if(e.next()!=="0"||e.next()!=="0"||e.next()!=="0"||e.next()!==")"||e.next()!=="(")return console.log("ParsePatch invalid token"),null;for(var n=0;n<t.height;n++){if(e.next()!=="(")return console.log("ParsePatch invalid token"),null;for(var r=0;r<t.width;r++){var i=new u,s;if((s=e.next())!=="(")return console.log("ParsePatch invalid token",s,n,r,t.width),null;i.xyz[0]=parseFloat(e.next()),i.xyz[1]=parseFloat(e.next()),i.xyz[2]=parseFloat(e.next()),i.st[0]=parseFloat(e.next()),i.st[1]=parseFloat(e.next());if(e.next()!==")")return console.log("ParsePatch invalid token"),null;t.points.push(i)}if(e.next()!==")")return console.log("ParsePatch invalid token"),null}return e.next()!==")"||e.next()!=="}"?(console.log("ParsePatch invalid token"),null):t}var n=function(){this.entities=[]},r=function(){this.properties={},this.brushes=[]},i=function(){this.sides=null,this.patch=null},s=function(){this.plane=null,this.shaderName=null,this.xShift=0,this.yShift=0,this.rotation=0,this.xScale=0,this.yScale=0,this.contentFlags=0,this.surfaceFlags=0,this.unused=0},o=function(){this.shaderName=null,this.width=0,this.height=0,this.points=[]},u=function(){this.xyz=vec3.create(),this.st=[]};return{deserialize:a}}),define("common/map-compiler",["common/qmath","common/bsp-serializer"],function(e,t){function a(e){return s=e,u=new n,o=new t.Bsp,v(),f(),l(),p(),c(),h(),world}function f(){var e=o.entities={};for(var t=0;t<s.entities.length;t++){var n=s.entities[t],r=n.properties.classname;if(!r)continue;e[r]||(e[r]=[]),e[r].push(n.properties)}}function l(){o.planes=u.planes}function c(){o.bmodels=[];var e=new t.dmodel_t;o.bmodels.push(e)}function h(){o.nodes=[],o.leafs=[],o.leafBrushes=[],o.leafSurfaces=[];for(var e=0;e<o.surfaces.length;e++)o.leafSurfaces.push(e);var n=new t.dleaf_t;n.firstLeafSurface=0,n.numLeafSurfaces=o.leafSurfaces.length;var r=new t.dleaf_t;o.leafs.push(n),o.leafs.push(r);var i=new t.dnode_t;i.childrenNum[0]=-1,i.childrenNum[1]=-2,o.nodes.push(i)}function p(){o.verts=[],o.indexes=[],o.surfaces=[];for(var e=0;e<u.brushes.length;e++){var t=u.brushes[e];d(t)}}function d(e){var n=e.sides;for(var r=0;r<n.length;r++){var i=n[r],s=new t.dsurface_t;s.surfaceType=t.MST.PLANAR,s.vertex=o.verts.length,s.vertCount=i.w.p.length;for(var u=0;u<i.w.p.length;u++){var a=new t.drawVert_t;vec3.set(i.w.p[u],a.pos),a.texCoord[0]=u/i.w.p.length,a.texCoord[1]=u/i.w.p.length,o.verts.push(a)}s.meshVert=o.indexes.length,s.meshVertCount=(s.vertCount-2)*3;for(var u=2;u<i.w.p.length;u++)o.indexes.push(0),o.indexes.push(u-1),o.indexes.push(u);o.surfaces.push(s)}}function v(){for(var e=0;e<s.entities.length;e++){var t=s.entities[e];for(var n=0;n<t.brushes.length;n++){var r=t.brushes[n];if(!r.sides)continue;m(r)}}}function m(t){var n=new r;for(var s=0;s<t.sides.length;s++){var o=t.sides[s],a=new i;a.w=e.BaseWindingForPlane(o.plane.normal,o.plane.dist),a.planeNum=g(o.plane);for(var f=0;f<t.sides.length;f++){if(s===f)continue;var l=t.sides[f],c=vec3.add(o.plane.normal,l.plane.normal,vec3.create());if(vec3.length(c)<.01)continue;if(!e.ChopWindingInPlace(a.w,l.plane.normal,l.plane.dist,.1)){console.log("Winding chopped away completely.");return}}n.sides.push(a)}u.brushes.push(n)}function g(t){for(var n=0;n<u.planes.length;n++)if(e.PlaneEqual(t,u.planes[n]))return n;var r=u.planes.length;return u.planes.push(t),r}var n=function(){this.brushes=[],this.verts=[],this.planes=[]},r=function(){this.sides=[]},i=function(){this.w=null,this.planeNum=0},s,o,u;return{compile:a}}),define("clipmap/cm",["underscore","glmatrix","ByteBuffer","common/bsp-serializer","common/qmath","common/qshared"],function(e,t,n,r,i,s){function o(e){function O(){var e=Array.prototype.slice.call(arguments);e.splice(0,0,"CM:"),Function.apply.call(console.log,console,e)}function B(e,n,r){(e<=2||n<=2||!r)&&t.Error("GeneratePatchFacets: bad parameters"),(!(e&1)||!(n&1))&&t.Error("GeneratePatchFacets: even sizes are invalid for quadratic meshes"),(e>S||n>S)&&t.Error("GeneratePatchFacets: source is > MAX_GRID_SIZE");var s=new L;s.width=e,s.height=n,s.wrapWidth=!1,s.wrapHeight=!1;for(var o=0;o<e;o++)for(var u=0;u<n;u++)vec3.set(r[u*e+o],s.points[o][u]);j(s),F(s),R(s),W(s),j(s),F(s),R(s);var a=new k;i.ClearBounds(a.bounds[0],a.bounds[1]);for(var o=0;o<s.width;o++)for(var u=0;u<s.height;u++)i.AddPointToBounds(s.points[o][u],a.bounds[0],a.bounds[1]);return X(s,a),a.bounds[0][0]-=1,a.bounds[0][1]-=1,a.bounds[0][2]-=1,a.bounds[1][0]+=1,a.bounds[1][1]+=1,a.bounds[1][2]+=1,H.push(a),a}function j(e){var t,n;for(t=0;t<e.height;t++){for(n=0;n<3;n++){var r=e.points[0][t][n]-e.points[e.width-1][t][n];if(r<-T||r>T)break}if(n!=3)break}t===e.height?e.wrapWidth=!0:e.wrapWidth=!1}function F(e){var t,n,r,i=vec3.create(),s=vec3.create(),o=vec3.create();for(t=0;t<e.width-2;){for(n=0;n<e.height;n++)if(I(e.points[t][n],e.points[t+1][n],e.points[t+2][n]))break;if(n===e.height){for(n=0;n<e.height;n++)for(r=t+2;r<e.width;r++)vec3.set(e.points[r][n],e.points[r-1][n]);e.width--,t++;continue}for(n=0;n<e.height;n++){vec3.set(e.points[t][n],i),vec3.set(e.points[t+1][n],s),vec3.set(e.points[t+2][n],o);for(r=e.width-1;r>t+1;r--)vec3.set(e.points[r][n],e.points[r+2][n]);q(i,s,o,e.points[t+1][n],e.points[t+2][n],e.points[t+3][n])}e.width+=2}}function I(e,t,n){var r=vec3.create(),i=vec3.create(),s=vec3.create();for(var o=0;o<3;o++)i[o]=.5*(e[o]+n[o]);for(var o=0;o<3;o++)r[o]=.5*(.5*(e[o]+t[o])+.5*(t[o]+n[o]));vec3.subtract(r,i,s);var u=vec3.length(s);return u>=x}function q(e,t,n,r,i,s){for(var o=0;o<3;o++)r[o]=.5*(e[o]+t[o]),s[o]=.5*(t[o]+n[o]),i[o]=.5*(r[o]+s[o])}function R(e){var t,n,r;for(t=0;t<e.width-1;t++){for(n=0;n<e.height;n++)if(!z(e.points[t][n],e.points[t+1][n]))break;if(n!==e.height)continue;for(n=0;n<e.height;n++)for(r=t+2;r<e.width;r++)vec3.set(e.points[r][n],e.points[r-1][n]);e.width--,t--}}function z(e,t){var n=e[0]-t[0];return n<-U||n>U?!1:(n=e[1]-t[1],n<-U||n>U?!1:(n=e[2]-t[2],n<-U||n>U?!1:!0))}function W(e){var t,n,r,i=vec3.create(),s=!1;if(e.width>e.height)for(t=0;t<e.height;t++)for(n=t+1;n<e.width;n++)n<e.height?(vec3.set(e.points[t][n],i),vec3.set(e.points[n][t],e.points[t][n]),vec3.set(i,e.points[n][t])):vec3.set(e.points[n][t],e.points[t][n]);else for(t=0;t<e.width;t++)for(n=t+1;n<e.height;n++)n<e.width?(vec3.set(e.points[n][t],i),vec3.set(e.points[t][n],e.points[n][t]),vec3.set(i,e.points[t][n])):vec3.set(e.points[t][n],e.points[n][t]);r=e.width,e.width=e.height,e.height=r,s=e.wrapWidth,e.wrapWidth=e.wrapHeight,e.wrapHeight=s}function X(e,n){var r,i,s,o,u,a=[0,0,0,0],f=[0,0,0,0],l=new Array(S);for(r=0;r<S;r++){l[r]=new Array(S);for(i=0;i<S;i++)l[r][i]=new Array(2)}for(r=0;r<e.width-1;r++)for(i=0;i<e.height-1;i++)s=e.points[r][i],o=e.points[r+1][i],u=e.points[r+1][i+1],l[r][i][0]=V(n,s,o,u),s=e.points[r+1][i+1],o=e.points[r][i+1],u=e.points[r][i],l[r][i][1]=V(n,s,o,u);for(r=0;r<e.width-1;r++)for(i=0;i<e.height-1;i++){a[M]=-1,i>0?a[M]=l[r][i-1][1]:e.wrapHeight&&(a[M]=l[r][e.height-2][1]),f[M]=a[M]==l[r][i][0];if(a[M]==-1||f[M])a[M]=$(n,e,l,r,i,0);a[D]=-1,i<e.height-2?a[D]=l[r][i+1][0]:e.wrapHeight&&(a[D]=l[r][0][0]),f[D]=a[D]==l[r][i][1];if(a[D]==-1||f[D])a[D]=$(n,e,l,r,i,2);a[P]=-1,r>0?a[P]=l[r-1][i][0]:e.wrapWidth&&(a[P]=l[e.width-2][i][0]),f[P]=a[P]==l[r][i][1];if(a[P]==-1||f[P])a[P]=$(n,e,l,r,i,3);a[_]=-1,r<e.width-2?a[_]=l[r+1][i][1]:e.wrapWidth&&(a[_]=l[0][i][1]),f[_]=a[_]==l[r][i][0];if(a[_]==-1||f[_])a[_]=$(n,e,l,r,i,1);n.facets.length>=b&&t.Error("MAX_FACETS");var c=new C;if(l[r][i][0]===l[r][i][1]){if(l[r][i][0]===-1)continue;c.surfacePlane=l[r][i][0],c.numBorders=4,c.borderPlanes[0]=a[M],c.borderNoAdjust[0]=f[M],c.borderPlanes[1]=a[_],c.borderNoAdjust[1]=f[_],c.borderPlanes[2]=a[D],c.borderNoAdjust[2]=f[D],c.borderPlanes[3]=a[P],c.borderNoAdjust[3]=f[P],K(n,c,e,l,r,i,-1),Q(n,c)&&(G(n,c),n.facets.push(c))}else c.surfacePlane=l[r][i][0],c.numBorders=3,c.borderPlanes[0]=a[M],c.borderNoAdjust[0]=f[M],c.borderPlanes[1]=a[_],c.borderNoAdjust[1]=f[_],c.borderPlanes[2]=l[r][i][1],c.borderPlanes[2]===-1&&(c.borderPlanes[2]=a[D],c.borderPlanes[2]===-1&&(c.borderPlanes[2]=$(n,e,l,r,i,4))),K(n,c,e,l,r,i,0),Q(n,c)&&(G(n,c),n.facets.push(c)),n.facets.length>=b&&t.Error("MAX_FACETS"),c=c=new C,c.surfacePlane=l[r][i][1],c.numBorders=3,c.borderPlanes[0]=a[D],c.borderNoAdjust[0]=f[D],c.borderPlanes[1]=a[P],c.borderNoAdjust[1]=f[P],c.borderPlanes[2]=l[r][i][0],c.borderPlanes[2]===-1&&(c.borderPlanes[2]=a[M],c.borderPlanes[2]===-1&&(c.borderPlanes[2]=$(n,e,l,r,i,5))),K(n,c,e,l,r,i,1),Q(n,c)&&(G(n,c),n.facets.push(c))}}function V(e,n,r,s){var o=i.PlaneFromPoints(n,r,s);if(!o)return-1;for(var u=0;u<e.planes.length;u++){var a=e.planes[u];if(vec3.dot(o.normal,a.normal)<0)continue;if(i.PointOnPlaneSide(n,a)!==i.SIDE_ON)continue;if(i.PointOnPlaneSide(r,a)!==i.SIDE_ON)continue;if(i.PointOnPlaneSide(s,a)!==i.SIDE_ON)continue;return u}e.planes.length>=E&&t.Error("MAX_PATCH_PLANES");var f=e.planes.length;return e.planes.push(o),f}function $(e,n,r,i,s,o){var u,a,f,l,c=vec3.create();switch(o){case 0:return u=n.points[i][s],a=n.points[i+1][s],f=J(r,i,s,0),l=e.planes[f],vec3.add(u,vec3.scale(l.normal,4,vec3.create()),c),V(e,u,a,c);case 2:return u=n.points[i][s+1],a=n.points[i+1][s+1],f=J(r,i,s,1),l=e.planes[f],vec3.add(u,vec3.scale(l.normal,4,vec3.create()),c),V(e,a,u,c);case 3:return u=n.points[i][s],a=n.points[i][s+1],f=J(r,i,s,1),l=e.planes[f],vec3.add(u,vec3.scale(l.normal,4,vec3.create()),c),V(e,a,u,c);case 1:return u=n.points[i+1][s],a=n.points[i+1][s+1],f=J(r,i,s,0),l=e.planes[f],vec3.add(u,vec3.scale(l.normal,4,vec3.create()),c),V(e,u,a,c);case 4:return u=n.points[i+1][s+1],a=n.points[i][s],f=J(r,i,s,0),l=e.planes[f],vec3.add(u,vec3.scale(l.normal,4,vec3.create()),c),V(e,u,a,c);case 5:return u=n.points[i][s],a=n.points[i+1][s+1],f=J(r,i,s,1),l=e.planes[f],vec3.add(u,vec3.scale(l.normal,4,vec3.create()),c),V(e,u,a,c)}return t.Error("EdgePlaneNum: bad k"),-1}function J(e,t,n,r){var i=e[t][n][r];return i!==-1?i:(i=e[t][n][r^1],i!==-1?i:(O("WARNING: GridPlane unresolvable"),-1))}function K(e,n,r,s,o,u,a){var f=[null,null,null,null],l;switch(a){case-1:f[0]=r.points[o][u],f[1]=r.points[o+1][u],f[2]=r.points[o+1][u+1],f[3]=r.points[o][u+1],l=4;break;case 0:f[0]=r.points[o][u],f[1]=r.points[o+1][u],f[2]=r.points[o+1][u+1],l=3;break;case 1:f[0]=r.points[o+1][u+1],f[1]=r.points[o][u+1],f[2]=r.points[o][u],l=3;break;default:t.Error("SetBorderInward: bad parameter"),l=0}for(var c=0;c<n.numBorders;c++){var h=0,p=0;for(var d=0;d<l;d++){var v=n.borderPlanes[c];if(v===-1)continue;var m=i.PointOnPlaneSide(f[d],e.planes[v]);m===i.SIDE_FRONT?h++:m===i.SIDE_BACK&&p++}h&&!p?n.borderInward[c]=!0:p&&!h?n.borderInward[c]=!1:!h&&!p?n.borderPlanes[c]=-1:(O("WARNING: SetBorderInward: mixed plane sides"),n.borderInward[c]=!1)}}function Q(e,t){if(t.surfacePlane===-1)return!1;var n=[vec3.create(),vec3.create()],r=e.planes[t.surfacePlane].clone(),s=i.BaseWindingForPlane(r.normal,r.dist);for(var o=0;o<t.numBorders;o++){if(t.borderPlanes[o]===-1)return!1;e.planes[t.borderPlanes[o]].clone(r),t.borderInward[o]||(vec3.negate(r.normal),r.dist=-r.dist);if(!i.ChopWindingInPlace(s,r.normal,r.dist,.1))return!1}i.WindingBounds(s,n[0],n[1]);for(var o=0;o<3;o++){if(n[1][o]-n[0][o]>i.MAX_MAP_BOUNDS)return!1;if(n[0][o]>=i.MAX_MAP_BOUNDS)return!1;if(n[1][o]<=-i.MAX_MAP_BOUNDS)return!1}return!0}function G(e,t){var n,r,s,o,u,a,f,l=[!1],c=vec3.create(),h=vec3.create(),p=vec3.create(),d=vec3.create(),v=e.planes[t.surfacePlane].clone(),m=new i.Plane,g=i.BaseWindingForPlane(v.normal,v.dist);for(r=0;r<t.numBorders;r++){if(t.borderPlanes[r]===t.surfacePlane)continue;e.planes[t.borderPlanes[r]].clone(v),t.borderInward[r]||(vec3.negate(v.normal),v.dist=-v.dist);if(!i.ChopWindingInPlace(g,v.normal,v.dist,.1))return}i.WindingBounds(g,c,h),f=0;for(u=0;u<3;u++)for(a=-1;a<=1;a+=2,f++){v.normal[0]=v.normal[1]=v.normal[2]=0,v.normal[u]=a,a===1?v.dist=h[u]:v.dist=-c[u];if(et(e.planes[t.surfacePlane],v,l))continue;for(n=0;n<t.numBorders;n++)if(et(e.planes[t.borderPlanes[n]],v,l))break;n===t.numBorders&&(t.numBorders>26&&O("ERROR: too many bevels"),t.borderPlanes[t.numBorders]=nt(e,v,l),t.borderNoAdjust[t.numBorders]=0,t.borderInward[t.numBorders]=l[0],t.numBorders++)}for(r=0;r<g.p.length;r++){s=(r+1)%g.p.length,vec3.subtract(g.p[r],g.p[s],p),vec3.normalize(p);if(vec3.length(p)<.5)continue;tt(p);for(s=0;s<3;s++)if(p[s]==-1||p[s]==1)break;if(s<3)continue;for(u=0;u<3;u++)for(a=-1;a<=1;a+=2){d[0]=d[1]=d[2]=0,d[u]=a,vec3.cross(p,d,v.normal),vec3.normalize(v.normal);if(vec3.length(v.normal)<.5)continue;v.dist=vec3.dot(g.p[r],v.normal);for(o=0;o<g.p.length;o++){var y=vec3.dot(g.p[o],v.normal)-v.dist;if(y>.1)break}if(o<g.p.length)continue;if(et(e.planes[t.surfacePlane],v,l))continue;for(n=0;n<t.numBorders;n++)if(et(e.planes[t.borderPlanes[n]],v,l))break;if(n===t.numBorders){t.numBorders>26&&O("ERROR: too many bevels"),t.borderPlanes[t.numBorders]=nt(e,v,l);for(s=0;s<t.numBorders;s++)t.borderPlanes[t.numBorders]==t.borderPlanes[s]&&O("WARNING: bevel plane already used");t.borderNoAdjust[t.numBorders]=0,t.borderInward[t.numBorders]=l[0];var b=g.clone();e.planes[t.borderPlanes[t.numBorders]].clone(m),t.borderInward[t.numBorders]||(vec3.negate(m.normal),m.dist=-m.dist);if(!i.ChopWindingInPlace(b,m.normal,m.dist,.1)){O("WARNING: AddFacetBevels... invalid bevel");continue}t.numBorders++}}}t.borderPlanes[t.numBorders]=t.surfacePlane,t.borderNoAdjust[t.numBorders]=0,t.borderInward[t.numBorders]=!0,t.numBorders++}function et(e,t,n){if(Math.abs(e.normal[0]-t.normal[0])<Y&&Math.abs(e.normal[1]-t.normal[1])<Y&&Math.abs(e.normal[2]-t.normal[2])<Y&&Math.abs(e.dist-t.dist)<Z)return n[0]=!1,!0;var r=new i.Plane;return vec3.negate(t.normal,r.normal),r.dist=-t.dist,Math.abs(e.normal[0]-r.normal[0])<Y&&Math.abs(e.normal[1]-r.normal[1])<Y&&Math.abs(e.normal[2]-r.normal[2])<Y&&Math.abs(e.dist-r.dist)<Z?(n[0]=!0,!0):!1}function tt(e){for(var t=0;t<3;t++){if(Math.abs(e[t]-1)<Y){e[0]=e[1]=e[2]=0,e[t]=1;break}if(Math.abs(e[t]+1)<Y){e[0]=e[1]=e[2]=0,e[t]=-1;break}}}function nt(e,n,r){for(var i=0;i<e.planes.length;i++)if(et(e.planes[i],n,r))return i;e.planes.length===E&&t.Error("MAX_PATCH_PLANES");var s=e.planes.length,o=n.clone();return e.planes.push(o),r[0]=!1,s}function rt(e,t){var n,r,s,o,u,f,l=new st,c=new i.Plane,h=new i.Plane,p=vec3.create(),d=vec3.create();if(!i.BoundsIntersect(e.bounds[0],e.bounds[1],t.bounds[0],t.bounds[1],a))return;if(e.isPoint){it(e,t);return}for(var n=0;n<t.facets.length;n++){var v=t.facets[n];l.enterFrac=-1,l.leaveFrac=1,l.hit=!1,s=-1,f=t.planes[v.surfacePlane],vec3.set(f.normal,c.normal),c.dist=f.dist,e.sphere.use?(c.dist+=e.sphere.radius,u=vec3.dot(c.normal,e.sphere.offset),u>0?(vec3.subtract(e.start,e.sphere.offset,p),vec3.subtract(e.end,e.sphere.offset,d)):(vec3.add(e.start,e.sphere.offset,p),vec3.add(e.end,e.sphere.offset,d))):(o=vec3.dot(e.offsets[f.signbits],c.normal),c.dist-=o,vec3.set(e.start,p),vec3.set(e.end,d));if(!ot(c,p,d,l))continue;l.hit&&c.clone(h);for(r=0;r<v.numBorders;r++){f=t.planes[v.borderPlanes[r]],v.borderInward[r]?(vec3.negate(f.normal,c.normal),c.dist=-f.dist):(vec3.set(f.normal,c.normal),c.dist=f.dist),e.sphere.use?(c.dist+=e.sphere.radius,u=vec3.dot(c.normal,e.sphere.offset),u>0?(vec3.subtract(e.start,e.sphere.offset,p),vec3.subtract(e.end,e.sphere.offset,d)):(vec3.add(e.start,e.sphere.offset,p),vec3.add(e.end,e.sphere.offset,d))):(o=vec3.dot(e.offsets[f.signbits],c.normal),c.dist+=Math.abs(o),vec3.set(e.start,p),vec3.set(e.end,d));if(!ot(c,p,d,l))break;l.hit&&(s=r,c.clone(h))}if(r<v.numBorders)continue;if(s===v.numBorders-1)continue;l.enterFrac<l.leaveFrac&&l.enterFrac>=0&&l.enterFrac<e.trace.fraction&&(l.enterFrac<0&&(l.enterFrac=0),e.trace.fraction=l.enterFrac,h.clone(e.trace.plane))}}function it(e,t){var n,r,i,s=new Array(E),o=new Array(E),u,f,l,c;if(!e.isPoint)return;for(n=0;n<t.planes.length;n++){var h=t.planes[n];f=vec3.dot(e.offsets[h.signbits],h.normal),l=vec3.dot(e.start,h.normal)-h.dist+f,c=vec3.dot(e.end,h.normal)-h.dist+f,l<=0?s[n]=!1:s[n]=!0,l===c?o[n]=99999:(o[n]=l/(l-c),o[n]<=0&&(o[n]=99999))}for(n=0;n<t.facets.length;n++){var p=t.facets[n];if(!s[p.surfacePlane])continue;u=o[p.surfacePlane];if(u<0)continue;if(u>e.trace.fraction)continue;for(r=0;r<p.numBorders;r++){i=p.borderPlanes[r];if(s[i]^p.borderInward[r]){if(o[i]>u)break}else if(o[i]<u)break}if(r===p.numBorders){var h=t.planes[p.surfacePlane];f=vec3.dot(e.offsets[h.signbits],h.normal),l=vec3.dot(e.start,h.normal)-h.dist+f,c=vec3.dot(e.end,h.normal)-h.dist+f,e.trace.fraction=(l-a)/(l-c),e.trace.fraction<0&&(e.trace.fraction=0),h.clone(e.trace.plane)}}}function ot(e,t,n,r){var i,s=vec3.dot(t,e.normal)-e.dist,o=vec3.dot(n,e.normal)-e.dist;return r.hit=!1,s>0&&(o>=a||o>=s)?!1:s<=0&&o<=0?!0:(s>o?(i=(s-a)/(s-o),i<0&&(i=0),i>r.enterFrac&&(r.enterFrac=i,r.hit=!0)):(i=(s+a)/(s-o),i>1&&(i=1),i<r.leaveFrac&&(r.leaveFrac=i)),!0)}function ut(e){var t=new i.Plane,n=vec3.createFrom(-1,-1,-1),r=vec3.createFrom(1,1,1),s=vec3.create(),o=vec3.create();for(var u=0;u<H.length;u++){var a=H[u];for(var f=0;f<a.facets.length;f++){var l=a.facets[f];for(var c=0;c<l.numBorders+1;c++){var h,p;c<l.numBorders?(h=l.borderPlanes[c],p=l.borderInward[c]):(h=l.surfacePlane,p=!1),a.planes[h].clone(t),p&&(vec3.negate(t),t.dist=-t.dist);for(y=0;y<3;y++)t[y]>0?s[y]=r[y]:s[y]=n[y];vec3.negate(t.normal,o),t.dist+=Math.abs(vec3.dot(s,o));var d=i.BaseWindingForPlane(t.normal,t.dist);for(var v=0;v<l.numBorders+1;v++){var m,g;v<l.numBorders?(m=l.borderPlanes[v],g=l.borderInward[v]):(m=l.surfacePlane,g=!1);if(m===h)continue;a.planes[m].clone(t),g||(vec3.negate(t.normal),t.dist=-t.dist);for(var y=0;y<3;y++)t[y]>0?s[y]=r[y]:s[y]=n[y];vec3.negate(t.normal,o),t.dist-=Math.abs(vec3.dot(s,o));if(!i.ChopWindingInPlace(d,t.normal,t.dist,.1))break}v===l.numBorders+1&&e(d.p)}}}}function at(e,t){if(!Mt.vis||e===t||e==-1)return!0;var n=e*Mt.clusterBytes;return(Mt.vis[n+(t>>3)]&1<<(t&7))!==0}function ft(e,t,n,r){for(;;){if(r<0){var s=-1-r;Mt.leafs[s].cluster!==-1&&(e.lastLeaf=s);if(e.count>=e.maxCount)return;e.list[e.count++]=s;return}var o=Mt.nodes[r],u=i.BoxOnPlaneSide(t,n,Mt.planes[o.planeNum]);u===i.SIDE_FRONT?r=o.childrenNum[0]:u===i.SIDE_BACK?r=o.childrenNum[1]:(ft(e,t,n,o.childrenNum[0]),r=o.childrenNum[1])}}function lt(e,t,n,r){var i=new m;return i.list=n,i.maxCount=r,Mt.checkcount++,ft(i,e,t,0),i}function ct(e,t){var n;while(t>=0){var r=Mt.nodes[t],i=Mt.planes[r.planeNum];i.type<3?n=e[i.type]-i.dist:n=vec3.dot(i.normal,e)-i.dist,n<0?t=r.childrenNum[1]:t=r.childrenNum[0]}return-1-t}function ht(e){return ct(e,0)}function pt(e,t){var n=Mt.leafBrushes,r=Mt.brushes,s=Mt.brushSides,o;if(t){var u=Jt(t);o=u.leaf}else{var a=ht(e);o=Mt.leafs[a]}var f=0;for(var l=0;l<o.numLeafBrushes;l++){var c=n[o.firstLeafBrush+l],h=r[c];if(!i.BoundsIntersectPoint(h.bounds[0],h.bounds[1],e))continue;var p;for(var p=0;p<h.numSides;p++){var d=s[h.firstSide+p],v=vec3.dot(e,d.plane.normal);if(v>d.plane.dist)break}p===h.numSides&&(f|=h.contents)}return f}function dt(e,t,n,r){var s=vec3.subtract(e,n,vec3.create());if(t!==o&&(r[0]||r[1]||r[2])){var u=vec3.create(),a=vec3.create(),f=vec3.create();i.AnglesToVectors(r,u,a,f);var l=vec3.create(s);s[0]=vec3.dot(l,u),s[1]=-vec3.dot(l,a),s[2]=vec3.dot(l,f)}return pt(s,t)}function vt(e,n){var r=Mt.areas[e];if(r.floodValid===Mt.floodValid){if(r.floodnum===n)return;t.Error("FloodArea_r: reflooded")}r.floodnum=n,r.floodValid=Mt.floodValid;var i=e*Mt.areas.length;for(var s=0;s<Mt.areas.length;s++)Mt.areaPortals[i+s]>0&&vt(s,n)}function mt(){Mt.floodValid++;var e=0;for(var t=0;t<Mt.areas.length;t++){var n=Mt.areas[t];if(n.floodValid===Mt.floodValid)continue;e++,vt(t,e)}}function gt(e,n,r){if(e<0||n<0)return;(e>=Mt.areas.length||n>=Mt.areas.length)&&t.Error("ChangeAreaPortalState: bad area number"),r?(Mt.areaPortals[e*Mt.numAreas+n]++,Mt.areaPortals[n*Mt.numAreas+e]++):(Mt.areaPortals[e*Mt.numAreas+n]--,Mt.areaPortals[n*Mt.numAreas+e]--,Mt.areaPortals[n*Mt.numAreas+e]<0&&t.Error("AdjustAreaPortalState: negative reference count")),mt()}function yt(e,n){return e<0||n<0?!1:((e>=Mt.areas.length||n>=Mt.areas.length)&&t.Error("area >= cm.numAreas"),Mt.areas[e].floodnum===Mt.areas[n].floodnum?!0:!1)}function bt(e,t){for(var n=0;n<3;n++)for(var r=0;r<3;r++)t[n][r]=e[r][n]}function wt(e,t){var n=Mt.brushSides;if(!t.numSides)return;if(e.bounds[0][0]>t.bounds[1][0]||e.bounds[0][1]>t.bounds[1][1]||e.bounds[0][2]>t.bounds[1][2]||e.bounds[1][0]<t.bounds[0][0]||e.bounds[1][1]<t.bounds[0][1]||e.bounds[1][2]<t.bounds[0][2])return;if(e.sphere.use)for(var r=6;r<t.numSides;r++){var i=n[t.firstSide+r],s=i.plane,o=s.dist+e.sphere.radius,u=vec3.create(),a=vec3.dot(s.normal,e.sphere.offset);a>0?vec3.subtract(e.start,e.sphere.offset,u):vec3.add(e.start,e.sphere.offset,u);var f=vec3.dot(u,s.normal)-o;if(f>0)return}else for(var r=6;r<t.numSides;r++){var i=n[t.firstSide+r],s=i.plane,o=s.dist-vec3.dot(e.offsets[s.signbits],s.normal),f=vec3.dot(e.start,s.normal)-o;if(f>0)return}e.trace.startSolid=e.trace.allSolid=!0,e.trace.fraction=0,e.trace.contents=t.contents}function Et(e,t){var n=Mt.brushes,r=Mt.leafBrushes;for(var i=0;i<t.numLeafBrushes;i++){var s=r[t.firstLeafBrush+i],o=n[s];if(o.checkcount===Mt.checkcount)continue;o.checkcount=Mt.checkcount;if(!(o.contents&e.contents))continue;wt(e,o);if(e.trace.allSolid)return}}function xt(e){var t=Mt.leafs,n=vec3.add(e.start,e.size[0],vec3.create()),r=vec3.add(e.start,e.size[1],vec3.create());vec3.add(n,[-1,-1,-1]),vec3.add(r,[1,1,1]);var i=new m;i.list=St,i.maxCount=v,Mt.checkcount++,ft(i,n,r,0),Mt.checkcount++;for(var s=0;s<i.count;s++){Et(e,t[i.list[s]]);if(e.trace.allSolid)break}}function Tt(e,t,n,r,i,s){var o=Mt.brushes,u=Mt.leafs,f=Mt.leafBrushes,l=Mt.nodes,c=Mt.planes;if(e.trace.fraction<=n)return;if(t<0){Nt(e,u[-(t+1)]);return}var h=l[t],p=c[h.planeNum],d,v,m;p.type<3?(d=i[p.type]-p.dist,v=s[p.type]-p.dist,m=e.extents[p.type]):(d=vec3.dot(p.normal,i)-p.dist,v=vec3.dot(p.normal,s)-p.dist,e.isPoint?m=0:m=2048);if(d>=m+1&&v>=m+1){Tt(e,h.childrenNum[0],n,r,i,s);return}if(d<-m-1&&v<-m-1){Tt(e,h.childrenNum[1],n,r,i,s);return}var g,y,b,w;d<v?(g=1/(d-v),y=1,w=(d+m+a)*g,b=(d-m+a)*g):d>v?(g=1/(d-v),y=0,w=(d-m-a)*g,b=(d+m+a)*g):(y=0,b=1,w=0);var E=vec3.create(),S;b<0?b=0:b>1&&(b=1),S=n+(r-n)*b,E[0]=i[0]+b*(s[0]-i[0]),E[1]=i[1]+b*(s[1]-i[1]),E[2]=i[2]+b*(s[2]-i[2]),Tt(e,h.childrenNum[y],n,S,i,E),w<0&&(w=0),w>1&&(w=1),S=n+(r-n)*w,E[0]=i[0]+w*(s[0]-i[0]),E[1]=i[1]+w*(s[1]-i[1]),E[2]=i[2]+w*(s[2]-i[2]),Tt(e,h.childrenNum[y^1],S,r,E,s)}function Nt(e,t){var n,r=Mt.brushes,s=Mt.leafBrushes;for(n=0;n<t.numLeafBrushes;n++){var o=s[t.firstLeafBrush+n],u=r[o];if(u.checkcount===Mt.checkcount)continue;u.checkcount=Mt.checkcount;if(!(u.contents&e.contents))continue;if(!i.BoundsIntersect(e.bounds[0],e.bounds[1],u.bounds[0],u.bounds[1],a))continue;Ct(e,u);if(!e.trace.fraction)return}for(n=0;n<t.numLeafSurfaces;n++){var f=Mt.surfaces[Mt.leafSurfaces[t.firstLeafSurface+n]];if(!f)continue;if(f.checkcount===Mt.checkcount)continue;f.checkcount=Mt.checkcount;if(!(f.contents&e.contents))continue;kt(e,f);if(!e.trace.fraction)return}}function Ct(e,t){var n=Mt.brushSides,r=Mt.shaders,i=e.trace,s,o,u=!1,f=!1,l=-1,c=1;if(!t.numSides)return;if(e.sphere.use)for(var h=0;h<t.numSides;h++){var p=Mt.brushSides[t.firstSide+h],d=p.plane,v=d.dist+e.sphere.radius,m=vec3.create(),g=vec3.create(),y=vec3.dot(d.normal,e.sphere.offset);y>0?(vec3.subtract(e.start,e.sphere.offset,m),vec3.subtract(e.end,e.sphere.offset,g)):(vec3.add(e.start,e.sphere.offset,m),vec3.add(e.end,e.sphere.offset,g));var b=vec3.dot(m,d.normal)-v,w=vec3.dot(g,d.normal)-v;w>0&&(u=!0),b>0&&(f=!0);if(b>0&&(w>=a||w>=b))return;if(b<=0&&w<=0)continue;if(b>w){var E=(b-a)/(b-w);E<0&&(E=0),E>l&&(l=E,o=d,s=p)}else{var E=(b+a)/(b-w);E>1&&(E=1),E<c&&(c=E)}}else for(var h=0;h<t.numSides;h++){var p=Mt.brushSides[t.firstSide+h],d=p.plane,v=d.dist-vec3.dot(e.offsets[d.signbits],d.normal),b=vec3.dot(e.start,d.normal)-v,w=vec3.dot(e.end,d.normal)-v;w>0&&(u=!0),b>0&&(f=!0);if(b>0&&(w>=a||w>=b))return;if(b<=0&&w<=0)continue;if(b>w){var E=(b-a)/(b-w);E<0&&(E=0),E>l&&(l=E,o=d,s=p)}else{var E=(b+a)/(b-w);E>1&&(E=1),E<c&&(c=E)}}if(!f){e.trace.startSolid=!0,u||(e.trace.allSolid=!0,e.trace.fraction=0,e.trace.contents=t.contents,e.trace.shaderName=t.shader.shaderName);return}l<c&&l>-1&&l<e.trace.fraction&&(l<0&&(l=0),e.trace.fraction=l,o.clone(e.trace.plane),e.trace.surfaceFlags=s.surfaceFlags,e.trace.contents=t.contents,e.trace.shaderName=t.shader.shaderName)}function kt(e,t){var n=e.trace.fraction;rt(e,t.pc),e.trace.fraction<n&&(e.trace.surfaceFlags=t.surfaceFlags,e.trace.contents=t.contents)}function Lt(e,n,r,i,s,o,u,a,f){var l=new y,c=l.trace;Mt.checkcount||(Mt.checkcount=0),Mt.checkcount++,r||(r=vec3.create()),i||(i=vec3.create()),l.contents=u;var h=vec3.create();for(var p=0;p<3;p++)h[p]=(r[p]+i[p])*.5,l.size[0][p]=r[p]-h[p],l.size[1][p]=i[p]-h[p],l.start[p]=e[p]+h[p],l.end[p]=n[p]+h[p];f?f.clone(l.sphere):(l.sphere.use=a,l.sphere.radius=l.size[1][0]>l.size[1][2]?l.size[1][2]:l.size[1][0],l.sphere.halfheight=l.size[1][2],vec3.set([0,0,l.size[1][2]-l.sphere.radius],l.sphere.offset)),l.maxOffset=l.size[1][0]+l.size[1][1]+l.size[1][2],l.offsets[0][0]=l.size[0][0],l.offsets[0][1]=l.size[0][1],l.offsets[0][2]=l.size[0][2],l.offsets[1][0]=l.size[1][0],l.offsets[1][1]=l.size[0][1],l.offsets[1][2]=l.size[0][2],l.offsets[2][0]=l.size[0][0],l.offsets[2][1]=l.size[1][1],l.offsets[2][2]=l.size[0][2],l.offsets[3][0]=l.size[1][0],l.offsets[3][1]=l.size[1][1],l.offsets[3][2]=l.size[0][2],l.offsets[4][0]=l.size[0][0],l.offsets[4][1]=l.size[0][1],l.offsets[4][2]=l.size[1][2],l.offsets[5][0]=l.size[1][0],l.offsets[5][1]=l.size[0][1],l.offsets[5][2]=l.size[1][2],l.offsets[6][0]=l.size[0][0],l.offsets[6][1]=l.size[1][1],l.offsets[6][2]=l.size[1][2],l.offsets[7][0]=l.size[1][0],l.offsets[7][1]=l.size[1][1],l.offsets[7][2]=l.size[1][2];if(l.sphere.use)for(var p=0;p<3;p++)l.start[p]<l.end[p]?(l.bounds[0][p]=l.start[p]-Math.abs(l.sphere.offset[p])-l.sphere.radius,l.bounds[1][p]=l.end[p]+Math.abs(l.sphere.offset[p])+l.sphere.radius):(l.bounds[0][p]=l.end[p]-Math.abs(l.sphere.offset[p])-l.sphere.radius,l.bounds[1][p]=l.start[p]+Math.abs(l.sphere.offset[p])+l.sphere.radius);else for(var p=0;p<3;p++)l.start[p]<l.end[p]?(l.bounds[0][p]=l.start[p]+l.size[0][p],l.bounds[1][p]=l.end[p]+l.size[1][p]):(l.bounds[0][p]=l.end[p]+l.size[0][p],l.bounds[1][p]=l.start[p]+l.size[1][p]);var d=s?Jt(s):null;e[0]==n[0]&&e[1]==n[1]&&e[2]==n[2]?s?Et(l,d.leaf):xt(l):(l.size[0][0]===0&&l.size[0][1]===0&&l.size[0][2]===0?(l.isPoint=!0,l.extents=vec3.create()):(l.isPoint=!1,l.extents[0]=l.size[1][0],l.extents[1]=l.size[1][1],l.extents[2]=l.size[1][2]),s?Nt(l,d.leaf):Tt(l,0,0,1,l.start,l.end));for(var p=0;p<3;p++)l.trace.endPos[p]=e[p]+l.trace.fraction*(n[p]-e[p]);return!l.trace.allSolid&&l.trace.fraction!==1&&vec3.squaredLength(l.trace.plane.normal)<=.9999&&t.Error("Invalid trace result"),c}function At(e,t,n,r,i,s,o){return Lt(e,t,n,r,i,vec3.create(),s,o,null)}function Ot(e,t,n,r,s,u,a,f,l){n||(n=vec3.create()),r||(r=vec3.create());var c=vec3.create(),h=vec3.create(),p=vec3.create(),d=[vec3.create(),vec3.create()],v=[vec3.create(),vec3.create(),vec3.create()],m=[vec3.create(),vec3.create(),vec3.create()];for(var y=0;y<3;y++)p[y]=(n[y]+r[y])*.5,d[0][y]=n[y]-p[y],d[1][y]=r[y]-p[y],c[y]=e[y]+p[y],h[y]=t[y]+p[y];vec3.subtract(c,a),vec3.subtract(h,a);var b=!1;s!==o&&(f[0]||f[1]||f[2])&&(b=!0);var w=d[1][0],E=d[1][2],S=new g;S.use=l,S.radius=w>E?E:w,S.halfheight=E;var x=E-S.radius;b?(i.AnglesToAxis(f,v),i.RotatePoint(c,v),i.RotatePoint(h,v),S.offset[0]=v[0][2]*x,S.offset[1]=-v[1][2]*x,S.offset[2]=v[2][2]*x):vec3.set([0,0,x],S.offset);var T=Lt(c,h,d[0],d[1],s,a,u,l,S);return b&&T.fraction!==1&&(bt(v,m),i.RotatePoint(T.plane.normal,m)),T.endPos[0]=e[0]+T.fraction*(t[0]-e[0]),T.endPos[1]=e[1]+T.fraction*(t[1]-e[1]),T.endPos[2]=e[2]+T.fraction*(t[2]-e[2]),T}function _t(e){O("Initializing"),Mt=new f,Mt.entities=e.entities,Mt.shaders=e.shaders,Mt.planes=e.planes,Mt.nodes=e.nodes,Mt.numClusters=e.numClusters,Mt.clusterBytes=e.clusterBytes,Mt.vis=e.vis,Dt(e.leafs,e.leafBrushes,e.leafSurfaces),Pt(e.brushes,e.brushSides),Ht(e.bmodels),Bt(e.surfaces,e.verts),Wt(),mt()}function Dt(e,t,n){Mt.leafs=e,Mt.leafBrushes=t,Mt.leafSurfaces=n;var r=0;for(var i=0;i<e.length;i++){var s=e[i];s.area>=r&&(r=s.area+1)}Mt.areas=new Array(r),Mt.areaPortals=new Array(r*r);for(var i=0;i<r;i++)Mt.areas[i]=new p;for(var i=0;i<r*r;i++)Mt.areaPortals[i]=0}function Pt(e,t){var n=Mt.shaders,r=Mt.planes,i=Mt.brushSides=new Array(t.length);for(var s=0;s<t.length;s++){var o=t[s],u=i[s]=new c;u.plane=r[o.planeNum],u.surfaceFlags=n[o.shaderNum].surfaceFlags}var a=Mt.brushes=new Array(e.length);for(var s=0;s<e.length;s++){var f=e[s],l=a[s]=new h;l.shader=n[f.shaderNum],l.contents=l.shader.contents,l.bounds[0][0]=-i[f.side+0].plane.dist,l.bounds[0][1]=-i[f.side+2].plane.dist,l.bounds[0][2]=-i[f.side+4].plane.dist,l.bounds[1][0]=i[f.side+1].plane.dist,l.bounds[1][1]=i[f.side+3].plane.dist,l.bounds[1][2]=i[f.side+5].plane.dist,l.firstSide=f.side,l.numSides=f.numSides}}function Ht(e){Mt.models=new Array(e.length);for(var t=0;t<e.length;t++){var n=e[t],r=Mt.models[t]=new l,i=vec3.createFrom(1,1,1);vec3.subtract(n.bounds[0],i,r.mins),vec3.add(n.bounds[1],i,r.maxs);if(t===0)continue;var s=r.leaf;s.numLeafBrushes=n.numBrushes,s.firstLeafBrush=Mt.leafBrushes.length;for(var o=0;o<n.numBrushes;o++)Mt.leafBrushes.push(n.firstBrush+o);s.numLeafSurfaces=n.numSurfaces,s.firstLeafSurface=Mt.leafSurfaces.length;for(var o=0;o<n.numSurfaces;o++)Mt.leafSurfaces.push(n.firstSurface+o)}}function Bt(e,n){Mt.surfaces=new Array(e.length);var i=new Array(w);for(var s=0;s<w;s++)i[s]=vec3.create();for(var s=0;s<e.length;s++){var o=e[s];if(o.surfaceType!==r.MST.PATCH)continue;var u=Mt.surfaces[s]=new A,a=o.patchWidth,f=o.patchHeight,l=a*f;l>w&&t.Error("ParseMesh: MAX_PATCH_VERTS");for(var c=0;c<l;c++)vec3.set(n[o.vertex+c].pos,i[c]);u.contents=Mt.shaders[o.shaderNum].contents,u.surfaceFlags=Mt.shaders[o.shaderNum].surfaceFlags,u.pc=B(a,f,i)}}function Wt(){Rt=new l,Rt.leaf.numLeafBrushes=1,Rt.leaf.firstLeafBrush=Mt.leafBrushes.length,Mt.leafBrushes.push(Mt.brushes.length),Ut=new h,Ut.firstSide=Mt.brushSides.length,Ut.numSides=Ft,Ut.contents=s.CONTENTS.BODY,Mt.brushes.push(Ut),zt=new Array(qt);for(var e=0;e<qt;e++){var t=zt[e]=new i.Plane;Mt.planes.push(t)}for(var e=0;e<6;e++){var n=e&1,o=new r.dbrushside_t;o.plane=zt[e*2+n],o.surfaceFlags=0;var u=zt[e*2];u.type=e>>1,u.normal[0]=u.normal[1]=u.normal[2]=0,u.normal[e>>1]=1,u.signbits=0,u=zt[e*2+1],u.type=3+(e>>1),u.normal[0]=u.normal[1]=u.normal[2]=0,u.normal[e>>1]=-1,u.signbits=i.GetPlaneSignbits(u.normal),Mt.brushSides.push(o)}}function Xt(e){return(e<0||e>=Mt.models.length)&&t.Error("GetInlineModel: bad number"),e}function Vt(e,t,n){return vec3.set(e,Rt.mins),vec3.set(t,Rt.maxs),n?u:(zt[0].dist=t[0],zt[1].dist=-t[0],zt[2].dist=e[0],zt[3].dist=-e[0],zt[4].dist=t[1],zt[5].dist=-t[1],zt[6].dist=e[1],zt[7].dist=-e[1],zt[8].dist=t[2],zt[9].dist=-t[2],zt[10].dist=e[2],zt[11].dist=-e[2],vec3.set(e,Ut.bounds[0]),vec3.set(t,Ut.bounds[1]),o)}function $t(e,t,n){var r=Jt(e);vec3.set(r.mins,t),vec3.set(r.maxs,n)}function Jt(e){e<0&&t.Error("ClipHandleToModel: bad handle "+e);if(e<Mt.models.length)return Mt.models[e];if(e===o)return Rt;t.Error("ClipHandleToModel: bad handle "+Mt.models.length+" < "+e)}function Kt(e){return(e<0||e>=Mt.leafs.length)&&t.Error("LeafCluster: bad number"),Mt.leafs[e].cluster}function Qt(e){return(e<0||e>=Mt.leafs.length)&&t.Error("LeafArea: bad number"),Mt.leafs[e].area}var t=e.COM,n=256,o=255,u=254,a=.125,f=function(){this.shaders=null,this.brushes=null,this.brushSides=null,this.models=null,this.leafs=null,this.leafBrushes=null,this.leafSurfaces=null,this.nodes=null,this.planes=null,this.shaders=null,this.entities=null,this.surfaces=null,this.visibility=null,this.numClusters=0,this.clusterBytes=0,this.areas=null,this.areaPortals=null,this.floodValid=0},l=function(){this.mins=vec3.create(),this.maxs=vec3.create(),this.leaf=new r.dleaf_t},c=function(){this.plane=null,this.surfaceFlags=0},h=function(){this.shader=0,this.contents=0,this.bounds=[vec3.create(),vec3.create()],this.firstSide=0,this.numSides=0,this.checkcount=0},p=function(){this.floodnum=0,this.floodValid=0},d=function(){this.allSolid=!1,this.startSolid=!1,this.fraction=1,this.endPos=vec3.create(),this.plane=new i.Plane,this.surfaceFlags=0,this.contents=0,this.entityNum=0,this.shaderName=null};d.prototype.clone=function(e){return typeof e=="undefined"&&(e=new d),e.allSolid=this.allSolid,e.startSolid=this.startSolid,e.fraction=this.fraction,vec3.set(this.endPos,e.endPos),this.plane.clone(e.plane),e.surfaceFlags=this.surfaceFlags,e.contents=this.contents,e.entityNum=this.entityNum,e.shaderName=this.shaderName,e};var v=1024,m=function(){this.list=null,this.count=0,this.maxCount=0,this.lastLeaf=0},g=function(){this.use=!1,this.radius=0,this.halfheight=0,this.offset=vec3.create()};g.prototype.clone=function(e){typeof e=="undefined"&&(e=new g),e.use=this.use,e.radius=this.radius,e.halfheight=this.halfheight,vec3.set(this.offset,e.offset)};var y=function(){this.trace=new d,this.start=vec3.create(),this.end=vec3.create(),this.size=[vec3.create(),vec3.create()],this.offsets=[vec3.create(),vec3.create(),vec3.create(),vec3.create(),vec3.create(),vec3.create(),vec3.create(),vec3.create()],this.maxOffset=0,this.extents=vec3.create(),this.bounds=[vec3.create(),vec3.create()],this.contents=0,this.isPoint=!1,this.sphere=new g},b=1024,w=1024,E=2048,S=129,x=16,T=.1,N=function(){this.plane=vec4.create(),this.signbits=0},C=function(){this.surfacePlane=0,this.numBorders=0,this.borderPlanes=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.borderInward=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.borderNoAdjust=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1]},k=function(){this.bounds=[vec3.create(),vec3.create()],this.planes=[],this.facets=[]},L=function(){this.width=0,this.height=0,this.wrapWidth=0,this.wrapHeight=0,this.points=new Array(S);for(var e=0;e<S;e++){this.points[e]=new Array(S);for(var t=0;t<S;t++)this.points[e][t]=vec3.create()}},A=function(){this.checkcount=0,this.surfaceFlags=0,this.contents=0,this.pc=null},M=0,_=1,D=2,P=3,H=[],U=.1,Y=1e-4,Z=.02,st=function(){this.enterFrac=0,this.leaveFrac=0,this.hit=!1},St=new Uint32Array(v),Mt,jt=1,Ft=6,It=2,qt=12,Rt=null,Ut=null,zt=null;return{LoadWorld:_t,InlineModel:Xt,TempBoxModel:Vt,ModelBounds:$t,LeafArea:Qt,LeafCluster:Kt,ClusterVisible:at,BoxLeafnums:lt,PointLeafnum:ht,PointContents:pt,TransformedPointContents:dt,AdjustAreaPortalState:gt,AreasConnected:yt,BoxTrace:At,TransformedBoxTrace:Ot,EmitCollisionSurfaces:ut}}return{CreateInstance:function(e){return new o(e)}}}),define("game/bg",["glmatrix","common/qmath","common/qshared"],function(e,t,n){function r(e){function tt(e){r.Error(e)}function nt(e,t,n){e.events[e.eventSequence&u-1]=t,e.eventParms[e.eventSequence&u-1]=n,e.eventSequence++}function rt(e,n){e.pm_type===O.INTERMISSION||e.pm_type===O.SPECTATOR?n.eType=W.INVISIBLE:e.stats[j.HEALTH]<=d?n.eType=W.INVISIBLE:n.eType=W.PLAYER,n.number=e.clientNum,n.pos.trType=l.INTERPOLATE,vec3.set(e.origin,n.pos.trBase),vec3.set(e.velocity,n.pos.trDelta),n.apos.trType=l.INTERPOLATE,vec3.set(e.viewangles,n.apos.trBase),n.angles2[t.YAW]=e.movementDir,n.legsAnim=e.legsAnim,n.torsoAnim=e.torsoAnim,n.clientNum=e.clientNum,n.eFlags=e.eFlags,e.stats[j.HEALTH]<=0?n.eFlags|=X.DEAD:n.eFlags&=~X.DEAD;if(e.externalEvent)n.event=e.externalEvent,n.eventParm=e.externalEventParm;else if(e.entityEventSequence<e.eventSequence){e.entityEventSequence<e.eventSequence-u&&(e.entityEventSequence=e.eventSequence-u);var r=e.entityEventSequence&u-1;n.event=e.events[r]|(e.entityEventSequence&3)<<8,n.eventParm=e.eventParms[r],e.entityEventSequence++}n.weapon=e.weapon,n.groundEntityNum=e.groundEntityNum,n.powerups=0;for(var i=0;i<o;i++)e.powerups[i]&&(n.powerups|=1<<i);n.loopSound=e.loopSound,n.generic1=e.generic1}function it(e,t,n){var i,s;switch(e.trType){case l.STATIONARY:case l.INTERPOLATE:vec3.set(e.trBase,n);break;case l.LINEAR:i=(t-e.trTime)*.001,vec3.add(e.trBase,vec3.scale(e.trDelta,i,vec3.create()),n);break;case l.SINE:i=(t-e.trTime)/e.trDuration,s=Math.sin(i*Math.PI*2),vec3.add(e.trBase,vec3.scale(e.trDelta,s,vec3.create()),n);break;case l.LINEAR_STOP:t>e.trTime+e.trDuration&&(t=e.trTime+e.trDuration),i=(t-e.trTime)*.001,i<0&&(i=0),vec3.add(e.trBase,vec3.scale(e.trDelta,i,vec3.create()),n);break;case l.GRAVITY:i=(t-e.trTime)*.001,vec3.add(e.trBase,vec3.scale(e.trDelta,i,vec3.create()),n),n[2]-=.5*p*i*i;break;default:r.Error("EvaluateTrajectory: unknown trType: "+e.trType)}}function st(e,t,n){var i,s;switch(e.trType){case l.STATIONARY:case l.INTERPOLATE:n[0]=n[1]=n[2]=0;break;case l.LINEAR:vec3.set(e.trDelta,n);break;case l.SINE:i=(t-e.trTime)/e.trDuration,s=Math.cos(i*Math.PI*2),s*=.5,vec3.scale(e.trDelta,s,n);break;case l.LINEAR_STOP:if(t>e.trTime+e.trDuration){n[0]=n[1]=n[2]=0;return}vec3.set(e.trDelta,n);break;case l.GRAVITY:i=(t-e.trTime)*.001,vec3.set(e.trDelta,n),n[2]-=p*i;break;default:r.Error("EvaluateTrajectoryDelta: unknown trType: "+e.trType)}}function ot(e,n){if(e.pm_type!==O.NORMAL)return;if(e.powerups[I.FLIGHT])return;if(e.jumppad_ent!==n.number){var r=vec3.create();t.VectorToAngles(n.origin2,r);var i=Math.abs(t.AngleNormalize180(r[t.PITCH])),s=i<45?0:1;nt(e,Q.JUMP_PAD,s)}e.jumppad_ent=n.number,e.jumppad_frame=e.pmove_framecount,vec3.set(n.origin2,e.velocity)}function ut(e,t,n){(t.modelIndex<1||t.modelIndex>=dn.length)&&r.Error("CanItemBeGrabbed: index out of range");var i=dn[t.modelIndex];switch(i.giType){case H.WEAPON:return!0;case H.AMMO:if(n.ammo[i.giTag]>=200)return!1;return!0;case H.ARMOR:if(n.stats[j.ARMOR]>=n.stats[j.MAX_HEALTH]*2)return!1;return!0;case H.HEALTH:if(i.quantity==5||i.quantity==100)return n.stats[j.HEALTH]>=n.stats[j.MAX_HEALTH]*2?!1:!0;if(n.stats[j.HEALTH]>=n.stats[j.MAX_HEALTH])return!1;return!0;case H.POWERUP:return!0;case H.TEAM:if(e==_.CTF)if(n.persistant[U.TEAM]==q.RED){if(i.giTag==I.BLUEFLAG||i.giTag==I.REDFLAG&&t.modelIndex2||i.giTag==I.REDFLAG&&n.powerups[I.BLUEFLAG])return!0}else if(n.persistant[U.TEAM]==q.BLUE)if(i.giTag==I.REDFLAG||i.giTag==I.BLUEFLAG&&t.modelIndex2||i.giTag==I.BLUEFLAG&&n.powerups[I.REDFLAG])return!0;return!1;case H.HOLDABLE:if(n.stats[j.HOLDABLE_ITEM])return!1;return!0;case H.BAD:return tt("CanItemBeGrabbed: IT.BAD"),!1;default:}return!1}function at(e,t,n){var r=vec3.create();return it(t.pos,n,r),e.origin[0]-r[0]>44||e.origin[0]-r[0]<-50||e.origin[1]-r[1]>36||e.origin[1]-r[1]<-36||e.origin[2]-r[2]>36||e.origin[2]-r[2]<-36?!1:!0}function ft(e,t,n){var r=0,i=vec3.create(e);i[2]+=E+1;var s=n(i,-1);if(s&B.WATER){var o=t-E,u=o/2;r=1,i[2]=e[2]+E+u,s=n(i,-1),s&B.WATER&&(r=2,i[2]=e[2]+E+o,s=n(i,-1),s&B.WATER&&(r=3))}return r}function Lt(e){var t=e.ps,n=e.cmd,r=n.serverTime;if(r<t.commandTime)return;r>t.commandTime+1e3&&(t.commandTime=r-1e3),t.pmove_framecount=t.pmove_framecount+1&(1<<a)-1;while(t.commandTime!==r){var i=r-t.commandTime;e.pmove_fixed?i>e.pmove_msec&&(i=e.pmove_msec):i>66&&(i=66),n.serverTime=t.commandTime+i,At(e),e.ps.pm_flags&M.JUMP_HELD&&(e.cmd.upmove=20)}}function At(e){ct=e;var n=ct.ps,r=ct.cmd;lt.reset(),lt.msec=r.serverTime-n.commandTime,lt.msec<1?lt.msec=1:lt.msec>200&&(lt.msec=200),n.commandTime=r.serverTime,lt.frameTime=lt.msec*.001;if(Math.abs(r.forwardmove)>64||Math.abs(r.rightmove)>64)r.buttons&=~f.WALKING;!(n.pm_flags&M.RESPAWNED)&&!(n.pm_flags&M.NO_ATTACK)&&n.pm_type!==O.INTERMISSION&&n.pm_type!==O.NOCLIP&&r.buttons&f.ATTACK&&n.ammo[n.weapon]?n.eFlags|=X.FIRING:n.eFlags&=~X.FIRING,n.stats[j.HEALTH]>0&&!(r.buttons&(f.ATTACK|f.USE_HOLDABLE))&&(n.pm_flags&=~M.RESPAWNED),Gt(n,r),t.AnglesToVectors(n.viewangles,lt.forward,lt.right,lt.up);if(Math.abs(r.forwardmove)>64||Math.abs(r.rightmove)>64)r.buttons&=~f.WALKING;ct.cmd.upmove<10&&(n.pm_flags&=~M.JUMP_HELD);if(r.forwardmove<0)n.pm_flags|=M.BACKWARDS_RUN;else if(ct.cmd.forwardmove>0||r.forwardmove===0&&r.rightmove)n.pm_flags&=~M.BACKWARDS_RUN;n.pm_type>=O.DEAD&&(r.forwardmove=0,r.rightmove=0,r.upmove=0);if(ct.ps.pm_type===O.SPECTATOR){_t(),It(),Yt();return}if(ct.ps.pm_type===O.NOCLIP){qt(),Yt();return}if(ct.ps.pm_type==O.INTERMISSION||ct.ps.pm_type==O.SPINTERMISSION)return;Mt(),lt.previous_waterlevel=ct.waterlevel,_t(),Pt(),n.pm_type===O.DEAD&&Ft(),Yt(),n.pm_flags&M.TIME_WATERJUMP?zt():ct.waterlevel>1?Ut():lt.walking?Wt():Rt(),Pt(),Mt(),Zt(),nn(),rn(),sn(),t.SnapVector(n.velocity),ct=null}function Ot(e,t){var n=Math.abs(e.forwardmove);Math.abs(e.rightmove)>n&&(n=Math.abs(e.rightmove)),Math.abs(e.upmove)>n&&(n=Math.abs(e.upmove));if(!n)return 0;var r=Math.sqrt(e.forwardmove*e.forwardmove+e.rightmove*e.rightmove+e.upmove*e.upmove),i=t*n/(127*r);return i}function Mt(){var e=ct.ps;ct.waterlevel=ft(e.origin,e.viewheight,ct.pointContents);var t=vec3.createFrom(e.origin[0],e.origin[1],e.origin[2]+E+1),n=ct.pointContents(t,-1);n&B.WATER?ct.watertype=n:ct.watertype=0}function _t(){var e=ct.ps;ct.mins[0]=-15,ct.mins[1]=-15,ct.maxs[0]=15,ct.maxs[1]=15,ct.mins[2]=E;if(ct.pm_type===O.DEAD){ct.maxs[2]=-8,e.viewheight=T;return}if(ct.cmd.upmove<0)e.pm_flags|=M.DUCKED;else if(e.pm_flags&M.DUCKED){ct.maxs[2]=32;var t=ct.trace(e.origin,e.origin,ct.mins,ct.maxs,e.clientNum,ct.tracemask);t.allSolid||(e.pm_flags&=~M.DUCKED)}e.pm_flags&M.DUCKED?(ct.maxs[2]=16,e.viewheight=x):(ct.maxs[2]=32,e.viewheight=S)}function Dt(){var e=ct.ps;return ct.cmd.upmove<10?!1:e.pm_flags&M.JUMP_HELD?(ct.cmd.upmove=0,!1):(lt.groundPlane=!1,lt.walking=!1,e.pm_flags|=M.JUMP_HELD,e.groundEntityNum=i,e.velocity[2]=kt,un(Q.JUMP),ct.cmd.forwardmove>=0?(pn(Z.LEGS_JUMP),e.pm_flags&=~M.BACKWARDS_JUMP):(pn(Z.LEGS_JUMPB),e.pm_flags|=M.BACKWARDS_JUMP),!0)}function Pt(){var e=ct.ps,t=vec3.createFrom(e.origin[0],e.origin[1],e.origin[2]-.25),n=ct.trace(e.origin,t,ct.mins,ct.maxs,e.clientNum,ct.tracemask);lt.groundTrace=n;if(n.allSolid&&!Bt(n))return;if(n.fraction===1){jt();return}if(e.velocity[2]>0&&vec3.dot(e.velocity,n.plane.normal)>10){ct.cmd.forwardmove>=0?(pn(Z.LEGS_JUMP),e.pm_flags&=~M.BACKWARDS_JUMP):(pn(Z.LEGS_JUMPB),e.pm_flags|=M.BACKWARDS_JUMP),e.groundEntityNum=i,lt.groundPlane=!1,lt.walking=!1;return}if(n.plane.normal[2]<pt){e.groundEntityNum=i,lt.groundPlane=!0,lt.walking=!1;return}lt.groundPlane=!0,lt.walking=!0,e.groundEntityNum=n.entityNum,e.pm_flags&M.TIME_WATERJUMP&&(e.pm_flags&=~(M.TIME_WATERJUMP|M.TIME_LAND),e.pm_time=0),an(n.entityNum)}function Ht(){var e=ct.ps;if(e.pm_time)return!1;if(ct.waterlevel!==2)return!1;var t=vec3.createFrom(lt.forward[0],lt.forward[1],0);vec3.normalize(t);var n=vec3.add(vec3.scale(t,30,vec3.create()),e.origin);n[2]+=4;var r=ct.pointContents(n,e.clientNum);return r&h.SOLID?(n[2]+=16,r=ct.pointContents(n,e.clientNum),r&(h.SOLID|h.PLAYERCLIP|h.BODY)?!1:(vec3.scale(lt.forward,200,e.velocity),e.velocity[2]=350,e.pm_flags|=M.TIME_WATERJUMP,e.pm_time=2e3,!0)):!1}function Bt(e){var t=ct.ps,n=vec3.create(),r;for(var s=-1;s<=1;s++)for(var o=-1;o<=1;o++)for(var u=-1;u<=1;u++){vec3.set(t.origin,n),n[0]+=s,n[1]+=o,n[2]+=u,r=ct.trace(n,n,ct.mins,ct.maxs,t.clientNum,ct.tracemask);if(!r.allSolid)return r.clone(e),!0}return t.groundEntityNum=i,lt.groundPlane=!1,lt.walking=!1,!1}function jt(){var e=ct.ps;if(e.groundEntityNum!==i){var t=vec3.create(e.origin);t[2]-=64;var n=ct.trace(e.origin,t,ct.mins,ct.maxs,e.clientNum,ct.tracemask);n.fraction===1&&(ct.cmd.forwardmove>=0?(pn(Z.LEGS_JUMP),e.pm_flags&=~M.BACKWARDS_JUMP):(pn(Z.LEGS_JUMPB),e.pm_flags|=M.BACKWARDS_JUMP))}e.groundEntityNum=i,lt.groundPlane=!1,lt.walking=!1}function Ft(){if(!lt.walking)return;var e=ct.ps,t=vec3.length(e.velocity);t-=20,t<=0?e.velocity[0]=e.velocity[1]=e.velocity[2]=0:(vec3.normalize(e.velocity),vec3.scale(e.velocity,t))}function It(){var e=ct.ps,t=ct.cmd;Vt(!0);var n=Ot(t,e.speed),r=vec3.create();for(var i=0;i<3;i++)r[i]=n*lt.forward[i]*t.forwardmove+n*lt.right[i]*t.rightmove;r[2]+=t.upmove;var s=vec3.length(r),o=vec3.normalize(r,vec3.create());$t(o,s,St),Qt(!1)}function qt(){var e=ct.ps,n=ct.cmd;e.viewheight=S;var r=vec3.length(e.velocity);if(r<1)vec3.set(t.vec3origin,e.velocity);else{var i=xt*1.5,s=r<mt?mt:r,o=s*i*lt.frameTime,u=r-o;u<0&&(u=0),u/=r,vec3.scale(e.velocity,u)}var a=Ot(n,e.speed),f=vec3.create();for(var l=0;l<3;l++)f[l]=lt.forward[l]*n.forwardmove+lt.right[l]*n.rightmove;f[2]+=n.upmove;var c=vec3.length(f)*a,h=vec3.normalize(f,vec3.create());$t(h,c,bt),vec3.add(e.origin,vec3.scale(e.velocity,lt.frameTime,vec3.create()))}function Rt(){var e=ct.ps,t=ct.cmd;Vt(),Xt(),lt.forward[2]=0,lt.right[2]=0,vec3.normalize(lt.forward),vec3.normalize(lt.right);var n=Ot(t,e.speed),r=vec3.create();for(var i=0;i<2;i++)r[i]=lt.forward[i]*t.forwardmove+lt.right[i]*t.rightmove;r[2]=0;var s=vec3.normalize(r,vec3.create()),o=vec3.length(r)*n;$t(s,o,wt),lt.groundPlane&&(e.velocity=Jt(e.velocity,lt.groundTrace.plane.normal,vt)),Qt(!0)}function Ut(){var e=ct.ps,t=ct.cmd;if(Ht()){zt();return}Vt();var n=Ot(t,e.speed),r=vec3.create();if(!n)r[0]=0,r[1]=0,r[2]=-60;else{for(var i=0;i<3;i++)r[i]=lt.forward[i]*t.forwardmove+lt.right[i]*t.rightmove;r[2]+=n*ct.cmd.upmove}var s=vec3.normalize(r,vec3.create()),o=vec3.length(r);o>e.speed*yt&&(o=e.speed*yt),$t(s,o,Et);if(lt.groundPlane&&vec3.dot(e.velocity,lt.groundTrace.plane.normal)<0){var u=vec3.length(e.velocity);Jt(e.velocity,lt.groundTrace.plane.normal,e.velocity,vt),vec3.normalize(e.velocity),vec3.scale(e.velocity,u)}Kt(!1)}function zt(){var e=ct.ps;Qt(!0),e.velocity[2]-=e.gravity*lt.frameTime,e.velocity[2]<0&&(e.pm_flags&=~M.ALL_TIMES,e.pm_time=0)}function Wt(){var e=ct.ps,t=ct.cmd;if(Dt()){Rt();return}Vt(),Xt(),lt.forward[2]=0,lt.right[2]=0,lt.forward=Jt(lt.forward,lt.groundTrace.plane.normal,vt),lt.right=Jt(lt.right,lt.groundTrace.plane.normal,vt),vec3.normalize(lt.forward),vec3.normalize(lt.right);var n=Ot(t,e.speed),r=vec3.create();for(var i=0;i<3;i++)r[i]=lt.forward[i]*t.forwardmove+lt.right[i]*t.rightmove;var s=vec3.length(r),o=vec3.normalize(r,vec3.create());s*=n,e.pm_flags&M.DUCKED&&s>e.speed*gt&&(s=e.speed*gt);if(ct.waterlevel){var u=ct.waterlevel/3;u=1-(1-yt)*u,s>e.speed*u&&(s=e.speed*u)}var a=bt;if(lt.groundTrace.surfaceFlags&c.SLICK||e.pm_flags&M.TIME_KNOCKBACK)a=wt;$t(o,s,a);if(lt.groundTrace.surfaceFlags&c.SLICK||e.pm_flags&M.TIME_KNOCKBACK)e.velocity[2]-=e.gravity*lt.frameTime;var f=vec3.length(e.velocity);e.velocity=Jt(e.velocity,lt.groundTrace.plane.normal,vt),vec3.normalize(e.velocity),vec3.scale(e.velocity,f);if(!e.velocity[0]&&!e.velocity[1])return;Qt(!1)}function Xt(){var e=ct.ps;ct.cmd.forwardmove||ct.cmd.rightmove?ct.cmd.rightmove===0&&ct.cmd.forwardmove>0?e.movementDir=0:ct.cmd.rightmove<0&&ct.cmd.forwardmove>0?e.movementDir=1:ct.cmd.rightmove<0&&ct.cmd.forwardmove===0?e.movementDir=2:ct.cmd.rightmove<0&&ct.cmd.forwardmove<0?e.movementDir=3:ct.cmd.rightmove===0&&ct.cmd.forwardmove<0?e.movementDir=4:ct.cmd.rightmove>0&&ct.cmd.forwardmove<0?e.movementDir=5:ct.cmd.rightmove>0&&ct.cmd.forwardmove===0?e.movementDir=6:ct.cmd.rightmove>0&&ct.cmd.forwardmove>0&&(e.movementDir=7):e.movementDir===2?e.movementDir=1:e.movementDir===6&&(e.movementDir=7)}function Vt(e){var t=ct.ps,n=vec3.create(t.velocity);lt.walking&&(n[2]=0);var r=vec3.length(n);if(r<1){t.velocity[0]=0,t.velocity[1]=0;return}var i=0;if(ct.waterlevel<=1&&lt.walking&&!(lt.groundTrace.surfaceFlags&c.SLICK)&&!(t.pm_flags&M.TIME_KNOCKBACK)){var s=r<mt?mt:r;i+=s*xt*lt.frameTime}ct.waterlevel&&(i+=r*Tt*ct.waterlevel*lt.frameTime),e&&(i+=r*Nt*lt.frameTime);var o=r-i;o<0&&(o=0),o/=r,vec3.scale(t.velocity,o)}function $t(e,t,n){var r=ct.ps,i=vec3.dot(r.velocity,e),s=t-i;if(s<=0)return;var o=n*lt.frameTime*t;o>s&&(o=s),vec3.add(r.velocity,vec3.scale(e,o,vec3.create()))}function Jt(e,t,n){var r=vec3.dot(e,t);r<0?r*=n:r/=n;var i=vec3.scale(t,r,vec3.create());return vec3.subtract(e,i,vec3.create())}function Kt(e){var t=ct.ps,n=vec3.create(),r=lt.frameTime,i=[],s=4,o=vec3.create();e&&(vec3.set(t.velocity,n),n[2]-=t.gravity*r,t.velocity[2]=(t.velocity[2]+n[2])*.5,lt.groundPlane&&(t.velocity=Jt(t.velocity,lt.groundTrace.plane.normal,vt))),lt.groundPlane&&i.push(vec3.set(lt.groundTrace.plane.normal,vec3.create())),i.push(vec3.normalize(t.velocity,vec3.create()));for(var u=0;u<s;u++){vec3.add(t.origin,vec3.scale(t.velocity,r,vec3.create()),o);var a=ct.trace(t.origin,o,ct.mins,ct.maxs,t.clientNum,ct.tracemask);if(a.allSolid)return t.velocity[2]=0,!1;a.fraction>0&&vec3.set(a.endPos,t.origin);if(a.fraction===1)break;an(a.entityNum),r-=r*a.fraction;if(i.length>=ht)return t.velocity=vec3.create(),!1;for(var f=0;f<i.length;f++)if(vec3.dot(a.plane.normal,i[f])>.99){vec3.add(t.velocity,a.plane.normal);break}if(f<i.length)continue;i.push(vec3.set(a.plane.normal,vec3.create()));for(var f=0;f<i.length;++f){var l=vec3.dot(t.velocity,i[f]);if(l>=.1)continue;var c=Jt(t.velocity,i[f],vt),h=Jt(n,i[f],vt);for(var p=0;p<i.length;p++){if(p===f)continue;if(vec3.dot(c,i[p])>=.1)continue;c=Jt(c,i[p],vt),h=Jt(h,i[p],vt);if(vec3.dot(c,i[f])>=0)continue;var d=vec3.cross(i[f],i[p],vec3.create());vec3.normalize(d);var v=vec3.dot(d,t.velocity);vec3.scale(d,v,c),vec3.cross(i[f],i[p],d),vec3.normalize(d),v=vec3.dot(d,n),vec3.scale(d,v,h);for(var m=0;m<i.length;m++){if(m==f||m==p)continue;if(vec3.dot(c,i[m])>=.1)continue;return t.velocity=vec3.create(),!1}}vec3.set(c,t.velocity),vec3.set(h,n);break}}return e&&vec3.set(n,t.velocity),u===0}function Qt(e){var t=ct.ps,n=vec3.create(t.origin),r=vec3.create(t.velocity);if(Kt(e))return;var i=vec3.createFrom(0,0,1),s=vec3.create(n);s[2]-=dt;var o=ct.trace(n,s,ct.mins,ct.maxs,t.clientNum,ct.tracemask);if(t.velocity[2]>0&&(o.fraction===1||vec3.dot(o.plane.normal,i)<.7))return;vec3.set(n,i),i[2]+=dt,o=ct.trace(n,i,ct.mins,ct.maxs,t.clientNum,ct.tracemask);if(o.allSolid)return;vec3.set(o.endPos,t.origin),vec3.set(r,t.velocity),Kt(e);var u=o.endPos[2]-n[2];vec3.set(t.origin,s),s[2]-=u,o=ct.trace(t.origin,s,ct.mins,ct.maxs,t.clientNum,ct.tracemask),o.allSolid||vec3.set(o.endPos,t.origin),o.fraction<1&&(t.velocity=Jt(t.velocity,o.plane.normal,vt));var a=t.origin[2]-n[2];a>2&&(a<7?un(Q.STEP_4):a<11?un(Q.STEP_8):a<15?un(Q.STEP_12):un(Q.STEP_16))}function Gt(e,n){if(e.pm_type===O.INTERMISSION||e.pm_type===O.SPINTERMISSION)return;if(e.pm_type!==O.SPECTATOR&&e.stats[j.HEALTH]<=0)return;for(var r=0;r<3;r++){var i=n.angles[r]+e.delta_angles[r]&65535;i>32767&&(i-=65535),r===t.PITCH&&(i>16e3?(e.delta_angles[r]=16e3-n.angles[r],i=16e3):i<-16e3&&(e.delta_angles[r]=-16e3-n.angles[r],i=-16e3)),e.viewangles[r]=t.ShortToAngle(i)}}function Yt(){var e=ct.ps;e.pm_time&&(lt.msec>=e.pm_time?(e.pm_flags&=~M.ALL_TIMES,e.pm_time=0):e.pm_time-=lt.msec)}function Zt(){var e=ct.ps;if(e.pm_flags&M.RESPAWNED)return;if(ct.ps.persistant[U.SPECTATOR_STATE]!==R.NOT)return;if(e.pm_type===O.DEAD){e.weapon=F.NONE;return}e.weaponTime>0&&(e.weaponTime-=lt.msec),(e.weaponTime<=0||e.weaponState!==P.FIRING)&&e.weapon!==ct.cmd.weapon&&en(ct.cmd.weapon);if(e.weaponTime>0)return;if(e.weaponState===P.DROPPING){tn();return}if(e.weaponState===P.RAISING){e.weaponState=P.READY,e.weapon===F.GAUNTLET?fn(Z.TORSO_STAND2):fn(Z.TORSO_STAND);return}if(e.pm_flags&M.NO_ATTACK)return;if(!(ct.cmd.buttons&f.ATTACK)){e.weaponTime=0,e.weaponState=P.READY;return}if(e.weapon===F.GAUNTLET){if(!ct.gauntletHit){e.weaponTime=0,e.weaponState=P.READY;return}fn(Z.TORSO_ATTACK2)}else fn(Z.TORSO_ATTACK);e.weaponState=P.FIRING;if(!e.ammo[e.weapon]){un(Q.NOAMMO),e.weaponTime+=500;return}e.ammo[e.weapon]!==-1&&e.ammo[e.weapon]--,un(Q.FIRE_WEAPON);var t=0;switch(e.weapon){case F.GAUNTLET:t=400;break;case F.LIGHTNING:t=50;break;case F.SHOTGUN:t=1e3;break;case F.MACHINEGUN:t=100;break;case F.GRENADE_LAUNCHER:t=800;break;case F.ROCKET_LAUNCHER:t=800;break;case F.PLASMAGUN:t=100;break;case F.RAILGUN:t=1500;break;case F.BFG:t=200;break;case F.GRAPPLING_HOOK:t=400;break;default:t=400}e.powerups[I.HASTE]&&(t/=1.3),e.weaponTime+=t}function en(e){var t=ct.ps;if(e<=F.NONE||e>=F.NUM_WEAPONS)return;if(!(t.stats[j.WEAPONS]&1<<e))return;if(t.weaponState==P.DROPPING)return;un(Q.CHANGE_WEAPON),t.weaponState=P.DROPPING,t.weaponTime+=200,fn(Z.TORSO_DROP)}function tn(){var e=ct.ps,t=ct.cmd.weapon;if(t<F.NONE||t>=F.NUM_WEAPONS)t=F.NONE;e.stats[j.WEAPONS]&1<<t||(t=F.NONE),e.weapon=t,e.weaponState=P.RAISING,e.weaponTime+=250,fn(Z.TORSO_RAISE)}function nn(){var e=ct.ps;e.weaponState===P.READY&&(e.weapon==F.GAUNTLET?hn(Z.TORSO_STAND2):hn(Z.TORSO_STAND))}function rn(){var e=ct.ps;ct.xyspeed=Math.sqrt(e.velocity[0]*e.velocity[0]+e.velocity[1]*e.velocity[1]);if(e.groundEntityNum===i){ct.waterlevel>1&&cn(Z.LEGS_SWIM);return}if(!ct.cmd.forwardmove&&!ct.cmd.rightmove){ct.xyspeed<5&&(e.bobCycle=0,e.pm_flags&M.DUCKED?cn(Z.LEGS_IDLECR):cn(Z.LEGS_IDLE));return}var t=!1,n=0;e.pm_flags&M.DUCKED?(n=.5,e.pm_flags&M.BACKWARDS_RUN?cn(Z.LEGS_BACKCR):cn(Z.LEGS_WALKCR)):ct.cmd.buttons&f.WALKING?(n=.3,e.pm_flags&M.BACKWARDS_RUN?cn(Z.LEGS_BACKWALK):cn(Z.LEGS_WALK)):(n=.4,e.pm_flags&M.BACKWARDS_RUN?cn(Z.LEGS_BACK):cn(Z.LEGS_RUN),t=!0);var r=e.bobCycle;e.bobCycle=parseInt(r+n*lt.msec,10)%256,(r+64^e.bobCycle+64)&128&&(ct.waterlevel===0?t&&un(on()):ct.waterlevel===1?un(Q.FOOTSPLASH):ct.waterlevel===2?un(Q.SWIM):ct.waterlevel===3)}function sn(){!lt.previous_waterlevel&&ct.waterlevel&&un(Q.WATER_TOUCH),lt.previous_waterlevel&&!ct.waterlevel&&un(Q.WATER_LEAVE),lt.previous_waterlevel!==3&&ct.waterlevel===3&&un(Q.WATER_UNDER),lt.previous_waterlevel===3&&ct.waterlevel!==3&&un(Q.WATER_CLEAR)}function on(){return lt.groundTrace.surfaceFlags&c.NOSTEPS?0:lt.groundTrace.surfaceFlags&c.METALSTEPS?Q.FOOTSTEP_METAL:Q.FOOTSTEP}function un(e){nt(ct.ps,e,0)}function an(e){if(e===s)return;if(ct.numTouch===C)return;if(ct.touchEnts.indexOf(e)!==-1)return;ct.touchEnts[ct.numTouch]=e,ct.numTouch++}function fn(e){var t=ct.ps;if(t.pm_type>=O.DEAD)return;t.torsoAnim=t.torsoAnim&Y^Y|e}function ln(e){var t=ct.ps;if(t.pm_type>=O.DEAD)return;if(t.legsTimer>0)return;t.legsAnim=t.legsAnim&Y^Y|e}function cn(e){var t=ct.ps;if((t.legsAnim&~Y)===e)return;if(t.legsTimer>0)return;ln(e)}function hn(e){var t=ct.ps;if((t.torsoAnim&~Y)===e)return;if(t.torsoTimer>0)return;fn(e)}function pn(e){var t=ct.ps;t.legsTimer=0,ln(e)}function vn(e){for(var t=1;t<dn.length;t++){var n=dn[t];if(n.name===e)return n}return null}function mn(e){for(var t=1;t<dn.length;t++){var n=dn[t];if(n.giType===H.WEAPON&&n.giTag===e)return n}return null}function gn(e){for(var t=1;t<dn.length;t++){var n=dn[t];if((n.giType===H.POWERUP||n.giType===H.TEAM)&&n.giTag===e)return n}return null}function yn(e){for(var t=1;t<dn.length;t++){var n=dn[t];if(n.giType===H.HOLDABLE&&n.giTag===e)return n}return null}var r=e.com,i=n.ENTITYNUM_NONE,s=n.ENTITYNUM_WORLD,o=n.MAX_POWERUPS,u=n.MAX_PS_EVENTS,a=n.PMOVEFRAMECOUNTBITS,f=n.BUTTON,l=n.TR,c=n.SURF,h=n.CONTENTS,p=800,d=-40,v=.66,m=16384,g=700,y=11,b=768,w=-9999,E=-24,S=26,x=12,T=-16,N=23,C=32,k=function(){this.reset()};k.prototype.reset=function(){this.forward=vec3.create(),this.right=vec3.create(),this.up=vec3.create(),this.frameTime=0,this.msec=0,this.walking=!1,this.groundPlane=!1,this.groundTrace=null,this.impactSpeed=0,this.previous_origin=vec3.create(),this.previous_velocity=vec3.create(),this.previous_waterlevel=0};var L=function(){this.ps=null,this.cmd=new n.UserCmd,this.mins=vec3.create(),this.maxs=vec3.create(),this.tracemask=0,this.gauntletHit=!1,this.touchEnts=new Array(C),this.numTouch=0,this.xyspeed=0,this.watertype=0,this.waterlevel=0,this.pmove_fixed=0,this.pmove_msec=0,this.trace=null,this.pointContents=null},A=function(){this.firstFrame=0,this.numFrames=0,this.loopFrames=0,this.frameLerp=0,this.initialLerp=0,this.reversed=!1,this.flipflop=!1},O={NORMAL:0,NOCLIP:1,SPECTATOR:2,DEAD:3,FREEZE:4,INTERMISSION:5,SPINTERMISSION:6},M={DUCKED:1,JUMP_HELD:2,NO_ATTACK:4,BACKWARDS_JUMP:8,BACKWARDS_RUN:16,TIME_LAND:32,TIME_KNOCKBACK:64,TIME_WATERJUMP:256,RESPAWNED:512,USE_ITEM_HELD:1024,GRAPPLE_PULL:2048,FOLLOW:4096,SCOREBOARD:8192,INVULEXPAND:16384,ALL_TIMES:352},_={FFA:0,TOURNAMENT:1,SINGLE_PLAYER:2,TEAM:3,CTF:4,NFCTF:5,CLANARENA:6,MAX_GAME_TYPE:7},D=[];D[_.FFA]="ffa",D[_.TOURNAMENT]="tournament",D[_.SINGLE_PLAYER]="single",D[_.TEAM]="team",D[_.CTF]="ctf",D[_.NFCTF]="nfctf",D[_.CLANARENA]="ca";var P={READY:0,RAISING:1,DROPPING:2,FIRING:3},H={BAD:0,WEAPON:1,AMMO:2,ARMOR:3,HEALTH:4,POWERUP:5,HOLDABLE:6,PERSISTANT_POWERUP:7,TEAM:8},B={ALL:-1,SOLID:h.SOLID,PLAYERSOLID:h.SOLID|h.PLAYERCLIP|h.BODY,DEADSOLID:h.SOLID|h.PLAYERCLIP,WATER:h.WATER|h.LAVA|h.SLIME,OPAQUE:h.SOLID|h.SLIME|h.LAVA,SHOT:h.SOLID|h.BODY|h.CORPSE},j={HEALTH:0,HOLDABLE_ITEM:1,WEAPONS:2,ARMOR:3,DEAD_YAW:4,CLIENTS_READY:5,MAX_HEALTH:6},F={NONE:0,GAUNTLET:1,MACHINEGUN:2,SHOTGUN:3,GRENADE_LAUNCHER:4,ROCKET_LAUNCHER:5,LIGHTNING:6,RAILGUN:7,PLASMAGUN:8,BFG:9,GRAPPLING_HOOK:10,NUM_WEAPONS:11},I={NONE:0,QUAD:1,BATTLESUIT:2,HASTE:3,INVIS:4,REGEN:5,FLIGHT:6,REDFLAG:7,BLUEFLAG:8,NEUTRALFLAG:9,NUM_POWERUPS:10},q={FREE:0,RED:1,BLUE:2,SPECTATOR:3,NUM_TEAMS:4},R={NOT:0,FREE:1,FOLLOW:2,SCOREBOARD:3},U={SCORE:0,HITS:1,RANK:2,TEAM:3,SPECTATOR_STATE:4,SPAWN_COUNT:5,PLAYEREVENTS:6,ATTACKER:7,ATTACKEE_ARMOR:8,KILLED:9,IMPRESSIVE_COUNT:10,EXCELLENT_COUNT:11,DEFEND_COUNT:12,ASSIST_COUNT:13,GAUNTLET_FRAG_COUNT:14,CAPTURES:15},z={DENIEDREWARD:1,GAUNTLETREWARD:2,HOLYSHIT:4},W={GENERAL:0,PLAYER:1,ITEM:2,MISSILE:3,MOVER:4,BEAM:5,PORTAL:6,SPEAKER:7,PUSH_TRIGGER:8,TELEPORT_TRIGGER:9,INVISIBLE:10,GRAPPLE:11,TEAM:12,EVENTS:13},X={DEAD:1,TELEPORT_BIT:4,AWARD_EXCELLENT:8,PLAYER_EVENT:16,BOUNCE:16,BOUNCE_HALF:32,AWARD_GAUNTLET:64,NODRAW:128,FIRING:256,KAMIKAZE:512,MOVER_STOP:1024,AWARD_CAP:2048,TALK:4096,CONNECTION:8192,VOTED:16384,AWARD_IMPRESSIVE:32768,AWARD_DEFEND:65536,AWARD_ASSIST:131072,AWARD_DENIED:262144,TEAMVOTED:524288},V=256,$=512,J=V|$,K=300,Q={NONE:0,FOOTSTEP:1,FOOTSTEP_METAL:2,FOOTSPLASH:3,FOOTWADE:4,SWIM:5,STEP_4:6,STEP_8:7,STEP_12:8,STEP_16:9,FALL_SHORT:10,FALL_MEDIUM:11,FALL_FAR:12,JUMP_PAD:13,JUMP:14,WATER_TOUCH:15,WATER_LEAVE:16,WATER_UNDER:17,WATER_CLEAR:18,ITEM_PICKUP:19,GLOBAL_ITEM_PICKUP:20,NOAMMO:21,CHANGE_WEAPON:22,FIRE_WEAPON:23,USE_ITEM0:24,USE_ITEM1:25,USE_ITEM2:26,USE_ITEM3:27,USE_ITEM4:28,USE_ITEM5:29,USE_ITEM6:30,USE_ITEM7:31,USE_ITEM8:32,USE_ITEM9:33,USE_ITEM10:34,USE_ITEM11:35,USE_ITEM12:36,USE_ITEM13:37,USE_ITEM14:38,USE_ITEM15:39,ITEM_RESPAWN:40,ITEM_POP:41,PLAYER_TELEPORT_IN:42,PLAYER_TELEPORT_OUT:43,GRENADE_BOUNCE:44,GENERAL_SOUND:45,GLOBAL_SOUND:46,GLOBAL_TEAM_SOUND:47,BULLET_HIT_FLESH:48,BULLET_HIT_WALL:49,MISSILE_HIT:50,MISSILE_MISS:51,MISSILE_MISS_METAL:52,RAILTRAIL:53,SHOTGUN:54,BULLET:55,PAIN:56,DEATH1:57,DEATH2:58,DEATH3:59,OBITUARY:60,POWERUP_QUAD:61,POWERUP_BATTLESUIT:62,POWERUP_REGEN:63,GIB_PLAYER:64,SCOREPLUM:65,DEBUG_LINE:66,STOPLOOPINGSOUND:67,TAUNT:68,TAUNT_YES:69,TAUNT_NO:70,TAUNT_FOLLOWME:71,TAUNT_GETFLAG:72,TAUNT_GUARDBASE:73,TAUNT_PATROL:74},G={RED_CAPTURE:0,BLUE_CAPTURE:1,RED_RETURN:2,BLUE_RETURN:3,RED_TAKEN:4,BLUE_TAKEN:5,REDOBELISK_ATTACKED:6,BLUEOBELISK_ATTACKED:7,REDTEAM_SCORED:8,BLUETEAM_SCORED:9,REDTEAM_TOOK_LEAD:10,BLUETEAM_TOOK_LEAD:11,TEAMS_ARE_TIED:12,KAMIKAZE:13},Y=128,Z={BOTH_DEATH1:0,BOTH_DEAD1:1,BOTH_DEATH2:2,BOTH_DEAD2:3,BOTH_DEATH3:4,BOTH_DEAD3:5,TORSO_GESTURE:6,TORSO_ATTACK:7,TORSO_ATTACK2:8,TORSO_DROP:9,TORSO_RAISE:10,TORSO_STAND:11,TORSO_STAND2:12,LEGS_WALKCR:13,LEGS_WALK:14,LEGS_RUN:15,LEGS_BACK:16,LEGS_SWIM:17,LEGS_JUMP:18,LEGS_LAND:19,LEGS_JUMPB:20,LEGS_LANDB:21,LEGS_IDLE:22,LEGS_IDLECR:23,LEGS_TURN:24,TORSO_GETFLAG:25,TORSO_GUARDBASE:26,TORSO_PATROL:27,TORSO_FOLLOWME:28,TORSO_AFFIRMATIVE:29,TORSO_NEGATIVE:30,MAX:31,LEGS_BACKCR:32,LEGS_BACKWALK:33,FLAG_RUN:34,FLAG_STAND:35,FLAG_STAND2RUN:36,MAX_TOTALANIMATIONS:37},et={UNKNOWN:0,SHOTGUN:1,GAUNTLET:2,MACHINEGUN:3,GRENADE:4,GRENADE_SPLASH:5,ROCKET:6,ROCKET_SPLASH:7,PLASMA:8,PLASMA_SPLASH:9,RAILGUN:10,LIGHTNING:11,BFG:12,BFG_SPLASH:13,WATER:14,SLIME:15,LAVA:16,CRUSH:17,TELEFRAG:18,FALLING:19,SUICIDE:20,TARGET_LASER:21,TRIGGER_HURT:22,GRAPPLE:23},lt=new k,ct=null,ht=5,pt=.7,dt=18,vt=1.001,mt=100,gt=.25,yt=.5,bt=10,wt=1,Et=4,St=8,xt=6,Tt=1,Nt=3,Ct=5,kt=270,dn=[{},{classname:"item_armor_shard",name:"Armor Shard",models:{primary:"models/powerups/armor/shard.md3"},gfx:{icon:"icons/iconr_shard"},sounds:{pickup:"sound/misc/ar1_pkup"},quantity:5,giType:H.ARMOR,giTag:0},{classname:"item_armor_combat",name:"Armor",models:{primary:"models/powerups/armor/armor_yel.md3"},gfx:{icon:"icons/iconr_yellow"},sounds:{pickup:"sound/misc/ar2_pkup"},quantity:50,giType:H.ARMOR,giTag:0},{classname:"item_armor_body",name:"Heavy Armor",models:{primary:"models/powerups/armor/armor_red.md3"},gfx:{icon:"icons/iconr_red"},sounds:{pickup:"sound/misc/ar2_pkup"},quantity:100,giType:H.ARMOR,giTag:0},{classname:"item_health_small",name:"5 Health",models:{primary:"models/powerups/health/small_cross.md3",secondary:"models/powerups/health/small_sphere.md3"},gfx:{icon:"icons/iconh_green"},sounds:{pickup:"sound/items/s_health"},quantity:5,giType:H.HEALTH,giTag:0},{classname:"item_health",name:"25 Health",models:{primary:"models/powerups/health/medium_cross.md3",secondary:"models/powerups/health/medium_sphere.md3"},gfx:{icon:"icons/iconh_yellow"},sounds:{pickup:"sound/items/n_health"},quantity:25,giType:H.HEALTH,giTag:0},{classname:"item_health_large",name:"50 Health",models:{primary:"models/powerups/health/large_cross.md3",secondary:"models/powerups/health/large_sphere.md3"},gfx:{icon:"icons/iconh_red"},sounds:{pickup:"sound/items/l_health"},quantity:50,giType:H.HEALTH,giTag:0},{classname:"item_health_mega",name:"Mega Health",models:{primary:"models/powerups/health/mega_cross.md3",secondary:"models/powerups/health/mega_sphere.md3"},gfx:{icon:"icons/iconh_mega"},sounds:{pickup:"sound/items/m_health"},quantity:100,giType:H.HEALTH,giTag:0},{classname:"weapon_gauntlet",name:"Gauntlet",models:{primary:"models/weapons2/gauntlet/gauntlet.md3",barrel:"models/weapons2/gauntlet/gauntlet_barrel.md3",flash:"models/weapons2/gauntlet/gauntlet_flash.md3",hand:"models/weapons2/gauntlet/gauntlet_hand.md3"},gfx:{icon:"icons/iconw_gauntlet"},sounds:{pickup:"sound/misc/w_pkup",firing:"sound/weapons/melee/fstrun",flash0:"sound/weapons/melee/fstatck"},quantity:0,giType:H.WEAPON,giTag:F.GAUNTLET,flashDlightColor:[.6,.6,1]},{classname:"weapon_machinegun",name:"Machinegun",models:{primary:"models/weapons2/machinegun/machinegun.md3",barrel:"models/weapons2/machinegun/machinegun_barrel.md3",flash:"models/weapons2/machinegun/machinegun_flash.md3",hand:"models/weapons2/machinegun/machinegun_hand.md3"},shaders:{bulletExplosion:"bulletExplosion"},gfx:{icon:"icons/iconw_machinegun"},sounds:{pickup:"sound/misc/w_pkup",flash0:"sound/weapons/machinegun/machgf1b",flash1:"sound/weapons/machinegun/machgf2b",flash2:"sound/weapons/machinegun/machgf3b",flash3:"sound/weapons/machinegun/machgf4b",ric0:"sound/weapons/machinegun/ric1",ric1:"sound/weapons/machinegun/ric2",ric2:"sound/weapons/machinegun/ric3"},quantity:40,giType:H.WEAPON,giTag:F.MACHINEGUN,flashDlightColor:[1,1,0]},{classname:"weapon_shotgun",name:"Shotgun",models:{primary:"models/weapons2/shotgun/shotgun.md3",flash:"models/weapons2/shotgun/shotgun_flash.md3",hand:"models/weapons2/shotgun/shotgun_hand.md3"},shaders:{bulletExplosion:"bulletExplosion"},gfx:{icon:"icons/iconw_shotgun"},sounds:{pickup:"sound/misc/w_pkup",flash0:"sound/weapons/shotgun/sshotf1b"},quantity:10,giType:H.WEAPON,giTag:F.SHOTGUN,flashDlightColor:[1,1,0]},{classname:"weapon_grenadelauncher",name:"Grenade Launcher",models:{primary:"models/weapons2/grenadel/grenadel.md3",flash:"models/weapons2/grenadel/grenadel_flash.md3",hand:"models/weapons2/grenadel/grenadel_hand.md3",missile:"models/ammo/grenade1.md3"},shaders:{explosion:"grenadeExplosion"},gfx:{icon:"icons/iconw_grenade"},sounds:{pickup:"sound/misc/w_pkup",flash0:"sound/weapons/grenade/grenlf1a",bounce0:"sound/weapons/grenade/hgrenb1a",bounce1:"sound/weapons/grenade/hgrenb2a"},quantity:10,trailTime:700,trailRadius:32,giType:H.WEAPON,giTag:F.GRENADE_LAUNCHER,flashDlightColor:[1,.7,0]},{classname:"weapon_rocketlauncher",name:"Rocket Launcher",models:{primary:"models/weapons2/rocketl/rocketl.md3",flash:"models/weapons2/rocketl/rocketl_flash.md3",hand:"models/weapons2/rocketl/rocketl_hand.md3",missile:"models/ammo/rocket/rocket.md3"},shaders:{explosion:"rocketExplosion"},gfx:{icon:"icons/iconw_rocket"},sounds:{pickup:"sound/misc/w_pkup",missile:"sound/weapons/rocket/rockfly",flash0:"sound/weapons/rocket/rocklf1a",explosion:"sound/weapons/rocket/rocklx1a"},quantity:10,trailTime:2e3,trailRadius:64,giType:H.WEAPON,giTag:F.ROCKET_LAUNCHER,flashDlightColor:[1,.75,0],missileDlightIntensity:200,missileDlightColor:[1,.75,0]},{classname:"weapon_lightning",name:"Lightning Gun",models:{primary:"models/weapons2/lightning/lightning.md3",flash:"models/weapons2/lightning/lightning_flash.md3",hand:"models/weapons2/lightning/lightning_hand.md3",explosion:"models/weaphits/crackle.md3"},shaders:{lightning:"lightningBoltNew"},gfx:{icon:"icons/iconw_lightning"},sounds:{pickup:"sound/misc/w_pkup",ready:"sound/weapons/melee/fsthum",firing:"sound/weapons/lightning/lg_hum",flash0:"sound/weapons/lightning/lg_fire",hit0:"sound/weapons/lightning/lg_hit",hit1:"sound/weapons/lightning/lg_hit2",hit2:"sound/weapons/lightning/lg_hit3"},quantity:100,giType:H.WEAPON,giTag:F.LIGHTNING,flashDlightColor:[.6,.6,1]},{classname:"weapon_railgun",name:"Railgun",models:{primary:"models/weapons2/railgun/railgun.md3",flash:"models/weapons2/railgun/railgun_flash.md3",hand:"models/weapons2/railgun/railgun_hand.md3"},shaders:{core:"railCore",explosion:"railExplosion"},gfx:{icon:"icons/iconw_railgun"},sounds:{pickup:"sound/misc/w_pkup",ready:"sound/weapons/railgun/rg_hum",explosion:"sound/weapons/plasma/plasmx1a",flash0:"sound/weapons/railgun/railgf1a"},quantity:10,giType:H.WEAPON,giTag:F.RAILGUN,flashDlightColor:[1,.5,0]},{classname:"weapon_plasmagun",name:"Plasma Gun",models:{primary:"models/weapons2/plasma/plasma.md3",flash:"models/weapons2/plasma/plasma_flash.md3",hand:"models/weapons2/plasma/plasma_hand.md3"},shaders:{missile:"railDisc",explosion:"plasmaExplosion"},gfx:{icon:"icons/iconw_plasma"},sounds:{pickup:"sound/misc/w_pkup",missile:"sound/weapons/plasma/lasfly",explosion:"sound/weapons/plasma/plasmx1a",flash0:"sound/weapons/plasma/hyprbf1a"},quantity:50,giType:H.WEAPON,giTag:F.PLASMAGUN,flashDlightColor:[.6,.6,1]},{classname:"weapon_bfg",name:"BFG10K",models:{primary:"models/weapons2/bfg/bfg.md3",barrel:"models/weapons2/bfg/bfg_barrel.md3",flash:"models/weapons2/bfg/bfg_flash.md3",hand:"models/weapons2/bfg/bfg_hand.md3",missile:"models/weaphits/bfg.md3"},shaders:{explosion:"bfgExplosion"},gfx:{icon:"icons/iconw_bfg"},sounds:{pickup:"sound/misc/w_pkup",ready:"sound/weapons/bfg/bfg_hum",missile:"sound/weapons/rocket/rockfly",flash0:"sound/weapons/bfg/bfg_fire"},quantity:20,giType:H.WEAPON,giTag:F.BFG,flashDlightColor:[1,.7,1]},{classname:"weapon_grapplinghook",name:"Grappling Hook",models:{primary:"models/weapons2/grapple/grapple.md3",flash:"models/weapons2/grapple/grapple_flash.md3",hand:"models/weapons2/grapple/grapple_hand.md3"},gfx:{icon:"icons/iconw_grapple"},sounds:{pickup:"sound/misc/w_pkup",ready:"sound/weapons/melee/fsthum",firing:"sound/weapons/melee/fstrun"},quantity:0,giType:H.WEAPON,giTag:F.GRAPPLING_HOOK},{classname:"ammo_bullets",name:"Bullets",models:{primary:"models/powerups/ammo/machinegunam.md3"},gfx:{icon:"icons/icona_machinegun"},sounds:{pickup:"sound/misc/am_pkup"},quantity:50,giType:H.AMMO,giTag:F.MACHINEGUN},{classname:"ammo_shells",name:"Shells",models:{primary:"models/powerups/ammo/shotgunam.md3"},gfx:{icon:"icons/icona_shotgun"},sounds:{pickup:"sound/misc/am_pkup"},quantity:10,giType:H.AMMO,giTag:F.SHOTGUN},{classname:"ammo_grenades",name:"Grenades",models:{primary:"models/powerups/ammo/grenadeam.md3"},gfx:{icon:"icons/icona_grenade"},sounds:{pickup:"sound/misc/am_pkup"},quantity:5,giType:H.AMMO,giTag:F.GRENADE_LAUNCHER},{classname:"ammo_rockets",name:"Rockets",models:{primary:"models/powerups/ammo/rocketam.md3"},gfx:{icon:"icons/icona_rocket"},sounds:{pickup:"sound/misc/am_pkup"},quantity:5,giType:H.AMMO,giTag:F.ROCKET_LAUNCHER},{classname:"ammo_lightning",name:"Lightning",models:{primary:"models/powerups/ammo/lightningam.md3"},gfx:{icon:"icons/icona_lightning"},sounds:{pickup:"sound/misc/am_pkup"},quantity:60,giType:H.AMMO,giTag:F.LIGHTNING},{classname:"ammo_slugs",name:"Slugs",models:{primary:"models/powerups/ammo/railgunam.md3"},gfx:{icon:"icons/icona_railgun"},sounds:{pickup:"sound/misc/am_pkup"},quantity:10,giType:H.AMMO,giTag:F.RAILGUN},{classname:"ammo_cells",name:"Cells",models:{primary:"models/powerups/ammo/plasmaam.md3"},gfx:{icon:"icons/icona_plasma"},sounds:{pickup:"sound/misc/am_pkup"},quantity:30,giType:H.AMMO,giTag:F.PLASMAGUN},{classname:"ammo_bfg",name:"Bfg Ammo",models:{primary:"models/powerups/ammo/bfgam.md3"},gfx:{icon:"icons/icona_bfg"},sounds:{pickup:"sound/misc/am_pkup"},quantity:15,giType:H.AMMO,giTag:F.BFG},{classname:"item_quad",name:"Quad Damage",models:{primary:"models/powerups/instant/quad.md3",secondary:"models/powerups/instant/quad_ring.md3"},gfx:{icon:"icons/quad"},sounds:{pickup:"sound/items/quaddamage",use:"sound/items/damage3"},quantity:30,giType:H.POWERUP,giTag:I.QUAD},{classname:"item_enviro",name:"Battle Suit",models:{primary:"models/powerups/instant/enviro.md3",secondary:"models/powerups/instant/enviro_ring.md3"},gfx:{icon:"icons/envirosuit"},sounds:{pickup:"sound/items/protect"},quantity:30,giType:H.POWERUP,giTag:I.BATTLESUIT},{classname:"item_haste",name:"Speed",models:{primary:"models/powerups/instant/haste.md3",secondary:"models/powerups/instant/haste_ring.md3"},gfx:{icon:"icons/haste"},sounds:{pickup:"sound/items/haste"},quantity:30,giType:H.POWERUP,giTag:I.HASTE},{classname:"item_invis",name:"Invisibility",models:{primary:"models/powerups/instant/invis.md3",secondary:"models/powerups/instant/invis_ring.md3"},gfx:{icon:"icons/invis"},sounds:{pickup:"sound/items/invisibility"},quantity:30,giType:H.POWERUP,giTag:I.INVIS},{classname:"item_regen",name:"Regeneration",models:{primary:"models/powerups/instant/regen.md3",secondary:"models/powerups/instant/regen_ring.md3"},gfx:{icon:"icons/regen"},sounds:{pickup:"sound/items/regeneration",use:"sound/items/regen"},quantity:30,giType:H.POWERUP,giTag:I.REGEN},{classname:"item_flight",name:"Flight",models:{primary:"models/powerups/instant/flight.md3",secondary:"models/powerups/instant/flight_ring.md3"},gfx:{icon:"icons/flight"},sounds:{pickup:"sound/items/flight"},quantity:60,giType:H.POWERUP,giTag:I.FLIGHT},{classname:"team_CTF_redflag",name:"Red Flag",models:{primary:"models/flags/r_flag.md3"},gfx:{icon:"icons/iconf_red1"},quantity:0,giType:H.TEAM,giTag:I.REDFLAG},{classname:"team_CTF_blueflag",name:"Blue Flag",models:{primary:"models/flags/b_flag.md3"},gfx:{icon:"icons/iconf_blu1"},quantity:0,giType:H.TEAM,giTag:I.BLUEFLAG},{classname:"team_CTF_neutralflag",name:"Neutral Flag",models:{primary:"models/flags/n_flag.md3"},gfx:{icon:"icons/iconf_neutral1"},quantity:0,giType:H.TEAM,giTag:I.NEUTRALFLAG}];return{DEFAULT_GRAVITY:p,GIB_HEALTH:d,ARMOR_PROTECTION:v,RANK_TIED_FLAG:m,DEFAULT_SHOTGUN_SPREAD:g,DEFAULT_SHOTGUN_COUNT:y,LIGHTNING_RANGE:b,SCORE_NOT_PRESENT:w,DEFAULT_VIEWHEIGHT:S,CROUCH_VIEWHEIGHT:x,CS_FLAGSTATUS:N,ANIM_TOGGLEBIT:Y,EV_EVENT_BIT1:V,EV_EVENT_BIT2:$,EV_EVENT_BITS:J,EVENT_VALID_MSEC:K,PM:O,PMF:M,GT:_,WS:P,IT:H,MASK:B,STAT:j,WP:F,PW:I,TEAM:q,SPECTATOR:R,PERS:U,PLAYEREVENTS:z,ET:W,EF:X,EV:Q,GTS:G,ANIM:Z,MOD:et,GametypeNames:D,PmoveInfo:L,Animation:A,ItemList:dn,FindItem:vn,FindItemForWeapon:mn,FindItemForPowerup:gn,FindItemForHoldable:yn,Pmove:Lt,UpdateViewAngles:Gt,AddPredictableEventToPlayerstate:nt,PlayerStateToEntityState:rt,EvaluateTrajectory:it,EvaluateTrajectoryDelta:st,TouchJumpPad:ot,CanItemBeGrabbed:ut,PlayerTouchesItem:at,GetWaterLevel:ft}}return{CreateInstance:function(e){return new r(e)}}}),define("game/gm",["underscore","glmatrix","common/qmath","common/qshared","game/bg"],function(_,glmatrix,QMath,QShared,BG){function Game(imp){function log(){var e=Array.prototype.slice.call(arguments);e.splice(0,0,"GM:"),Function.apply.call(console.log,console,e)}function error(e){com.Error(e)}function Init(e){log("Initializing"),level=new LevelLocals,level.time=e,level.startTime=e,gms||(gms=new GameStatic),RegisterCvars(),InitWorldSession(),level.maxclients=com.GetCvarVal("sv_maxClients"),sv.LocateGameData(level.gentities,level.clients),InitBodyQueue(),SpawnAllEntitiesFromDefs(),ChainTeams(),gms.warmupDisabled||ChangeWarmupState(-1),gms.warmupDisabled=!1}function Shutdown(){WriteSessionData()}function Frame(e){if(level.restarted){console.log("level restarted ignoring");return}level.framenum++,level.previousTime=level.time,level.time=e;for(var t=0;t<MAX_GENTITIES;t++){var n=level.gentities[t];if(!n.inuse)continue;if(level.time-n.eventTime>EVENT_VALID_MSEC){n.s.event&&(n.s.event=0,n.client&&(n.client.ps.externalEvent=0));if(n.freeAfterEvent){FreeEntity(n);continue}n.unlinkAfterEvent&&(n.unlinkAfterEvent=!1,sv.UnlinkEntity(n))}if(n.freeAfterEvent)continue;if(!n.linked&&n.neverFree)continue;if(n.s.eType===ET.MISSILE){RunMissile(n);continue}if(n.s.eType===ET.ITEM||n.physicsObject){RunItem(n);continue}if(n.s.eType===ET.MOVER){RunMover(n);continue}if(t<level.maxclients){RunClient(n);continue}RunEntity(n)}for(var t=0;t<level.maxclients;t++){var n=level.gentities[t];n.inuse&&ClientEndFrame(n)}CheckWarmup(),CheckTournament(),CheckMatchRules(),CheckExitRules(),level.intermissiontime&&SendScoreboardMessageToAllClients()}function ChangeWarmupState(e){if(!g_doWarmup()&&g_gametype()!==GT.CLANARENA)return;level.warmupTime=e,sv.SetConfigstring("warmup",level.warmupTime)}function CheckWarmup(){if(level.numPlayingClients===0)return;if(g_gametype()===GT.TOURNAMENT){if(level.numPlayingClients!==2){level.warmupTime!==-1&&ChangeWarmupState(-1);return}if(level.warmupTime===0)return;if(level.warmupTime<0){if(level.numPlayingClients===2){var e=0;g_warmup()>1&&(e=level.time+(g_warmup()-1)*1e3),ChangeWarmupState(e)}return}if(level.time>level.warmupTime){level.restarted=!0,gms.warmupDisabled=!0,com.ExecuteBuffer("map_restart 0");return}}else{var t=new Array(TEAM.NUM_TEAMS),n=!1;if(g_gametype()>GT.TEAM){t[TEAM.BLUE]=TeamCount(TEAM.BLUE,null),t[TEAM.RED]=TeamCount(TEAM.RED,null);if(t[TEAM.RED]<1||t[TEAM.BLUE]<1)n=!0}else level.numPlayingClients<2&&(n=!0);if(n){level.warmupTime!==-1&&ChangeWarmupState(-1);return}if(level.warmupTime===0)return;if(level.warmupTime<0){var e=0;g_warmup()>1&&(e=level.time+(g_warmup()-1)*1e3),ChangeWarmupState(e);return}if(level.time>level.warmupTime){g_gametype()===GT.CLANARENA?(ChangeWarmupState(0),StartMatch()):(level.restarted=!0,gms.warmupDisabled=!0,com.ExecuteBuffer("map_restart 0"));return}}}function CheckTournament(){g_gametype()===GT.TOURNAMENT&&level.numPlayingClients<2&&AddTournamentPlayer()}function CheckMatchRules(){if(g_gametype()!==GT.CLANARENA)return;if(level.warmupTime!==0)return;if(level.matchRestartTime){level.time>level.matchRestartTime&&RestartMatch();return}var e=new Array(TEAM.NUM_TEAMS);e[TEAM.RED]=TeamAliveCount(null,TEAM.RED),e[TEAM.BLUE]=TeamAliveCount(null,TEAM.BLUE),!e[TEAM.RED]&&!e[TEAM.BLUE]?EndMatch(null):e[TEAM.RED]?e[TEAM.BLUE]||EndMatch(TEAM.RED):EndMatch(TEAM.BLUE)}function StartMatch(){for(var e=0;e<level.maxclients;e++){var t=level.gentities[e];if(!t.inuse)continue;var n=t.client;if(n.sess.sessionTeam===TEAM.SPECTATOR)continue;n.ps.pm_type===PM.DEAD&&ClientSpawn(t)}}function EndMatch(e){log("EndMatch"),e===null?(level.teamScores[TEAM.RED]+=1,level.teamScores[TEAM.BLUE]+=1):level.teamScores[e]+=1,level.matchRestartTime=level.time+5e3}function RestartMatch(){level.matchRestartTime=0,ChangeWarmupState(-1);for(var e=0;e<level.maxclients;e++){var t=level.gentities[e];if(!t.inuse)continue;var n=t.client;if(n.sess.sessionTeam===TEAM.SPECTATOR)continue;n.sess.spectatorState=SPECTATOR.NOT,ClientSpawn(t)}}function CheckExitRules(){if(level.intermissiontime){CheckIntermissionExit();return}if(level.intermissionQueued){level.time-level.intermissionQueued>=INTERMISSION_DELAY_TIME&&(level.intermissionQueued=0,BeginIntermission());return}if(ScoreIsTied())return;if(g_timelimit()&&!level.warmupTime&&level.time-level.startTime>=g_timelimit()*6e4){sv.SendServerCommand(null,"print","Timelimit hit."),LogExit("Timelimit hit.");return}if(g_gametype()<GT.CTF&&g_fraglimit()){if(level.teamScores[TEAM.RED]>=g_fraglimit()){sv.SendServerCommand(null,"print","Red hit the fraglimit."),LogExit("Fraglimit hit.");return}if(level.teamScores[TEAM.BLUE]>=g_fraglimit()){sv.SendServerCommand(null,"print","Blue hit the fraglimit."),LogExit("Fraglimit hit.");return}for(var e=0;e<level.maxclients;e++){var t=level.clients[e];if(t.pers.connected!==CON.CONNECTED)continue;if(t.sess.sessionTeam!==TEAM.FREE)continue;if(t.ps.persistant[PERS.SCORE]>=g_fraglimit()){sv.SendServerCommand(null,t.pers.netname+" hit the fraglimit."),LogExit("Fraglimit hit.");return}}}if(g_gametype()>=GT.CTF&&g_gametype()!==GT.CLANARENA&&g_capturelimit()){if(level.teamScores[TEAM.RED]>=g_capturelimit()){sv.SendServerCommand(null,"print","Red hit the capturelimit."),LogExit("Capturelimit hit.");return}if(level.teamScores[TEAM.BLUE]>=g_capturelimit()){sv.SendServerCommand(null,"print","Blue hit the capturelimit."),LogExit("Capturelimit hit.");return}}}function CheckIntermissionExit(){var e=0,t=0,n=0,r=0;for(var i=0;i<level.maxclients;i++){var s=level.clients[i];if(s.pers.connected!==CON.CONNECTED)continue;if(level.gentities[s.ps.clientNum].svFlags&SVF.BOT)continue;r++,s.readyToExit?(e++,i<16&&(n|=1<<i)):t++}for(var i=0;i<level.maxclients;i++){var s=level.clients[i];if(s.pers.connected!==CON.CONNECTED)continue;s.ps.stats[STAT.CLIENTS_READY]=n}if(level.time<level.intermissiontime+5e3)return;if(r>0){if(!e){level.readyToExit=!1;return}if(!t){ExitLevel();return}}level.readyToExit||(level.readyToExit=!0,level.exitTime=level.time);if(level.time<level.exitTime+1e4)return;ExitLevel()}function BeginIntermission(){if(level.intermissiontime)return;g_gametype()===GT.TOURNAMENT&&AdjustTournamentScores(),level.intermissiontime=level.time;for(var e=0;e<level.maxclients;e++){var t=level.gentities[e];if(!t.inuse)continue;t.health<=0&&ClientRespawn(t),MoveClientToIntermission(t)}SendScoreboardMessageToAllClients()}function ScoreIsTied(){if(level.numPlayingClients<2)return!1;if(g_gametype()>=GT.TEAM)return level.teamScores[TEAM.RED]===level.teamScores[TEAM.BLUE];var e=level.clients[level.sortedClients[0]].ps.persistant[PERS.SCORE],t=level.clients[level.sortedClients[1]].ps.persistant[PERS.SCORE];return e==t}function MoveClientToIntermission(e){e.client.sess.spectatorState===SPECTATOR.FOLLOW&&StopFollowing(e);var t=vec3.create(),n=vec3.create();SelectIntermissionSpawnPoint(t,n,e.client.sess.arena),vec3.set(t,e.s.origin),vec3.set(t,e.client.ps.origin),vec3.set(n,e.client.ps.viewangles),e.client.ps.pm_type=PM.INTERMISSION,e.client.ps.eFlags=0,e.s.eFlags=0,e.s.eType=ET.GENERAL,e.s.modelIndex=0,e.s.loopSound=0,e.s.event=0,e.contents=0}function SendScoreboardMessageToAllClients(){for(var e=0;e<level.maxclients;e++)level.clients[e].pers.connected===CON.CONNECTED&&DeathmatchScoreboardMessage(level.gentities[e])}function ExitLevel(){level.changemap=null,level.intermissiontime=0,level.teamScores[TEAM.RED]=0,level.teamScores[TEAM.BLUE]=0;for(var e=0;e<level.maxclients;e++){var t=level.clients[e];if(t.pers.connected!==CON.CONNECTED)continue;t.ps.persistant[PERS.SCORE]=0}WriteSessionData();for(var e=0;e<level.maxclients;e++)level.clients[e].pers.connected==CON.CONNECTED&&(level.clients[e].pers.connected=CON.CONNECTING)}function LogExit(e){var t,n;level.intermissionQueued=level.time,sv.SetConfigstring("intermission",1)}function CalculateRanks(){var e,t,n;level.follow1=-1,level.follow2=-1,level.numConnectedClients=0,level.numNonSpectatorClients=0,level.numPlayingClients=0,level.numVotingClients=0;for(var r=0;r<level.numteamVotingClients.length;r++)level.numteamVotingClients[r]=0;for(var r=0;r<level.maxclients;r++)level.clients[r].pers.connected!==CON.DISCONNECTED&&(level.sortedClients[level.numConnectedClients]=r,level.numConnectedClients+=1,level.clients[r].sess.sessionTeam!==TEAM.SPECTATOR&&(level.numNonSpectatorClients+=1,level.clients[r].pers.connected===CON.CONNECTED&&(level.numPlayingClients+=1,level.gentities[r].svFlags&SVF.BOT||(level.numVotingClients+=1,level.clients[r].sess.sessionTeam==TEAM.RED?level.numteamVotingClients[0]+=1:level.clients[r].sess.sessionTeam==TEAM.BLUE&&(level.numteamVotingClients[1]+=1)),level.follow1===-1?level.follow1=r:level.follow2===-1&&(level.follow2=r))));level.sortedClients.sort(SortRanks);if(g_gametype()>=GT.TEAM)for(var r=0;r<level.numConnectedClients;r++){var i=level.clients[level.sortedClients[r]];level.teamScores[TEAM.RED]===level.teamScores[TEAM.BLUE]?i.ps.persistant[PERS.RANK]=2:level.teamScores[TEAM.RED]>level.teamScores[TEAM.BLUE]?i.ps.persistant[PERS.RANK]=0:i.ps.persistant[PERS.RANK]=1}else{e=-1,t=0;for(var r=0;r<level.numPlayingClients;r++){var i=level.clients[level.sortedClients[r]];n=i.ps.persistant[PERS.SCORE],r===0||n!==t?(e=r,level.clients[level.sortedClients[r]].ps.persistant[PERS.RANK]=e):(level.clients[level.sortedClients[r-1]].ps.persistant[PERS.RANK]=e|RANK_TIED_FLAG,level.clients[level.sortedClients[r]].ps.persistant[PERS.RANK]=e|RANK_TIED_FLAG),t=n}}if(g_gametype()>=GT.TEAM)sv.SetConfigstring("score1",{s:level.teamScores[TEAM.RED]}),sv.SetConfigstring("score2",{s:level.teamScores[TEAM.BLUE]});else{var s=level.sortedClients[0],o=level.sortedClients[1];level.numConnectedClients===0?(sv.SetConfigstring("score1",{s:SCORE_NOT_PRESENT}),sv.SetConfigstring("score2",{s:SCORE_NOT_PRESENT})):level.numConnectedClients===1?(sv.SetConfigstring("score1",{s:level.clients[s].ps.persistant[PERS.SCORE],n:s}),sv.SetConfigstring("score2",{s:SCORE_NOT_PRESENT})):(sv.SetConfigstring("score1",{s:level.clients[s].ps.persistant[PERS.SCORE],n:s}),sv.SetConfigstring("score2",{s:level.clients[o].ps.persistant[PERS.SCORE],n:o}))}CheckExitRules()}function SortRanks(e,t){var n=level.clients[e],r=level.clients[t];return n.sess.spectatorState===SPECTATOR.SCOREBOARD||n.sess.spectatorClient<0?1:r.sess.spectatorState===SPECTATOR.SCOREBOARD||r.sess.spectatorClient<0?-1:n.pers.connected===CON.CONNECTING?1:r.pers.connected===CON.CONNECTING?-1:n.sess.sessionTeam==TEAM.SPECTATOR&&r.sess.sessionTeam==TEAM.SPECTATOR?n.sess.spectatorNum>r.sess.spectatorNum?-1:n.sess.spectatorNum<r.sess.spectatorNum?1:0:n.sess.sessionTeam==TEAM.SPECTATOR?1:r.sess.sessionTeam==TEAM.SPECTATOR?-1:n.ps.persistant[PERS.SCORE]>r.ps.persistant[PERS.SCORE]?-1:n.ps.persistant[PERS.SCORE]<r.ps.persistant[PERS.SCORE]?1:0}function BGExports(){return{com:{ERR:com.ERR,Error:com.Error}}}function RunClient(e){if(!g_synchronousClients())return;e.client.pers.cmd.serverTime=level.time,ClientThink_real(e)}function ClientThink(e){var t=level.gentities[e];sv.GetUserCmd(e,t.client.pers.cmd),t.client.lastCmdTime=level.time;if(g_synchronousClients())return;ClientThink_real(t)}function ClientThink_real(e){var t=e.client,n=t.pers.cmd;n.serverTime>level.time+200&&(n.serverTime=level.time+200),n.serverTime<level.time-1e3&&(n.serverTime=level.time-1e3);var r=n.serverTime-t.ps.commandTime;if(r<1&&t.sess.spectatorState!==SPECTATOR.FOLLOW)return;r>200&&(r=200),pmove_msec()<8?pmove_msec(8):pmove_msec()>33&&pmove_msec(33),pmove_fixed()&&(n.serverTime=(n.serverTime+pmove_msec()-1)/pmove_msec()*pmove_msec());if(level.intermissiontime){ClientIntermissionThink(t);return}if(t.sess.spectatorState!==SPECTATOR.NOT){if(t.sess.spectatorState===SPECTATOR.SCOREBOARD)return;ClientSpectatorThink(e,n);return}level.time>t.rewardTime&&(t.ps.eFlags&=~(EF.AWARD_IMPRESSIVE|EF.AWARD_EXCELLENT|EF.AWARD_GAUNTLET|EF.AWARD_ASSIST|EF.AWARD_DEFEND|EF.AWARD_CAP)),t.noclip?t.ps.pm_type=PM.NOCLIP:t.ps.stats[STAT.HEALTH]<=0?t.ps.pm_type=PM.DEAD:t.ps.pm_type=PM.NORMAL,t.ps.gravity=g_gravity(),t.ps.speed=g_speed(),t.ps.powerups[PW.HASTE]&&(t.ps.speed*=1.3),g_gametype()===GT.CLANARENA&&(level.warmupTime!==0?t.ps.pm_flags|=PMF.NO_ATTACK:t.ps.pm_flags&=~PMF.NO_ATTACK);var i=t.ps.eventSequence,s=new bg.PmoveInfo;s.ps=t.ps,n.clone(s.cmd),s.trace=sv.Trace,s.pointContents=sv.PointContents,s.pmove_fixed=pmove_fixed(),s.pmove_msec=pmove_msec(),s.ps.pm_type===PM.DEAD?s.tracemask=MASK.PLAYERSOLID&~CONTENTS.BODY:s.tracemask=MASK.PLAYERSOLID,t.ps.weapon===WP.GAUNTLET&&!(n.buttons&BUTTON.TALK)&&n.buttons&BUTTON.ATTACK&&t.ps.weaponTime<=0&&(s.gauntletHit=CheckGauntletAttack(e)),e.flags&GFL.FORCE_GESTURE&&(e.flags&=~GFL.FORCE_GESTURE,e.client.pers.cmd.buttons|=BUTTON.GESTURE),vec3.set(t.ps.origin,t.oldOrigin),bg.Pmove(s),e.client.ps.eventSequence!==i&&(e.eventTime=level.time),bg.PlayerStateToEntityState(t.ps,e.s),vec3.set(e.s.pos.trBase,e.currentOrigin),vec3.set(s.mins,e.mins),vec3.set(s.maxs,e.maxs),e.waterlevel=s.waterlevel,e.watertype=s.watertype,ClientEvents(e,i),sv.LinkEntity(e),e.client.noclip||TouchTriggers(e),vec3.set(t.ps.origin,e.currentOrigin),ClientImpacts(e,s),e.client.ps.eventSequence!=i&&(e.eventTime=level.time);if(t.ps.pm_type===PM.DEAD){if(level.time>t.respawnTime){if(g_gametype()===GT.CLANARENA){t.sess.spectatorState=SPECTATOR.FREE,ClientRespawn(e);return}if(g_forcerespawn()>0&&level.time-t.respawnTime>g_forcerespawn()*1e3){ClientRespawn(e);return}n.buttons&(BUTTON.ATTACK|BUTTON.USE_HOLDABLE)&&ClientRespawn(e)}return}}function ClientIntermissionThink(e){e.ps.eFlags&=~EF.TALK,e.ps.eFlags&=~EF.FIRING,e.oldbuttons=e.buttons,e.buttons=e.pers.cmd.buttons,e.buttons&(BUTTON.ATTACK|BUTTON.USE_HOLDABLE)&(e.oldbuttons^e.buttons)&&(e.readyToExit=1)}function ClientSpectatorThink(e,t){var n=e.client;if(n.sess.spectatorState!==SPECTATOR.FOLLOW){n.ps.pm_type=PM.SPECTATOR,n.ps.speed=400;var r=new bg.PmoveInfo;r.ps=n.ps,t.clone(r.cmd),r.tracemask=MASK.PLAYERSOLID&~CONTENTS.BODY,r.trace=sv.Trace,r.pointContents=sv.PointContents,bg.Pmove(r),vec3.set(n.ps.origin,e.s.origin),TouchTriggers(e),sv.UnlinkEntity(e)}}function ClientEvents(e,t){var n=e.client;t<n.ps.eventSequence-MAX_PS_EVENTS&&(t=n.ps.eventSequence-MAX_PS_EVENTS);for(var r=t;r<n.ps.eventSequence;r++){var i=n.ps.events[r&MAX_PS_EVENTS-1];switch(i){case EV.FIRE_WEAPON:FireWeapon(e);break;default:}}}function ClientEndFrame(e){var t=e.client;if(t.sess.spectatorState!==SPECTATOR.NOT){SpectatorClientEndFrame(e);return}for(var n=0;n<MAX_POWERUPS;n++)t.ps.powerups[n]<level.time&&(t.ps.powerups[n]=0);if(level.intermissiontime)return;WorldEffects(e),DamageFeedback(e),level.time-t.lastCmdTime>1e3?t.ps.eFlags|=EF.CONNECTION:t.ps.eFlags&=~EF.CONNECTION,t.ps.stats[STAT.HEALTH]=e.health,SetClientSound(e),bg.PlayerStateToEntityState(t.ps,e.s)}function SpectatorClientEndFrame(e){if(e.client.sess.spectatorState===SPECTATOR.FOLLOW){var t=e.client.sess.spectatorClient;t===-1?t=level.follow1:t===-2&&(t=level.follow2);if(t>=0){var n=level.clients[t];if(n.pers.connected===CON.CONNECTED&&n.sess.spectatorState===SPECTATOR.NOT){var r=n.ps.eFlags&~(EF.VOTED|EF.TEAMVOTED)|e.client.ps.eFlags&(EF.VOTED|EF.TEAMVOTED);e.client.ps=n.ps,e.client.ps.pm_flags|=PMF.FOLLOW,e.client.ps.eFlags=r;return}e.client.sess.spectatorClient>=0&&(e.client.sess.spectatorState=SPECTATOR.FREE,ClientBegin(e.s.number))}}e.client.sess.spectatorState===SPECTATOR.SCOREBOARD?e.client.ps.pm_flags|=PMF.SCOREBOARD:e.client.ps.pm_flags&=~PMF.SCOREBOARD}function DamageFeedback(e){var t=e.client;if(t.ps.pm_type===PM.DEAD)return;var n=t.damage_blood+t.damage_armor;if(n===0)return;n>255&&(n=255);if(t.damage_fromWorld)t.ps.damagePitch=255,t.ps.damageYaw=255,t.damage_fromWorld=!1;else{var r=vec3.create();QMath.VectorToAngles(t.damage_from,r),t.ps.damagePitch=r[QMath.PITCH]/360*256,t.ps.damageYaw=r[QMath.YAW]/360*256}level.time>e.painDebounceTime&&!(e.flags&GFL.GODMODE)&&(e.painDebounceTime=level.time+700,AddEvent(e,EV.PAIN,e.health),t.ps.damageEvent++),t.ps.damageCount=n,t.damage_blood=0,t.damage_armor=0,t.damage_knockback=0}function WorldEffects(e){if(e.client.noclip){e.client.airOutTime=level.time+12e3;return}var t=e.waterlevel,n=e.client.ps.powerups[PW.BATTLESUIT]>level.time;t===3?(n&&(e.client.airOutTime=level.time+1e4),e.client.airOutTime<level.time&&(e.client.airOutTime+=1e3,e.health>0&&(e.damage+=2,e.damage>15&&(e.damage=15),e.painDebounceTime=level.time+200,Damage(e,null,null,null,null,e.damage,DAMAGE.NO_ARMOR,MOD.WATER)))):(e.client.airOutTime=level.time+12e3,e.damage=2),t&&e.watertype&(CONTENTS.LAVA|CONTENTS.SLIME)&&e.health>0&&e.painDebounceTime<=level.time&&(n?AddEvent(e,EV.POWERUP_BATTLESUIT,0):(e.watertype&CONTENTS.LAVA&&Damage(e,null,null,null,null,30*t,0,MOD.LAVA),e.watertype&CONTENTS.SLIME&&Damage(e,null,null,null,null,10*t,0,MOD.SLIME)))}function SetClientSound(e){}function TouchTriggers(e){if(!e.client)return;if(e.client.pm_type===PM.DEAD)return;var t=e.client.ps,n=vec3.createFrom(40,40,52),r=vec3.create(),i=vec3.create();vec3.subtract(t.origin,n,r),vec3.add(t.origin,n,i);var s=sv.FindEntitiesInBox(r,i);vec3.add(t.origin,e.mins,r),vec3.add(t.origin,e.maxs,i);for(var o=0;o<s.length;o++){var u=level.gentities[s[o]];if(!u.touch)continue;if(!(u.contents&CONTENTS.TRIGGER))continue;if(u.s.eType===ET.ITEM){if(!bg.PlayerTouchesItem(e.client.ps,u.s,level.time))continue}else if(!sv.EntityContact(r,i,u))continue;u.touch.call(this,u,e)}t.jumppad_frame!=t.pmove_framecount&&(t.jumppad_frame=0,t.jumppad_ent=0)}function ClientImpacts(e,t){for(var n=0;n<t.numTouch;n++){for(var r=0;r<n;r++)if(t.touchEnts[r]===t.touchEnts[n])break;if(r!==n)continue;var i=level.gentities[t.touchEnts[n]];if(!i.touch)continue;i.touch(i,e,null)}}function ClientConnect(e,t){var n=level.gentities[e]=new GameEntity,r=level.clients[e]=new GameClient,i=sv.GetUserinfo(e);n.inuse=!0,n.s.number=e,n.client=r,r.ps.clientNum=e,r.pers.connected=CON.CONNECTING,(t||level.newSession)&&InitSessionData(r,i),ReadSessionData(r),ClientUserinfoChanged(e),t&&sv.SendServerCommand(null,"print",r.pers.netname+" connected"),g_gametype()>=GT.TEAM&&r.sess.sessionTeam!==TEAM.SPECTATOR&&BroadcastTeamChange(null,r),CalculateRanks()}function ClientUserinfoChanged(e){var t=level.gentities[e],n=t.client,r=sv.GetUserinfo(e);n.pers.netname=r.name;var i={name:n.pers.netname,team:n.sess.sessionTeam};sv.SetConfigstring("player"+e,i),log("ClientUserinfoChanged: "+e+" "+JSON.stringify(i))}function ClientBegin(e){var t=level.gentities[e],n=level.clients[e];t.linked&&sv.UnlinkEntity(t),t.touch=0,t.pain=0,n.pers.connected=CON.CONNECTED,n.pers.enterTime=level.time,n.pers.teamState.state=TEAM_STATE.BEGIN,ClientSpawn(t),n.sess.sessionTeam!==TEAM.SPECTATOR&&g_gametype()!==GT.TOURNAMENT&&sv.SendServerCommand(null,"print",n.pers.netname+" entered the game"),CalculateRanks()}function ClientSpawn(e){var t=e.client,n=e.client.ps,r=vec3.create(),i=vec3.create(),s;t.sess.spectatorState!==SPECTATOR.NOT?s=SelectSpectatorSpawnPoint(r,i,t.sess.arena):g_gametype()>=GT.CTF?s=SelectCTFSpawnPoint(t.sess.sessionTeam,t.pers.teamState.state,r,i,t.sess.arena):s=SelectSpawnPoint(t.ps.origin,r,i,t.sess.arena),t.pers.teamState.state=TEAM_STATE.ACTIVE;var o=e.client.ps.eFlags&(EF.TELEPORT_BIT|EF.VOTED|EF.TEAMVOTED);o^=EF.TELEPORT_BIT;var u=t.pers.clone(),a=t.sess.clone(),f=new Array(MAX_PERSISTANT);for(var l=0;l<MAX_PERSISTANT;l++)f[l]=t.ps.persistant[l];var c=t.ps.ping,h=t.accuracy_hits,p=t.accuracy_shots,d=t.ps.eventSequence;t.reset(),u.clone(t.pers),a.clone(t.sess);for(var l=0;l<MAX_PERSISTANT;l++)t.ps.persistant[l]=f[l];t.ps.ping=c,t.accuracy_hits=h,t.accuracy_shots=p,t.ps.clientNum=e.s.number,t.ps.eventSequence=d,t.lastkilled_client=-1,t.ps.persistant[PERS.SPAWN_COUNT]++,t.ps.persistant[PERS.TEAM]=t.sess.sessionTeam,t.ps.persistant[PERS.SPECTATOR_STATE]=t.sess.spectatorState,t.airOutTime=level.time+12e3,t.pers.maxHealth=100,t.ps.stats[STAT.MAX_HEALTH]=t.pers.maxHealth,t.ps.eFlags=o,e.s.groundEntityNum=ENTITYNUM_NONE,e.client=level.clients[e.s.number],e.takeDamage=!0,e.inuse=!0,e.classname="player",e.contents=CONTENTS.BODY,e.clipmask=MASK.PLAYERSOLID,e.die=PlayerDie,e.waterlevel=0,e.watertype=0,e.flags=0,vec3.set(playerMins,e.mins),vec3.set(playerMaxs,e.maxs),g_gametype()===GT.CLANARENA?(t.ps.stats[STAT.WEAPONS]=1<<WP.GAUNTLET,t.ps.stats[STAT.WEAPONS]|=1<<WP.MACHINEGUN,t.ps.stats[STAT.WEAPONS]|=1<<WP.SHOTGUN,t.ps.stats[STAT.WEAPONS]|=1<<WP.GRENADE_LAUNCHER,t.ps.stats[STAT.WEAPONS]|=1<<WP.ROCKET_LAUNCHER,t.ps.stats[STAT.WEAPONS]|=1<<WP.LIGHTNING,t.ps.stats[STAT.WEAPONS]|=1<<WP.RAILGUN,t.ps.stats[STAT.WEAPONS]|=1<<WP.PLASMAGUN,t.ps.ammo[WP.GAUNTLET]=-1,t.ps.ammo[WP.MACHINEGUN]=-1,t.ps.ammo[WP.SHOTGUN]=-1,t.ps.ammo[WP.GRENADE_LAUNCHER]=-1,t.ps.ammo[WP.ROCKET_LAUNCHER]=-1,t.ps.ammo[WP.LIGHTNING]=-1,t.ps.ammo[WP.RAILGUN]=-1,t.ps.ammo[WP.PLASMAGUN]=-1,t.ps.weapon=WP.ROCKET_LAUNCHER,e.health=t.ps.stats[STAT.HEALTH]=t.ps.stats[STAT.MAX_HEALTH],t.ps.stats[STAT.ARMOR]=t.ps.stats[STAT.MAX_HEALTH]):(t.ps.stats[STAT.WEAPONS]=1<<WP.GAUNTLET,t.ps.stats[STAT.WEAPONS]|=1<<WP.MACHINEGUN,t.ps.ammo[WP.GAUNTLET]=-1,g_gametype()===GT.TEAM?t.ps.ammo[WP.MACHINEGUN]=50:t.ps.ammo[WP.MACHINEGUN]=100,t.ps.weapon=WP.MACHINEGUN,e.health=t.ps.stats[STAT.HEALTH]=t.ps.stats[STAT.MAX_HEALTH]+25),t.ps.weaponState=WS.READY,SetOrigin(e,r),vec3.set(r,t.ps.origin),SetClientViewAngle(e,i),sv.GetUserCmd(t.ps.clientNum,e.client.pers.cmd),t.ps.pm_flags|=PMF.RESPAWNED,t.ps.pm_flags|=PMF.TIME_KNOCKBACK,t.ps.pm_time=100,t.respawnTime=level.time,t.inactivityTime=level.time+g_inactivity()*1e3,t.ps.torsoAnim=ANIM.TORSO_STAND,t.ps.legsAnim=ANIM.LEGS_IDLE;if(!level.intermissiontime){if(e.client.sess.spectatorState===SPECTATOR.NOT){KillBox(e),UseTargets(s,e);if(g_gametype()!==GT.CLANARENA)for(var l=WP.NUM_WEAPONS-1;l>0;l--)if(t.ps.stats[STAT.WEAPONS]&1<<l){t.ps.weapon=l;break}vec3.set(e.client.ps.origin,e.currentOrigin);var v=TempEntity(e.client.ps.origin,EV.PLAYER_TELEPORT_IN);v.s.clientNum=e.s.clientNum,sv.LinkEntity(e)}}else MoveClientToIntermission(e);t.ps.commandTime=level.time-100,t.pers.cmd.serverTime=level.time,ClientThink(t.ps.clientNum),ClientEndFrame(e),bg.PlayerStateToEntityState(t.ps,e.s)}function ClientRespawn(e){CopyToBodyQueue(e),ClientSpawn(e)}function ClientDisconnect(e){var t=level.gentities[e];if(!t.client||t.client.pers.connected==CON.DISCONNECTED)return;log("ClientDisconnect: "+e),sv.UnlinkEntity(t),t.s.modelIndex=0,t.classname="disconnected",t.client.pers.connected=CON.DISCONNECTED,t.client.ps.persistant[PERS.TEAM]=TEAM.FREE,t.client.ps.persistant[PERS.SPECTATOR_STATE]=SPECTATOR.NOT,t.client.sess.sessionTeam=TEAM.FREE,sv.SetConfigstring("player"+e,null),CalculateRanks()}function SetClientViewAngle(e,t){for(var n=0;n<3;n++){var r=QMath.AngleToShort(t[n]);e.client.ps.delta_angles[n]=r-e.client.pers.cmd.angles[n]}vec3.set(t,e.s.angles),vec3.set(e.s.angles,e.client.ps.viewangles)}function SetArena(e,t){var n=e.client,r=e.s.number,i=n.sess.sessionTeam;n.sess.arena=t,g_teamAutoJoin()?n.sess.sessionTeam=PickTeam(n.sess.arena,null):n.sess.sessionTeam=TEAM.SPECTATOR,BroadcastTeamChange(i,n),ClientUserinfoChanged(r),ClientBegin(e.s.number)}function SetTeam(e,t){var n=e.client,r=e.s.number,i,s=SPECTATOR.NOT,o=0;t==="scoreboard"||t==="score"?(i=TEAM.SPECTATOR,s=SPECTATOR.SCOREBOARD):t==="follow1"?(i=TEAM.SPECTATOR,s=SPECTATOR.FOLLOW,o=-1):t==="follow2"?(i=TEAM.SPECTATOR,s=SPECTATOR.FOLLOW,o=-2):t==="spectator"||t==="s"?(i=TEAM.SPECTATOR,s=SPECTATOR.FREE):g_gametype()>=GT.TEAM?(s=SPECTATOR.NOT,t==="red"||t==="r"?i=TEAM.RED:t==="blue"||t==="b"?i=TEAM.BLUE:i=PickTeam(n.sess.arena,r)):i=TEAM.FREE,g_gametype()===GT.TOURNAMENT&&level.numNonSpectatorClients>=2?i=TEAM.SPECTATOR:g_maxGameClients()>0&&level.numNonSpectatorClients>=g_maxGameClients()&&(i=TEAM.SPECTATOR);var u=n.sess.sessionTeam;if(i===u&&i!==TEAM.SPECTATOR)return;n.ps.pm_type===PM.DEAD&&CopyToBodyQueue(e),n.pers.teamState.state=TEAM_STATE.BEGIN,u!==TEAM.SPECTATOR&&(e.flags&=~GFL.GODMODE,n.ps.stats[STAT.HEALTH]=e.health=0,PlayerDie(e,e,e,1e5,MOD.SUICIDE)),i===TEAM.SPECTATOR&&u!==i,n.sess.sessionTeam=i,n.sess.spectatorState=s,n.sess.spectatorClient=o,n.sess.teamLeader=!1;if(i===TEAM.RED||i==TEAM.BLUE){var a=TeamLeader(i);a==-1&&SetTeamLeader(r,i)}(u===TEAM.RED||u===TEAM.BLUE)&&CheckTeamLeader(u),BroadcastTeamChange(u,n),ClientUserinfoChanged(r),ClientBegin(r)}function GetClientPlayerstate(e){var t=level.clients[e];return t.ps}function SelectSpawnPoint_compare(e,t){return e.dist>t.dist?-1:e.dist<t.dist?1:0}function SelectSpawnPoint(e,t,n,r){var i=FindEntity({classname:"info_player_deathmatch"}),s=[],o;for(var u=0;u<i.length;u++){o=i[u];if(SpotWouldTelefrag(o))continue;if(o.flags&GFL.NO_HUMANS)continue;if(g_gametype()===GT.CLANARENA&&o.arena!==r)continue;var a=vec3.subtract(o.s.origin,e,vec3.create()),f=vec3.length(a);s.push({dist:f,spot:o})}if(!s.length)o=i[0],o||error("Couldn't find a spawn point");else{s.sort(SelectSpawnPoint_compare);var l=QMath.irrandom(0,Math.floor(s.length/2));o=s[l].spot}return vec3.set(o.s.origin,t),t[2]+=9,vec3.set(o.s.angles,n),o}function SpotWouldTelefrag(e){var t=vec3.add(e.s.origin,playerMins,vec3.create()),n=vec3.add(e.s.origin,playerMaxs,vec3.create()),r=sv.FindEntitiesInBox(t,n);for(var i=0;i<r.length;i++){var s=level.gentities[r[i]];if(s.client)return!0}return!1}function SelectSpectatorSpawnPoint(e,t,n){return SelectIntermissionSpawnPoint(e,t,n)}function SelectIntermissionSpawnPoint(e,t,n){var r,i,s=vec3.create(),o=FindEntity({classname:"info_player_intermission"}),u;if(!o.length)u=SelectSpawnPoint(QMath.vec3origin,e,t,n);else{var a;for(a=0;a<o.length;a++){u=o[a];if(g_gametype()===GT.CLANARENA&&u.arena===n)break}a===o.length&&(u=o[0]),vec3.set(u.s.origin,e),vec3.set(u.s.angles,t);if(u.target){var i=PickTarget(u.target);if(i){var s=vec3.subtract(i.s.origin,e,vec3.create());QMath.VectorToAngles(s,t)}}}return u}function InitBodyQueue(){level.bodyQueueIndex=0;for(var e=0;e<BODY_QUEUE_SIZE;e++){var t=SpawnEntity();t.classname="bodyqueue",t.neverFree=!0,level.bodyQueue[e]=t}}function CopyToBodyQueue(e){sv.UnlinkEntity(e);var t=sv.PointContents(e.s.origin,-1);if(t&CONTENTS.NODROP)return;var n=level.bodyQueue[level.bodyQueueIndex];level.bodyQueueIndex=(level.bodyQueueIndex+1)%BODY_QUEUE_SIZE;var r=n.s.number;e.s.clone(n.s),n.s.eFlags=EF.DEAD,n.s.powerups=0,n.s.loopSound=0,n.s.number=r,n.timestamp=level.time,n.physicsObject=!0,n.physicsBounce=0,n.s.groundEntityNum===ENTITYNUM_NONE?(n.s.pos.trType=TR.GRAVITY,n.s.pos.trTime=level.time,vec3.set(e.client.ps.velocity,n.s.pos.trDelta)):n.s.pos.trType=TR.STATIONARY,n.s.event=0;switch(n.s.legsAnim&~ANIM_TOGGLEBIT){case ANIM.BOTH_DEATH1:case ANIM.BOTH_DEAD1:n.s.torsoAnim=n.s.legsAnim=ANIM.BOTH_DEAD1;break;case ANIM.BOTH_DEATH2:case ANIM.BOTH_DEAD2:n.s.torsoAnim=n.s.legsAnim=ANIM.BOTH_DEAD2;break;case ANIM.BOTH_DEATH3:case ANIM.BOTH_DEAD3:default:n.s.torsoAnim=n.s.legsAnim=ANIM.BOTH_DEAD3}n.svFlags=e.svFlags,vec3.set(e.mins,n.mins),vec3.set(e.maxs,n.maxs),vec3.set(e.absmin,n.absmin),vec3.set(e.absmax,n.absmax),n.clipmask=CONTENTS.SOLID|CONTENTS.PLAYERCLIP,n.contents=CONTENTS.CORPSE,n.ownerNum=e.s.number,n.nextthink=level.time+5e3,n.think=BodySink,n.die=BodyDie,e.health<=GIB_HEALTH?n.takeDamage=!1:n.takeDamage=!0,vec3.set(n.s.pos.trBase,n.currentOrigin),sv.LinkEntity(n)}function BodySink(e){if(level.time-e.timestamp>6500){sv.UnlinkEntity(e),e.physicsObject=!1;return}e.nextthink=level.time+100,e.s.pos.trBase[2]-=1}function BodyDie(e,t,n,r,i){if(e.health>GIB_HEALTH)return;GibEntity(e,0)}function ClientCommand(e,t){var n=level.gentities[e];if(!n.client||n.client.pers.connected!==CON.CONNECTED)return;var r=t.type,i=t.data;if(r==="say"){ClientCmdSay(n,SAY.ALL,i[0]);return}if(r==="score"){ClientCmdScore(n);return}r==="noclip"?ClientCmdNoclip(n):r==="team"&&ClientCmdTeam(n,i[0])}function ClientCmdSay(e,t,n){Say(e,null,t,n)}function Say(e,t,n,r){g_gametype()<GT.TEAM&&n===SAY.TEAM&&(n=SAY.ALL);var i;switch(n){case SAY.ALL:i=e.client.pers.netname}r=r.substr(0,MAX_SAY_TEXT);for(var s=0;s<level.maxclients;s++){var o=level.gentities[s];SayTo(e,o,n,i,r)}}function SayTo(e,t,n,r,i){if(!t)return;if(!t.inuse)return;if(!t.client)return;if(t.client.pers.connected!==CON.CONNECTED)return;if(n===SAY.TEAM&&!OnSameTeam(e,t))return;if(g_gametype()===GT.TOURNAMENT&&t.client.sess.sessionTeam===TEAM.FREE&&e.client.sess.sessionTeam!==TEAM.FREE)return;sv.SendServerCommand(t.s.number,n===SAY.TEAM?"tchat":"chat",{name:r,text:i})}function ClientCmdScore(e){DeathmatchScoreboardMessage(e)}function DeathmatchScoreboardMessage(e){var t=level.numConnectedClients,n={red:level.teamScores[TEAM.RED],blue:level.teamScores[TEAM.BLUE],scores:[]};for(var r=0;r<t;r++){var i=level.sortedClients[r],s=level.clients[i],o=-1;s.pers.connected!==CON.CONNECTING&&(o=s.ps.ping<999?s.ps.ping:999);var u=0;s.accuracy_shots&&(u=s.accuracy_hits*100/s.accuracy_shots);var a=s.ps.persistant[PERS.RANK]===0&&s.ps.persistant[PERS.KILLED]===0?1:0;n.scores.push({clientNum:i,score:s.ps.persistant[PERS.SCORE],ping:o,time:(level.time-s.pers.enterTime)/6e4,powerups:level.gentities[level.sortedClients[r]].s.powerups,accuracy:u,impressive:s.ps.persistant[PERS.IMPRESSIVE_COUNT],excellent:s.ps.persistant[PERS.EXCELLENT_COUNT],gauntlet:s.ps.persistant[PERS.GAUNTLET_FRAG_COUNT],defend:s.ps.persistant[PERS.DEFEND_COUNT],assist:s.ps.persistant[PERS.ASSIST_COUNT],perfect:a,captures:s.ps.persistant[PERS.CAPTURES]})}sv.SendServerCommand(e.s.number,"scores",n)}function ClientCmdNoclip(e){e.client.noclip=!e.client.noclip;var t="noclip ON";e.client.noclip||(t="noclip OFF"),sv.SendServerCommand(e.s.number,"print",t)}function ClientCmdTeam(e,t){if(!t){var n=e.client.sess.sessionTeam;switch(n){case TEAM.BLUE:sv.SendServerCommand(e.s.number,"print","Blue team");break;case TEAM.RED:sv.SendServerCommand(e.s.number,"print","Red team");break;case TEAM.FREE:sv.SendServerCommand(e.s.number,"print","Free team");break;case TEAM.SPECTATOR:sv.SendServerCommand(e.s.number,"print","Spectator team")}return}if(e.client.switchTeamTime>level.time){sv.SendServerCommand(e.s.number,"print","May not switch teams more than once per 5 seconds.");return}g_gametype()===GT.TOURNAMENT&&e.client.sess.sessionTeam===TEAM.FREE&&e.client.sess.losses++,SetTeam(e,t),e.client.switchTeamTime=level.time+5e3}function Damage(e,t,n,r,i,s,o,u){if(!e.takeDamage)return;if(level.intermissionQueued)return;t||(t=level.gentities[ENTITYNUM_WORLD]),n||(n=level.gentities[ENTITYNUM_WORLD]);if(e.s.eType===ET.MOVER){e.use&&e.moverState==MOVER.POS1&&e.use(e,t,n);return}var a=e.client;if(a&&a.noclip)return;r?vec3.normalize(r):o|=DAMAGE.NO_KNOCKBACK;var f=s;f>200&&(f=200),e.flags&GFL.NO_KNOCKBACK&&(f=0),o&DAMAGE.NO_KNOCKBACK&&(f=0);if(f&&e.client){var l=200,c=vec3.scale(r,g_knockback()*f/l,vec3.create());vec3.add(e.client.ps.velocity,c);if(!e.client.ps.pm_time){var h=f*2;h<50?h=50:h>200&&(h=200),e.client.ps.pm_time=h,e.client.ps.pm_flags|=PMF.TIME_KNOCKBACK}}if(a&&a.ps.powerups[PW.BATTLESUIT]){AddEvent(e,EV.POWERUP_BATTLESUIT,0);if(o&DAMAGE.RADIUS||u===MOD.FALLING)return;s*=.5}n.client&&a&&e!==n&&e.health>0&&e.s.eType!==ET.MISSILE&&e.s.eType!==ET.GENERAL&&(OnSameTeam(e,n)?n.client.ps.persistant[PERS.HITS]--:n.client.ps.persistant[PERS.HITS]++,n.client.ps.persistant[PERS.ATTACKEE_ARMOR]=e.health<<8|a.ps.stats[STAT.ARMOR]),e===n&&(s*=.5),s=Math.ceil(s),g_gametype()===GT.CLANARENA&&e===n&&t.classname==="rocket"&&(s=0);var p=s,d=CheckArmor(e,p,o);p-=d,a&&(n?a.ps.persistant[PERS.ATTACKER]=n.s.number:a.ps.persistant[PERS.ATTACKER]=ENTITYNUM_WORLD,a.damage_armor+=d,a.damage_blood+=p,a.damage_knockback+=f,r?(vec3.set(r,a.damage_from),a.damage_fromWorld=!1):(vec3.set(e.currentOrigin,a.damage_from),a.damage_fromWorld=!0)),e.client&&(e.client.lasthurt_client=n.s.number,e.client.lasthurt_mod=u);if(p){e.health=e.health-p,e.client&&(e.client.ps.stats[STAT.HEALTH]=e.health);if(e.health<=0){a&&(e.flags|=GFL.NO_KNOCKBACK),e.health<-999&&(e.health=-999),e.enemy=n,e.die(e,t,n,p,u);return}e.pain&&e.pain(e,n,p)}}function RadiusDamage(e,t,n,r,i,s,o){var u=vec3.create(),a=vec3.create(),f=vec3.create(),l=!1;i<1&&(i=1);for(var c=0;c<3;c++)a[c]=e[c]-i,f[c]=e[c]+i;var h=sv.FindEntitiesInBox(a,f);for(var p=0;p<h.length;p++){var d=level.gentities[h[p]];if(d===s)continue;if(!d.takeDamage)continue;for(var c=0;c<3;c++)e[c]<d.absmin[c]?u[c]=d.absmin[c]-e[c]:e[c]>d.absmax[c]?u[c]=e[c]-d.absmax[c]:u[c]=0;var v=vec3.length(u);if(v>=i)continue;var m=r*(1-v/i);if(CanDamage(d,e)){LogAccuracyHit(d,n)&&(l=!0);var g=vec3.subtract(d.currentOrigin,e,vec3.create());g[2]+=24,Damage(d,t,n,g,e,m,DAMAGE.RADIUS,o)}}return l}function CanDamage(e,t){var n=vec3.add(e.absmin,e.absmax,vec3.create());vec3.scale(n,.5);var r=vec3.create(n),i=sv.Trace(t,r,QMath.vec3origin,QMath.vec3origin,ENTITYNUM_NONE,MASK.SOLID);return i.fraction===1||i.entityNum===e.s.number?!0:(vec3.set(n,r),r[0]+=15,r[1]+=15,i=sv.Trace(t,r,QMath.vec3origin,QMath.vec3origin,ENTITYNUM_NONE,MASK.SOLID),i.fraction===1?!0:(vec3.set(n,r),r[0]+=15,r[1]-=15,i=sv.Trace(t,r,QMath.vec3origin,QMath.vec3origin,ENTITYNUM_NONE,MASK.SOLID),i.fraction===1?!0:(vec3.set(n,r),r[0]-=15,r[1]+=15,i=sv.Trace(t,r,QMath.vec3origin,QMath.vec3origin,ENTITYNUM_NONE,MASK.SOLID),i.fraction===1?!0:(vec3.set(n,r),r[0]-=15,r[1]-=15,i=sv.Trace(t,r,QMath.vec3origin,QMath.vec3origin,ENTITYNUM_NONE,MASK.SOLID),i.fraction===1?!0:!1))))}function PlayerDie(e,t,n,r,i){if(e.client.ps.pm_type===PM.DEAD)return;if(level.intermissiontime)return;e.client.ps.pm_type=PM.DEAD;var s,o;n&&(s=n.s.number,n.client?o=n.client.pers.netname:o="<non-client>");if(s===undefined||s<0||s>=MAX_CLIENTS)s=ENTITYNUM_WORLD,o="<world>";log("Kill:",s,e.s.number,i,",",o,"killed",e.client.pers.netname);var u=TempEntity(e.currentOrigin,EV.OBITUARY);u.s.eventParm=i,u.s.otherEntityNum=e.s.number,u.s.otherEntityNum2=s,u.svFlags=SVF.BROADCAST,e.enemy=n,e.client.ps.persistant[PERS.KILLED]++,n&&n.client?(n.client.lastkilled_client=e.s.number,n==e||OnSameTeam(e,n)?AddScore(n,e.currentOrigin,-1):(AddScore(n,e.currentOrigin,1),i===MOD.GAUNTLET&&(n.client.ps.persistant[PERS.GAUNTLET_FRAG_COUNT]++,n.client.ps.eFlags&=~(EF.AWARD_IMPRESSIVE|EF.AWARD_EXCELLENT|EF.AWARD_GAUNTLET|EF.AWARD_ASSIST|EF.AWARD_DEFEND|EF.AWARD_CAP),n.client.ps.eFlags|=EF.AWARD_GAUNTLET,n.client.rewardTime=level.time+REWARD_SPRITE_TIME,e.client.ps.persistant[PERS.PLAYEREVENTS]^=PLAYEREVENTS.GAUNTLETREWARD),level.time-n.client.lastKillTime<CARNAGE_REWARD_TIME&&(n.client.ps.persistant[PERS.EXCELLENT_COUNT]++,n.client.ps.eFlags&=~(EF.AWARD_IMPRESSIVE|EF.AWARD_EXCELLENT|EF.AWARD_GAUNTLET|EF.AWARD_ASSIST|EF.AWARD_DEFEND|EF.AWARD_CAP),n.client.ps.eFlags|=EF.AWARD_EXCELLENT,n.client.rewardTime=level.time+REWARD_SPRITE_TIME),n.client.lastKillTime=level.time)):AddScore(e,e.currentOrigin,-1),i===MOD.SUICIDE&&(e.client.ps.powerups[PW.NEUTRALFLAG]?(Team_ReturnFlag(TEAM.FREE),e.client.ps.powerups[PW.NEUTRALFLAG]=0):e.client.ps.powerups[PW.REDFLAG]?(Team_ReturnFlag(TEAM.RED),e.client.ps.powerups[PW.REDFLAG]=0):e.client.ps.powerups[PW.BLUEFLAG]&&(Team_ReturnFlag(TEAM.BLUE),e.client.ps.powerups[PW.BLUEFLAG]=0)),TossClientItems(e),DeathmatchScoreboardMessage(e);for(var a=0;a<level.maxclients;a++){var f=level.clients[a];if(f.pers.connected!==CON.CONNECTED)continue;if(f.sess.sessionTeam!==TEAM.SPECTATOR)continue;f.sess.spectatorClient===e.s.number&&DeathmatchScoreboardMessage(level.gentities[a])}e.takeDamage=!0,e.s.weapon=WP.NONE,e.s.powerups=0,e.contents=CONTENTS.CORPSE,e.s.angles[0]=0,e.s.angles[2]=0,LookAtKiller(e,t,n),vec3.set(e.s.angles,e.client.ps.viewangles),e.s.loopSound=0,e.maxs[2]=-8,e.client.respawnTime=level.time+1700;for(var a=0;a<MAX_POWERUPS;a++)e.client.ps.powerups[a]=0;var l=sv.PointContents(e.currentOrigin,-1);if(e.health<=GIB_HEALTH&&!(l&CONTENTS.NODROP)||i===MOD.SUICIDE)GibEntity(e,s);else{var c;switch(deathAnim){case 0:c=ANIM.BOTH_DEATH1;break;case 1:c=ANIM.BOTH_DEATH2;break;case 2:default:c=ANIM.BOTH_DEATH3}e.health<=GIB_HEALTH&&(e.health=GIB_HEALTH+1),e.client.ps.legsAnim=e.client.ps.legsAnim&ANIM_TOGGLEBIT^ANIM_TOGGLEBIT|c,e.client.ps.torsoAnim=e.client.ps.torsoAnim&ANIM_TOGGLEBIT^ANIM_TOGGLEBIT|c,AddEvent(e,EV.DEATH1+a,s),e.die=BodyDie,deathAnim=(deathAnim+1)%3}sv.LinkEntity(e)}function LookAtKiller(e,t,n){var r=vec3.create();if(n&&n!==e)vec3.subtract(n.s.pos.trBase,e.s.pos.trBase,r);else{if(!t||t===e){e.client.ps.stats[STAT.DEAD_YAW]=e.s.angles[QMath.YAW];return}vec3.subtract(t.s.pos.trBase,e.s.pos.trBase,r)}e.client.ps.stats[STAT.DEAD_YAW]=VecToYaw(r)}function GibEntity(e,t){AddEvent(e,EV.GIB_PLAYER,t),e.takeDamage=!1,e.s.eType=ET.INVISIBLE,e.contents=0}function VecToYaw(e){var t;return e[QMath.YAW]===0&&e[QMath.PITCH]===0?t=0:(e[QMath.PITCH]?t=Math.atan2(e[QMath.YAW],e[QMath.PITCH])*180/Math.PI:e[QMath.YAW]>0?t=90:t=270,t<0&&(t+=360)),t}function LogAccuracyHit(e,t){return e.takeDamage?e===t?!1:e.client?t.client?e.client.ps.stats[STAT.HEALTH]<=0?!1:OnSameTeam(e,t)?!1:!0:!1:!1:!1}function CheckArmor(e,t,n){if(!t)return 0;if(n&DAMAGE.NO_ARMOR)return 0;var r=e.client;if(!r)return 0;var i=r.ps.stats[STAT.ARMOR],s=Math.ceil(t*ARMOR_PROTECTION);return s>=i&&(s=i),s?(r.ps.stats[STAT.ARMOR]-=s,s):0}function AddScore(e,t,n){if(!e.client)return;if(level.warmupTime)return;ScorePlum(e,t,n),e.client.ps.persistant[PERS.SCORE]+=n,g_gametype()===GT.TEAM&&(level.teamScores[e.client.ps.persistant[PERS.TEAM]]+=n),CalculateRanks()}function ScorePlum(e,t,n){var r=TempEntity(t,EV.SCOREPLUM);r.svFlags|=SVF.SINGLECLIENT,r.singleClient=e.s.number,r.s.otherEntityNum=e.s.number,r.s.time=n}function TossClientItems(e){if(g_gametype()===GT.CLANARENA)return;var t=e.s.weapon;if(t===WP.MACHINEGUN||t===WP.GRAPPLING_HOOK)e.client.ps.weaponstate===WS.DROPPING&&(t=e.client.pers.cmd.weapon),e.client.ps.stats[STAT.WEAPONS]&1<<t||(t=WP.NONE);if(t>WP.MACHINEGUN&&t!==WP.GRAPPLING_HOOK&&e.client.ps.ammo[t]){var n=bg.FindItemForWeapon(t);ItemDrop(e,n,0)}if(g_gametype()!==GT.TEAM){var r=45;for(var i=1;i<PW.NUM_POWERUPS;i++)if(e.client.ps.powerups[i]>level.time){var n=bg.FindItemForPowerup(i);if(!n)continue;var s=ItemDrop(e,n,r);s.count=(e.client.ps.powerups[i]-level.time)/1e3,s.count<1&&(s.count=1),r+=45}}}function RegisterCvars(){g_gametype=com.AddCvar("g_gametype",0,CVF.SERVERINFO|CVF.LATCH),g_forcearena=com.AddCvar("g_forcearena",0,CVF.SERVERINFO|CVF.LATCH),g_maxGameClients=com.AddCvar("g_maxGameClients",0,CVF.SERVERINFO|CVF.LATCH|CVF.ARCHIVE),g_fraglimit=com.AddCvar("g_fraglimit",20,CVF.SERVERINFO|CVF.ARCHIVE|CVF.NORESTART),g_timelimit=com.AddCvar("g_timelimit",0,CVF.SERVERINFO|CVF.ARCHIVE|CVF.NORESTART),g_capturelimit=com.AddCvar("g_capturelimit",8,CVF.SERVERINFO|CVF.ARCHIVE|CVF.NORESTART),g_synchronousClients=com.AddCvar("g_synchronousClients",0,CVF.SYSTEMINFO),pmove_fixed=com.AddCvar("pmove_fixed",1,CVF.SYSTEMINFO),pmove_msec=com.AddCvar("pmove_msec",8,CVF.SYSTEMINFO),g_friendlyFire=com.AddCvar("g_friendlyFire",0,CVF.ARCHIVE),g_teamAutoJoin=com.AddCvar("g_teamAutoJoin",1,CVF.ARCHIVE),g_teamForceBalance=com.AddCvar("g_teamForceBalance",0,CVF.ARCHIVE),g_warmup=com.AddCvar("g_warmup",10,CVF.ARCHIVE),g_doWarmup=com.AddCvar("g_doWarmup",1,CVF.ARCHIVE),g_speed=com.AddCvar("g_speed",320),g_gravity=com.AddCvar("g_gravity",800),g_knockback=com.AddCvar("g_knockback",1e3),g_quadfactor=com.AddCvar("g_quadfactor",3),g_weaponRespawn=com.AddCvar("g_weaponrespawn",5),g_weaponTeamRespawn=com.AddCvar("g_weaponTeamRespawn",30),g_forcerespawn=com.AddCvar("g_forcerespawn",20),g_inactivity=com.AddCvar("g_inactivity",0),g_motd=com.AddCvar("g_motd",""),g_blood=com.AddCvar("g_blood",1)}function SpawnEntity(){for(var e=MAX_CLIENTS;e<MAX_GENTITIES;e++){var t=level.gentities[e];if(t.inuse)continue;if(t.freeTime>level.startTime+2e3&&level.time-t.freeTime<1e3)continue;return t.reset(),t.s.number=e,t.inuse=!0,t}error("Game entities is full")}function FreeEntity(e){sv.UnlinkEntity(e);if(e.neverFree)return;e.classname="freed",e.freeTime=level.time,e.inuse=!1}function TempEntity(e,t){var n=SpawnEntity();return n.s.eType=ET.EVENTS+t,n.classname="tempEntity",n.eventTime=level.time,n.freeAfterEvent=!0,SetOrigin(n,e),sv.LinkEntity(n),n}function FindEntity(e){var t=[];for(var n=0;n<level.gentities.length;n++){var r=level.gentities[n];if(!r.inuse)continue;var i=!0;for(var s in e){var o=e[s];if(r[s]!==o){i=!1;break}}i&&t.push(r)}return t}function RunEntity(e){var t=e.nextthink;if(t<=0)return;if(t>level.time)return;e.nextthink=0,e.think||error("null ent.think"),e.think.call(this,e)}function PickTarget(e){if(!e)return log("PickTarget called with NULL targetname"),null;var t=FindEntity({targetName:e});return t.length?t[QMath.irrandom(0,t.length-1)]:(log("PickTarget: target "+e+" not found"),null)}function UseTargets(e,t){if(!e)return;if(!e.target)return;var n=FindEntity({targetName:e.target});for(var r=0;r<n.length;r++){var i=n[r];i==e?log("WARNING: Entity used itself."):i.use&&i.use(i,e,t);if(!e.inuse){log("Entity was removed while using targets.");return}}}function SpawnAllEntitiesFromDefs(){var e=sv.GetEntityDefs();for(var t=0;t<e.length;t++){var n=e[t];SpawnEntityFromDef(n)}}function SpawnEntityFromDef(e){var t=SpawnEntity();level.spawnVars=e;for(var n in e){if(!e.hasOwnProperty(n))continue;ParseField(t,n,e[n])}if(g_gametype()>=GT.TEAM){var r=SpawnInt("notteam",0);if(r){sv.LinkEntity(t),sv.AdjustAreaPortalState(t,!0),FreeEntity(t);return}}else{var i=SpawnInt("notfree",0);if(i){sv.LinkEntity(t),sv.AdjustAreaPortalState(t,!0),FreeEntity(t);return}}var s=SpawnString("gametype",null);if(s!==null&&g_gametype()>=GT.FFA&&g_gametype()<GT.MAX_GAME_TYPE){var o=GametypeNames[g_gametype()];if(s.indexOf(o)===-1){sv.LinkEntity(t),sv.AdjustAreaPortalState(t,!0),FreeEntity(t);return}}for(var u=1;u<bg.ItemList.length;u++){var a=bg.ItemList[u];if(a.classname===t.classname){SpawnItem(t,a);return}}t.spawn=spawnFuncs[t.classname];if(!t.spawn){FreeEntity(t);return}t.spawn.call(this,t)}function ParseField(ent,key,value){var fi=fields[key];if(!fi)return;var out;switch(fi.type){case"vector":value.replace(/([^\s]+)\s+([^\s]+)\s*([^\s]*)/,function(e,t,n,r){out=vec3.createFrom(parseFloat(t),parseFloat(n),r?parseFloat(r):0)});break;case"int":out=parseInt(value,10);break;case"float":out=parseFloat(value);break;case"anglehack":out=vec3.createFrom(0,parseFloat(value),0);break;default:out=value}if(!fi.aliases)ent[key]=out;else for(var i=0;i<fi.aliases.length;i++){var alias=fi.aliases[i];eval("ent."+alias+" = out;")}}function SpawnString(e,t){return typeof level.spawnVars[e]!="undefined"?level.spawnVars[e]:t}function SpawnFloat(e,t){var n=SpawnString(e,t);return parseFloat(n)}function SpawnInt(e,t){var n=SpawnString(e,t);return parseInt(n,10)}function SpawnVector(e,t){var n=vec3.create(),r=SpawnString(e,t);return r.replace(/(.+) (.+) (.+)/,function(e,t,r,i){n[0]=parseFloat(t),n[1]=parseFloat(t),n[2]=parseFloat(t)}),n}function ChainTeams(){var e=0,t=0;for(var n=1;n<MAX_GENTITIES;n++){var r=level.gentities[n];if(!r.inuse)continue;if(!r.team)continue;if(r.flags&GFL.TEAMSLAVE)continue;r.teammaster=r,e++,t++;for(var i=n+1;i<MAX_GENTITIES;i++){var s=level.gentities[i];if(!s.inuse)continue;if(!s.team)continue;if(s.flags&GFL.TEAMSLAVE)continue;r.team===s.team&&(t++,s.teamchain=r.teamchain,r.teamchain=s,s.teammaster=r,s.flags|=GFL.TEAMSLAVE,s.targetname&&(r.targetname=s.targetname,s.targetname=null))}}log(e,"teams with",t,"entities")}function SetOrigin(e,t){vec3.set(t,e.s.pos.trBase),e.s.pos.trType=TR.STATIONARY,e.s.pos.trTime=0,e.s.pos.trDuration=0,e.s.pos.trDelta[0]=e.s.pos.trDelta[1]=e.s.pos.trDelta[2]=0,vec3.set(t,e.currentOrigin)}function SetMovedir(e,t){vec3.equal(e,VEC_UP)?vec3.set(MOVEDIR_UP,t):vec3.equal(e,VEC_DOWN)?vec3.set(MOVEDIR_DOWN,t):QMath.AnglesToVectors(e,t,null,null),e[0]=e[1]=e[2]=0}function KillBox(e){var t=vec3.add(e.client.ps.origin,e.mins,vec3.create()),n=vec3.add(e.client.ps.origin,e.maxs,vec3.create()),r=sv.FindEntitiesInBox(t,n);for(var i=0;i<r.length;i++){var s=level.gentities[r[i]];if(!s.client)continue;Damage(s,e,e,null,null,1e5,DAMAGE.NO_PROTECTION,MOD.TELEFRAG)}}function AddPredictableEvent(e,t,n){if(!e.client)return;bg.AddPredictableEventToPlayerstate(e.client.ps,t,n)}function AddEvent(e,t,n){var r;if(!t){log("AddEvent: zero event added for entity",e.s.number);return}e.client?(r=e.client.ps.externalEvent&EV_EVENT_BITS,r=r+EV_EVENT_BIT1&EV_EVENT_BITS,e.client.ps.externalEvent=t|r,e.client.ps.externalEventParm=n,e.client.ps.externalEventTime=level.time):(r=e.s.event&EV_EVENT_BITS,r=r+EV_EVENT_BIT1&EV_EVENT_BITS,e.s.event=t|r,e.s.eventParm=n),e.eventTime=level.time}function SpawnItem(e,t){e.item=t,e.nextthink=level.time+FRAMETIME*2,e.think=FinishSpawningItem,e.physicsBounce=.5}function RunItem(e){!(e.spawnflags&1)&&e.s.groundEntityNum===ENTITYNUM_NONE&&e.s.pos.trType!==TR.GRAVITY&&(e.s.pos.trType=TR.GRAVITY,e.s.pos.trTime=level.time);if(e.s.pos.trType===TR.STATIONARY){RunEntity(e);return}var t=vec3.create();bg.EvaluateTrajectory(e.s.pos,level.time,t);var n;e.clipmask?n=e.clipmask:n=MASK.PLAYERSOLID&~CONTENTS.BODY;var r=sv.Trace(e.currentOrigin,t,e.mins,e.maxs,e.ownerNum,n);r.startSolid&&(r.fraction=0),vec3.set(r.endPos,e.currentOrigin),sv.LinkEntity(e),RunEntity(e);if(r.fraction===1)return;var i=sv.PointContents(e.currentOrigin,-1);if(i&CONTENTS.NODROP){e.item&&e.item.giType===IT.TEAM?Team_FreeEntity(e):FreeEntity(e);return}BounceItem(e,r)}function BounceItem(e,t){var n=level.previousTime+(level.time-level.previousTime)*t.fraction,r=vec3.create();bg.EvaluateTrajectoryDelta(e.s.pos,n,r);var i=vec3.dot(r,t.plane.normal);vec3.add(vec3.scale(t.plane.normal,-2*i,e.s.pos.trDelta),r),vec3.scale(e.s.pos.trDelta,e.physicsBounce,e.s.pos.trDelta);if(t.plane.normal[2]>0&&e.s.pos.trDelta[2]<40){t.endPos[2]+=1,SetOrigin(e,t.endPos),e.s.groundEntityNum=t.entityNum;return}vec3.add(e.currentOrigin,t.plane.normal),vec3.set(e.currentOrigin,e.s.pos.trBase),e.s.pos.trTime=level.time}function FinishSpawningItem(e){var t=bg.ItemList.indexOf(e.item);vec3.set([-ITEM_RADIUS,-ITEM_RADIUS,-ITEM_RADIUS],e.mins),vec3.set([ITEM_RADIUS,ITEM_RADIUS,ITEM_RADIUS],e.maxs),e.s.eType=ET.ITEM,e.s.modelIndex=t,e.s.modelIndex2=0,e.contents=CONTENTS.TRIGGER,e.touch=ItemTouch;if(e.spawnflags&1)SetOrigin(e,e.s.origin);else{var n=vec3.createFrom(e.s.origin[0],e.s.origin[1],e.s.origin[2]-4096),r=sv.Trace(e.s.origin,n,e.mins,e.maxs,e.s.number,MASK.SOLID);if(r.startSolid){log("FinishSpawningItem:",e.classname,"startsolid at",e.s.origin[0],e.s.origin[1],e.s.origin[2]),FreeEntity(e);return}e.s.groundEntityNum=r.entityNum,SetOrigin(e,r.endPos)}if(e.flags&GFL.TEAMSLAVE||e.targetName){e.s.eFlags|=EF.NODRAW,e.contents=0;return}if(e.item.giType===IT.POWERUP){var i=45+QMath.crandom()*15;e.s.eFlags|=EF.NODRAW,e.contents=0,e.nextthink=level.time+i*1e3,e.think=RespawnItem;return}sv.LinkEntity(e)}function RespawnItem(e){if(e.team){e.teammaster||error("RespawnItem: bad teammaster");var t,n,r=e.teammaster;for(t=0,e=r;e;e=e.teamchain,t++);n=QMath.irrandom(0,t-1);for(t=0,e=r;t<n;e=e.teamchain,t++);}e.contents=CONTENTS.TRIGGER,e.s.eFlags&=~EF.NODRAW,e.svFlags&=~SVF.NOCLIENT,sv.LinkEntity(e);if(e.item.giType===IT.POWERUP){var i;e.speed?i=TempEntity(e.s.pos.trBase,EV.GENERAL_SOUND):i=TempEntity(e.s.pos.trBase,EV.GLOBAL_SOUND),i.svFlags|=SVF.BROADCAST}if(e.item.giType===IT.HOLDABLE){var i;e.speed?i=TempEntity(e.s.pos.trBase,EV.GENERAL_SOUND):i=TempEntity(e.s.pos.trBase,EV.GLOBAL_SOUND),i.svFlags|=SVF.BROADCAST}AddEvent(e,EV.ITEM_RESPAWN,0),e.nextthink=0}function ItemTouch(e,t){if(!t.client)return;if(t.health<1)return;if(!bg.CanItemBeGrabbed(g_gametype(),e.s,t.client.ps))return;var n=!0,r;switch(e.item.giType){case IT.WEAPON:r=PickupWeapon(e,t);break;case IT.AMMO:r=PickupAmmo(e,t);break;case IT.ARMOR:r=PickupArmor(e,t);break;case IT.HEALTH:r=PickupHealth(e,t);break;case IT.POWERUP:r=PickupPowerup(e,t),n=!1;break;case IT.TEAM:r=PickupTeam(e,t);break;case IT.HOLDABLE:r=PickupHoldable(e,t);break;default:return}if(!r)return;n?AddPredictableEvent(t,EV.ITEM_PICKUP,e.s.modelIndex):AddEvent(t,EV.ITEM_PICKUP,e.s.modelIndex);if(e.item.giType===IT.POWERUP||e.item.giType===IT.TEAM){var i;e.speed?(i=TempEntity(e.s.pos.trBase,EV.GLOBAL_ITEM_PICKUP),i.s.eventParm=e.s.modelIndex,i.svFlags|=SVF.SINGLECLIENT,i.singleClient=t.s.number):(i=TempEntity(e.s.pos.trBase,EV.GLOBAL_ITEM_PICKUP),i.s.eventParm=e.s.modelIndex,i.svFlags|=SVF.BROADCAST)}UseTargets(e,t);if(e.wait===-1){e.svFlags|=SVF.NOCLIENT,e.s.eFlags|=EF.NODRAW,e.contents=0,e.unlinkAfterEvent=!0;return}e.wait&&(r=e.wait),e.random&&(r+=Math.random()*e.random,r<1&&(r=1)),e.flags&GFL.DROPPED_ITEM&&(e.freeAfterEvent=!0),e.svFlags|=SVF.NOCLIENT,e.s.eFlags|=EF.NODRAW,e.contents=0,r<=0?(e.nextthink=0,e.think=0):(e.nextthink=level.time+r*1e3,e.think=RespawnItem),sv.LinkEntity(e)}function PickupWeapon(e,t){var n;return e.count<0?n=0:(e.count?n=e.count:n=e.item.quantity,!(e.flags&GFL.DROPPED_ITEM)&&g_gametype()!==GT.TEAM&&(t.client.ps.ammo[e.item.giTag]<n?n-=t.client.ps.ammo[e.item.giTag]:n=1)),t.client.ps.stats[STAT.WEAPONS]|=1<<e.item.giTag,AddAmmo(t,e.item.giTag,n),g_gametype()===GT.TEAM?g_weaponTeamRespawn():g_weaponRespawn()}function PickupAmmo(e,t){var n;return e.count?n=e.count:n=e.item.quantity,AddAmmo(t,e.item.giTag,n),RESPAWN.AMMO}function AddAmmo(e,t,n){e.client.ps.ammo[t]+=n,e.client.ps.ammo[t]>200&&(e.client.ps.ammo[t]=200)}function PickupArmor(e,t){return t.client.ps.stats[STAT.ARMOR]+=e.item.quantity,t.client.ps.stats[STAT.ARMOR]>t.client.ps.stats[STAT.MAX_HEALTH]*2&&(t.client.ps.stats[STAT.ARMOR]=t.client.ps.stats[STAT.MAX_HEALTH]*2),RESPAWN.ARMOR}function PickupHealth(e,t){var n,r;return e.item.quantity!=5&&e.item.quantity!=100?n=t.client.ps.stats[STAT.MAX_HEALTH]:n=t.client.ps.stats[STAT.MAX_HEALTH]*2,e.count?r=e.count:r=e.item.quantity,t.health+=r,t.health>n&&(t.health=n),t.client.ps.stats[STAT.HEALTH]=t.health,e.item.quantity==100?RESPAWN.MEGAHEALTH:RESPAWN.HEALTH}function PickupPowerup(e,t){t.client.ps.powerups[e.item.giTag]||(t.client.ps.powerups[e.item.giTag]=level.time-level.time%1e3);var n;e.count?n=e.count:n=e.item.quantity,t.client.ps.powerups[e.item.giTag]+=n*1e3;for(var r=0;r<MAX_CLIENTS;r++){var i=level.clients[r];if(i===t.client)continue;if(i.pers.connected===CON.DISCONNECTED)continue;if(i.ps.pm_type===PM.DEAD)continue;if(g_gametype()>=GT.TEAM&&t.client.sess.sessionTeam===i.sess.sessionTeam)continue;var s=vec3.subtract(e.s.pos.trBase,i.ps.origin,vec3.create()),o=vec3.normalize(s);if(o>192)continue;var u=vec3.create();QMath.AnglesToVectors(i.ps.viewangles,u,null,null);if(vec3.dot(s,u)<.4)continue;var a=sv.Trace(i.ps.origin,e.s.pos.trBase,null,null,ENTITYNUM_NONE,CONTENTS.SOLID);if(a.fraction!==1)continue;i.ps.persistant[PERS.PLAYEREVENTS]^=PLAYEREVENTS.DENIEDREWARD}return RESPAWN.POWERUP}function PickupHoldable(e,t){return RESPAWN.HOLDABLE}function LaunchItem(e,t,n){var r=SpawnEntity();return r.s.eType=ET.ITEM,r.s.modelIndex=bg.ItemList.indexOf(e),r.s.modelIndex2=1,r.classname=e.classname,r.item=e,vec3.set([-ITEM_RADIUS,-ITEM_RADIUS,-ITEM_RADIUS],r.mins),vec3.set([ITEM_RADIUS,ITEM_RADIUS,ITEM_RADIUS],r.maxs),r.contents=CONTENTS.TRIGGER,r.touch=ItemTouch,SetOrigin(r,t),r.s.pos.trType=TR.GRAVITY,r.s.pos.trTime=level.time,vec3.set(n,r.s.pos.trDelta),r.s.eFlags|=EF.BOUNCE_HALF,g_gametype()!=GT.CTF&&g_gametype()!=GT.NFCTF||e.giType!=IT.TEAM?(r.think=FreeEntity,r.nextthink=level.time+3e4):(r.think=Team_DroppedFlagThink,r.nextthink=level.time+3e4,Team_CheckDroppedItem(r)),r.flags=GFL.DROPPED_ITEM,sv.LinkEntity(r),r}function ItemDrop(e,t,n){var r=vec3.create(),i=vec3.create();return vec3.set(e.s.apos.trBase,i),i[QMath.YAW]+=n,i[QMath.PITCH]=0,QMath.AnglesToVectors(i,r,null,null),vec3.scale(r,150,r),r[2]+=200+QMath.crandom()*50,LaunchItem(t,e.s.pos.trBase,r)}function ItemUse(e,t,n){RespawnItem(e)}function TeleportPlayer(e,t,n){var r=n[0]>999999;if(e.client.sess.spectatorState===SPECTATOR.NOT){var i=TempEntity(e.client.ps.origin,EV.PLAYER_TELEPORT_OUT);i.s.clientNum=e.s.clientNum,i=TempEntity(t,EV.PLAYER_TELEPORT_IN),i.s.clientNum=e.s.clientNum}sv.UnlinkEntity(e),vec3.set(t,e.client.ps.origin),e.client.ps.origin[2]+=1,r||(QMath.AnglesToVectors(n,e.client.ps.velocity,null,null),vec3.scale(e.client.ps.velocity,400),e.client.ps.pm_time=160,e.client.ps.pm_flags|=PMF.TIME_KNOCKBACK,SetClientViewAngle(e,n)),e.client.ps.eFlags^=EF.TELEPORT_BIT,e.client.sess.spectatorState===SPECTATOR.NOT&&KillBox(e),bg.PlayerStateToEntityState(e.client.ps,e.s),vec3.set(e.client.ps.origin,e.currentOrigin),e.client.sess.spectatorState===SPECTATOR.NOT&&sv.LinkEntity(e)}function RunMissile(e){var t=vec3.create();bg.EvaluateTrajectory(e.s.pos,level.time,t);var n=sv.Trace(e.currentOrigin,t,e.mins,e.maxs,e.ownerNum,e.clipmask);n.startSolid||n.allSolid?(n=sv.Trace(e.currentOrigin,e.currentOrigin,e.mins,e.maxs,e.ownerNum,e.clipmask),n.fraction=0):vec3.set(n.endPos,e.currentOrigin),sv.LinkEntity(e);if(n.fraction!==1){if(n.surfaceFlags&SURF.NOIMPACT){FreeEntity(e);return}MissileImpact(e,n);if(e.s.eType!==ET.MISSILE)return}RunEntity(e)}function MissileImpact(e,t){var n=level.gentities[t.entityNum],r=!1;if(!n.takeDamage&&e.s.eFlags&(EF.BOUNCE|EF.BOUNCE_HALF)){BounceMissile(e,t),AddEvent(e,EV.GRENADE_BOUNCE,0);return}if(n.takeDamage&&e.damage){var i=vec3.create();LogAccuracyHit(n,level.gentities[e.ownerNum])&&(level.gentities[e.ownerNum].client.accuracy_hits++,r=!0),bg.EvaluateTrajectoryDelta(e.s.pos,level.time,i),vec3.length(i)===0&&(i[2]=1),Damage(n,e,level.gentities[e.ownerNum],i,e.s.origin,e.damage,0,e.methodOfDeath)}n.takeDamage&&n.client?(AddEvent(e,EV.MISSILE_HIT,QMath.DirToByte(t.plane.normal)),e.s.otherEntityNum=n.s.number):t.surfaceFlags&SURF.METALSTEPS?AddEvent(e,EV.MISSILE_MISS_METAL,QMath.DirToByte(t.plane.normal)):AddEvent(e,EV.MISSILE_MISS,QMath.DirToByte(t.plane.normal)),e.freeAfterEvent=!0,e.s.eType=ET.GENERAL,SetOrigin(e,t.endPos),e.splashDamage&&RadiusDamage(t.endPos,e,e.parent,e.splashDamage,e.splashRadius,n,e.splashMethodOfDeath)&&(r||level.gentities[e.ownerNum].client.accuracy_hits++),sv.LinkEntity(e)}function BounceMissile(e,t){var n=vec3.create(),r,i;i=level.previousTime+(level.time-level.previousTime)*t.fraction,bg.EvaluateTrajectoryDelta(e.s.pos,i,n),r=vec3.dot(n,t.plane.normal),vec3.add(n,vec3.scale(t.plane.normal,-2*r,vec3.create()),e.s.pos.trDelta);if(e.s.eFlags&EF.BOUNCE_HALF){vec3.scale(e.s.pos.trDelta,.65,e.s.pos.trDelta);if(t.plane.normal[2]>.2&&vec3.length(e.s.pos.trDelta)<40){SetOrigin(e,t.endPos),e.s.time=level.time/4;return}}vec3.add(e.currentOrigin,t.plane.normal,e.currentOrigin),vec3.set(e.currentOrigin,e.s.pos.trBase),e.s.pos.trTime=level.time}function ExplodeMissile(e){var t=vec3.create(),n=vec3.createFrom(0,0,1);bg.EvaluateTrajectory(e.s.pos,level.time,t),SetOrigin(e,t),e.s.eType=ET.GENERAL,e.freeAfterEvent=!0,AddEvent(e,EV.MISSILE_MISS,QMath.DirToByte(n)),e.splashDamage&&RadiusDamage(e.currentOrigin,e,e.parent,e.splashDamage,e.splashRadius,e,e.splashMethodOfDeath)&&level.gentities[e.ownerNum].client.accuracy_hits++,sv.LinkEntity(e)}function FireRocket(e,t,n){var r=SpawnEntity();return r.classname="rocket",r.nextthink=level.time+15e3,r.think=ExplodeMissile,r.s.eType=ET.MISSILE,r.svFlags=SVF.USE_CURRENT_ORIGIN,r.s.weapon=WP.ROCKET_LAUNCHER,r.ownerNum=e.s.number,r.parent=e,r.damage=100,r.splashDamage=100,r.splashRadius=120,r.methodOfDeath=MOD.ROCKET,r.splashMethodOfDeath=MOD.ROCKET_SPLASH,r.clipmask=MASK.SHOT,r.s.pos.trType=TR.LINEAR,r.s.pos.trTime=level.time-MISSILE_PRESTEP_TIME,vec3.set(t,r.s.pos.trBase),vec3.normalize(n),vec3.scale(n,900,r.s.pos.trDelta),vec3.set(t,r.currentOrigin),r}function FireGrenade(e,t,n){var r=SpawnEntity();return r.classname="grenade",r.nextthink=level.time+2500,r.think=ExplodeMissile,r.s.eType=ET.MISSILE,r.svFlags=SVF.USE_CURRENT_ORIGIN,r.s.weapon=WP.GRENADE_LAUNCHER,r.s.eFlags=EF.BOUNCE_HALF,r.ownerNum=e.s.number,r.parent=e,r.damage=100,r.splashDamage=100,r.splashRadius=150,r.methodOfDeath=MOD.GRENADE,r.splashMethodOfDeath=MOD.GRENADE_SPLASH,r.clipmask=MASK.SHOT,r.s.pos.trType=TR.GRAVITY,r.s.pos.trTime=level.time-MISSILE_PRESTEP_TIME,vec3.set(t,r.s.pos.trBase),vec3.normalize(n),vec3.scale(n,700,r.s.pos.trDelta),vec3.set(t,r.currentOrigin),r}function FirePlasma(e,t,n){var r=SpawnEntity();return r.classname="plasma",r.nextthink=level.time+1e4,r.think=ExplodeMissile,r.s.eType=ET.MISSILE,r.svFlags=SVF.USE_CURRENT_ORIGIN,r.s.weapon=WP.PLASMAGUN,r.ownerNum=e.s.number,r.parent=e,r.damage=20,r.splashDamage=15,r.splashRadius=20,r.methodOfDeath=MOD.PLASMA,r.splashMethodOfDeath=MOD.PLASMA_SPLASH,r.clipmask=MASK.SHOT,r.s.pos.trType=TR.LINEAR,r.s.pos.trTime=level.time-MISSILE_PRESTEP_TIME,vec3.set(t,r.s.pos.trBase),vec3.normalize(n),vec3.scale(n,2e3,r.s.pos.trDelta),vec3.set(t,r.currentOrigin),r}function FireBFG(e,t,n){var r=SpawnEntity();return r.classname="bfg",r.nextthink=level.time+1e4,r.think=ExplodeMissile,r.s.eType=ET.MISSILE,r.svFlags=SVF.USE_CURRENT_ORIGIN,r.s.weapon=WP.BFG,r.ownerNum=e.s.number,r.parent=e,r.damage=100,r.splashDamage=100,r.splashRadius=120,r.methodOfDeath=MOD.BFG,r.splashMethodOfDeath=MOD.BFG_SPLASH,r.clipmask=MASK.SHOT,r.s.pos.trType=TR.LINEAR,r.s.pos.trTime=level.time-MISSILE_PRESTEP_TIME,vec3.set(t,r.s.pos.trBase),vec3.normalize(n),vec3.scale(n,2e3,r.s.pos.trDelta),vec3.set(t,r.currentOrigin),r}function InitMover(e){e.use=UseBinaryMover,e.reached=ReachedBinaryMover,e.moverState=MOVER.POS1,e.svFlags=SVF.USE_CURRENT_ORIGIN,e.s.eType=ET.MOVER,vec3.set(e.pos1,e.currentOrigin),sv.LinkEntity(e),e.s.pos.trType=TR.STATIONARY,vec3.set(e.pos1,e.s.pos.trBase);var t=vec3.subtract(e.pos2,e.pos1,vec3.create()),n=vec3.length(t);e.speed||(e.speed=100),vec3.scale(t,e.speed,e.s.pos.trDelta),e.s.pos.trDuration=n*1e3/e.speed,e.s.pos.trDuration<=0&&(e.s.pos.trDuration=1)}function RunMover(e){if(e.flags&GFL.TEAMSLAVE)return;(e.s.pos.trType!==TR.STATIONARY||e.s.apos.trType!==TR.STATIONARY)&&RunMoverTeam(e),RunEntity(e)}function RunMoverTeam(e){var t,n,r=vec3.create(),i=vec3.create(),s=vec3.create(),o=vec3.create();for(t=e;t;t=t.teamchain){bg.EvaluateTrajectory(t.s.pos,level.time,s),bg.EvaluateTrajectory(t.s.apos,level.time,o),vec3.subtract(s,t.currentOrigin,r),vec3.subtract(o,t.currentAngles,i),n=MoverPush(t,r,i);if(n)break}if(t){for(t=e;t;t=t.teamchain)t.s.pos.trTime+=level.time-level.previousTime,t.s.apos.trTime+=level.time-level.previousTime,bg.EvaluateTrajectory(t.s.pos,level.time,t.currentOrigin),bg.EvaluateTrajectory(t.s.apos,level.time,t.currentAngles),sv.LinkEntity(t);e.blocked&&e.blocked(e,n);return}for(t=e;t;t=t.teamchain)t.s.pos.trType===TR.LINEAR_STOP&&level.time>=t.s.pos.trTime+t.s.pos.trDuration&&t.reached&&t.reached(t)}function MoverPush(e,t,n){var r=vec3.create(),i=vec3.create(),s=vec3.create(),o=vec3.create();if(e.currentAngles[0]||e.currentAngles[1]||e.currentAngles[2]||n[0]||n[1]||n[2]){var u=QMath.RadiusFromBounds(e.mins,e.maxs);for(var a=0;a<3;a++)r[a]=e.currentOrigin[a]+t[a]-u,i[a]=e.currentOrigin[a]+t[a]+u,s[a]=r[a]-t[a],o[a]=i[a]-t[a]}else{for(var a=0;a<3;a++)r[a]=e.absmin[a]+t[a],i[a]=e.absmax[a]+t[a];vec3.set(e.absmin,s),vec3.set(e.absmax,o);for(a=0;a<3;a++)t[a]>0?o[a]+=t[a]:s[a]+=t[a]}sv.UnlinkEntity(e);var f=sv.FindEntitiesInBox(s,o);vec3.add(e.currentOrigin,t),vec3.add(e.currentAngles,n),sv.LinkEntity(e);for(var a=0;a<f.length;a++){var l=level.gentities[f[a]];if(l.s.eType!==ET.ITEM&&l.s.eType!==ET.PLAYER&&!l.physicsObject)continue;if(l.s.groundEntityNum!==e.s.number){if(l.absmin[0]>=i[0]||l.absmin[1]>=i[1]||l.absmin[2]>=i[2]||l.absmax[0]<=r[0]||l.absmax[1]<=r[1]||l.absmax[2]<=r[2])continue;if(!TestEntityPosition(l))continue}if(TryPushingEntity(l,e,t,n))continue;if(e.s.pos.trType===TR.SINE||e.s.apos.trType===TR.SINE){Damage(l,e,e,null,null,99999,0,MOD.CRUSH);continue}var c=l;return c}return null}function TestEntityPosition(e){var t;e.clipmask?t=e.clipmask:t=MASK.SOLID;var n;return e.client?n=sv.Trace(e.client.ps.origin,e.client.ps.origin,e.mins,e.maxs,e.s.number,t):n=sv.Trace(e.s.pos.trBase,e.s.pos.trBase,e.mins,e.maxs,e.s.number,t),n.startSolid?level.gentities[n.entityNum]:null}function TryPushingEntity(e,t,n,r){return t.s.eFlags&EF.MOVER_STOP&&e.s.groundEntityNum!==t.s.number?!1:!1}function SetMoverState(e,t,n){var r=vec3.create(),i;e.moverState=t,e.s.pos.trTime=n;switch(t){case MOVER.POS1:vec3.set(e.pos1,e.s.pos.trBase),e.s.pos.trType=TR.STATIONARY;break;case MOVER.POS2:vec3.set(e.pos2,e.s.pos.trBase),e.s.pos.trType=TR.STATIONARY;break;case MOVER.ONETOTWO:vec3.set(e.pos1,e.s.pos.trBase),vec3.subtract(e.pos2,e.pos1,r),i=1e3/e.s.pos.trDuration,vec3.scale(r,i,e.s.pos.trDelta),e.s.pos.trType=TR.LINEAR_STOP;break;case MOVER.TWOTOONE:vec3.set(e.pos2,e.s.pos.trBase),vec3.subtract(e.pos1,e.pos2,r),i=1e3/e.s.pos.trDuration,vec3.scale(r,i,e.s.pos.trDelta),e.s.pos.trType=TR.LINEAR_STOP}bg.EvaluateTrajectory(e.s.pos,level.time,e.currentOrigin),sv.LinkEntity(e)}function UseBinaryMover(e,t,n){var r,i;if(e.flags&GFL.TEAMSLAVE){UseBinaryMover(e.teammaster,t,n);return}e.activator=n;if(e.moverState===MOVER.POS1){MatchTeam(e,MOVER.ONETOTWO,level.time+50),e.sound1to2&&AddEvent(e,EV.GENERAL_SOUND,e.sound1to2),e.s.loopSound=e.soundLoop,(e.teammaster===e||!e.teammaster)&&sv.AdjustAreaPortalState(e,!0);return}if(e.moverState===MOVER.POS2){e.nextthink=level.time+e.wait;return}if(e.moverState===MOVER.TWOTOONE){r=e.s.pos.trDuration,i=level.time-e.s.pos.trTime,i>r&&(i=r),MatchTeam(e,MOVER.ONETOTWO,level.time-(r-i)),e.sound1to2&&AddEvent(e,EV.GENERAL_SOUND,e.sound1to2);return}if(e.moverState===MOVER.ONETOTWO){r=e.s.pos.trDuration,i=level.time-e.s.pos.trTime,i>r&&(i=r),MatchTeam(e,MOVER.TWOTOONE,level.time-(r-i)),e.sound2to1&&AddEvent(e,EV.GENERAL_SOUND,e.sound2to1);return}}function ReachedBinaryMover(e){e.s.loopSound=e.soundLoop,e.moverState===MOVER.ONETOTWO?(SetMoverState(e,MOVER.POS2,level.time),e.soundPos2&&AddEvent(e,EV.GENERAL_SOUND,e.soundPos2),e.think=ReturnToPos1,e.nextthink=level.time+e.wait,e.activator||(e.activator=e),UseTargets(e,e.activator)):e.moverState===MOVER.TWOTOONE?(SetMoverState(e,MOVER.POS1,level.time),e.soundPos1&&AddEvent(e,EV.GENERAL_SOUND,e.soundPos1),(e.teammaster===e||!e.teammaster)&&sv.AdjustAreaPortalState(e,!1)):error("ReachedBinaryMover: bad moverState")}function MatchTeam(e,t,n){for(var r=e;r;r=r.teamchain)SetMoverState(r,t,n)}function ReturnToPos1(e){MatchTeam(e,MOVER.TWOTOONE,level.time),e.s.loopSound=e.soundLoop,e.sound2to1&&AddEvent(e,EV.GENERAL_SOUND,e.sound2to1)}function InitSessionData(e,t){var n=e.sess;if(g_gametype()>=GT.TEAM)g_gametype()===GT.CLANARENA&&(n.arena=g_forcearena()),g_teamAutoJoin()?(n.sessionTeam=PickTeam(n.arena,null),BroadcastTeamChange(null,e)):n.sessionTeam=TEAM.SPECTATOR;else{var r=t.team;if(r==="s")n.sessionTeam=TEAM.SPECTATOR;else switch(g_gametype()){default:case GT.FFA:g_maxGameClients()>0&&level.numNonSpectatorClients>=g_maxGameClients()?n.sessionTeam=TEAM.SPECTATOR:n.sessionTeam=TEAM.FREE;break;case GT.TOURNAMENT:level.numNonSpectatorClients>=2?n.sessionTeam=TEAM.SPECTATOR:n.sessionTeam=TEAM.FREE}}n.sessionTeam===TEAM.SPECTATOR?n.spectatorState=SPECTATOR.FREE:n.spectatorState=SPECTATOR.NOT,WriteClientSessionData(e)}function ReadSessionData(e){var t="session"+e.ps.clientNum,n=com.GetCvarVal(t);n=JSON.parse(n),e.sess.arena=n.arena,e.sess.sessionTeam=n.sessionTeam,e.sess.spectatorNum=n.spectatorNum,e.sess.spectatorState=n.spectatorState,e.sess.spectatorClient=n.spectatorClient,e.sess.wins=n.wins,e.sess.losses=n.losses,e.sess.teamLeader=n.teamLeader}function WriteClientSessionData(e){var t="session"+e.ps.clientNum,n=JSON.stringify(e.sess);com.SetCvarVal(t,n)}function InitWorldSession(){var e=parseInt(com.GetCvarVal("session"),10);g_gametype()!==e&&(level.newSession=!0,log("Gametype changed, clearing session data."))}function WriteSessionData(){com.SetCvarVal("session",g_gametype());for(var e=0;e<MAX_CLIENTS;e++)level.clients[e].pers.connected===CON.CONNECTED&&WriteClientSessionData(level.clients[e])}function OtherTeam(e){return e===TEAM.RED?TEAM.BLUE:e===TEAM.BLUE?TEAM.RED:e}function TeamName(e){return e===TEAM.RED?"RED":e===TEAM.BLUE?"BLUE":e===TEAM.SPECTATOR?"SPECTATOR":"FREE"}function Team_InitGame(){teamgame.reset();switch(g_gametype()){case GT.CTF:teamgame.redStatus=-1,teamgame.blueStatus=-1,Team_SetFlagStatus(TEAM.RED,FLAG.ATBASE),Team_SetFlagStatus(TEAM.BLUE,FLAG.ATBASE);break;default:}}function Team_SetFlagStatus(e,t){var n=!1;switch(e){case TEAM.RED:teamgame.redStatus!=t&&(teamgame.redStatus=t,n=!0);break;case TEAM.BLUE:teamgame.blueStatus!=t&&(teamgame.blueStatus=t,n=!0);break;case TEAM.FREE:teamgame.flagStatus!=t&&(teamgame.flagStatus=t,n=!0)}if(n){var r=new Array(4);g_gametype()==GT.CTF?(r[0]=ctfFlagStatusRemap[teamgame.redStatus],r[1]=ctfFlagStatusRemap[teamgame.blueStatus],r[2]=0):(r[0]=oneFlagStatusRemap[teamgame.flagStatus],r[1]=0),sv.SetConfigstring("flagstatus",r)}}function Team_CheckDroppedItem(e){e.item.giTag===PW.REDFLAG?Team_SetFlagStatus(TEAM.RED,FLAG.DROPPED):e.item.giTag===PW.BLUEFLAG?Team_SetFlagStatus(TEAM.BLUE,FLAG.DROPPED):e.item.giTag==PW.NEUTRALFLAG&&Team_SetFlagStatus(TEAM.FREE,FLAG.DROPPED)}function OnSameTeam(e,t){return!e.client||!t.client?!1:g_gametype()<GT.TEAM?!1:e.client.sess.sessionTeam===t.client.sess.sessionTeam?!0:!1}function PickupTeam(e,t){var n=t.client,r;if(e.classname==="team_CTF_redflag")r=TEAM.RED;else{if(e.classname!=="team_CTF_blueflag")return sv.SendServerCommand(t.s.number,"print","Don't know what team the flag is on."),0;r=TEAM.BLUE}return r===n.sess.sessionTeam?Team_TouchOurFlag(e,t,r):Team_TouchEnemyFlag(e,t,r)}function Team_TouchOurFlag(e,t,n){var r=t.client,i;r.sess.sessionTeam==TEAM.RED?i=PW.BLUEFLAG:i=PW.REDFLAG;if(e.flags&GFL.DROPPED_ITEM)return sv.SendServerCommand(null,"print",r.pers.netname+" returned the "+TeamName(n)+" flag!"),AddScore(t,e.currentOrigin,CTF_RECOVERY_BONUS),t.client.pers.teamState.flagrecovery++,t.client.pers.teamState.lastreturnedflag=level.time,Team_ReturnFlagSound(Team_ResetFlag(n),n),0;if(!r.ps.powerups[i])return 0;sv.SendServerCommand(null,"print",r.pers.netname+" captured the "+TeamName(OtherTeam(n))+" flag!"),r.ps.powerups[i]=0,teamgame.last_flag_capture=level.time,teamgame.last_capture_team=n,AddTeamScore(e.s.pos.trBase,t.client.sess.sessionTeam,1),Team_ForceGesture(t.client.sess.sessionTeam),t.client.pers.teamState.captures++,t.client.ps.eFlags&=~(EF.AWARD_IMPRESSIVE|EF.AWARD_EXCELLENT|EF.AWARD_GAUNTLET|EF.AWARD_ASSIST|EF.AWARD_DEFEND|EF.AWARD_CAP),t.client.ps.eFlags|=EF.AWARD_CAP,t.client.rewardTime=level.time+REWARD_SPRITE_TIME,t.client.ps.persistant[PERS.CAPTURES]++,AddScore(t,e.currentOrigin,CTF_CAPTURE_BONUS),Team_CaptureFlagSound(e,n);for(var s=0;s<level.maxclients;s++){var o=level.gentities[s];if(!o.inuse||o==t)continue;o.client.sess.sessionTeam!=r.sess.sessionTeam?o.client.pers.teamState.lasthurtcarrier=-5:o.client.sess.sessionTeam==r.sess.sessionTeam&&(o.client.pers.teamState.lastreturnedflag+CTF_RETURN_FLAG_ASSIST_TIMEOUT>level.time&&(AddScore(o,e.currentOrigin,CTF_RETURN_FLAG_ASSIST_BONUS),t.client.pers.teamState.assists++,o.client.ps.persistant[PERS.ASSIST_COUNT]++,o.client.ps.eFlags&=~(EF.AWARD_IMPRESSIVE|EF.AWARD_EXCELLENT|EF.AWARD_GAUNTLET|EF.AWARD_ASSIST|EF.AWARD_DEFEND|EF.AWARD_CAP),o.client.ps.eFlags|=EF.AWARD_ASSIST,o.client.rewardTime=level.time+REWARD_SPRITE_TIME),o.client.pers.teamState.lastfraggedcarrier+CTF_FRAG_CARRIER_ASSIST_TIMEOUT>level.time&&(AddScore(o,e.currentOrigin,CTF_FRAG_CARRIER_ASSIST_BONUS),t.client.pers.teamState.assists++,o.client.ps.persistant[PERS.ASSIST_COUNT]++,o.client.ps.eFlags&=~(EF.AWARD_IMPRESSIVE|EF.AWARD_EXCELLENT|EF.AWARD_GAUNTLET|EF.AWARD_ASSIST|EF.AWARD_DEFEND|EF.AWARD_CAP),o.client.ps.eFlags|=EF.AWARD_ASSIST,o.client.rewardTime=level.time+REWARD_SPRITE_TIME))}return Team_ResetFlags(),CalculateRanks(),0}function Team_TouchEnemyFlag(e,t,n){var r=t.client;return sv.SendServerCommand(null,"print",t.client.pers.netname+" got the "+TeamName(n)+" flag!"),n==TEAM.RED?r.ps.powerups[PW.REDFLAG]=536870911:r.ps.powerups[PW.BLUEFLAG]=536870911,Team_SetFlagStatus(n,FLAG.TAKEN),r.pers.teamState.flagsince=level.time,Team_TakeFlagSound(e,n),-1}function AddTeamScore(e,t,n){var r=TempEntity(e,EV.GLOBAL_TEAM_SOUND);r.svFlags|=SVF.BROADCAST,t===TEAM.RED?level.teamScores[TEAM.RED]+n===level.teamScores[TEAM.BLUE]?r.s.eventParm=GTS.TEAMS_ARE_TIED:level.teamScores[TEAM.RED]<=level.teamScores[TEAM.BLUE]&&level.teamScores[TEAM.RED]+n>level.teamScores[TEAM.BLUE]?r.s.eventParm=GTS.REDTEAM_TOOK_LEAD:r.s.eventParm=GTS.REDTEAM_SCORED:level.teamScores[TEAM.BLUE]+n===level.teamScores[TEAM.RED]?r.s.eventParm=GTS.TEAMS_ARE_TIED:level.teamScores[TEAM.BLUE]<=level.teamScores[TEAM.RED]&&level.teamScores[TEAM.BLUE]+n>level.teamScores[TEAM.RED]?r.s.eventParm=GTS.BLUETEAM_TOOK_LEAD:r.s.eventParm=GTS.BLUETEAM_SCORED,level.teamScores[t]+=n}function Team_ForceGesture(e){var t,n;for(t=0;t<MAX_CLIENTS;t++){n=level.gentities[t];if(!n.inuse)continue;if(!n.client)continue;if(n.client.sess.sessionTeam!=e)continue;n.flags|=GFL.FORCE_GESTURE}}function Team_ResetFlags(){g_gametype()==GT.CTF?(Team_ResetFlag(TEAM.RED),Team_ResetFlag(TEAM.BLUE)):g_gametype()==GT.NFCTF&&Team_ResetFlag(TEAM.FREE)}function Team_ResetFlag(e){var t,n,r;switch(e){case TEAM.RED:t="team_CTF_redflag";break;case TEAM.BLUE:t="team_CTF_blueflag";break;case TEAM.FREE:t="team_CTF_neutralflag";break;default:return null}n=FindEntity({classname:t});for(var i=0;i<n.length;i++)n[i].flags&GFL.DROPPED_ITEM?FreeEntity(n[i]):(r=n[i],RespawnItem(n[i]));return Team_SetFlagStatus(e,FLAG.ATBASE),r}function PickTeam(e,t){var n=new Array(TEAM.NUM_TEAMS);return g_gametype()===GT.CLANARENA&&e===0?TEAM.FREE:(n[TEAM.BLUE]=TeamCount(TEAM.BLUE,t),n[TEAM.RED]=TeamCount(TEAM.RED,t),n[TEAM.BLUE]>n[TEAM.RED]?TEAM.RED:n[TEAM.RED]>n[TEAM.BLUE]?TEAM.BLUE:level.teamScores[TEAM.BLUE]>level.teamScores[TEAM.RED]?TEAM.RED:TEAM.BLUE)}function TeamCount(e,t){var n=0;for(var r=0;r<level.maxclients;r++){if(r===t)continue;var i=level.clients[r];if(i.pers.connected===CON.DISCONNECTED)continue;i.sess.sessionTeam===e&&n++}return n}function TeamAliveCount(e,t){var n=0;for(var r=0;r<level.maxclients;r++){if(r===e)continue;var i=level.clients[r];if(i.pers.connected===CON.DISCONNECTED||i.sess.spectatorState!==SPECTATOR.NOT)continue;i.sess.sessionTeam===t&&n++}return n}function TeamLeader(e){for(var t=0;t<level.maxclients;t++){if(level.clients[t].pers.connected===CON.DISCONNECTED)continue;if(level.clients[t].sess.sessionTeam===e&&level.clients[t].sess.teamLeader)return t}return-1}function CheckTeamLeader(e){var t;for(t=0;t<level.maxclients;t++){var n=level.clients[t];if(n.sess.sessionTeam!==e)continue;if(n.sess.teamLeader)break}if(t>=level.maxclients)for(t=0;t<level.maxclients;t++){var n=level.clients[t];if(n.sess.sessionTeam!==e)continue;level.clients[t].sess.teamLeader=!0;break}}function SetTeamLeader(e,t){var n=level.clients[e];if(n.pers.connected===CON.DISCONNECTED)return;if(n.sess.sessionTeam!==t)return;for(var r=0;r<level.maxclients;r++){if(level.clients[r].sess.sessionTeam!==t)continue;level.clients[r].sess.teamLeader&&(level.clients[r].sess.teamLeader=!1,ClientUserinfoChanged(r))}n.sess.teamLeader=!0,ClientUserinfoChanged(e)}function BroadcastTeamChange(e,t){t.sess.sessionTeam===TEAM.RED?sv.SendServerCommand(null,"cp",t.pers.netname+" joined the red team."):t.sess.sessionTeam===TEAM.BLUE?sv.SendServerCommand(null,"cp",t.pers.netname+" joined the blue team."):t.sess.sessionTeam===TEAM.SPECTATOR&&e!==TEAM.SPECTATOR?sv.SendServerCommand(null,"cp",t.pers.netname+" joined the spectators."):t.sess.sessionTeam===TEAM.FREE&&sv.SendServerCommand(null,"cp",t.pers.netname+" joined the battle.")}function Team_ReturnFlagSound(e,t){if(!e)return;var n=TempEntity(e.s.pos.trBase,EV.GLOBAL_TEAM_SOUND);t==TEAM.BLUE?n.s.eventParm=GTS.RED_RETURN:n.s.eventParm=GTS.BLUE_RETURN,n.svFlags|=SVF.BROADCAST}function Team_TakeFlagSound(e,t){if(!e)return;switch(t){case TEAM.RED:if(teamgame.blueStatus!=FLAG.ATBASE&&teamgame.blueTakenTime>level.time-1e4)return;teamgame.blueTakenTime=level.time;break;case TEAM.BLUE:if(teamgame.redStatus!=FLAG.ATBASE&&teamgame.redTakenTime>level.time-1e4)return;teamgame.redTakenTime=level.time}var n=TempEntity(e.s.pos.trBase,EV.GLOBAL_TEAM_SOUND);t==TEAM.BLUE?n.s.eventParm=GTS.RED_TAKEN:n.s.eventParm=GTS.BLUE_TAKEN,n.svFlags|=SVF.BROADCAST}function Team_CaptureFlagSound(e,t){if(!e)return;var n=TempEntity(e.s.pos.trBase,EV.GLOBAL_TEAM_SOUND);t===TEAM.BLUE?n.s.eventParm=GTS.BLUE_CAPTURE:n.s.eventParm=GTS.RED_CAPTURE,n.svFlags|=SVF.BROADCAST}function Team_ReturnFlag(e){Team_ReturnFlagSound(Team_ResetFlag(e),e),e===TEAM.FREE?sv.SendServerCommand(null,"print","The flag has returned!"):sv.SendServerCommand(null,"print","The "+TeamName(e)+" flag has returned!")}function Team_FreeEntity(e){e.item.giTag===PW.REDFLAG?Team_ReturnFlag(TEAM.RED):e.item.giTag===PW.BLUEFLAG?Team_ReturnFlag(TEAM.BLUE):e.item.giTag===PW.NEUTRALFLAG&&Team_ReturnFlag(TEAM.FREE)}function Team_DroppedFlagThink(e){var t=TEAM.FREE;e.item.giTag===PW.REDFLAG?t=TEAM.RED:e.item.giTag===PW.BLUEFLAG?t=TEAM.BLUE:e.item.giTag===PW.NEUTRALFLAG&&(t=TEAM.FREE),Team_ReturnFlagSound(Team_ResetFlag(t),t)}function SelectCTFSpawnPoint(e,t,n,r,i){var s;t==TEAM_STATE.BEGIN?e==TEAM.RED?s="team_CTF_redplayer":e==TEAM.BLUE&&(s="team_CTF_blueplayer"):e==TEAM.RED?s="team_CTF_redspawn":e==TEAM.BLUE&&(s="team_CTF_bluespawn");if(!s)return SelectSpawnPoint(QMath.vec3origin,n,r,i);var o=FindEntity({classname:s}),u=[],a;for(var f=0;f<o.length;f++){a=o[f];if(SpotWouldTelefrag(a))continue;if(g_gametype()===GT.CLANARENA&&a.arena!==i)continue;u.push(a)}if(!u.length){a=o[0];if(!a)return SelectSpawnPoint(QMath.vec3origin,n,r,i)}else{var l=QMath.irrandom(0,u.length-1);a=u[l]}return vec3.set(a.s.origin,n),n[2]+=9,vec3.set(a.s.angles,r),a}function InitTrigger(e){vec3.equal(e.s.angles,QMath.vec3origin)||SetMovedir(e.s.angles,e.movedir),sv.SetBrushModel(e,e.model),e.contents=CONTENTS.TRIGGER,e.svFlags=SVF.NOCLIENT}function AimAtTarget(e){var t=vec3.add(e.absmin,e.absmax,vec3.create());vec3.scale(t,.5);var n=PickTarget(e.target);if(!n){FreeEntity(e);return}var r=n.s.origin[2]-t[2],i=g_gravity(),s=Math.sqrt(r/(.5*i));if(!s){FreeEntity(e);return}vec3.subtract(n.s.origin,t,e.s.origin2),e.s.origin2[2]=0;var o=vec3.length(e.s.origin2);vec3.normalize(e.s.origin2);var u=o/s;vec3.scale(e.s.origin2,u),e.s.origin2[2]=s*i}function FireWeapon(e){var t=e.client;e.s.weapon!==WP.GRAPPLING_HOOK&&e.s.weapon!==WP.GAUNTLET&&t.accuracy_shots++;switch(e.s.weapon){case WP.GAUNTLET:break;case WP.LIGHTNING:LightningFire(e);break;case WP.SHOTGUN:ShotgunFire(e);break;case WP.MACHINEGUN:g_gametype()!==GT.TEAM?BulletFire(e,MACHINEGUN_SPREAD,MACHINEGUN_DAMAGE,MOD.MACHINEGUN):BulletFire(e,MACHINEGUN_SPREAD,MACHINEGUN_TEAM_DAMAGE,MOD.MACHINEGUN);break;case WP.GRENADE_LAUNCHER:GrenadeLauncherFire(e);break;case WP.ROCKET_LAUNCHER:RocketLauncherFire(e);break;case WP.PLASMAGUN:PlasmagunFire(e);break;case WP.RAILGUN:RailgunFire(e);break;case WP.BFG:BFGFire(e);break;case WP.GRAPPLING_HOOK:break;default:}}function CalcMuzzlePoint(e,t,n){vec3.set(e.s.pos.trBase,n),n[2]+=e.client.ps.viewheight,vec3.add(n,vec3.scale(t,14,vec3.create()))}function QuadFactor(e){var t=e.client;return t.ps.powerups[PW.QUAD]?g_quadfactor():1}function CheckGauntletAttack(e){if(e.client.noclip)return!1;var t=vec3.create(),n=vec3.create();QMath.AnglesToVectors(e.client.ps.viewangles,n,null,null),CalcMuzzlePoint(e,n,t);var r=vec3.add(vec3.scale(n,32,vec3.create()),t),i=sv.Trace(t,r,null,null,e.s.number,MASK.SHOT);if(i.surfaceFlags&SURF.NOIMPACT)return!1;var s=level.gentities[i.entityNum];if(s.takeDamage&&s.client){var o=TempEntity(i.endPos,EV.MISSILE_HIT);o.s.otherEntityNum=s.s.number,o.s.eventParm=QMath.DirToByte(i.plane.normal),o.s.weapon=e.s.weapon}if(!s.takeDamage)return!1;e.client.ps.powerups[PW.QUAD]&&AddEvent(e,EV.POWERUP_QUAD,0);var u=50*QuadFactor(e);return Damage(s,e,e,n,i.endPos,u,0,MOD.GAUNTLET),!0}function BulletFire(e,t,n,r){var i=vec3.create(),s=vec3.create(),o=vec3.create(),u=vec3.create();QMath.AnglesToVectors(e.client.ps.viewangles,s,o,u),CalcMuzzlePoint(e,s,i),n*=QuadFactor(e);var a=Math.random()*Math.PI*2,f=Math.sin(a)*QMath.crandom()*t*16;a=Math.cos(a)*QMath.crandom()*t*16;var l=vec3.add(i,vec3.scale(s,131072,vec3.create()),vec3.create());vec3.add(l,vec3.scale(o,a,vec3.create())),vec3.add(l,vec3.scale(u,f,vec3.create()));var c=e.s.number;for(var h=0;h<10;h++){var p=sv.Trace(i,l,null,null,c,MASK.SHOT);if(p.surfaceFlags&SURF.NOIMPACT)return;var d=level.gentities[p.entityNum],v;d.takeDamage&&d.client?(v=TempEntity(p.endPos,EV.BULLET_HIT_FLESH),v.s.eventParm=d.s.number,LogAccuracyHit(d,e)&&e.client.accuracy_hits++):(v=TempEntity(p.endPos,EV.BULLET_HIT_WALL),v.s.eventParm=QMath.DirToByte(p.plane.normal)),v.s.otherEntityNum=e.s.number,d.takeDamage&&Damage(d,e,e,s,p.endPos,n,0,r);break}}function ShotgunFire(e){var t=vec3.create(),n=vec3.create();QMath.AnglesToVectors(e.client.ps.viewangles,n,null,null),CalcMuzzlePoint(e,n,t);var r=TempEntity(t,EV.SHOTGUN);vec3.scale(n,4096,r.s.origin2),r.s.eventParm=QMath.irrandom(0,255),r.s.otherEntityNum=e.s.number,ShotgunPattern(r.s.pos.trBase,r.s.origin2,r.s.eventParm,e)}function ShotgunPattern(e,t,n,r){var i,s,o=vec3.create(),u=vec3.create(),a=vec3.create(),f=vec3.create(),l=!1;vec3.normalize(t,u),QMath.PerpendicularVector(u,a),vec3.cross(u,a,f);for(var c=0;c<DEFAULT_SHOTGUN_COUNT;c++)i=QMath.crandom()*DEFAULT_SHOTGUN_SPREAD*16,s=QMath.crandom()*DEFAULT_SHOTGUN_SPREAD*16,vec3.add(e,vec3.scale(u,131072,vec3.create()),o),vec3.add(o,vec3.scale(a,i,vec3.create())),vec3.add(o,vec3.scale(f,s,vec3.create())),ShotgunPellet(e,o,r)&&!l&&(l=!0,r.client.accuracy_hits+=1)}function ShotgunPellet(e,t,n){var r=vec3.subtract(t,e,vec3.create());vec3.normalize(r);for(var i=0;i<10;i++){var s=sv.Trace(e,t,null,null,n.s.number,MASK.SHOT),o=level.gentities[s.entityNum];if(s.surfaceFlags&SURF.NOIMPACT)return!1;if(o.takeDamage){var u=DEFAULT_SHOTGUN_DAMAGE*QuadFactor(n);Damage(o,n,n,r,s.endPos,u,0,MOD.SHOTGUN);if(LogAccuracyHit(o,n))return!0}return!1}return!1}function GrenadeLauncherFire(e){var t=vec3.create(),n=vec3.create();QMath.AnglesToVectors(e.client.ps.viewangles,n,null,null),CalcMuzzlePoint(e,n,t),n[2]+=.2,vec3.normalize(n);var r=FireGrenade(e,t,n);r.damage*=QuadFactor(e),r.splashDamage*=QuadFactor(e)}function RocketLauncherFire(e){var t=vec3.create(),n=vec3.create();QMath.AnglesToVectors(e.client.ps.viewangles,n,null,null),CalcMuzzlePoint(e,n,t);var r=FireRocket(e,t,n);r.damage*=QuadFactor(e),r.splashDamage*=QuadFactor(e)}function LightningFire(e){var t=8*QuadFactor(e),n=vec3.create(),r=vec3.create(),i=vec3.create();QMath.AnglesToVectors(e.client.ps.viewangles,i,null,null),CalcMuzzlePoint(e,i,r);for(var s=0;s<10;s++){vec3.add(r,vec3.scale(i,LIGHTNING_RANGE,vec3.create()),n);var o=sv.Trace(r,n,null,null,e.s.number,MASK.SHOT);if(o.entityNum===ENTITYNUM_NONE)return;var u=level.gentities[o.entityNum];u.takeDamage&&Damage(u,e,e,i,o.endPos,t,0,MOD.LIGHTNING);var a;u.takeDamage&&u.client?(a=TempEntity(o.endPos,EV.MISSILE_HIT),a.s.otherEntityNum=u.s.number,a.s.eventParm=QMath.DirToByte(o.plane.normal),a.s.weapon=e.s.weapon,LogAccuracyHit(u,e)&&e.client.accuracy_hits++):o.surfaceFlags&SURF.NOIMPACT||(a=TempEntity(o.endPos,EV.MISSILE_MISS),a.s.eventParm=QMath.DirToByte(o.plane.normal),a.s.weapon=e.s.weapon);break}}function PlasmagunFire(e){var t=vec3.create(),n=vec3.create();QMath.AnglesToVectors(e.client.ps.viewangles,n,null,null),CalcMuzzlePoint(e,n,t);var r=FirePlasma(e,t,n);r.damage*=QuadFactor(e),r.splashDamage*=QuadFactor(e)}function RailgunFire(e){var t=100*QuadFactor(e),n=e.s.number,r=[],i=vec3.create(),s=0,o,u=vec3.create(),a=vec3.create(),f=vec3.create(),l=vec3.create();QMath.AnglesToVectors(e.client.ps.viewangles,a,f,l),CalcMuzzlePoint(e,a,u),vec3.add(u,vec3.scale(a,8192,vec3.create()),i);while(r.length<MAX_RAIL_HITS){o=sv.Trace(u,i,null,null,n,MASK.SHOT);if(o.entityNum>=ENTITYNUM_MAX_NORMAL)break;var c=level.gentities[o.entityNum];c.takeDamage&&(LogAccuracyHit(c,e)&&s++,Damage(c,e,e,a,o.endPos,t,0,MOD.RAILGUN));if(o.contents&CONTENTS.SOLID)break;sv.UnlinkEntity(c),r.push(c)}for(var h=0;h<r.length;h++)sv.LinkEntity(r[h]);var p=TempEntity(o.endPos,EV.RAILTRAIL);p.s.clientNum=e.s.clientNum,vec3.set(u,p.s.origin2),vec3.add(p.s.origin2,vec3.scale(f,4,vec3.create())),vec3.add(p.s.origin2,vec3.scale(l,-1,vec3.create())),o.surfaceFlags&SURF.NOIMPACT?p.s.eventParm=255:p.s.eventParm=QMath.DirToByte(o.plane.normal),p.s.clientNum=e.s.clientNum,s===0?e.client.accurateCount=0:(e.client.accurateCount+=s,e.client.accurateCount>=2&&(e.client.accurateCount-=2,e.client.ps.persistant[PERS.IMPRESSIVE_COUNT]++,e.client.ps.eFlags&=~(EF.AWARD_IMPRESSIVE|EF.AWARD_EXCELLENT|EF.AWARD_GAUNTLET|EF.AWARD_ASSIST|EF.AWARD_DEFEND|EF.AWARD_CAP),e.client.ps.eFlags|=EF.AWARD_IMPRESSIVE,e.client.rewardTime=level.time+REWARD_SPRITE_TIME),e.client.accuracy_hits++)}function BFGFire(e){var t=vec3.create(),n=vec3.create();QMath.AnglesToVectors(e.client.ps.viewangles,n,null,null),CalcMuzzlePoint(e,n,t);var r=FireBFG(e,t,n);r.damage*=QuadFactor(e),r.splashDamage*=QuadFactor(e)}function ButtonTouch(e,t,n){if(!t.client)return;e.moverState===MOVER.POS1&&UseBinaryMover(e,t,t)}function DoorBlocked(e,t){if(!t.client){TempEntity(t.s.origin,EV.ITEM_POP),FreeEntity(t);return}e.damage&&Damage(t,e,e,null,null,e.damage,0,MOD.CRUSH);if(e.spawnflags&4)return;UseBinaryMover(e,e,t)}function DoorSpawnNewTrigger(e){for(var t=e;t;t=t.teamchain)t.takeDamage=!0;var n=vec3.create(e.absmin),r=vec3.create(e.absmax);for(var t=e.teamchain;t;t=t.teamchain)QMath.AddPointToBounds(t.absmin,n,r),QMath.AddPointToBounds(t.absmax,n,r);var i=0;for(var s=1;s<3;s++)r[s]-n[s]<r[i]-n[i]&&(i=s);r[i]+=120,n[i]-=120;var t=SpawnEntity();t.classname="door_trigger",vec3.set(n,t.mins),vec3.set(r,t.maxs),t.parent=e,t.contents=CONTENTS.TRIGGER,t.touch=DoorTriggerTouch,t.count=i,sv.LinkEntity(t),MatchTeam(e,e.moverState,level.time)}function DoorMatchTeam(e){MatchTeam(e,e.moverState,level.time)}function DoorTriggerTouch(e,t,n){t.client&&t.client.sess.spectatorState!==SPECTATOR.NOT?e.parent.moverState!==MOVER.ONETOTWO&&e.parent.moverState!==MOVER.POS2&&DoorTriggerTouchSpectator(e,t,n):e.parent.moverState!==MOVER.ONETOTWO&&UseBinaryMover(e.parent,e,t)}function DoorTriggerTouchSpectator(e,t,n){var r=e.count,i=e.absmin[r]+100,s=e.absmax[r]-100,o=vec3.create(t.client.ps.origin);if(o[r]<i||o[r]>s)return;Math.abs(o[r]-s)<Math.abs(o[r]-i)?o[r]=i-10:o[r]=s+10,TeleportPlayer(t,o,vec3.createFrom(1e7,0,0))}function TrainSetupTargets(e){var t=FindEntity({targetName:e.target});if(!t.length){log("func_train at",e.absmin,"with an unfound target");return}e.nextTrain=t[0];var n;for(var r=e.nextTrain;r!==n;r=i){n||(n=r);if(!r.target){log("Train corner at",r.s.origin,"without a target");return}t=FindEntity({targetName:r.target});var i;for(var s=0;s<t.length;s++){i=t[s++];if(i.classname==="path_corner")break}r.nextTrain=i}TrainReached(e)}function TrainReached(e){var t=e.nextTrain;if(!t||!t.nextTrain)return;UseTargets(t,null),e.nextTrain=t.nextTrain,vec3.set(t.s.origin,e.pos1),vec3.set(t.nextTrain.s.origin,e.pos2);var n=t.speed?t.speed:e.speed;n<1&&(n=1);var r=vec3.subtract(e.pos2,e.pos1,vec3.create()),i=vec3.length(r);e.s.pos.trDuration=i*1e3/n,e.svFlags&=~SVF.NOCLIENT,e.s.pos.trDuration<1&&(e.s.pos.trDuration=1,e.svFlags|=SVF.NOCLIENT),e.s.loopSound=t.soundLoop,SetMoverState(e,MOVER.ONETOTWO,level.time),t.wait&&(e.nextthink=level.time+t.wait*1e3,e.think=TrainBeginMoving,e.s.pos.trType=TR.STATIONARY)}function TrainBeginMoving(e){e.s.pos.trTime=level.time,e.s.pos.trType=TR.LINEAR_STOP}function PortalLocateCamera(e){var t=PickTarget(e.target);if(!t){log("Couldn't find target for misc_partal_surface"),FreeEntity(e);return}e.ownerNum=t.s.number,t.spawnflags&1?e.s.frame=25:t.spawnflags&2&&(e.s.frame=75),t.spawnflags&4?e.s.powerups=0:e.s.powerups=1,e.s.clientNum=t.s.clientNum,vec3.set(t.s.origin,e.s.origin2);var n=vec3.create(),r=PickTarget(t.target);r?(vec3.subtract(r.s.origin,t.s.origin,n),vec3.normalize(n)):SetMovedir(t.s.angles,n),e.s.eventParm=QMath.DirToByte(n)}function PushUse(e,t,n){if(!n.client)return;if(n.client.ps.pm_type!==PM.NORMAL)return;if(n.client.ps.powerups[PW.FLIGHT])return;vec3.set(e.s.origin2,n.client.ps.velocity)}function TeleporterUse(e,t,n){if(!n.client)return;var r=PickTarget(e.target);if(!r){log("Couldn't find teleporter destination");return}TeleportPlayer(n,r.s.origin,r.s.angles)}function HurtTouch(e,t){if(!t.takeDamage)return;if(e.timestamp>level.time)return;e.spawnflags&16?e.timestamp=level.time+1e3:e.timestamp=level.time+FRAMETIME,!(e.spawnflags&4);var n=0;e.spawnflags&8&&(n=DAMAGE.NO_PROTECTION),Damage(t,e,e,null,null,e.damage,n,MOD.TRIGGER_HURT)}function HurtUse(e,t,n){e.linked?sv.UnlinkEntity(e):sv.LinkEntity(e)}function MultiTouch(e,t,n){if(!t.client)return;MultiTrigger(e,t)}function MultiUse(e,t,n){MultiTrigger(e,n)}function MultiTrigger(e,t){e.activator=t;if(e.nextthink)return;if(t.client){if(e.spawnflags&1&&t.client.sess.sessionTeam!==TEAM.RED)return;if(e.spawnflags&2&&t.client.sess.sessionTeam!==TEAM.BLUE)return}UseTargets(e,e.activator),e.wait>0?(e.think=MultiWait,e.nextthink=level.time+(e.wait+e.random*QMath.crandom())*1e3):(e.touch=0,e.nextthink=level.time+FRAMETIME,e.think=FreeEntity)}function MultiWait(e){e.nextthink=0}function PushTouch(e,t){if(!t.client)return;bg.TouchJumpPad(t.client.ps,e.s)}function TeleportTouch(e,t){if(!t.client)return;if(t.client.ps.pm_type===PM.DEAD)return;if(g_gametype()===GT.CLANARENA&&e.arena!==0){SetArena(t,e.arena);return}var n=PickTarget(e.target);if(!n){log("Couldn't find teleporter destination"),FreeEntity(e);return}TeleportPlayer(t,n.s.origin,n.s.angles)}var sys=imp.sys,com=imp.com,sv=imp.sv,bg=BG.CreateInstance(BGExports()),MAX_CLIENTS=QShared.MAX_CLIENTS,MAX_GENTITIES=QShared.MAX_GENTITIES,MAX_PERSISTANT=QShared.MAX_PERSISTANT,MAX_POWERUPS=QShared.MAX_POWERUPS,MAX_PS_EVENTS=QShared.MAX_PS_EVENTS,ENTITYNUM_NONE=QShared.ENTITYNUM_NONE,ENTITYNUM_WORLD=QShared.ENTITYNUM_WORLD,ENTITYNUM_MAX_NORMAL=QShared.ENTITYNUM_MAX_NORMAL,GIB_HEALTH=bg.GIB_HEALTH,ARMOR_PROTECTION=bg.ARMOR_PROTECTION,RANK_TIED_FLAG=bg.RANK_TIED_FLAG,DEFAULT_SHOTGUN_SPREAD=bg.DEFAULT_SHOTGUN_SPREAD,DEFAULT_SHOTGUN_COUNT=bg.DEFAULT_SHOTGUN_COUNT,LIGHTNING_RANGE=bg.LIGHTNING_RANGE,SCORE_NOT_PRESENT=bg.SCORE_NOT_PRESENT,ANIM_TOGGLEBIT=bg.ANIM_TOGGLEBIT,EV_EVENT_BIT1=bg.EV_EVENT_BIT1,EV_EVENT_BIT2=bg.EV_EVENT_BIT2,EV_EVENT_BITS=bg.EV_EVENT_BITS,EVENT_VALID_MSEC=bg.EVENT_VALID_MSEC,CVF=QShared.CVF,BUTTON=QShared.BUTTON,TR=QShared.TR,SURF=QShared.SURF,CONTENTS=QShared.CONTENTS,FLAG=QShared.FLAG,PM=bg.PM,PMF=bg.PMF,GT=bg.GT,WS=bg.WS,IT=bg.IT,MASK=bg.MASK,STAT=bg.STAT,WP=bg.WP,PW=bg.PW,TEAM=bg.TEAM,SPECTATOR=bg.SPECTATOR,PERS=bg.PERS,PLAYEREVENTS=bg.PLAYEREVENTS,ET=bg.ET,EF=bg.EF,EV=bg.EV,GTS=bg.GTS,ANIM=bg.ANIM,MOD=bg.MOD,GametypeNames=bg.GametypeNames,BODY_QUEUE_SIZE=8,FRAMETIME=100,ITEM_RADIUS=15,CARNAGE_REWARD_TIME=3e3,REWARD_SPRITE_TIME=2e3,INTERMISSION_DELAY_TIME=1e3,SP_INTERMISSION_DELAY_TIME=5e3,DAMAGE={RADIUS:1,NO_ARMOR:2,NO_KNOCKBACK:4,NO_PROTECTION:8},GFL={GODMODE:16,NOTARGET:32,TEAMSLAVE:1024,NO_KNOCKBACK:2048,DROPPED_ITEM:4096,NO_BOTS:8192,NO_HUMANS:16384,FORCE_GESTURE:32768},MOVER={POS1:0,POS2:1,ONETOTWO:2,TWOTOONE:3},CON={DISCONNECTED:0,CONNECTING:1,CONNECTED:2},TEAM_STATE={BEGIN:0,ACTIVE:1},LevelLocals=function(){this.clients=new Array(MAX_CLIENTS),this.gentities=new Array(MAX_GENTITIES),this.gentitySize=0,this.num_entities=0,this.warmupTime=0,this.maxclients=0,this.framenum=0,this.previousTime=0,this.time=0,this.startTime=0,this.teamScores=new Array(TEAM.NUM_TEAMS),this.lastTeamLocationTime=0,this.newSession=!1,this.restarted=!1,this.numConnectedClients=0,this.numNonSpectatorClients=0,this.numPlayingClients=0,this.sortedClients=new Array(MAX_CLIENTS),this.numVotingClients=0,this.numteamVotingClients=new Array(2),this.spawnVars=null,this.matchRestartTime=0,this.intermissionQueued=0,this.intermissiontime=0,this.readyToExit=!1,this.exitTime=0,this.bodyQueue=new Array(BODY_QUEUE_SIZE),this.bodyQueueIndex=0;for(var e=0;e<MAX_CLIENTS;e++)this.clients[e]=new GameClient;for(var e=0;e<MAX_GENTITIES;e++)this.gentities[e]=new GameEntity;for(var e=0;e<TEAM.NUM_TEAMS;e++)this.teamScores[e]=0},GameStatic=function(){this.warmupDisabled=!1},SVF={NOCLIENT:1,BOT:2,BROADCAST:8,PORTAL:32,USE_CURRENT_ORIGIN:64,SINGLECLIENT:128,NOTSINGLECLIENT:256},GameEntity=function(){this.reset()};GameEntity.prototype.reset=function(){this.s=new QShared.EntityState,this.linked=!1,this.svFlags=0,this.singleClient=0,this.bmodel=!1,this.mins=vec3.create(),this.maxs=vec3.create(),this.contents=0,this.absmin=vec3.create(),this.absmax=vec3.create(),this.currentOrigin=vec3.create(),this.currentAngles=vec3.create(),this.client=null,this.ownerNum=ENTITYNUM_NONE,this.parent=null,this.inuse=!1,this.classname="noclass",this.spawnflags=0,this.arena=0,this.freeTime=0,this.eventTime=0,this.freeAfterEvent=!1,this.unlinkAfterEvent=!1,this.neverFree=!1,this.model=null,this.model2=null,this.physicsObject=!1,this.physicsBounce=0,this.clipmask=0,this.moverState=0,this.soundPos1=0,this.sound1to2=0,this.sound2to1=0,this.soundPos2=0,this.soundLoop=0,this.nextTrain=null,this.prevTrain=null,this.pos1=vec3.create(),this.pos2=vec3.create(),this.target=null,this.targetName=null,this.team=null,this.targetShaderName=null,this.targetShaderNewName=null,this.targetEnt=null,this.speed=0,this.wait=0,this.movedir=vec3.create(),this.nextthink=0,this.think=null,this.timestamp=0,this.painDebounceTime=0,this.flyDebounceTime=0,this.health=0,this.takeDamage=!1,this.damage=0,this.splashDamage=0,this.splashRadius=0,this.methodOfDeath=0,this.splashMethodOfDeath=0,this.count=0,this.chain=null,this.enemy=null,this.activator=null,this.teamchain=null,this.teammaster=null,this.watertype=0,this.waterlevel=0,this.noise_index=0,this.wait=0,this.random=0};var GameClient=function(){this.reset()};GameClient.prototype.reset=function(){this.ps=new QShared.PlayerState,this.pers=new ClientPersistant,this.sess=new ClientSession,this.readyToExit=!1,this.noclip=!1,this.lastCmdTime=0,this.oldOrigin=vec3.create(),this.damage_armor=0,this.damage_blood=0,this.damage_knockback=0,this.damage_from=vec3.create(),this.damage_fromWorld=!1,this.impressive_count=0,this.accuracy_shots=0,this.accuracy_hits=0,this.lastkilled_client=0,this.lasthurt_mod=0,this.respawnTime=0,this.inactivityTime=0,this.inactivityWarning=0,this.rewardTime=0,this.lastKillTime=0,this.airOutTime=0,this.switchTeamTime=0};var PlayerTeamState=function(){this.state=TEAM_STATE.BEGIN,this.captures=0,this.basedefense=0,this.carrierdefense=0,this.flagrecovery=0,this.fragcarrier=0,this.assists=0,this.lasthurtcarrier=0,this.lastreturnedflag=0,this.flagsince=0,this.lastfraggedcarrier=0},ClientPersistant=function(){this.connected=0,this.cmd=new QShared.UserCmd,this.localClient=!1,this.initialSpawn=!1,this.predictItemPickup=!1,this.pmoveFixed=!1,this.netname=null,this.maxHealth=0,this.enterTime=0,this.teamState=new PlayerTeamState,this.voteCount=0,this.teamVoteCount=0,this.teamInfo=!1};ClientPersistant.prototype.clone=function(e){return typeof e=="undefined"&&(e=new ClientPersistant),e.connected=this.connected,e.cmd=this.cmd,e.localClient=this.localClient,e.initialSpawn=this.initialSpawn,e.predictItemPickup=this.predictItemPickup,e.pmoveFixed=this.pmoveFixed,e.netname=this.netname,e.maxHealth=this.maxHealth,e.enterTime=this.enterTime,e.teamState=this.teamState,e.voteCount=this.voteCount,e.teamVoteCount=this.teamVoteCount,e.teamInfo=this.teamInfo,e};var ClientSession=function(){this.arena=0,this.sessionTeam=TEAM.FREE,this.spectatorNum=0,this.spectatorState=SPECTATOR.NOT,this.spectatorClient=0,this.wins=0,this.losses=0,this.teamLeader=!1};ClientSession.prototype.clone=function(e){return typeof e=="undefined"&&(e=new ClientSession),e.arena=this.arena,e.sessionTeam=this.sessionTeam,e.spectatorNum=this.spectatorNum,e.spectatorState=this.spectatorState,e.spectatorClient=this.spectatorClient,e.wins=this.wins,e.losses=this.losses,e.teamLeader=this.teamLeader,e};var level,gms,playerMins=vec3.createFrom(-15,-15,-24),playerMaxs=vec3.createFrom(15,15,32),MAX_SAY_TEXT=150,SAY={ALL:0,TEAM:1,TELL:2},deathAnim=0,g_gametype,g_forcearena,g_maxGameClients,g_fraglimit,g_timelimit,g_capturelimit,g_synchronousClients,pmove_fixed,pmove_msec,g_friendlyFire,g_teamAutoJoin,g_teamForceBalance,g_warmup,g_doWarmup,g_speed,g_gravity,g_knockback,g_quadfactor,g_weaponRespawn,g_weaponTeamRespawn,g_forcerespawn,g_inactivity,g_motd,g_blood,spawnFuncs={},fields={angle:{type:"anglehack",aliases:["s.angles"]},angles:{type:"vector",aliases:["s.angles"]},arena:{type:"int"},classname:{},count:{type:"int"},dmg:{type:"int",aliases:["damage"]},health:{type:"int"},message:{},model:{},model2:{},origin:{type:"vector",aliases:["currentOrigin","s.origin","s.pos.trBase"]},random:{type:"float"},spawnflags:{type:"int"},speed:{type:"float"},target:{},targetname:{aliases:["targetName"]},team:{},wait:{type:"float"}},VEC_UP=vec3.createFrom(0,-1,0),MOVEDIR_UP=vec3.createFrom(0,0,1),VEC_DOWN=vec3.createFrom(0,-2,0),MOVEDIR_DOWN=vec3.createFrom(0,0,-1),RESPAWN={ARMOR:25,HEALTH:35,AMMO:40,HOLDABLE:60,MEGAHEALTH:35,POWERUP:120},MISSILE_PRESTEP_TIME=50,CTF_CAPTURE_BONUS=5,CTF_TEAM_BONUS=0,CTF_RECOVERY_BONUS=1,CTF_FLAG_BONUS=0,CTF_FRAG_CARRIER_BONUS=2,CTF_FLAG_RETURN_TIME=4e4,CTF_CARRIER_DANGER_PROTECT_BONUS=2,CTF_CARRIER_PROTECT_BONUS=1,CTF_FLAG_DEFENSE_BONUS=1,CTF_RETURN_FLAG_ASSIST_BONUS=1,CTF_FRAG_CARRIER_ASSIST_BONUS=2,CTF_TARGET_PROTECT_RADIUS=1e3,CTF_ATTACKER_PROTECT_RADIUS=1e3,CTF_CARRIER_DANGER_PROTECT_TIMEOUT=8e3,CTF_FRAG_CARRIER_ASSIST_TIMEOUT=1e4,CTF_RETURN_FLAG_ASSIST_TIMEOUT=1e4,CTF_GRAPPLE_SPEED=750,CTF_GRAPPLE_PULL_SPEED=750,OVERLOAD_ATTACK_BASE_SOUND_TIME=2e4,teamgame_t=function(){this.reset()};teamgame_t.prototype.reset=function(){this.last_flag_capture=0,this.last_capture_team=0,this.redStatus=0,this.blueStatus=0,this.flagStatus=0,this.redTakenTime=0,this.blueTakenTime=0,this.redObeliskAttackedTime=0,this.blueObeliskAttackedTime=0};var teamgame=new teamgame_t,ctfFlagStatusRemap=[0,1,"*","*",2],oneFlagStatusRemap=[0,1,2,3,4],MACHINEGUN_SPREAD=200,MACHINEGUN_DAMAGE=7,MACHINEGUN_TEAM_DAMAGE=5,DEFAULT_SHOTGUN_DAMAGE=10,MAX_RAIL_HITS=4;spawnFuncs.func_bobbing=function(e){var t=SpawnFloat("height",32),n=SpawnFloat("phase",0);e.speed=SpawnFloat("speed",4),e.damage=SpawnInt("dmg",2),sv.SetBrushModel(e,e.model),InitMover(e),vec3.set(e.s.origin,e.s.pos.trBase),vec3.set(e.s.origin,e.currentOrigin),e.s.pos.trDuration=e.speed*1e3,e.s.pos.trTime=e.s.pos.trDuration*n,e.s.pos.trType=TR.SINE,e.spawnflags&1?e.s.pos.trDelta[0]=t:e.spawnflags&2?e.s.pos.trDelta[1]=t:e.s.pos.trDelta[2]=t},spawnFuncs.func_button=function(e){e.speed||(e.speed=40),e.wait||(e.wait=1),e.wait*=1e3,vec3.set(e.s.origin,e.pos1),sv.SetBrushModel(e,e.model);var t=SpawnFloat("lip",4);SetMovedir(e.s.angles,e.movedir);var n=vec3.createFrom(Math.abs(e.movedir[0]),Math.abs(e.movedir[1]),Math.abs(e.movedir[2])),r=vec3.subtract(e.maxs,e.mins,vec3.create()),i=n[0]*r[0]+n[1]*r[1]+n[2]*r[2]-t;vec3.add(e.pos1,vec3.scale(e.movedir,i,vec3.create()),e.pos2),e.health?e.takeDamage=!0:e.touch=ButtonTouch,InitMover(e)},spawnFuncs.func_door=function(e){e.blocked=DoorBlocked,e.speed||(e.speed=400),e.wait||(e.wait=2),e.wait*=1e3;var t=SpawnFloat("lip",8);e.damage=SpawnInt("dmg",2),vec3.set(e.s.origin,e.pos1),sv.SetBrushModel(e,e.model),SetMovedir(e.s.angles,e.movedir);var n=vec3.createFrom(Math.abs(e.movedir[0]),Math.abs(e.movedir[1]),Math.abs(e.movedir[2])),r=vec3.subtract(e.maxs,e.mins,vec3.create()),i=vec3.dot(n,r)-t;vec3.add(e.pos1,vec3.scale(e.movedir,i,vec3.create()),e.pos2);if(e.spawnflags&1){var s=vec3.create(e.pos2);vec3.set(e.s.origin,e.pos2),vec3.set(s,e.pos1)}InitMover(e),e.nextthink=level.time+FRAMETIME;if(!(e.flags&GFL.TEAMSLAVE)){var o=SpawnInt("health",0);o&&(e.takeDamage=!0),e.targetName||o?e.think=DoorMatchTeam:e.think=DoorSpawnNewTrigger}},spawnFuncs.func_static=function(e){sv.SetBrushModel(e,e.model),InitMover(e),vec3.set(e.s.origin,e.s.pos.trBase),vec3.set(e.s.origin,e.currentOrigin)};var TRAIN_START_ON=1,TRAIN_TOGGLE=2,TRAIN_BLOCK_STOPS=4;return spawnFuncs.func_train=function(e){console.log("SPAWANING func_train"),e.s.angles[0]=e.s.angles[1]=e.s.angles[2]=0,e.spawnflags&TRAIN_BLOCK_STOPS?e.damage=0:e.damage||(e.damage=2),e.speed||(e.speed=100);if(!e.target){log("func_train without a target at",e.absmin),FreeEntity(e);return}sv.SetBrushModel(e,e.model),InitMover(e),e.reached=TrainReached,e.nextthink=level.time+FRAMETIME,e.think=TrainSetupTargets},spawnFuncs.info_notnull=function(e){SetOrigin(e,e.s.origin)},spawnFuncs.info_player_deathmatch=function(e){},spawnFuncs.info_player_intermission=function(e){},spawnFuncs.misc_portal_camera=function(e){e.mins[0]=e.mins[1]=e.mins[2]=0,e.maxs[0]=e.maxs[1]=e.maxs[2]=0,sv.LinkEntity(e);var t=SpawnFloat("roll",0);e.s.clientNum=t/360*256},spawnFuncs.misc_portal_surface=function(e){e.mins[0]=e.mins[1]=e.mins[2]=0,e.maxs[0]=e.maxs[1]=e.maxs[2]=0,sv.LinkEntity(e),e.svFlags=SVF.PORTAL,e.s.eType=ET.PORTAL,e.target?(e.think=PortalLocateCamera,e.nextthink=level.time+100):vec3.set(e.s.origin,e.s.origin2)},spawnFuncs.misc_teleporter_dest=function(e){SetOrigin(e,e.s.origin)},spawnFuncs.path_corner=function(e){if(!e.targetname){log("path_corner with no targetname at",e.s.origin),FreeEntity(e);return}},spawnFuncs.target_position=function(e){SetOrigin(e,e.s.origin)},spawnFuncs.target_push=function(e){e.speed||(e.speed=1e3),SetMovedir(e.s.angles,e.s.origin2),vec3.scale(e.s.origin2,e.speed),e.target&&(vec3.set(e.s.origin,e.absmin),vec3.set(e.s.origin,e.absmax),e.think=AimAtTarget,e.nextthink=level.time+FRAMETIME),e.use=PushUse},spawnFuncs.target_teleporter=function(e){e.targetName||log("Untargeted",e.classname,"at",e.s.origin),e.use=TeleporterUse},spawnFuncs.team_CTF_blueplayer=function(e){},spawnFuncs.team_CTF_bluespawn=function(e){},spawnFuncs.team_CTF_redplayer=function(e){},spawnFuncs.team_CTF_redspawn=function(e){},spawnFuncs.trigger_hurt=function(e){InitTrigger(e),e.touch=HurtTouch,e.use=HurtUse,e.damage||(e.damage=5),e.spawnflags&1?sv.UnlinkEntity(e):sv.LinkEntity(e)},spawnFuncs.trigger_multiple=function(e){e.wait=SpawnFloat("wait",.5),e.random=SpawnFloat("random",0),e.random>=e.wait&&e.wait>=0&&(e.random=e.wait-FRAMETIME,log("trigger_multiple has random >= wait")),e.touch=MultiTouch,e.use=MultiUse,InitTrigger(e),sv.LinkEntity(e)},spawnFuncs.trigger_push=function(e){InitTrigger(e),e.svFlags&=~SVF.NOCLIENT,e.s.eType=ET.PUSH_TRIGGER,e.touch=PushTouch,e.think=AimAtTarget,e.nextthink=level.time+FRAMETIME,sv.LinkEntity(e)},spawnFuncs.trigger_teleport=function(e){InitTrigger(e),e.spawnflags&1?e.svFlags|=SVF.NOCLIENT:e.svFlags&=~SVF.NOCLIENT,e.s.eType=ET.TELEPORT_TRIGGER,e.touch=TeleportTouch,sv.LinkEntity(e)},spawnFuncs.worldspawn=function(e){sv.SetConfigstring("levelStartTime",level.startTime);var t=SpawnString("music","");t=t.replace("\\","/").replace(/\.[^\/.]+$/,""),sv.SetConfigstring("music",t);var n=SpawnString("message","");sv.SetConfigstring("message",n),level.gentities[ENTITYNUM_WORLD].s.number=ENTITYNUM_WORLD,level.gentities[ENTITYNUM_WORLD].ownerNum=ENTITYNUM_NONE,level.gentities[ENTITYNUM_WORLD].classname="worldspawn",level.gentities[ENTITYNUM_NONE].s.number=ENTITYNUM_NONE,level.gentities[ENTITYNUM_NONE].ownerNum=ENTITYNUM_NONE,level.gentities[ENTITYNUM_NONE].classname="nothing"},{SVF:SVF,Init:Init,Shutdown:Shutdown,Frame:Frame,ClientConnect:ClientConnect,ClientUserinfoChanged:ClientUserinfoChanged,ClientBegin:ClientBegin,ClientThink:ClientThink,ClientDisconnect:ClientDisconnect,ClientCommand:ClientCommand,GetClientPlayerstate:GetClientPlayerstate}}return{CreateInstance:function(e){return new Game(e)}}}),define("server/sv",["underscore","ByteBuffer","common/qmath","common/qshared","clipmap/cm","game/gm"],function(e,t,n,r,i,s){function o(o){function T(){var e=Array.prototype.slice.call(arguments);e.splice(0,0,"SV:"),Function.apply.call(console.log,console,e)}function N(e,t){T("Initializing"),w=e,E=new v,S||(S=new p),x=!w,yt(),bt(),C(t)}function C(e){if(!x){var t=a.StringToAddr("localhost"),n=a.NetchanSetup(r.NS.SERVER,t,{onmessage:function(e){H(n,e)}});return}u.NetListen(e,{onrequest:Q,onaccept:G})}function k(){var e=vt(),t=1e3/e;return t<1&&(t=1),t}function L(e){if(!A())return;var t=k();E.timeResidual+=e;if(E.restartTime&&E.time>=E.restartTime){E.restartTime=0,a.ExecuteBuffer("map_restart 0");return}a.cvarModifiedFlags&r.CVF.SERVERINFO&&(R("serverInfo",a.GetCvarValues(r.CVF.SERVERINFO)),a.cvarModifiedFlags&=~r.CVF.SERVERINFO),a.cvarModifiedFlags&r.CVF.SYSTEMINFO&&(R("systemInfo",a.GetCvarValues(r.CVF.SYSTEMINFO)),a.cvarModifiedFlags&=~r.CVF.SYSTEMINFO),O();var n=0;while(E.timeResidual>=t)E.timeResidual-=t,S.time+=t,E.time+=t,l.Frame(E.time),n++;M(),n>0&&qt(),P()}function A(){return S.initialized}function O(){for(var e=0;e<dt();e++){var t=S.clients[e];if(t.state!==g.ACTIVE){t.ping=999;continue}if(!t.gentity){t.ping=999;continue}var n=0,r=0;for(var i=0;i<a.PACKET_BACKUP;i++){if(t.frames[i].messageAcked<=0)continue;var s=t.frames[i].messageAcked-t.frames[i].messageSent;n+=s,r++}r?(t.ping=Math.floor(n/r),t.ping>999&&(t.ping=999)):t.ping=999;var o=l.GetClientPlayerstate(e);o.ping=t.ping}}function M(){var e=S.time-1e3*mt(),t=S.time-1e3*gt();for(var n=0;n<dt();n++){var r=S.clients[n];if(r.state===g.FREE)continue;r.lastPacketTime>S.time&&(r.lastPacketTime=S.time);if(r.state===g.ZOMBIE&&r.lastPacketTime<t){T("Going from CS_ZOMBIE to CS_FREE for client",n),r.state=g.FREE;continue}r.state>=g.CONNECTED&&r.lastPacketTime<e&&(et(r,"timed out"),r.state=g.FREE)}}function P(){return;var e,t}function H(e,n){if(!A())return;var r=new t(n,t.LITTLE_ENDIAN);if(n.byteLength>4&&r.view.getInt32(0,!!t.LITTLE_ENDIAN)===-1){B(e,r);return}for(var i=0;i<S.clients.length;i++){var s=S.clients[i];if(s.state===g.FREE)continue;if(s.netchan!==e)continue;a.NetchanProcess(s,r)&&(s.lastPacketTime=S.time,ft(s,r));return}}function B(e,t){t.readInt();var n=t.readCString();n.indexOf("connect")===0&&Y(e,n.substr(8))}function j(e){T("Spawning new server for",e,"at",a.frameTime),S.initialized=!1,xt(),x||(w.MapLoading(),w.ShutdownSubsystems(),w.ShutdownCGame(),w.InitSubsystems()),S.snapFlagServerBit^=r.SNAPFLAG_SERVERCOUNT;var t=E.time;E=new v,a.LoadBsp(e,function(t,n){if(t)return error(t);E.world=n,f.LoadWorld(n),pt(e),E.serverId=E.restartedServerId=a.frameTime,ht(E.serverId),Xt(),E.state=d.LOADING,St();for(var i=0;i<3;i++)l.Frame(E.time),E.time+=100,S.time+=100;I();for(var i=0;i<dt();i++){var s=S.clients[i];if(!s||s.state<g.CONNECTED)continue;s.gentity=null;var o=l.ClientConnect(i,!1);o&&et(s,o),s.state=g.CONNECTED}l.Frame(E.time),E.time+=100,S.time+=100,R("systemInfo",a.GetCvarValues(r.CVF.SYSTEMINFO)),R("serverInfo",a.GetCvarValues(r.CVF.SERVERINFO)),E.state=d.GAME,S.initialized=!0})}function F(){T("KillServer"),xt(),E=new v,S=new p}function I(){for(var e=0;e<r.MAX_GENTITIES;e++){var t=E.svEntities[e],n=Ct(t);if(!n.linked)continue;n.s.clone(E.svEntities[e].baseline)}}function q(e){return E.configstrings[e]}function R(t,n){if(e.isEqual(n,E.configstrings[t]))return;E.configstrings[t]=n;if(E.state===d.GAME||E.restarting)for(var r=0;r<dt();r++){var i=S.clients[r];if(i.state<g.ACTIVE){i.state===g.PRIMED&&(i.csUpdated[t]=!0);continue}U(i,t)}}function U(e,t){X(e,"cs",{k:t,v:E.configstrings[t]})}function z(e){for(var t in E.configstrings){if(!E.configstrings.hasOwnProperty(t))continue;if(!e.csUpdated[t])continue;U(e,t),e.csUpdated[t]=!1}}function W(e){return(e<0||e>=r.MAX_CLIENTS)&&a.Error("GetUserinfo: bad index "+e),S.clients[e].userinfo}function X(e,t,n){if(e!==null){V(e,t,n);return}for(var r=0;r<dt();r++)V(S.clients[r],t,n)}function V(e,t,n){if(e.state<g.PRIMED)return;e.reliableSequence++;var r={type:t,data:n};if(e.reliableSequence-e.reliableAcknowledge===a.MAX_RELIABLE_COMMANDS+1){T("----- pending server commands -----");for(var i=e.reliableAcknowledge+1;i<=e.reliableSequence;i++)T("cmd",i,e.reliableCommands[i%a.MAX_RELIABLE_COMMANDS]);T("cmd",i,r),et(e,"Server command overflow");return}e.reliableCommands[e.reliableSequence%a.MAX_RELIABLE_COMMANDS]=r}function $(){return{sys:sys,com:com}}function J(){return{sys:{ReadFile:u.ReadFile},com:{ERR:a.ERR,Error:a.Error}}}function K(){return{sys:{GetMilliseconds:u.GetMilliseconds,ReadFile:u.ReadFile},com:{ERR:a.ERR,Error:a.Error,ExecuteBuffer:a.ExecuteBuffer,AddCmd:a.AddCmd,AddCvar:a.AddCvar,GetCvarVal:a.GetCvarVal,SetCvarVal:a.SetCvarVal},sv:{LocateGameData:kt,GetUserCmd:Lt,AdjustAreaPortalState:Mt,EntityContact:_t,GetConfigstring:q,SetConfigstring:R,GetUserinfo:W,SendServerCommand:At,SetBrushModel:Ot,GetEntityDefs:$t,LinkEntity:Qt,UnlinkEntity:Gt,FindEntitiesInBox:Yt,Trace:tn,PointContents:sn}}}function Q(e){return!0}function G(e){var t=a.NetchanSetup(r.NS.SERVER,e,{onmessage:function(e){H(t,e)},onclose:function(){tt(t)}})}function Y(e,t){if(!A())return;T("A client is connecting");var n;for(var i=0;i<r.MAX_CLIENTS;i++)if(S.clients[i].state===g.FREE){n=i;break}if(n===undefined){T("Rejected a connection.");return}var s=S.clients[n];s.reset(),s.netchan=e,s.userinfo=JSON.parse(t),l.ClientConnect(n,!0),st(s),T("Going from CS_FREE to CS_CONNECTED for ",n),s.state=g.CONNECTED,s.lastSnapshotTime=S.time,s.lastPacketTime=S.time,a.NetchanPrint(s.netchan,"connectResponse"),s.gamestateMessageNum=-1}function Z(e,t){var n=S.clients.indexOf(e);e.state=g.ACTIVE,T("Going from CS_CONNECTED to CS_ACTIVE for ",n),z(e),e.deltaMessage=-1,e.lastSnapshotTime=0,e.gentity=Tt(n),t?t.clone(e.lastUserCmd):e.lastUserCmd=new r.UserCmd,l.ClientBegin(n)}function et(e,t){if(e.state===g.ZOMBIE)return;var n=ot(e);l.ClientDisconnect(n),e.state=g.ZOMBIE}function tt(e){for(var t=0;t<S.clients.length;t++){var n=S.clients[t];if(n.state===g.FREE)continue;if(n.netchan===e){et(n,"disconnected");return}}}function nt(e,t,n){n?e.deltaMessage=e.messageAcknowledge:e.deltaMessage=-1;var i=t.readByte(t);if(i<1){T("UserMove cmd count < 1");return}var s=[];for(var o=0;o<i;o++){var u=new r.UserCmd;a.ReadDeltaUsercmd(t,null,u),s.push(u)}e.frames[e.messageAcknowledge%a.PACKET_BACKUP].messageAcked=S.time,e.state===g.PRIMED&&Z(e,s[0]);if(e.state!==g.ACTIVE){e.deltaMessage=-1;return}for(var o=0;o<s.length;o++){var u=s[o];if(u.serverTime>s[s.length-1].serverTime)continue;if(u.serverTime<=e.lastUserCmd.serverTime)return;rt(e,u)}}function rt(e,t){var n=ot(e);t.clone(e.lastUserCmd),l.ClientThink(n)}function it(e){e.state=g.PRIMED,e.gamestateMessageNum=e.netchan.outgoingSequence;var n=new t(S.msgBuffer,t.LITTLE_ENDIAN);n.writeInt(e.lastClientCommand),n.writeByte(a.SVM.gamestate),n.writeInt(e.reliableSequence);for(var i in E.configstrings){if(!E.configstrings.hasOwnProperty(i))continue;n.writeByte(a.SVM.configstring),n.writeCString(JSON.stringify({k:i,v:E.configstrings[i]}))}var s=new r.EntityState;for(var o=0;o<r.MAX_GENTITIES;o++){var u=E.svEntities[o].baseline;if(!u.number)continue;n.writeByte(a.SVM.baseline),a.WriteDeltaEntityState(n,s,u,!0)}n.writeByte(a.SVM.EOF),n.writeInt(ot(e)),n.writeByte(a.SVM.EOF),a.NetchanSend(e.netchan,n.buffer,n.index)}function st(e){e.name=e.userinfo.name;var t=20;t<1?t=1:t>vt()&&(t=vt()),t=1e3/t,t!=e.snapshotMsec&&(e.lastSnapshotTime=0,e.snapshotMsec=t)}function ot(e){return S.clients.indexOf(e)}function ut(e,t){e.userinfo=t,st(e);var n=ot(e);l.ClientUserinfoChanged(n)}function at(e){et(e,"disconnected")}function ft(e,t){var n=t.readInt();e.messageAcknowledge=t.readInt();if(e.messageAcknowledge<0)return;e.reliableAcknowledge=t.readInt();if(e.reliableAcknowledge<e.reliableSequence-a.MAX_RELIABLE_COMMANDS){e.reliableAcknowledge=e.reliableSequence;return}if(n!==E.serverId){if(n>=E.restartedServerId&&n<E.serverId)return;e.messageAcknowledge>e.gamestateMessageNum&&it(e);return}e.oldServerTime&&n===ht()&&(e.oldServerTime=0);var r;for(;;){r=t.readUnsignedByte();if(r===a.CLM.EOF)break;if(r!==a.CLM.clientCommand)break;if(!lt(e,t))return;if(e.state===g.ZOMBIE)return}switch(r){case a.CLM.move:nt(e,t,!0);break;case a.CLM.moveNoDelta:nt(e,t,!1)}}function lt(e,t){var n=t.readInt(),r=JSON.parse(t.readCString());return e.lastClientCommand>=n?!0:n>e.lastClientCommand+1?(T("Client",e.name,"lost",n-e.lastClientCommand,"clientCommands"),et(e,"Lost reliable commands"),!1):(e.nextReliableTime=S.time+1e3,ct(e,r),e.lastClientCommand=n,!0)}function ct(e,t){t.type==="userinfo"?ut(e,t.data):t.type==="disconnect"&&at(e);if(E.state===d.GAME&&(e.state===g.ACTIVE||e.state===g.PRIMED)){var n=ot(e);l.ClientCommand(n,t)}}function yt(){ht=a.AddCvar("sv_serverid",0,r.CVF.SYSTEMINFO),pt=a.AddCvar("sv_mapname","nomap",r.CVF.SERVERINFO),dt=a.AddCvar("sv_maxClients",8,r.CVF.SERVERINFO|r.CVF.LATCH|r.CVF.ARCHIVE),vt=a.AddCvar("sv_fps",20),mt=a.AddCvar("sv_timeout",200),gt=a.AddCvar("sv_zombietime",2)}function bt(){a.AddCmd("map",wt),a.AddCmd("map_restart",Et),a.AddCmd("sectorlist",Wt)}function wt(e){j(e)}function Et(e){if(a.frameTime===ht())return;if(E.restartTime)return;var t=typeof e!="undefined"?parseInt(e,10):5;if(t&&!a.GetCvarVal("g_doWarmup")){E.restartTime=E.time+t*1e3,R("warmup",E.restartTime);return}if(a.RelatchCvar("sv_maxClients")){T("Restart map is doing a hard restart - sv_maxClients changed."),j(pt());return}S.snapFlagServerBit^=r.SNAPFLAG_SERVERCOUNT,E.serverId=a.frameTime,ht(E.serverId);for(var n=0;n<dt();n++)S.clients[n].state===g.PRIMED&&(S.clients[n].oldServerTime=E.restartTime);E.state=d.LOADING,E.restarting=!0,xt(),St();for(var n=0;n<3;n++)l.Frame(E.time),E.time+=100,S.time+=100;E.state=d.GAME,E.restarting=!1;for(var n=0;n<dt();n++){var i=S.clients[n];if(i.state<g.CONNECTED)continue;V(i,"map_restart");var s=l.ClientConnect(n,!1);if(s){et(i,s),T("MapRestart: dropped client",n,"- denied!");continue}i.state===g.ACTIVE?Z(i,i.lastUserCmd):Z(i,null)}l.Frame(E.time),E.time+=100,S.time+=100}function St(){S.gameInitialized=!0,l.Init(E.time)}function xt(){if(!S.gameInitialized)return;S.gameInitialized=!1,l.Shutdown()}function Tt(e){return E.gameEntities[e]}function Nt(e){var t=e.s.number;return(!e||t<0||t>=r.MAX_GENTITIES)&&a.Error("SvEntityForSharedEntity: bad game entity"),E.svEntities[t]}function Ct(e){var t=E.svEntities.indexOf(e);return(!e||t<0||t>=r.MAX_GENTITIES)&&a.Error("SharedEntityForSvEntity: bad sv entity"),Tt(t)}function kt(e,t){E.gameEntities=e,E.gameClients=t}function Lt(e,t){(e<0||e>=r.MAX_CLIENTS)&&a.Error("GetUsercmd: bad clientNum: "+e),S.clients[e].lastUserCmd.clone(t)}function At(e,t,n){e===null?X(null,t,n):((e<0||e>=r.MAX_CLIENTS)&&a.Error("GetUsercmd: bad clientNum: "+e),X(S.clients[e],t,n))}function Ot(e,t){t||a.Error("SV: SetBrushModel: null"),t.charAt(0)!=="*"&&a.Error("SV: SetBrushModel: "+t+"isn't a brush model"),e.s.modelIndex=parseInt(t.substr(1),10);var n=f.InlineModel(e.s.modelIndex);f.ModelBounds(n,e.mins,e.maxs),e.bmodel=!0,e.contents=-1}function Mt(e,t){var n=Nt(e);if(n.areanum2===-1)return;f.AdjustAreaPortalState(n.areanum,n.areanum2,t)}function _t(e,t,r){var i=r.currentOrigin,s=r.currentAngles,o=rn(r),u=f.TransformedBoxTrace(n.vec3origin,n.vec3origin,e,t,o,-1,i,s,!1);return u.startSolid}function Dt(e,t){var n=e.gentity;if(!n||e.state===g.ZOMBIE)return!1;E.snapshotCounter++;var r=e.frames[e.netchan.outgoingSequence%a.PACKET_BACKUP],i=ot(e),s=l.GetClientPlayerstate(i);s.clone(r.ps);var o=E.svEntities[i];o.snapshotCounter=E.snapshotCounter;var u=[];Pt(r.ps.origin,r,u,!1),r.numEntities=0,r.firstEntity=S.nextSnapshotEntities;for(var f=0;f<u.length;f++){var h=Tt(u[f]),p=S.snapshotEntities[S.nextSnapshotEntities%c];h.s.clone(p),S.nextSnapshotEntities++,r.numEntities++}return!0}function Pt(e,t,n){var i=f.PointLeafnum(e),s=f.LeafArea(i),o=f.LeafCluster(i);for(var u=0;u<r.MAX_GENTITIES;u++){var c=Tt(u);if(!c||!c.linked)continue;c.s.number!==u&&a.Error("Entity number does not match.. WTF"+c.s.number+", "+u);if(c.svFlags&l.SVF.NOCLIENT)continue;if(c.svFlags&l.SVF.SINGLECLIENT&&c.singleClient!==t.ps.clientNum)continue;if(c.svFlags&l.SVF.NOTSINGLECLIENT&&c.singleClient===t.ps.clientNum)continue;var h=Nt(c);if(h.snapshotCounter===E.snapshotCounter)continue;if(c.svFlags&l.SVF.BROADCAST){Ht(h,c,n);continue}if(!f.AreasConnected(s,h.areanum)&&!f.AreasConnected(s,h.areanum2))continue;if(!h.numClusters)continue;var p=0,d=0;for(p=0;p<h.numClusters;p++){d=h.clusternums[p];if(f.ClusterVisible(o,d))break}if(p===h.numClusters){if(!h.lastCluster)continue;for(;d<=h.lastCluster;d++)if(cm.ClusterVisible(o,d))break;if(d===h.lastCluster)continue}Ht(h,c,n);if(c.svFlags&l.SVF.PORTAL){if(c.s.generic1){var v=vec3.subtract(c.s.origin,e,vec3.create());if(vec3.squaredLength(v)>c.s.generic1*c.s.generic1)continue}Pt(c.s.origin2,t,n)}}}function Ht(e,t,n){if(e.snapshotCounter===E.snapshotCounter)return;e.snapshotCounter=E.snapshotCounter,n.push(t.s.number)}function Bt(e){if(!Dt(e))return;var n=new t(S.msgBuffer,t.LITTLE_ENDIAN);n.writeInt(e.lastClientCommand),jt(e,n),Ft(e,n),e.frames[e.netchan.outgoingSequence%a.PACKET_BACKUP].messageSent=S.time,e.frames[e.netchan.outgoingSequence%a.PACKET_BACKUP].messageAcked=-1,a.NetchanSend(e.netchan,n.buffer,n.index)}function jt(e,t){for(var n=e.reliableAcknowledge+1;n<=e.reliableSequence;n++){var r=e.reliableCommands[n%a.MAX_RELIABLE_COMMANDS];t.writeByte(a.SVM.serverCommand),t.writeInt(n),t.writeCString(JSON.stringify(r))}}function Ft(e,t){var n=e.frames[e.netchan.outgoingSequence%a.PACKET_BACKUP],i=null,s=0;e.deltaMessage<=0||e.state!==g.ACTIVE?(i=null,s=0):e.netchan.outgoingSequence-e.deltaMessage>=a.PACKET_BACKUP-3?(i=null,s=0):(i=e.frames[e.deltaMessage%a.PACKET_BACKUP],s=e.netchan.outgoingSequence-e.deltaMessage,i.firstEntity<=S.nextSnapshotEntities-S.numSnapshotEntities&&(T(e.name,": Delta request from out of date entities."),i=null,s=0)),t.writeUnsignedByte(a.SVM.snapshot);var o=E.time;e.oldServerTime&&(o=E.time+e.oldServerTime),t.writeInt(o),t.writeByte(s);var u=S.snapFlagServerBit;e.state!==g.ACTIVE&&(u|=r.SNAPFLAG_NOT_ACTIVE),t.writeInt(u),a.WriteDeltaPlayerState(t,i?i.ps:null,n.ps),It(t,i,n)}function It(e,t,n){var i,s,o,u,f,l,h;h=t?t.numEntities:0,i=null,s=null,o=0,u=0;while(u<n.numEntities||o<h){u>=n.numEntities?l=9999:(s=S.snapshotEntities[(n.firstEntity+u)%c],l=s.number),o>=h?f=9999:(i=S.snapshotEntities[(t.firstEntity+o)%c],f=i.number);if(l===f){a.WriteDeltaEntityState(e,i,s,!1),o++,u++;continue}if(l<f){a.WriteDeltaEntityState(e,E.svEntities[l].baseline,s,!0),u++;continue}if(l>f){a.WriteDeltaEntityState(e,i,null,!0),o++;continue}}e.writeShort(r.MAX_GENTITIES-1)}function qt(){for(var e=0;e<S.clients.length;e++){var t=S.clients[e];if(!t)continue;if(!t.state)continue;if(S.time-t.lastSnapshotTime<t.snapshotMsec)continue;Bt(t),t.lastSnapshotTime=S.time}}function Wt(){for(var t=0;t<Ut.length;t++){var n=Ut[t];T("sector "+t+": "+e.keys(n.entities).length+" entities")}}function Xt(){Ut=[];var e=f.InlineModel(0),t=vec3.create(),n=vec3.create();f.ModelBounds(e,t,n),Vt(0,t,n)}function Vt(e,t,n){var r=Ut[Ut.length]=new zt;if(e===Rt)return r.axis=-1,r.children[0]=r.children[1]=null,r;var i=vec3.subtract(n,t,vec3.create());i[0]>i[1]?r.axis=0:r.axis=1;var s=vec3.create(t),o=vec3.create(t),u=vec3.create(n),a=vec3.create(n);return r.dist=.5*(n[r.axis]+t[r.axis]),u[r.axis]=o[r.axis]=r.dist,r.children[0]=Vt(e+1,o,a),r.children[1]=Vt(e+1,s,u),r}function $t(){return E.world.entities}function Qt(e){var t,i,s,o=Nt(e);o.worldSector&&Gt(e),e.bmodel?e.s.solid=r.SOLID_BMODEL:e.contents&(r.CONTENTS.SOLID|r.CONTENTS.BODY)?(t=e.maxs[0],t<1?t=1:t>255&&(t=255),i=-e.mins[2],i<1?i=1:i>255&&(i=255),s=e.maxs[2]+32,s<1?s=1:s>255&&(s=255),e.s.solid=s<<16|i<<8|t):e.s.solid=0;var u=e.currentOrigin,a=e.currentAngles;if(e.bmodel&&(a[0]||a[1]||a[2])){var l=n.RadiusFromBounds(e.mins,e.maxs);for(t=0;t<3;t++)e.absmin[t]=u[t]-l,e.absmax[t]=u[t]+l}else vec3.add(u,e.mins,e.absmin),vec3.add(u,e.maxs,e.absmax);e.absmin[0]-=1,e.absmin[1]-=1,e.absmin[2]-=1,e.absmax[0]+=1,e.absmax[1]+=1,e.absmax[2]+=1,o.numClusters=0,o.lastCluster=0,o.areanum=-1,o.areanum2=-1;var c=f.BoxLeafnums(e.absmin,e.absmax,Kt,Jt);if(!c.count)return;for(t=0;t<c.count;t++){var p=f.LeafArea(Kt[t]);if(p===-1)continue;o.areanum!==-1&&o.areanum!==p?o.areanum2=p:o.areanum=p}o.numClusters=0;for(t=0;t<c.count;t++){var d=f.LeafCluster(Kt[t]);if(d===-1)continue;o.clusternums[o.numClusters++]=d;if(o.numClusters===h)break}t!==c.count&&(o.lastCluster=f.LeafCluster(c.lastLeaf));var v=Ut[0];for(;;){if(v.axis==-1)break;if(e.absmin[v.axis]>v.dist)v=v.children[0];else{if(!(e.absmax[v.axis]<v.dist))break;v=v.children[1]}}e.linked=!0,o.worldSector=v,v.entities[e.s.number]=o}function Gt(e){var t=Nt(e),n=t.worldSector;if(!n)return;e.linked=!1,delete n.entities[e.s.number],t.worldSector=null}function Yt(e,t){var n=[],r=function(i){for(var s in i.entities){if(!i.entities.hasOwnProperty(s))continue;var o=i.entities[s],u=Ct(o);if(u.absmin[0]>t[0]||u.absmin[1]>t[1]||u.absmin[2]>t[2]||u.absmax[0]<e[0]||u.absmax[1]<e[1]||u.absmax[2]<e[2])continue;n.push(u.s.number)}if(i.axis==-1)return;t[i.axis]>i.dist&&r(i.children[0]),e[i.axis]<i.dist&&r(i.children[1])};return r(Ut[0]),n}function tn(e,t,n,i,s,o,u){n||(n=vec3.create()),i||(i=vec3.create()),en.trace=f.BoxTrace(e,t,n,i,0,o,u),en.trace.entityNum=en.trace.fraction!==1?r.ENTITYNUM_WORLD:r.ENTITYNUM_NONE;if(en.trace.fraction===0)return en.trace;en.contentmask=o,vec3.set(e,en.start),vec3.set(t,en.end),vec3.set(n,en.mins),vec3.set(i,en.maxs),en.passEntityNum=s,en.capsule=u;for(var a=0;a<3;a++)t[a]>e[a]?(en.boxmins[a]=en.start[a]+en.mins[a]-1,en.boxmaxs[a]=en.end[a]+en.maxs[a]+1):(en.boxmins[a]=en.end[a]+en.mins[a]-1,en.boxmaxs[a]=en.start[a]+en.maxs[a]+1);return nn(en),en.trace}function nn(e){var t=vec3.create(),n=vec3.create(),i=-1,s=Yt(e.boxmins,e.boxmaxs);e.passEntityNum!==r.ENTITYNUM_NONE&&(i=Tt(e.passEntityNum).ownerNum,i===r.ENTITYNUM_NONE&&(i=-1));for(var o=0;o<s.length;o++){if(e.trace.allSolid)return;var u=Tt(s[o]);if(e.passEntityNum!==r.ENTITYNUM_NONE){if(s[o]===e.passEntityNum)continue;if(u.ownerNum===e.passEntityNum)continue;if(u.ownerNum===i)continue}if(!(e.contentmask&u.contents))continue;var a=rn(u);vec3.set(u.currentOrigin,t),vec3.set(u.currentAngles,n),u.bmodel||(n[0]=n[1]=n[2]=0);var l=f.TransformedBoxTrace(e.start,e.end,e.mins,e.maxs,a,e.contentmask,t,n,e.capsule);l.allSolid?(e.trace.allSolid=!0,l.entityNum=u.s.number):l.startSolid&&(e.trace.startSolid=!0,l.entityNum=u.s.number);if(l.fraction<e.trace.fraction){var c=e.trace.startSolid;l.entityNum=u.s.number,e.trace=l,e.trace.startSolid|=c}}}function rn(e){return e.bmodel?f.InlineModel(e.s.modelIndex):e.svFlags&l.SVF.CAPSULE?(a.Error("Capsules not supported."),0):f.TempBoxModel(e.mins,e.maxs,!1)}function sn(e,t){var r=f.PointContents(e,0),i=Yt(e,e);for(var s=0;s<i.length;s++){if(i[s]===t)continue;var o=Tt(i[s]),u=rn(o),a=n.vec3origin;o.bmodel&&(a=o.currentAngles);var l=f.TransformedPointContents(e,u,o.currentOrigin,a);r|=l}return r}var u=o.sys,a=o.com,f=i.CreateInstance(J()),l=s.CreateInstance(K()),c=r.MAX_CLIENTS*a.PACKET_BACKUP*64,h=16,p=function(){this.initialized=!1,this.gameInitialized=!1,this.time=0,this.nextHeartbeatTim=0,this.snapFlagServerBit=0,this.clients=new Array(r.MAX_CLIENTS),this.nextSnapshotEntities=0,this.snapshotEntities=new Array(c),this.msgBuffer=new ArrayBuffer(a.MAX_MSGLEN);for(var e=0;e<r.MAX_CLIENTS;e++)this.clients[e]=new y;for(var e=0;e<c;e++)this.snapshotEntities[e]=new r.EntityState},d={DEAD:0,LOADING:1,GAME:2},v=function(){this.state=d.DEAD,this.restarting=!1,this.serverId=0,this.restartedServerId=0,this.snapshotCounter=0,this.time=0,this.restartTime=0,this.timeResidual=0,this.configstrings={},this.world=null,this.svEntities=new Array(r.MAX_GENTITIES),this.gameEntities=null,this.gameClients=null;for(var e=0;e<r.MAX_GENTITIES;e++)this.svEntities[e]=new m},m=function(){this.worldSector=null,this.baseline=new r.EntityState,this.numClusters=0,this.clusternums=new Array(h),this.lastCluster=0,this.areanum=0,this.areanum2=0,this.snapshotCounter=0},g={FREE:0,ZOMBIE:1,CONNECTED:2,PRIMED:3,ACTIVE:4},y=function(){this.reset()};y.prototype.reset=function(){this.state=g.FREE,this.userinfo={},this.messageAcknowledge=0,this.reliableCommands=new Array(a.MAX_RELIABLE_COMMANDS),this.reliableSequence=0,this.reliableAcknowledge=0,this.gamestateMessageNum=-1,this.lastUserCmd=new r.UserCmd,this.lastMessageNum=0,this.lastClientCommand=0,this.name=null,this.deltaMessage=-1,this.nextReliableTime=0,this.lastSnapshotTime=0,this.snapshotMsec=0,this.frames=new Array(a.PACKET_BACKUP),this.netchan=null,this.oldServerTime=0,this.csUpdated={};for(var e=0;e<a.PACKET_BACKUP;e++)this.frames[e]=new b};var b=function(){this.ps=new r.PlayerState,this.numEntities=0,this.firstEntity=0},w,E,S,x,D=3e5,ht,pt,dt,vt,mt,gt,Rt=4,Ut,zt=function(){this.axis=0,this.dist=0,this.children=[null,null],this.entities={}},Jt=128,Kt=new Uint32Array(Jt),Zt=function(){this.boxmins=vec3.create(),this.boxmaxs=vec3.create(),this.mins=vec3.create(),this.maxs=vec3.create(),this.start=vec3.create(),this.end=vec3.create(),this.trace=null,this.passEntityNum=0,this.contentmask=0,this.capsule=0},en=new Zt;return{Init:N,Running:A,Frame:L,PacketEvent:H,ClientDisconnected:tt,Kill:F}}return{CreateInstance:function(e){return new o(e)}}}),function(){var e={},t=this,n=t.async;e.noConflict=function(){return t.async=n,e};var r=function(e,t){if(e.forEach)return e.forEach(t);for(var n=0;n<e.length;n+=1)t(e[n],n,e)},i=function(e,t){if(e.map)return e.map(t);var n=[];return r(e,function(e,r,i){n.push(t(e,r,i))}),n},s=function(e,t,n){return e.reduce?e.reduce(t,n):(r(e,function(e,r,i){n=t(n,e,r,i)}),n)},o=function(e){if(Object.keys)return Object.keys(e);var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t};typeof process=="undefined"||!process.nextTick?e.nextTick=function(e){setTimeout(e,0)}:e.nextTick=process.nextTick,e.forEach=function(e,t,n){n=n||function(){};if(!e.length)return n();var i=0;r(e,function(r){t(r,function(t){t?(n(t),n=function(){}):(i+=1,i===e.length&&n(null))})})},e.forEachSeries=function(e,t,n){n=n||function(){};if(!e.length)return n();var r=0,i=function(){t(e[r],function(t){t?(n(t),n=function(){}):(r+=1,r===e.length?n(null):i())})};i()},e.forEachLimit=function(e,t,n,r){r=r||function(){};if(!e.length||t<=0)return r();var i=0,s=0,o=0;(function u(){if(i===e.length)return r();while(o<t&&s<e.length)s+=1,o+=1,n(e[s-1],function(t){t?(r(t),r=function(){}):(i+=1,o-=1,i===e.length?r():u())})})()};var u=function(t){return function(){var n=Array.prototype.slice.call(arguments);return t.apply(null,[e.forEach].concat(n))}},a=function(t){return function(){var n=Array.prototype.slice.call(arguments);return t.apply(null,[e.forEachSeries].concat(n))}},f=function(e,t,n,r){var s=[];t=i(t,function(e,t){return{index:t,value:e}}),e(t,function(e,t){n(e.value,function(n,r){s[e.index]=r,t(n)})},function(e){r(e,s)})};e.map=u(f),e.mapSeries=a(f),e.reduce=function(t,n,r,i){e.forEachSeries(t,function(e,t){r(n,e,function(e,r){n=r,t(e)})},function(e){i(e,n)})},e.inject=e.reduce,e.foldl=e.reduce,e.reduceRight=function(t,n,r,s){var o=i(t,function(e){return e}).reverse();e.reduce(o,n,r,s)},e.foldr=e.reduceRight;var l=function(e,t,n,r){var s=[];t=i(t,function(e,t){return{index:t,value:e}}),e(t,function(e,t){n(e.value,function(n){n&&s.push(e),t()})},function(e){r(i(s.sort(function(e,t){return e.index-t.index}),function(e){return e.value}))})};e.filter=u(l),e.filterSeries=a(l),e.select=e.filter,e.selectSeries=e.filterSeries;var c=function(e,t,n,r){var s=[];t=i(t,function(e,t){return{index:t,value:e}}),e(t,function(e,t){n(e.value,function(n){n||s.push(e),t()})},function(e){r(i(s.sort(function(e,t){return e.index-t.index}),function(e){return e.value}))})};e.reject=u(c),e.rejectSeries=a(c);var h=function(e,t,n,r){e(t,function(e,t){n(e,function(n){n?(r(e),r=function(){}):t()})},function(e){r()})};e.detect=u(h),e.detectSeries=a(h),e.some=function(t,n,r){e.forEach(t,function(e,t){n(e,function(e){e&&(r(!0),r=function(){}),t()})},function(e){r(!1)})},e.any=e.some,e.every=function(t,n,r){e.forEach(t,function(e,t){n(e,function(e){e||(r(!1),r=function(){}),t()})},function(e){r(!0)})},e.all=e.every,e.sortBy=function(t,n,r){e.map(t,function(e,t){n(e,function(n,r){n?t(n):t(null,{value:e,criteria:r})})},function(e,t){if(e)return r(e);var n=function(e,t){var n=e.criteria,r=t.criteria;return n<r?-1:n>r?1:0};r(null,i(t.sort(n),function(e){return e.value}))})},e.auto=function(e,t){t=t||function(){};var n=o(e);if(!n.length)return t(null);var i={},u=[],a=function(e){u.unshift(e)},f=function(e){for(var t=0;t<u.length;t+=1)if(u[t]===e){u.splice(t,1);return}},l=function(){r(u.slice(0),function(e){e()})};a(function(){o(i).length===n.length&&(t(null,i),t=function(){})}),r(n,function(n){var r=e[n]instanceof Function?[e[n]]:e[n],o=function(e){if(e)t(e),t=function(){};else{var r=Array.prototype.slice.call(arguments,1);r.length<=1&&(r=r[0]),i[n]=r,l()}},u=r.slice(0,Math.abs(r.length-1))||[],c=function(){return s(u,function(e,t){return e&&i.hasOwnProperty(t)},!0)&&!i.hasOwnProperty(n)};if(c())r[r.length-1](o,i);else{var h=function(){c()&&(f(h),r[r.length-1](o,i))};a(h)}})},e.waterfall=function(t,n){n=n||function(){};if(!t.length)return n();var r=function(t){return function(i){if(i)n(i),n=function(){};else{var s=Array.prototype.slice.call(arguments,1),o=t.next();o?s.push(r(o)):s.push(n),e.nextTick(function(){t.apply(null,s)})}}};r(e.iterator(t))()},e.parallel=function(t,n){n=n||function(){};if(t.constructor===Array)e.map(t,function(e,t){e&&e(function(e){var n=Array.prototype.slice.call(arguments,1);n.length<=1&&(n=n[0]),t.call(null,e,n)})},n);else{var r={};e.forEach(o(t),function(e,n){t[e](function(t){var i=Array.prototype.slice.call(arguments,1);i.length<=1&&(i=i[0]),r[e]=i,n(t)})},function(e){n(e,r)})}},e.series=function(t,n){n=n||function(){};if(t.constructor===Array)e.mapSeries(t,function(e,t){e&&e(function(e){var n=Array.prototype.slice.call(arguments,1);n.length<=1&&(n=n[0]),t.call(null,e,n)})},n);else{var r={};e.forEachSeries(o(t),function(e,n){t[e](function(t){var i=Array.prototype.slice.call(arguments,1);i.length<=1&&(i=i[0]),r[e]=i,n(t)})},function(e){n(e,r)})}},e.iterator=function(e){var t=function(n){var r=function(){return e.length&&e[n].apply(null,arguments),r.next()};return r.next=function(){return n<e.length-1?t(n+1):null},r};return t(0)},e.apply=function(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t.concat(Array.prototype.slice.call(arguments)))}};var p=function(e,t,n,r){var i=[];e(t,function(e,t){n(e,function(e,n){i=i.concat(n||[]),t(e)})},function(e){r(e,i)})};e.concat=u(p),e.concatSeries=a(p),e.whilst=function(t,n,r){t()?n(function(i){if(i)return r(i);e.whilst(t,n,r)}):r()},e.until=function(t,n,r){t()?r():n(function(i){if(i)return r(i);e.until(t,n,r)})},e.queue=function(t,n){var i=0,s={tasks:[],concurrency:n,saturated:null,empty:null,drain:null,push:function(t,i){t.constructor!==Array&&(t=[t]),r(t,function(t){s.tasks.push({data:t,callback:typeof i=="function"?i:null}),s.saturated&&s.tasks.length==n&&s.saturated(),e.nextTick(s.process)})},process:function(){if(i<s.concurrency&&s.tasks.length){var e=s.tasks.shift();s.empty&&s.tasks.length==0&&s.empty(),i+=1,t(e.data,function(){i-=1,e.callback&&e.callback.apply(e,arguments),s.drain&&s.tasks.length+i==0&&s.drain(),s.process()})}},length:function(){return s.tasks.length},running:function(){return i}};return s};var d=function(e){return function(t){var n=Array.prototype.slice.call(arguments,1);t.apply(null,n.concat([function(t){var n=Array.prototype.slice.call(arguments,1);typeof console!="undefined"&&(t?console.error&&console.error(t):console[e]&&r(n,function(t){console[e](t)}))}]))}};e.log=d("log"),e.dir=d("dir"),e.memoize=function(e,t){var n={},r={};t=t||function(e){return e};var i=function(){var i=Array.prototype.slice.call(arguments),s=i.pop(),o=t.apply(null,i);o in n?s.apply(null,n[o]):o in r?r[o].push(s):(r[o]=[s],e.apply(null,i.concat([function(){n[o]=arguments;var e=r[o];delete r[o];for(var t=0,i=e.length;t<i;t++)e[t].apply(null,arguments)}])))};return i.unmemoized=e,i},e.unmemoize=function(e){return function(){return(e.unmemoized||e).apply(null,arguments)}},typeof define!="undefined"&&define.amd?define("async",[],function(){return e}):typeof module!="undefined"&&module.exports?module.exports=e:t.async=e}(),define("cgame/cg",["underscore","glmatrix","common/qmath","common/text-tokenizer","common/qshared","game/bg"],function(e,t,n,r,i,s){function o(t){function Wt(){arguments[0]==="print"?Rt.addEvent({type:"print",text:arguments[1]}):(arguments[0]==="chat"||arguments[0]==="tchat")&&Rt.addEvent({type:arguments[0],name:arguments[1],text:arguments[2]});var e=Array.prototype.slice.call(arguments);e.splice(0,0,"CG:"),Function.apply.call(console.log,console,e)}function Xt(e){u.Error(e)}function Vt(e,t,n){Wt("Initializing",e,t,n),It=new Ct,It.clientNum=n,qt||(qt=new kt),qt.processedSnapshotNum=e,qt.serverCommandSequence=t,qt.gameState=a.GetGameState(),Rt=h.GetView("hud"),Ut=h.GetView("loading"),zt=h.GetView("scoreboard"),Mn(),cn(),Li(),kr(),Kt(function(){It.initialized=!0})}function $t(){Wt("Shutting down")}function Jt(e){if(!It.initialized){_n();return}It.time=e,Pi();if(!It.snap||It.snap.snapFlags&m){_n();return}a.SetUserCmdValue("weapon",It.weaponSelect),a.SetUserCmdValue("sensitivity",It.zoomSensitivity),xi(),It.renderingThirdPerson=En()||It.snap.ps.pm_type===R.DEAD,Ri(),It.refdef.time=It.time,It.hyperspace||(lr(),Or()),ns(It.predictedPlayerState),fn(),c.Respatialize(It.snap.ps.clientNum,It.refdef.vieworg,It.refdef.viewaxis),It.frameTime=It.time-It.oldTime,It.frametime<0&&(It.frametime=0),It.oldTime=It.time,Kn(),l.RenderScene(It.refdef),Dn()}function Kt(e){var t=[Qt,Yt,en,tn,nn,rn],n=new Array(t.length),r=t.length,i=function(){var t=0;for(var i=0;i<n.length;i++)t+=n[i]||0;var s=Math.round(t/r*100);Ut.setProgress(s),t>=r&&(un(),e())};Ut.setMapName(qt.mapname),t.forEach(function(e,t){e(function(e){n[t]=e,i()})})}function Qt(e){a.LoadBsp(qt.mapname,function(t,n){if(t)return Xt(t);e(.25),f.LoadWorld(n),e(.5),l.LoadWorld(n,function(){e(.75),Gt(function(t){e(.75+.25*t)})})})}function Gt(e){var t=l.NumInlineModels();qt.inlineDrawModels=new Array(t),qt.inlineModelMidpoints=new Array(t);var n=t-1,r=0,i=function(t){var i="*"+t;l.RegisterModel(i,function(i){qt.inlineDrawModels[t]=i;var s=vec3.create(),o=vec3.create();l.ModelBounds(i,s,o),qt.inlineModelMidpoints[t]=vec3.createFrom(s[0]+.5*(o[0]-s[0]),s[1]+.5*(o[1]-s[1]),s[2]+.5*(o[2]-s[2])),e(++r/n)})};for(var s=1;s<t;s++)i(s)}function Yt(e){var t=p.ItemList.length-1,n=0,r=function(r){r>=1&&(n++,r=0),e((n+r)/t)};for(var i=1;i<p.ItemList.length;i++)Zt(i,r)}function Zt(t,n){var r=p.ItemList[t],i=It.itemInfo[t];if(!r||i){Xt("Invalid item number or item already registered");return}i=It.itemInfo[t]=new Ft;var s=(r.models?Object.keys(r.models).length:0)+(r.shaders?Object.keys(r.shaders).length:0)+(r.gfx?Object.keys(r.gfx).length:0)+(r.sounds?Object.keys(r.sounds).length:0),o=0;r.models&&e.each(r.models,function(e,t){l.RegisterModel(e,function(e){i.models[t]=e,n(++o/s)})}),r.shaders&&e.each(r.shaders,function(e,t){l.RegisterShader(e,function(e){i.shaders[t]=e,n(++o/s)})}),r.gfx&&e.each(r.gfx,function(e,t){h.RegisterImage(e,function(e){i.gfx[t]=e,n(++o/s)})}),r.sounds&&e.each(r.sounds,function(e,t){c.RegisterSound(r.sounds[t],function(e){i.sounds[t]=e,n(++o/s)})}),i.trailTime=r.trailTime,i.trailRadius=r.trailRadius,i.flashDlightColor=r.flashDlightColor,i.missileDlightIntensity=r.missileDlightIntensity,i.missileDlightColor=r.missileDlightColor}function en(t){var n={redQuadShader:"powerups/blueflag",quadShader:"powerups/quad",quadWeaponShader:"powerups/quadWeapon",battleSuitShader:"powerups/battleSuit",battleWeaponShader:"powerups/battleWeapon",invisShader:"powerups/invisibility",regenShader:"powerups/regen",hastePuffShader:"hasteSmokePuff",smokePuffShader:"smokePuff",shotgunSmokePuffShader:"shotgunSmokePuff",plasmaBallShader:"sprites/plasma1",bloodExplosionShader:"bloodExplosion",bloodTrailShader:"bloodTrail",bloodMarkShader:"bloodMark",teleportEffectShader:"teleportEffect",bulletMarkShader:"gfx/damage/bullet_mrk",burnMarkShader:"gfx/damage/burn_med_mrk",holeMarkShader:"gfx/damage/hole_lg_mrk",energyMarkShader:"gfx/damage/plasma_mrk",shadowMarkShader:"markShadow"},r=Object.keys(n).length,i=0;return e.each(n,function(e,n){l.RegisterShader(e,function(e){qt.media[n]=e,t(++i/r)})}),r}function tn(t){var n={bulletFlashModel:"models/weaphits/bullet",ringFlashModel:"models/weaphits/ring02",dishFlashModel:"models/weaphits/boom01",gibAbdomen:"models/gibs/abdomen",gibArm:"models/gibs/arm",gibChest:"models/gibs/chest",gibFist:"models/gibs/fist",gibFoot:"models/gibs/foot",gibForearm:"models/gibs/forearm",gibIntestine:"models/gibs/intestine",gibLeg:"models/gibs/leg",gibSkull:"models/gibs/skull",gibBrain:"models/gibs/brain",teleportEffectModel:"models/misc/telep"},r=Object.keys(n).length,i=0;e.each(n,function(e,n){l.RegisterModel(e,function(e){qt.media[n]=e,t(++i/r)})})}function nn(t){var n={oneMinuteSound:"sound/feedback/1_minute",fiveMinuteSound:"sound/feedback/5_minute",suddenDeathSound:"sound/feedback/sudden_death",oneFragSound:"sound/feedback/1_frag",twoFragSound:"sound/feedback/2_frags",threeFragSound:"sound/feedback/3_frags",count3Sound:"sound/feedback/three",count2Sound:"sound/feedback/two",count1Sound:"sound/feedback/one",countFightSound:"sound/feedback/fight",countPrepareSound:"sound/feedback/prepare",countPrepareTeamSound:"sound/feedback/prepare_team",gibSound:"sound/player/gibsplt1",gibBounce1Sound:"sound/player/gibimp1",gibBounce2Sound:"sound/player/gibimp2",gibBounce3Sound:"sound/player/gibimp3",teleInSound:"sound/world/telein",teleOutSound:"sound/world/teleout",respawnSound:"sound/items/respawn1",selectSound:"sound/weapons/change",noAmmoSound:"sound/weapons/noammo",n_healthSound:"sound/items/n_health",gurp1Sound:"sound/player/gurp1",gurp2Sound:"sound/player/gurp2",hitSound:"sound/feedback/hit",talkSound:"sound/player/talk",watrInSound:"sound/player/watr_in",watrOutSound:"sound/player/watr_out",watrUnSound:"sound/player/watr_un",jumpPadSound:"sound/world/jumppad"};for(var r=0;r<4;r++)n["footstep"+xt.NORMAL+r]="sound/player/footsteps/step"+(r+1),n["footstep"+xt.BOOT+r]="sound/player/footsteps/boot"+(r+1),n["footstep"+xt.FLESH+r]="sound/player/footsteps/flesh"+(r+1),n["footstep"+xt.MECH+r]="sound/player/footsteps/mech"+(r+1),n["footstep"+xt.ENERGY+r]="sound/player/footsteps/energy"+(r+1),n["footstep"+xt.SPLASH+r]="sound/player/footsteps/splash"+(r+1),n["footstep"+xt.METAL+r]="sound/player/footsteps/clank"+(r+1);if(qt.gametype>=z.TEAM){n.captureAwardSound="sound/teamplay/flagcapture_yourteam",n.redLeadsSound="sound/feedback/redleads",n.blueLeadsSound="sound/feedback/blueleads",n.teamsTiedSound="sound/feedback/teamstied",n.hitTeamSound="sound/feedback/hit_teammate",n.redScoredSound="sound/teamplay/voc_red_scores",n.blueScoredSound="sound/teamplay/voc_blue_scores",n.captureYourTeamSound="sound/teamplay/flagcapture_yourteam",n.captureOpponentSound="sound/teamplay/flagcapture_opponent",n.returnYourTeamSound="sound/teamplay/flagreturn_yourteam",n.returnOpponentSound="sound/teamplay/flagreturn_opponent",n.takenYourTeamSound="sound/teamplay/flagtaken_yourteam",n.takenOpponentSound="sound/teamplay/flagtaken_opponent",qt.gametype==z.CTF&&(n.redFlagReturnedSound="sound/teamplay/voc_red_returned",n.blueFlagReturnedSound="sound/teamplay/voc_blue_returned",n.enemyTookYourFlagSound="sound/teamplay/voc_enemy_flag",n.yourTeamTookEnemyFlagSound="sound/teamplay/voc_team_flag"),qt.gametype==z.NFCTF&&(n.neutralFlagReturnedSound="sound/teamplay/flagreturn_opponent",n.yourTeamTookTheFlagSound="sound/teamplay/voc_team_1flag",n.enemyTookTheFlagSound="sound/teamplay/voc_enemy_1flag");if(qt.gametype==z.CTF||qt.gametype==z.NFCTF)n.youHaveFlagSound="sound/teamplay/voc_you_flag",n.holyShitSound="sound/feedback/voc_holyshit";n.youHaveFlagSound="sound/teamplay/voc_you_flag",n.holyShitSound="sound/feedback/voc_holyshit"}var i=Object.keys(n).length,s=0;e.each(n,function(e,r){c.RegisterSound(n[r],function(e){qt.media[r]=e,t(++s/i)})})}function rn(e){var t=0;for(var n=0;n<y;n++){var r=on("player"+n);r&&t++}var i=0,s=function(){e(++i/t)};for(var n=0;n<y;n++){var r=on("player"+n);if(!r)continue;zr(n,s)}}function sn(e,t){for(var n=0;n<p.ItemList.length;n++)if(p.ItemList[n].giType===e&&p.ItemList[n].giTag===t)return It.itemInfo[n];return null}function on(e){return qt.gameState[e]}function un(){var e=on("music");c.StartBackgroundTrack(e,!0)}function an(e){if(!e)return;It.soundBuffer[It.soundBufferIn]=e,It.soundBufferIn=(It.soundBufferIn+1)%St,It.soundBufferIn===It.soundBufferOut&&It.soundBufferOut++}function fn(){It.soundTime<It.time&&It.soundBufferOut!==It.soundBufferIn&&It.soundBuffer[It.soundBufferOut]&&(c.StartLocalSound(It.soundBuffer[It.soundBufferOut]),It.soundBuffer[It.soundBufferOut]=0,It.soundBufferOut=(It.soundBufferOut+1)%St,It.soundTime=It.time+750)}function ln(){return{com:{Error:u.Error}}}function cn(){u.AddCmd("+zoom",hn),u.AddCmd("-zoom",pn),u.AddCmd("+scores",dn),u.AddCmd("-scores",vn),u.AddCmd("weapnext",Yi),u.AddCmd("weapprev",Zi),u.AddCmd("weapon",es),u.AddCmd("say",null),u.AddCmd("noclip",null),u.AddCmd("team",null)}function hn(){if(It.zoomed)return;It.zoomed=!0,It.zoomTime=It.time}function pn(){if(!It.zoomed)return;It.zoomed=!1,It.zoomTime=It.time}function dn(){It.scoresRequestTime+2e3<It.time?(It.scoresRequestTime=It.time,a.AddClientCommand("score"),It.showScores||(It.showScores=!0,It.numScores=0)):It.showScores=!0,It.showScores=!0}function vn(){It.showScores=!1}function Mn(){mn=u.AddCvar("cg_fov",110,B.ARCHIVE),gn=u.AddCvar("cg_zoomFov",22.5,B.ARCHIVE),yn=u.AddCvar("cg_errordecay",100,B.ARCHIVE),bn=u.AddCvar("cg_nopredict",0,B.ARCHIVE),wn=u.AddCvar("cg_showmiss",1,B.ARCHIVE),En=u.AddCvar("cg_thirdPerson",0,B.ARCHIVE),Sn=u.AddCvar("cg_thirdPersonAngle",0),xn=u.AddCvar("cg_thirdPersonRange",100),Tn=u.AddCvar("cg_railTrailTime",400,B.CHEAT),Nn=u.AddCvar("cg_autoSwitch",1,B.ARCHIVE),Cn=u.AddCvar("cg_trueLightning",1,B.ARCHIVE),kn=u.AddCvar("cg_drawLagometer",0,B.ARCHIVE),Ln=u.AddCvar("cg_crosshairShaders",0,B.CHEAT),An=u.AddCvar("pmove_fixed",0,B.SYSTEMINFO),On=u.AddCvar("pmove_msec",8,B.SYSTEMINFO)}function _n(){h.RenderView(Ut)}function Dn(){if(It.snap.ps.pm_type===R.INTERMISSION){h.RenderView(zt);return}Fn(),In(),Jn(),It.snap.ps.persistant[Y.SPECTATOR_STATE]!==G.NOT?Xn():(Xn(),zn(),Un(),qn(),Rn(),Wn(),$n()),h.RenderView(Rt),It.showScores&&h.RenderView(zt)}function Fn(){var e=o.GetMilliseconds(),t=e-Bn;Bn=e,Hn[jn%Pn]=t,jn++;if(jn>Pn){var n=0;for(var r=0;r<Pn;r++)n+=Hn[r];n||(n=1),Rt.setFPS(parseInt(1e3*Pn/n,10))}}function In(){var e=l.GetCounts();Rt.setCounts({shaders:e.shaders,nodes:e.nodes,leafs:e.leafs,surfaces:e.surfaces,indexes:e.indexes,culledModelOut:e.culledModelOut,culledModelIn:e.culledModelIn,culledModelClip:e.culledModelClip})}function qn(){var e=It.snap.ps.stats[$.WEAPONS];for(var t=2;t<E;t++){if(!(e&1<<t)){Rt.setWeapon(t,null);continue}Rt.setWeapon(t,sn(X.WEAPON,t))}Rt.setWeaponSelect(It.weaponSelect)}function Rn(){var e=It.snap.ps.stats[$.WEAPONS];for(var t=2;t<E;t++){if(!(e&1<<t))continue;Rt.setAmmo(t,It.snap.ps.ammo[t])}}function Un(){Rt.setArmor(It.snap.ps.stats[$.ARMOR])}function zn(){Rt.setHealth(It.snap.ps.stats[$.HEALTH])}function Wn(){if(!qt.score1||!qt.score2){Xt("No score configstrings.");return}if(qt.score1.s===A){Xt("Invalid score for score1.");return}var e=qt.clientinfo[It.snap.ps.clientNum],t=null,n=null;if(qt.gametype>=z.TEAM)t={score:qt.score1.s,localplayer:e.team===Q.RED},n={score:qt.score2.s,localplayer:e.team===Q.BLUE};else{var r=qt.clientinfo[qt.score1.n],i=null;qt.score2.s!==A&&(i=qt.clientinfo[qt.score2.n]),t={rank:1,name:r.name,score:qt.score1.s,localplayer:r===e};if(!t.localplayer){var s=(It.snap.ps.persistant[Y.RANK]&~N)+1,o=It.snap.ps.persistant[Y.SCORE];n={rank:s,name:e.name,score:o,localplayer:!0}}else if(t.localplayer&&i){var u=It.snap.ps.persistant[Y.RANK]&N,s=u?1:2;n={rank:s,name:i.name,score:qt.score2.s,localplayer:!1}}}Rt.setGametype(ft[qt.gametype]),Rt.setScore1(t),Rt.setScore2(n)}function Xn(){Vn(),Rt.setCrosshairName(It.crosshairName)}function Vn(){var e=vec3.create(It.refdef.vieworg),t=vec3.add(vec3.scale(It.refdef.viewaxis[0],131072,vec3.create()),e);if(Ln()){var r=bi(e,t,n.vec3origin,n.vec3origin,-1,q.SOLID|q.BODY|q.DETAIL);It.crosshairName=r.shaderName;return}var r=bi(e,t,n.vec3origin,n.vec3origin,It.snap.ps.clientNum,q.SOLID|q.BODY);if(r.entityNum>=y){It.crosshairName=null;return}if(It.entities[r.entityNum].currentState.powerups&1<<K.INVIS)return;It.crosshairName=qt.clientinfo[r.entityNum].name}function $n(){if(!It.warmup)return;if(It.warmup<0){It.warmupCount=0;return}if(qt.gametype===z.TOURNAMENT){var e,t;for(var n=0;n<qt.maxclients;n++)qt.clientinfo[n].infoValid&&qt.clientinfo[n].team===Q.FREE&&(e?t=qt.clientinfo[n]:e=qt.clientinfo[n]);e&&t}var r=Math.floor((It.warmup-It.time)/1e3);r!==It.warmupCount&&(It.warmupCount=r,r<0?c.StartLocalSound(qt.media.countFightSound):r===0?c.StartLocalSound(qt.media.count1Sound):r===1?c.StartLocalSound(qt.media.count2Sound):r===2&&c.StartLocalSound(qt.media.count3Sound)),r<0&&(It.warmup=0)}function Jn(){kn()?Rt.showLagometer():Rt.hideLagometer()}function Kn(){if(!kn())return;var e=It.time-It.latestSnapshotTime;Rt.addLagometerFrame(e)}function Qn(e){if(!kn())return;Rt.addSnapshotFrame(e.ping,e.snapFlags)}function Gn(e,t,r,i,s,o){s<=0&&Xt("MakeExplosion: msec = ",s);var u=Lr(),a=vec3.create(),f=n.irrandom(0,64);if(o){u.leType=_t.SPRITE_EXPLOSION,u.refent.rotation=n.rrandom(0,360);var l=vec3.scale(t,16,vec3.create());vec3.add(l,e,a)}else{u.leType=_t.EXPLOSION,vec3.set(e,a);if(!t)n.AxisClear(u.refent.axis);else{var c=n.rrandom(0,360);vec3.set(t,u.refent.axis[0]),n.RotateAroundDirection(u.refent.axis,c)}}return u.startTime=It.time-f,u.endTime=u.startTime+s,u.refent.shaderTime=u.startTime/1e3,u.refent.hModel=r,u.refent.customShader=i,vec3.set(a,u.refent.origin),vec3.set(a,u.refent.oldOrigin),u.color[0]=u.color[1]=u.color[2]=1,u}function nr(e,t,r,i,s,o,u,a,f,c,h){c<=0&&Xt("ImpactMark called with <= 0 radius");var p=new l.RefEntity,d=p.axis;vec3.normalize(r,d[0]),n.PerpendicularVector(d[0],d[1]),n.RotatePointAroundVector(d[1],d[0],i,d[2]),vec3.cross(d[0],d[2],d[1]);var v=.5/c,m=[vec3.create(),vec3.create(),vec3.create(),vec3.create()];for(var g=0;g<3;g++)m[0][g]=t[g]-c*d[1][g]-c*d[2][g],m[1][g]=t[g]+c*d[1][g]-c*d[2][g],m[2][g]=t[g]+c*d[1][g]+c*d[2][g],m[3][g]=t[g]-c*d[1][g]+c*d[2][g];var y=[s,o,u,a];p.reType=ot.POLY,p.customShader=e;var b=vec3.scale(r,-20,vec3.create()),w=l.MarkFragments(m,b);for(var g=0;g<w.length;g++){var E=w[g];p.polyVerts=[];for(var S=0;S<E.length;S++){var x=new l.PolyVert;vec3.set(E[S],x.xyz);var T=vec3.subtract(x.xyz,t,vec3.create());x.st[0]=.5+vec3.dot(T,d[1])*v,x.st[1]=.5+vec3.dot(T,d[2])*v,vec4.set(y,x.modulate),p.polyVerts.push(x)}if(h){l.AddRefEntityToScene(p);continue}var N=Lr();N.leType=_t.MARK,N.startTime=It.time,N.endTime=N.startTime+er,N.fadeTime=N.endTime-tr,N.alphaFade=f,N.color[0]=s,N.color[1]=o,N.color[2]=u,N.color[3]=a,p.clone(N.refent)}}function rr(e){var t=Lr();t.leFlags=0,t.leType=_t.FADE_RGB,t.startTime=It.time,t.endTime=It.time+500,t.color[0]=t.color[1]=t.color[2]=t.color[3]=1;var r=t.refent;r.reType=ot.MODEL,r.shaderTime=It.time/1e3,r.hModel=qt.media.teleportEffectModel,r.customShader=qt.media.teleportEffectShader,n.AxisClear(r.axis),vec3.set(e,r.origin),r.origin[2]-=24}function ir(e,t,n,r,i,s,o,u,a,f,l,c){var h=Lr();h.leFlags=l,h.radius=n;var p=h.refent;return p.rotation=Math.random()*360,p.radius=n,p.shaderTime=a/1e3,h.leType=_t.MOVE_SCALE_FADE,h.startTime=a,h.fadeTime=f,h.endTime=a+u,h.color[0]=r,h.color[1]=i,h.color[2]=s,h.color[3]=o,h.pos.trType=F.LINEAR,h.pos.trTime=a,vec3.set(t,h.pos.trDelta),vec3.set(e,h.pos.trBase),vec3.set(e,p.origin),p.customShader=c,p.shaderRGBA[0]=h.color[0],p.shaderRGBA[1]=h.color[1],p.shaderRGBA[2]=h.color[2],p.shaderRGBA[3]=1,p.reType=ot.SPRITE,p.radius=h.radius,h}function sr(e,t){var r=Lr();r.leType=_t.EXPLOSION,r.startTime=It.time,r.endTime=r.startTime+500;var i=r.refent;vec3.set(e,i.origin),i.reType=ot.SPRITE,i.rotation=n.rrandom(0,360),i.radius=24,i.customShader=qt.media.bloodExplosionShader,t===It.snap.ps.clientNum&&(i.renderfx|=ut.THIRD_PERSON)}function ar(e){var t=vec3.create(e.lerpOrigin);c.StartSound(null,e.currentState.number,qt.media.gibSound);var r=vec3.createFrom(n.crandom()*or,n.crandom()*or,ur+n.crandom()*or);n.irrandom(0,1)?fr(t,r,qt.media.gibSkull):fr(t,r,qt.media.gibBrain),r[0]=n.crandom()*or,r[1]=n.crandom()*or,r[2]=ur+n.crandom()*or,fr(t,r,qt.media.gibAbdomen),r[0]=n.crandom()*or,r[1]=n.crandom()*or,r[2]=ur+n.crandom()*or,fr(t,r,qt.media.gibArm),r[0]=n.crandom()*or,r[1]=n.crandom()*or,r[2]=ur+n.crandom()*or,fr(t,r,qt.media.gibChest),r[0]=n.crandom()*or,r[1]=n.crandom()*or,r[2]=ur+n.crandom()*or,fr(t,r,qt.media.gibFist),r[0]=n.crandom()*or,r[1]=n.crandom()*or,r[2]=ur+n.crandom()*or,fr(t,r,qt.media.gibFoot),r[0]=n.crandom()*or,r[1]=n.crandom()*or,r[2]=ur+n.crandom()*or,fr(t,r,qt.media.gibForearm),r[0]=n.crandom()*or,r[1]=n.crandom()*or,r[2]=ur+n.crandom()*or,fr(t,r,qt.media.gibIntestine),r[0]=n.crandom()*or,r[1]=n.crandom()*or,r[2]=ur+n.crandom()*or,fr(t,r,qt.media.gibLeg),r[0]=n.crandom()*or,r[1]=n.crandom()*or,r[2]=ur+n.crandom()*or,fr(t,r,qt.media.gibLeg)}function fr(e,t,r){var i=Lr(),s=i.refent;i.leType=_t.FRAGMENT,i.startTime=It.time,i.endTime=i.startTime+5e3+Math.random()*3e3,vec3.set(e,s.origin),n.AxisCopy(n.axisDefault,s.axis),s.hModel=r,i.pos.trType=F.GRAVITY,vec3.set(e,i.pos.trBase),vec3.set(t,i.pos.trDelta),i.pos.trTime=It.time,i.bounceFactor=.6,i.leBounceSoundType=Ht.BLOOD,i.leMarkType=Pt.BLOOD}function lr(){if(It.nextSnap){var e=It.nextSnap.serverTime-It.snap.serverTime;e===0?It.frameInterpolation=0:It.frameInterpolation=(It.time-It.snap.serverTime)/e}else It.frameInterpolation=0;It.autoAngles[0]=0,It.autoAngles[1]=(It.time&2047)*360/2048,It.autoAngles[2]=0,It.autoAnglesFast[0]=0,It.autoAnglesFast[1]=(It.time&1023)*360/1024,It.autoAnglesFast[2]=0;var t=It.predictedPlayerState;p.PlayerStateToEntityState(t,It.predictedPlayerEntity.currentState),cr(It.predictedPlayerEntity),pr(It.entities[It.snap.ps.clientNum]);for(var n=0;n<It.snap.numEntities;n++){var r=It.entities[It.snap.entities[n].number];cr(r)}}function cr(e){if(e.currentState.eType>=et.EVENTS)return;pr(e),vr(e);switch(e.currentState.eType){case et.PORTAL:gr(e);break;case et.ITEM:yr(e);break;case et.MISSILE:br(e);break;case et.MOVER:wr(e);break;case et.PLAYER:Qr(e)}}function hr(e,t,r,s){var o=new i.Orientation;l.LerpTag(o,r,t.oldFrame,t.frame,1-t.backlerp,s);var u=vec3.create();vec3.set(t.origin,e.origin);for(var a=0;a<3;a++)vec3.add(e.origin,vec3.scale(t.axis[a],o.origin[a],u));var f=[vec3.create(),vec3.create(),vec3.create()];n.AxisMultiply(e.axis,o.axis,f),n.AxisMultiply(f,t.axis,e.axis)}function pr(e){e.currentState.number<y&&(e.currentState.pos.trType=F.INTERPOLATE,e.nextState.pos.trType=F.INTERPOLATE);if(e.interpolate&&e.currentState.pos.trType===F.INTERPOLATE){dr(e);return}if(e.interpolate&&e.currentState.pos.trType===F.LINEAR_STOP&&e.currentState.number<y){dr(e);return}p.EvaluateTrajectory(e.currentState.pos,It.time,e.lerpOrigin),p.EvaluateTrajectory(e.currentState.apos,It.time,e.lerpAngles)}function dr(e){It.nextSnap||Xt("InterpoateEntityPosition: !cg.nextSnap");var t=It.frameInterpolation,r=vec3.create(),i=vec3.create();p.EvaluateTrajectory(e.currentState.pos,It.snap.serverTime,r),p.EvaluateTrajectory(e.nextState.pos,It.nextSnap.serverTime,i),e.lerpOrigin[0]=r[0]+t*(i[0]-r[0]),e.lerpOrigin[1]=r[1]+t*(i[1]-r[1]),e.lerpOrigin[2]=r[2]+t*(i[2]-r[2]),p.EvaluateTrajectory(e.currentState.apos,It.snap.serverTime,r),p.EvaluateTrajectory(e.nextState.apos,It.nextSnap.serverTime,i),e.lerpAngles[0]=n.LerpAngle(r[0],i[0],t),e.lerpAngles[1]=n.LerpAngle(r[1],i[1],t),e.lerpAngles[2]=n.LerpAngle(r[2],i[2],t)}function vr(e){mr(e)}function mr(e){c.UpdateEntityPosition(e.currentState.number,e.lerpOrigin)}function gr(e){var t=e.currentState,r=new l.RefEntity;vec3.set(e.lerpOrigin,r.origin),vec3.set(t.origin2,r.oldOrigin),n.ByteToDir(t.eventParm,r.axis[0]),n.PerpendicularVector(r.axis[0],r.axis[1]),vec3.subtract(n.vec3origin,r.axis[1],r.axis[1]),vec3.cross(r.axis[0],r.axis[1],r.axis[2]),r.reType=ot.PORTALSURFACE,r.oldFrame=t.powerups,r.frame=t.frame,r.skinNum=t.clientNum/256*360,l.AddRefEntityToScene(r)}function yr(e){var t=e.currentState,r=p.ItemList[t.modelIndex],i=It.itemInfo[t.modelIndex];if(!t.modelIndex||t.eFlags&tt.NODRAW)return;var s=new l.RefEntity;s.reType=ot.MODEL;var o=.005+e.currentState.number*1e-5;e.lerpOrigin[2]+=4+Math.cos((It.time+1e3)*o)*4,r.giType===X.HEALTH?vec3.set(It.autoAnglesFast,e.lerpAngles):vec3.set(It.autoAngles,e.lerpAngles),n.AnglesToAxis(e.lerpAngles,s.axis),r.giType===X.WEAPON&&(e.lerpOrigin[0]-=i.weaponMidpoint[0]*s.axis[0][0]+i.weaponMidpoint[1]*s.axis[1][0]+i.weaponMidpoint[2]*s.axis[2][0],e.lerpOrigin[1]-=i.weaponMidpoint[0]*s.axis[0][1]+i.weaponMidpoint[1]*s.axis[1][1]+i.weaponMidpoint[2]*s.axis[2][1],e.lerpOrigin[2]-=i.weaponMidpoint[0]*s.axis[0][2]+i.weaponMidpoint[1]*s.axis[1][2]+i.weaponMidpoint[2]*s.axis[2][2],e.lerpOrigin[2]+=8),s.hModel=i.models.primary,vec3.set(e.lerpOrigin,s.origin),vec3.set(e.lerpOrigin,s.oldOrigin),s.nonNormalizedAxes=!1;var u=It.time-e.miscTime,a=1;u>=0&&u<mt&&(a=u/mt,vec3.scale(s.axis[0],a),vec3.scale(s.axis[1],a),vec3.scale(s.axis[2],a),s.nonNormalizedAxes=!0);if(r.giType===X.WEAPON||r.giType===X.ARMOR)s.renderfx|=ut.MINLIGHT;r.giType===X.WEAPON&&(vec3.scale(s.axis[0],1.5),vec3.scale(s.axis[1],1.5),vec3.scale(s.axis[2],1.5),s.nonNormalizedAxes=!0),l.AddRefEntityToScene(s);if(r.giType===X.HEALTH||r.giType===X.POWERUP)if(i.models.secondary){var f=vec3.create();r.giType===X.POWERUP&&(s.origin[2]+=12,f[1]=It.time%1024*360/-1024),n.AnglesToAxis(f,s.axis),s.hModel=i.models.secondary,a!==1&&(vec3.scale(s.axis[0],a),vec3.scale(s.axis[1],a),vec3.scale(s.axis[2],a),s.nonNormalizedAxes=!0),l.AddRefEntityToScene(s)}}function br(e){var t=e.currentState;t.weapon>=J.NUM_WEAPONS&&(t.weapon=0);var r=sn(X.WEAPON,t.weapon);vec3.set(t.angles,e.lerpAngles);var i;switch(t.weapon){case J.GRENADE_LAUNCHER:i=bs;break;case J.ROCKET_LAUNCHER:i=ys;break;case J.PLASMAGUN:i=ws}i&&i(e,r),r.missileDlightIntensity&&l.AddLightToScene(e.lerpOrigin,r.missileDlightIntensity,r.missileDlightColor[0],r.missileDlightColor[1],r.missileDlightColor[2]),r.missileSound&&c.AddLoopingSound(e.currentState.number,e.lerpOrigin,undefined,weaponInfo.missileSound);var s=new l.RefEntity;vec3.set(e.lerpOrigin,s.origin),vec3.set(e.lerpOrigin,s.oldOrigin);if(e.currentState.weapon===J.PLASMAGUN){s.reType=ot.SPRITE,s.radius=16,s.rotation=0,s.customShader=qt.media.plasmaBallShader,l.AddRefEntityToScene(s);return}s.skinNum=It.clientFrame&1,s.hModel=r.models.missile,s.renderfx=ut.NOSHADOW,vec3.normalize(t.pos.trDelta,s.axis[0]),vec3.length(t.pos.trDelta)===0&&(s.axis[0][2]=1),t.pos.trType!==F.STATIONARY?n.RotateAroundDirection(s.axis,It.time/4):n.RotateAroundDirection(s.axis,t.time),Gr(s,t)}function wr(e){var t=e.currentState,r=new l.RefEntity;r.reType=ot.MODEL,vec3.set(e.lerpOrigin,r.origin),vec3.set(e.lerpOrigin,r.oldOrigin),n.AnglesToAxis(e.lerpAngles,r.axis),r.renderfx=ut.NOSHADOW,r.skinNum=It.time>>6&1,t.solid===v&&(r.hModel=qt.inlineDrawModels[t.modelIndex]),l.AddRefEntityToScene(r)}function Er(e){if(e.currentState.eType>et.EVENTS){if(e.previousEvent)return;e.currentState.eFlags&tt.PLAYER_EVENT&&(e.currentState.number=e.currentState.otherEntityNum),e.previousEvent=1,e.currentState.event=e.currentState.eType-et.EVENTS}else{if(e.currentState.event===e.previousEvent)return;e.previousEvent=e.currentState.event;if((e.currentState.event&~P)===0)return}p.EvaluateTrajectory(e.currentState.pos,It.snap.serverTime,e.lerpOrigin),mr(e),Sr(e,e.lerpOrigin)}function Sr(e,t){var r=e.currentState,i=qt.clientinfo[r.clientNum],s=r.event&~P,o=vec3.create();switch(s){case nt.FOOTSTEP:c.StartSound(null,r.number,qt.media["footstep"+i.footsteps+n.irrandom(0,3)]);break;case nt.STEP_4:case nt.STEP_8:case nt.STEP_12:case nt.STEP_16:if(r.clientNum!==It.predictedPlayerState.clientNum)break;if(It.snap.ps.pm_flags&U.FOLLOW)break;var u=0,a=It.time-It.stepTime;a<pt&&(u=It.stepChange*(pt-a)/pt);var f=4*(s-nt.STEP_4+1);It.stepChange=u+f,It.stepChange>wt&&(It.stepChange=wt),It.stepTime=It.time;break;case nt.JUMP_PAD:var l=vec3.createFrom(0,0,1);ir(e.lerpOrigin,l,32,1,1,1,.33,1e3,It.time,0,Dt.PUFF_DONT_SCALE,qt.media.smokePuffShader),c.StartSound(e.lerpOrigin,-1,qt.media.jumpPadSound),c.StartSound(null,r.number,pi(r.number,"*jump1"));break;case nt.JUMP:c.StartSound(null,r.number,pi(r.number,"*jump1"));break;case nt.WATER_TOUCH:c.StartSound(null,r.number,qt.media.watrInSound);break;case nt.WATER_LEAVE:c.StartSound(null,r.number,qt.media.watrOutSound);break;case nt.WATER_UNDER:c.StartSound(null,r.number,qt.media.watrUnSound);break;case nt.WATER_CLEAR:c.StartSound(null,r.number,pi(r.number,"*gasp"));break;case nt.ITEM_PICKUP:var h=r.eventParm;if(h<1||h>=p.ItemList.length)break;var d=p.ItemList[h],v=It.itemInfo[h];d.giType===X.POWERUP||d.giType===X.TEAM?c.StartSound(null,r.number,qt.media.n_healthSound):c.StartSound(null,r.number,v.sounds.pickup),r.number===It.snap.ps.clientNum&&xr(h);break;case nt.GLOBAL_ITEM_PICKUP:var h=r.eventParm;if(h<1||h>=p.ItemList.length)break;var d=p.ItemList[h],v=It.itemInfo[h];v.sounds.pickup&&c.StartSound(null,It.snap.ps.clientNum,v.sounds.pickup),r.number===It.snap.ps.clientNum&&xr(h);break;case nt.NOAMMO:c.StartSound(null,r.number,qt.media.noAmmoSound),r.number===It.snap.ps.clientNum&&fs();break;case nt.CHANGE_WEAPON:c.StartSound(null,r.number,qt.media.selectSound);break;case nt.FIRE_WEAPON:ls(e);break;case nt.POWERUP_QUAD:var m=sn(X.POWERUP,K.QUAD);c.StartSound(null,r.number,m.sounds.use);break;case nt.POWERUP_BATTLESUIT:var g=sn(X.POWERUP,K.BATTLESUIT);c.StartSound(null,r.number,g.sounds.pickup);break;case nt.POWERUP_REGEN:var y=sn(X.POWERUP,K.REGEN);c.StartSound(null,r.number,y.sounds.use);break;case nt.MISSILE_HIT:n.ByteToDir(r.eventParm,o),hs(r.weapon,t,o,r.otherEntityNum);break;case nt.MISSILE_MISS:n.ByteToDir(r.eventParm,o),cs(r.weapon,0,t,o,Tt.DEFAULT);break;case nt.MISSILE_MISS_METAL:n.ByteToDir(r.eventParm,o),cs(r.weapon,0,t,o,Tt.METAL);break;case nt.RAILTRAIL:e.currentState.weapon=J.RAILGUN,r.clientNum===It.snap.ps.clientNum&&!It.renderingThirdPerson,Ts(i,r.origin2,r.pos.trBase),r.eventParm!==255&&(n.ByteToDir(r.eventParm,o),cs(r.weapon,r.clientNum,t,o,Tt.DEFAULT));break;case nt.BULLET_HIT_FLESH:ps(r.pos.trBase,r.otherEntityNum,o,!0,r.eventParm);break;case nt.BULLET_HIT_WALL:n.ByteToDir(r.eventParm,o),ps(r.pos.trBase,r.otherEntityNum,o,!1,T);break;case nt.SHOTGUN:ms(r);break;case nt.GLOBAL_TEAM_SOUND:switch(r.eventParm){case rt.RED_CAPTURE:It.snap.ps.persistant[Y.TEAM]===Q.RED?an(qt.media.captureYourTeamSound):an(qt.media.captureOpponentSound);break;case rt.BLUE_CAPTURE:It.snap.ps.persistant[Y.TEAM]===Q.BLUE?an(qt.media.captureYourTeamSound):an(qt.media.captureOpponentSound);break;case rt.RED_RETURN:It.snap.ps.persistant[Y.TEAM]===Q.RED?an(qt.media.returnYourTeamSound):an(qt.media.returnOpponentSound),an(qt.media.blueFlagReturnedSound);break;case rt.BLUE_RETURN:It.snap.ps.persistant[Y.TEAM]==Q.BLUE?an(qt.media.returnYourTeamSound):an(qt.media.returnOpponentSound),an(qt.media.redFlagReturnedSound);break;case rt.RED_TAKEN:!It.snap.ps.powerups[K.BLUEFLAG]&&!It.snap.ps.powerups[K.NEUTRALFLAG]&&(It.snap.ps.persistant[Y.TEAM]===Q.BLUE?qt.gametype==z.NFCTF?an(qt.media.yourTeamTookTheFlagSound):an(qt.media.enemyTookYourFlagSound):It.snap.ps.persistant[Y.TEAM]===Q.RED&&(qt.gametype==z.NFCTF?an(qt.media.enemyTookTheFlagSound):an(qt.media.yourTeamTookEnemyFlagSound)));break;case rt.BLUE_TAKEN:!It.snap.ps.powerups[K.REDFLAG]&&!It.snap.ps.powerups[K.NEUTRALFLAG]&&(It.snap.ps.persistant[Y.TEAM]==Q.RED?qt.gametype==z.NFCTF?an(qt.media.yourTeamTookTheFlagSound):an(qt.media.enemyTookYourFlagSound):It.snap.ps.persistant[Y.TEAM]==Q.BLUE&&(qt.gametype==z.NFCTF?an(qt.media.enemyTookTheFlagSound):an(qt.media.yourTeamTookEnemyFlagSound)));break;case rt.REDTEAM_SCORED:an(qt.media.redScoredSound);break;case rt.BLUETEAM_SCORED:an(qt.media.blueScoredSound);break;case rt.REDTEAM_TOOK_LEAD:an(qt.media.redLeadsSound);break;case rt.BLUETEAM_TOOK_LEAD:an(qt.media.blueLeadsSound);break;case rt.TEAMS_ARE_TIED:an(qt.media.teamsTiedSound);break;default:}break;case nt.PAIN:e.currentState.number!==It.snap.ps.clientNum&&Nr(e,r.eventParm);break;case nt.DEATH1:case nt.DEATH2:case nt.DEATH3:break;case nt.OBITUARY:Cr(r);break;case nt.PLAYER_TELEPORT_IN:c.StartSound(null,r.number,qt.media.teleInSound),rr(t);break;case nt.PLAYER_TELEPORT_OUT:c.StartSound(null,r.number,qt.media.teleOutSound),rr(t);break;case nt.ITEM_POP:c.StartSound(null,r.number,qt.media.respawnSound);break;case nt.ITEM_RESPAWN:e.miscTime=It.time,c.StartSound(null,r.number,qt.media.respawnSound);break;case nt.GRENADE_BOUNCE:var v=sn(X.WEAPON,J.GRENADE_LAUNCHER);n.irrandom(0,1)?c.StartSound(null,r.number,v.sounds.bounce0):c.StartSound(null,r.number,v.sounds.bounce1);break;case nt.GIB_PLAYER:ar(e);break;case nt.GENERAL_SOUND:break;case nt.GLOBAL_SOUND:break;case nt.STOPLOOPINGSOUND:c.StopLoopingSound(r.number),r.loopSound=0}}function xr(e){It.itemPickup=e,It.itemPickupTime=It.time,It.itemPickupBlendTime=It.time,p.ItemList[e].giType===X.WEAPON&&Nn()&&p.ItemList[e].giTag!==J.MACHINEGUN&&(It.weaponSelectTime=It.time,It.weaponSelect=p.ItemList[e].giTag)}function Tr(e){var t=e.currentState.legsAnim&~D,n;return t===it.LEGS_WALKCR||t===it.LEGS_IDLECR?n=M:n=O,p.GetWaterLevel(e.lerpOrigin,n,wi)}function Nr(e,t){if(It.time-e.pe.painTime<500)return;var r;t<25?r="*pain25_1":t<50?r="*pain50_1":t<75?r="*pain75_1":r="*pain100_1",Tr(e)>=1?n.irrandom(0,1)?c.StartSound(null,e.currentState.number,qt.media.gurp1Sound):c.StartSound(null,e.currentState.number,qt.media.gurp2Sound):c.StartSound(null,e.currentState.number,pi(e.currentState.number,r)),e.pe.painTime=It.time,e.pe.painDirection^=1}function Cr(e){var t=e.otherEntityNum,n=e.otherEntityNum2,r=e.eventParm,i=qt.clientinfo[t];(t<0||t>=y)&&Xt("Obituary: target out of range");var s=on("player"+t);if(!s)return;var o=s.name,u,a;switch(r){case st.SUICIDE:u="suicides";break;case st.FALLING:u="cratered";break;case st.CRUSH:u="was squished";break;case st.WATER:u="sank like a rock";break;case st.SLIME:u="melted";break;case st.LAVA:u="does a back flip into the lava";break;case st.TARGET_LASER:u="saw the light";break;case st.TRIGGER_HURT:u="was in the wrong place";break;default:u=null}if(n===t){var f=i.gender;switch(r){case st.GRENADE_SPLASH:f===Nt.FEMALE?u="tripped on her own grenade":f===Nt.NEUTER?u="tripped on its own grenade":u="tripped on his own grenade";break;case st.ROCKET_SPLASH:f===Nt.FEMALE?u="blew herself up":f===Nt.NEUTER?u="blew itself up":u="blew himself up";break;case st.PLASMA_SPLASH:f===Nt.FEMALE?u="melted herself":f===Nt.NEUTER?u="melted itself":u="melted himself";break;case st.BFG_SPLASH:u="should have used a smaller gun";break;default:f==Nt.FEMALE?u="killed herself":f==Nt.NEUTER?u="killed itself":u="killed himself"}}if(u){Wt("print",o+" "+u);return}var l;n<0||n>=y?(n=T,l=null):l=on("player"+n);var c;l?(c=l.name,t===It.snap.ps.clientNum):(n=T,c="noname");if(n!==T){switch(r){case st.GRAPPLE:u="was caught by";break;case st.GAUNTLET:u="was pummeled by";break;case st.MACHINEGUN:u="was machinegunned by";break;case st.SHOTGUN:u="was gunned down by";break;case st.GRENADE:u="ate",a="'s grenade";break;case st.GRENADE_SPLASH:u="was shredded by",a="'s shrapnel";break;case st.ROCKET:u="ate",a="'s rocket";break;case st.ROCKET_SPLASH:u="almost dodged",a="'s rocket";break;case st.PLASMA:u="was melted by",a="'s plasmagun";break;case st.PLASMA_SPLASH:u="was melted by",a="'s plasmagun";break;case st.RAILGUN:u="was railed by";break;case st.LIGHTNING:u="was electrocuted by";break;case st.BFG:case st.BFG_SPLASH:u="was blasted by",a="'s BFG";break;case st.TELEFRAG:u="tried to invade",a="'s personal space";break;default:u="was killed by"}if(u){Wt("print",o+" "+u+" "+c+(a||"")+".");return}}Wt("print",o+" died.")}function kr(){It.localEntities=new Array(ht);for(var e=ht-1;e>=0;e--)It.localEntities[e]=new Bt,It.localEntities[e].idx=e,It.localEntities[e].next=e===ht-1?null:It.localEntities[e+1];It.activeLocalEntities=new Bt,It.activeLocalEntities.next=It.activeLocalEntities,It.activeLocalEntities.prev=It.activeLocalEntities,It.freeLocalEntities=It.localEntities[0]}function Lr(){It.freeLocalEntities||Ar(It.activeLocalEntities.prev);var e=It.freeLocalEntities;return It.freeLocalEntities=It.freeLocalEntities.next,e.reset(),e.next=It.activeLocalEntities.next,e.prev=It.activeLocalEntities,It.activeLocalEntities.next.prev=e,It.activeLocalEntities.next=e,e}function Ar(e){e.prev||Xt("FreeLocalEntity: not active"),e.prev.next=e.next,e.next.prev=e.prev,e.next=It.freeLocalEntities,It.freeLocalEntities=e}function Or(){var e,t;e=It.activeLocalEntities.prev;for(;e!=It.activeLocalEntities;e=t){t=e.prev;if(It.time>=e.endTime){Ar(e);continue}switch(e.leType){case _t.MARK:qr(e);break;case _t.EXPLOSION:Rr(e);break;case _t.SPRITE_EXPLOSION:Ur(e);break;case _t.FRAGMENT:Mr(e);break;case _t.MOVE_SCALE_FADE:jr(e);break;case _t.FADE_RGB:Br(e);break;case _t.FALL_SCALE_FADE:Ir(e);break;case _t.SCALE_FADE:Fr(e)}}}function Mr(e){var t=e.refent;if(e.pos.trType===F.STATIONARY){var r=e.endTime-It.time;if(r<bt){vec3.set(t.origin,t.lightingOrigin),t.renderfx|=ut.LIGHTING_ORIGIN;var i=t.origin[2];t.origin[2]-=16*(1-r/bt),l.AddRefEntityToScene(t),t.origin[2]=i}else l.AddRefEntityToScene(t);return}var s=vec3.create();p.EvaluateTrajectory(e.pos,It.time,s);var o=bi(t.origin,s,null,null,-1,q.SOLID);if(o.fraction===1){vec3.set(s,t.origin);if(e.leFlags&Dt.TUMBLE){var u=vec3.createFrom(0,0,0);p.EvaluateTrajectory(e.angles,It.time,u),n.AnglesToAxis(u,t.axis)}l.AddRefEntityToScene(t),e.leBounceSoundType===Ht.BLOOD&&_r(e);return}if(wi(o.endPos,0)&q.NODROP){Ar(e);return}Dr(e,o),Pr(e,o),Hr(e,o),l.AddRefEntityToScene(t)}function _r(e){var t=150,r=t*Math.floor((It.time-It.frameTime+t)/t),i=t*Math.floor(It.time/t),s=vec3.create();for(;r<=i;r+=t){p.EvaluateTrajectory(e.pos,r,s);var o=ir(s,n.vec3origin,20,1,1,1,1,2e3,r,0,0,qt.media.bloodTrailShader);o.leType=_t.FALL_SCALE_FADE,o.pos.trDelta[2]=40}}function Dr(e,t){if(e.leMarkType===Pt.BLOOD){var r=16+n.irrandom(0,31);nr(qt.media.bloodMarkShader,t.endPos,t.plane.normal,n.rrandom(0,360),1,1,1,1,!0,r,!1)}else if(e.leMarkType===Pt.BURN){var r=8+n.irrandom(0,15);nr(qt.media.burnMarkShader,t.endPos,t.plane.normal,n.rrandom(0,360),1,1,1,1,!0,r,!1)}e.leMarkType=Pt.NONE}function Pr(e,t){if(e.leBounceSoundType===Ht.BLOOD){if(n.irrandom(0,1)){var r=n.irrandom(0,2),i;r===0?i=qt.media.gibBounce1Sound:r===1?i=qt.media.gibBounce2Sound:i=qt.media.gibBounce3Sound,c.StartSound(t.endPos,-1,i)}}else e.leBounceSoundType===Ht.BRASS;e.leBounceSoundType=Ht.NONE}function Hr(e,t){var n=It.time-It.frameTime+It.frameTime*t.fraction,r=vec3.create();p.EvaluateTrajectoryDelta(e.pos,n,r),vec3.set(t.endPos,e.pos.trBase);var i=vec3.dot(r,t.plane.normal);vec3.add(r,vec3.scale(t.plane.normal,-2*i,vec3.create()),e.pos.trDelta),vec3.scale(e.pos.trDelta,e.bounceFactor),e.pos.trTime=It.time;if(t.allSolid||t.plane.normal[2]>0&&(e.pos.trDelta[2]<40||e.pos.trDelta[2]<-It.frameTime*e.pos.trDelta[2]))e.pos.trType=F.STATIONARY}function Br(e){var t=e.refent,n=(e.endTime-It.time)/(e.endTime-e.startTime);t.shaderRGBA[0]=e.color[0]*n,t.shaderRGBA[1]=e.color[1]*n,t.shaderRGBA[2]=e.color[2]*n,t.shaderRGBA[3]=e.color[3]*n,l.AddRefEntityToScene(t)}function jr(e){var t=e.refent,n;e.fadeTime>e.startTime&&It.time<e.fadeTime?n=1-(e.fadeTime-It.time)/(e.fadeTime-e.startTime):n=(e.endTime-It.time)/(e.endTime-e.startTime),t.shaderRGBA[3]=e.color[3]*n,e.leFlags&Dt.PUFF_DONT_SCALE||(t.radius=e.radius*(1-n)+8),p.EvaluateTrajectory(e.pos,It.time,t.origin);var r=vec3.subtract(t.origin,It.refdef.vieworg,vec3.create()),i=vec3.length(r);if(i<e.radius){Ar(e);return}l.AddRefEntityToScene(t)}function Fr(e){var t=e.refent,n=(e.endTime-It.time)/(e.endTime-e.startTime);t.shaderRGBA[3]=e.color[3]*n,t.radius=e.radius*(1-n)+8;var r=vec3.subtract(t.origin,It.refdef.vieworg,vec3.create()),i=vec3.length(r);if(i<e.radius){Ar(e);return}l.AddRefEntityToScene(t)}function Ir(e){var t=e.refent,n=(e.endTime-It.time)/(e.endTime-e.startTime);t.shaderRGBA[3]=e.color[3]*n,t.origin[2]=e.pos.trBase[2]-(1-n)*e.pos.trDelta[2],t.radius=e.radius*(1-n)+16;var r=vec3.subtract(t.origin,It.refdef.vieworg,vec3.create()),i=vec3.length(r);if(i<e.radius){Ar(e);return}l.AddRefEntityToScene(t)}function qr(e){var t=e.refent,n=(e.endTime-It.time)/(e.endTime-e.fadeTime);n>1&&(n=1);if(e.alphaFade)for(var r=0;r<t.polyVerts.length;r++)t.polyVerts[r].modulate[3]=n;else for(var r=0;r<t.polyVerts.length;r++)t.polyVerts[r].modulate[0]=e.color[0]*n,t.polyVerts[r].modulate[1]=e.color[1]*n,t.polyVerts[r].modulate[2]=e.color[2]*n;l.AddRefEntityToScene(t)}function Rr(e){var t=e.refent;l.AddRefEntityToScene(t);if(e.light){var n=(It.time-e.startTime)/(e.endTime-e.startTime);n<.5?n=1:n=1-(n-.5)*2,n=e.light*n,l.AddLightToScene(t.origin,n,e.lightColor[0],e.lightColor[1],e.lightColor[2])}}function Ur(e){var t=e.refent,n=(e.endTime-It.time)/(e.endTime-e.startTime);n>1&&(n=1),t.shaderRGBA[0]=1,t.shaderRGBA[1]=1,t.shaderRGBA[2]=1,t.shaderRGBA[3]=.33*n,t.reType=ot.SPRITE,t.radius=42*(1-n)+30,l.AddRefEntityToScene(t);if(e.light){var r=(It.time-e.startTime)/(e.endTime-e.startTime);r<.5?r=1:r=1-(r-.5)*2,r=e.light*r,l.AddLightToScene(t.origin,r,e.lightColor[0],e.lightColor[1],e.lightColor[2])}}function zr(e,t){var n=qt.clientinfo[e],r=on("player"+e);if(!r)return;n.name=r.name,n.team=r.team,Wr(e,n,t)}function Wr(e,t,n){var r="default";qt.gametype>=z.TEAM&&(t.team===Q.BLUE?r="blue":r="red"),Xr(t,lt,"default",r,function(e){e&&Xt("DEFAULT_MODEL ("+lt+") failed to register."),t.infoValid=!0,n&&n()})}function Xr(e,t,n,r,i){var s=!1,o=!1,u=!1,a=!1,f=function(){if(!s||!o||!u||!a)return;i(null)};Vr(e,t,function(){s=!0,f()}),$r(e,t,n,r,function(){o=!0,f()}),Jr(e,t,function(){u=!0,f()}),Kr(e,t,function(){a=!0,f()})}function Vr(t,n,r){var i={legsModel:"models/players/"+n+"/lower.md3",torsoModel:"models/players/"+n+"/upper.md3",headModel:"models/players/"+n+"/head.md3"},s=Object.keys(i).length,o=0;e.each(i,function(e,n){l.RegisterModel(e,function(e){t[n]=e,++o===s&&r()})})}function $r(t,n,r,i,s){var o={legsSkin:"models/players/"+n+"/lower_"+i+".skin",torsoSkin:"models/players/"+n+"/upper_"+i+".skin",headSkin:"models/players/"+n+"/head_"+i+".skin"},u=Object.keys(o).length,a=0;e.each(o,function(e,n){l.RegisterSkin(e,function(e){t[n]=e,++a===u&&s()})})}function Jr(t,n,r){var i=hi.length,s=0;e.each(hi,function(e,o){var u="sound/player/"+n+"/"+e.substr(1);c.RegisterSound(u,function(e){t.sounds[o]=e,++s===i&&r()})})}function Kr(t,n,i){var s="models/players/"+n+"/animation.cfg",u=t.animations,a=0;o.ReadFile(s,"utf8",function(n,o){if(n)return i(n);t.footsteps=xt.NORMAL,t.gender=Nt.MALE,t.fixedlegs=!1,t.fixedtorso=!1;var f=new r(o),l;while(!f.EOF()){l=f.next();if(!l)break;if(l==="footsteps"){l=f.next();if(!l)break;l==="default"||l==="normal"?t.footsteps=it.FOOTSTEP_NORMAL:l==="boot"?t.footsteps=it.FOOTSTEP_BOOT:l==="flesh"?t.footsteps=it.FOOTSTEP_FLESH:l==="mech"?t.footsteps=it.FOOTSTEP_MECH:l==="energy"?t.footsteps=it.FOOTSTEP_ENERGY:Wt("Bad footsteps parm in "+s+": "+l);continue}if(l==="headoffset"){for(var c=0;c<3;c++){l=f.next();if(!l)break}continue}if(l==="sex"){l=f.next();if(!l)break;l.charAt(0)==="f"||l.charAt(0)==="F"?t.gender=Nt.FEMALE:l.charAt(0)==="n"||l.charAt(0)==="N"?t.gender=Nt.NEUTER:t.gender=Nt.MALE;continue}if(l==="fixedlegs"){t.fixedlegs=!0;continue}if(l==="fixedtorso"){t.fixedtorso=!0;continue}if(l.charAt(0)>="0"&&l.charAt(0)<="9"){f.prev();break}Wt("Unknown token '"+l+"' in "+s)}for(var c=0;c<it.MAX;c++){l=f.next();if(!l){if(c>=it.TORSO_GETFLAG&&c<=it.TORSO_NEGATIVE){u[c].firstFrame=u[it.TORSO_GESTURE].firstFrame,u[c].frameLerp=u[it.TORSO_GESTURE].frameLerp,u[c].initialLerp=u[it.TORSO_GESTURE].initialLerp,u[c].loopFrames=u[it.TORSO_GESTURE].loopFrames,u[c].numFrames=u[it.TORSO_GESTURE].numFrames,u[c].reversed=!1,u[c].flipflop=!1;continue}break}u[c].firstFrame=parseInt(l,10),c===it.LEGS_WALKCR&&(a=u[it.LEGS_WALKCR].firstFrame-u[it.TORSO_GESTURE].firstFrame),c>=it.LEGS_WALKCR&&c<it.TORSO_GETFLAG&&(u[c].firstFrame-=a),l=f.next();if(!l)break;u[c].numFrames=parseInt(l,10),u[c].reversed=!1,u[c].flipflop=!1,u[c].numFrames<0&&(u[c].numFrames=-u[c].numFrames,u[c].reversed=!0),l=f.next();if(!l)break;u[c].loopFrames=parseInt(l,10),l=f.next();if(!l)break;var h=parseInt(l,10);h||(h=1),u[c].frameLerp=1e3/h,u[c].initialLerp=1e3/h}return c!==it.MAX?i(new Error("Error parsing animation file: "+s)):(u[it.LEGS_BACKCR]=e.clone(u[it.LEGS_WALKCR]),u[it.LEGS_BACKCR].reversed=!0,u[it.LEGS_BACKWALK]=e.clone(u[it.LEGS_WALK]),u[it.LEGS_BACKWALK].reversed=!0,u[it.FLAG_RUN].firstFrame=0,u[it.FLAG_RUN].numFrames=16,u[it.FLAG_RUN].loopFrames=16,u[it.FLAG_RUN].frameLerp=1e3/15,u[it.FLAG_RUN].initialLerp=1e3/15,u[it.FLAG_RUN].reversed=!1,u[it.FLAG_STAND].firstFrame=16,u[it.FLAG_STAND].numFrames=5,u[it.FLAG_STAND].loopFrames=0,u[it.FLAG_STAND].frameLerp=50,u[it.FLAG_STAND].initialLerp=50,u[it.FLAG_STAND].reversed=!1,u[it.FLAG_STAND2RUN].firstFrame=16,u[it.FLAG_STAND2RUN].numFrames=5,u[it.FLAG_STAND2RUN].loopFrames=1,u[it.FLAG_STAND2RUN].frameLerp=1e3/15,u[it.FLAG_STAND2RUN].initialLerp=1e3/15,u[it.FLAG_STAND2RUN].reversed=!0,i(null))})}function Qr(e){var t=e.currentState.clientNum;(t<0||t>=y)&&Xt("Bad clientNum on player entity");var n=qt.clientinfo[t];if(!n.infoValid)return;var r=0;e.currentState.number===It.snap.ps.clientNum&&(It.renderingThirdPerson||(r=ut.THIRD_PERSON));var i=new l.RefEntity,s=new l.RefEntity,o=new l.RefEntity;ri(e,i.axis,s.axis,o.axis),ai(e,i,s);var u=ui(e);r|=ut.LIGHTING_ORIGIN,i.reType=ot.MODEL,i.renderfx=r,i.hModel=n.legsModel,i.customSkin=n.legsSkin,vec3.set(e.lerpOrigin,i.origin),vec3.set(e.lerpOrigin,i.lightingOrigin),i.renderfx=r,vec3.set(i.origin,i.oldOrigin),Gr(i,e.currentState,n.team);if(!i.hModel)return;s.reType=ot.MODEL,s.renderfx=r,s.hModel=n.torsoModel;if(!s.hModel)return;s.customSkin=n.torsoSkin,hr(s,i,n.legsModel,"tag_torso"),vec3.set(e.lerpOrigin,s.lightingOrigin),s.renderfx=r,Gr(s,e.currentState,n.team),o.reType=ot.MODEL,o.renderfx=r,o.hModel=n.headModel;if(!o.hModel)return;o.customSkin=n.headSkin,hr(o,s,n.torsoModel,"tag_head"),vec3.set(e.lerpOrigin,o.lightingOrigin),o.renderfx=r,Gr(o,e.currentState,n.team),ts(s,null,e),Yr(e,s)}function Gr(e,t,n){t.powerups&1<<K.INVIS?(e.customShader=qt.media.invisShader,l.AddRefEntityToScene(e)):(l.AddRefEntityToScene(e),t.powerups&1<<K.QUAD&&(n===Q.RED?ent.customShader=qt.media.redQuadShader:e.customShader=qt.media.quadShader,l.AddRefEntityToScene(e)),t.powerups&1<<K.REGEN&&It.time/100%10===1&&(e.customShader=qt.media.regenShader,l.AddRefEntityToScene(e)),t.powerups&1<<K.BATTLESUIT&&(e.customShader=qt.media.battleSuitShader,l.AddRefEntityToScene(e)))}function Yr(e,t){var r=e.currentState.powerups;if(!r)return;r&1<<K.QUAD&&l.AddLightToScene(e.lerpOrigin,200+n.irrandom(0,31),.2,.2,1);if(r&1<<K.FLIGHT){var i=sn(X.POWERUP,K.FLIGHT);c.AddLoopingSound(e.currentState.number,e.lerpOrigin,n.vec3origin,i.sounds.pickup)}var s=qt.clientinfo[e.currentState.clientNum];if(r&1<<K.REDFLAG){var o=sn(X.TEAM,K.REDFLAG);Zr(e,o.models.primary),l.AddLightToScene(e.lerpOrigin,200+n.irrandom(0,31),1,.2,.2)}if(r&1<<K.BLUEFLAG){var u=sn(X.TEAM,K.BLUEFLAG);Zr(e,u.models.primary),l.AddLightToScene(e.lerpOrigin,200+n.irrandom(0,31),.2,.2,1)}if(r&1<<K.NEUTRALFLAG){var a=sn(X.TEAM,K.NEUTRALFLAG);Zr(e,a.models.primary),l.AddLightToScene(e.lerpOrigin,200+n.irrandom(0,31),1,1,1)}r&1<<K.HASTE&&ei(e)}function Zr(e,t){var r=new l.RefEntity,i=vec3.create(e.lerpAngles);i[n.PITCH]=0,i[n.ROLL]=0,n.AnglesToAxis(i,r.axis),vec3.add(vec3.scale(r.axis[0],-16,r.origin),e.lerpOrigin),r.origin[2]+=16,i[n.YAW]+=90,n.AnglesToAxis(i,r.axis),r.hModel=t,l.AddRefEntityToScene(r)}function ei(e){if(e.trailTime>It.time)return;var t=e.pe.legs.animationNumber&~D;if(t!==it.LEGS_RUN&&t!==it.LEGS_BACK)return;e.trailTime+=100,e.trailTime<It.time&&(e.trailTime=It.time);var r=vec3.create(e.lerpOrigin);r[2]-=16;var i=ir(r,n.vec3origin,8,1,1,1,1,500,It.time,0,0,qt.media.hastePuffShader);i.leType=_t.SCALE_FADE}function ri(e,t,r,i){var s,o=e.currentState.clientNum;o>=0&&o<y&&(s=qt.clientinfo[o]);var u=vec3.create(e.lerpAngles),a=u[n.YAW];u[n.YAW]=n.AngleNormalize360(u[n.YAW]);var f=vec3.create(),l=vec3.create();if((e.currentState.legsAnim&~D)!==it.LEGS_IDLE||(e.currentState.torsoAnim&~D)!==it.TORSO_STAND&&(e.currentState.torsoAnim&~D)!==it.TORSO_STAND2)e.pe.torso.yawing=!0,e.pe.torso.pitching=!0,e.pe.legs.yawing=!0;var c;e.currentState.eFlags&tt.DEAD?c=0:(c=e.currentState.angles2[n.YAW],(c<0||c>7)&&Xt("Bad player movement angle")),l[n.YAW]=u[n.YAW]+ni[c],f[n.YAW]=u[n.YAW]+.25*ni[c];var h={angle:e.pe.torso.yawAngle,swinging:e.pe.torso.yawing};ii(f[n.YAW],25,90,ti,h),f[n.YAW]=e.pe.torso.yawAngle=h.angle,e.pe.torso.yawing=h.swinging,h={angle:e.pe.legs.yawAngle,swinging:e.pe.legs.yawing},ii(l[n.YAW],40,90,ti,h),l[n.YAW]=e.pe.legs.yawAngle=h.angle,e.pe.legs.yawing=h.swinging;var p;u[n.PITCH]>180?p=(-360+u[n.PITCH])*.75:p=u[n.PITCH]*.75,h={angle:e.pe.torso.pitchAngle,swinging:e.pe.torso.pitching},ii(p,15,30,.1,h),f[n.PITCH]=e.pe.torso.pitchAngle=h.angle,e.pe.torso.pitching=h.swinging,s&&s.fixedtorso&&(f[n.PITCH]=0);var d=vec3.create(e.currentState.pos.trDelta),v=vec3.length(d);vec3.normalize(d);if(v){v*=.05;var m=[vec3.create(),vec3.create(),vec3.create()];n.AnglesToAxis(l,m);var g=v*vec3.dot(d,m[1]);l[n.ROLL]-=g,g=v*vec3.dot(d,m[0]),l[n.PITCH]+=g}s&&s.fixedlegs&&(l[n.YAW]=f[n.YAW],l[n.PITCH]=0,l[n.ROLL]=0),si(e,f),n.AnglesSubtract(u,f,u),n.AnglesSubtract(f,l,f),n.AnglesToAxis(l,t),n.AnglesToAxis(f,r),n.AnglesToAxis(u,i)}function ii(e,t,r,i,s){var o,u,a;if(!s.swinging){o=n.AngleSubtract(s.angle,e);if(o>t||o<-t)s.swinging=!0}if(!s.swinging)return;o=n.AngleSubtract(e,s.angle),a=Math.abs(o),a<t*.5?a=.5:a<t?a=1:a=2,o>=0?(u=It.frameTime*a*i,u>=o&&(u=o,s.swinging=!1),s.angle=n.AngleNormalize360(s.angle+u)):o<0&&(u=It.frameTime*a*-i,u<=o&&(u=o,s.swinging=!1),s.angle=n.AngleNormalize360(s.angle+u)),o=n.AngleSubtract(e,s.angle),o>r?s.angle=n.AngleNormalize360(e-(r-1)):o<-r&&(s.angle=n.AngleNormalize360(e+(r-1)))}function si(e,t){var r=It.time-e.pe.painTime;if(r>=vt)return;var i=1-r/vt;e.pe.painDirection?t[n.ROLL]+=20*i:t[n.ROLL]-=20*i}function ui(e){if(e.currentState.powerups&1<<K.INVIS)return!1;var t=vec3.createFrom(-15,-15,0),n=vec3.createFrom(15,15,2),r=vec3.create(e.lerpOrigin);r[2]-=oi;var i=f.BoxTrace(e.lerpOrigin,r,t,n,0,V.PLAYERSOLID);if(i.fraction===1||i.startSolid||i.allSolid)return!1;var s=1-i.fraction;return nr(qt.media.shadowMarkShader,i.endPos,i.plane.normal,e.pe.legs.yawAngle,s,s,s,1,!1,24,!0),!0}function ai(e,t,n){var r=e.currentState.clientNum,i=qt.clientinfo[r],s=1;e.currentState.powerups&1<<K.HASTE&&(s=1.5),e.pe.legs.yawing&&(e.currentState.legsAnim&~D)===it.LEGS_IDLE?fi(i,e.pe.legs,it.LEGS_TURN,s):fi(i,e.pe.legs,e.currentState.legsAnim,s),t.oldFrame=e.pe.legs.oldFrame,t.frame=e.pe.legs.frame,t.backlerp=e.pe.legs.backlerp,fi(i,e.pe.torso,e.currentState.torsoAnim,s),n.oldFrame=e.pe.torso.oldFrame,n.frame=e.pe.torso.frame,n.backlerp=e.pe.torso.backlerp}function fi(e,t,n,r){(n!==t.animationNumber||!t.animation)&&li(e,t,n);if(It.time>=t.frameTime){t.oldFrame=t.frame,t.oldFrameTime=t.frameTime;var i=t.animation;if(!i.frameLerp)return;It.time<t.animationTime?t.frameTime=t.animationTime:t.frameTime=t.oldFrameTime+i.frameLerp;var s=parseInt((t.frameTime-t.animationTime)/i.frameLerp*r,10),o=i.numFrames;i.flipflop&&(o*=2),s>=o&&(s-=o,i.loopFrames?(s%=i.loopFrames,s+=i.numFrames-i.loopFrames):(s=o-1,t.frameTime=It.time)),i.reversed?t.frame=i.firstFrame+i.numFrames-1-s:i.flipflop&&s>=i.numFrames?t.frame=i.firstFrame+i.numFrames-1-s%i.numFrames:t.frame=i.firstFrame+s,It.time>t.frameTime&&(t.frameTime=It.time)}t.frameTime>It.time+200&&(t.frameTime=It.time),t.oldFrameTime>It.time&&(t.oldFrameTime=It.time),t.frameTime===t.oldFrameTime?t.backlerp=0:t.backlerp=1-(It.time-t.oldFrameTime)/(t.frameTime-t.oldFrameTime)}function li(e,t,n){t.animationNumber=n,n&=~D,(n<0||n>=it.MAX_TOTALANIMATIONS)&&Xt("Bad animation number: "+n);var r=e.animations[n];t.animation=r,t.animationTime=t.frameTime+r.initialLerp}function ci(e,t,n){t.frameTime=t.oldFrameTime=It.time,li(e,t,n),t.oldFrame=t.frame=t.animation.firstFrame}function pi(e,t){if(e<0||e>=y)e=0;var n=qt.clientinfo[e];for(var r=0;r<hi.length;r++)if(hi[r]===t)return n.sounds[r];return Xt("Unknown custom sound:",t),0}function di(e,t){e.persistant[Y.SPAWN_COUNT]!==t.persistant[Y.SPAWN_COUNT]&&gi(),It.mapRestart&&(gi(),It.mapRestart=!1),It.snap.ps.pm_type!==R.INTERMISSION&&e.persistant[Y.SPECTATOR_STATE]===G.NOT&&vi(e,t),mi(e,t),e.viewheight!=t.viewheight&&(It.duckChange=e.viewheight-t.viewheight,It.duckTime=It.time)}function vi(e,t){if(e.persistant[Y.TEAM]!==t.persistant[Y.TEAM])return;e.persistant[Y.HITS]>t.persistant[Y.HITS]?c.StartLocalSound(qt.media.hitSound):e.persistant[Y.HITS]<t.persistant[Y.HITS]&&c.StartLocalSound(qt.media.hitTeamSound),e.stats[$.HEALTH]<t.stats[$.HEALTH]-1&&e.stats[$.HEALTH]>0&&Nr(It.predictedPlayerEntity,e.stats[$.HEALTH]);if(It.intermissionStarted)return;qt.gametype>z.TEAM&&(e.powerups[K.REDFLAG]!==t.powerups[K.REDFLAG]&&e.powerups[K.REDFLAG]||e.powerups[K.BLUEFLAG]!==t.powerups[K.BLUEFLAG]&&e.powerups[K.BLUEFLAG]||e.powerups[K.NEUTRALFLAG]!==t.powerups[K.NEUTRALFLAG]&&e.powerups[K.NEUTRALFLAG])&&c.StartLocalSound(qt.media.youHaveFlagSound);if(qt.timelimit>0){var n=It.time-qt.levelStartTime;!(It.timelimitWarnings&4)&&n>(qt.timelimit*60+2)*1e3?(It.timelimitWarnings|=7,c.StartLocalSound(qt.media.suddenDeathSound)):!(It.timelimitWarnings&2)&&n>(qt.timelimit-1)*60*1e3?(It.timelimitWarnings|=3,c.StartLocalSound(qt.media.oneMinuteSound)):qt.timelimit>5&&!(It.timelimitWarnings&1)&&n>(qt.timelimit-5)*60*1e3&&(It.timelimitWarnings|=1,c.StartLocalSound(qt.media.fiveMinuteSound))}if(qt.fraglimit>0&&qt.gametype<z.CTF){var r=qt.score1.s;qt.gametype===z.TEAM&&qt.scores2>r&&(r=qt.score2.s),!(It.fraglimitWarnings&4)&&r===qt.fraglimit-1?(It.fraglimitWarnings|=7,an(qt.media.oneFragSound)):qt.fraglimit>2&&!(It.fraglimitWarnings&2)&&r===qt.fraglimit-2?(It.fraglimitWarnings|=3,an(qt.media.twoFragSound)):qt.fraglimit>3&&!(It.fraglimitWarnings&1)&&r===qt.fraglimit-3&&(It.fraglimitWarnings|=1,an(qt.media.threeFragSound))}}function mi(e,t){var n;e.externalEvent&&e.externalEvent!=t.externalEvent&&(n=It.entities[e.clientNum],n.currentState.event=e.externalEvent,n.currentState.eventParm=e.externalEventParm,Sr(n,n.lerpOrigin)),n=It.predictedPlayerEntity;for(var r=e.eventSequence-S;r<e.eventSequence;r++)if(r>=t.eventSequence||r>t.eventSequence-S&&e.events[r&S-1]!==t.events[r&S-1])n.currentState.event=e.events[r&S-1],n.currentState.eventParm=e.eventParms[r&S-1],Sr(n,n.lerpOrigin)}function gi(){It.thisFrameTeleport=!0,It.weaponSelectTime=It.time,It.weaponSelect=It.snap.ps.weapon}function yi(){It.numSolidEntities=0,It.numTriggerEntities=0;var e;It.nextSnap&&!It.nextFrameTeleport&&!It.thisFrameTeleport?e=It.nextSnap:e=It.snap;for(var t=0;t<e.numEntities;t++){var n=It.entities[e.entities[t].number],r=n.currentState;if(r.eType===et.ITEM||r.eType==et.PUSH_TRIGGER||r.eType===et.TELEPORT_TRIGGER){It.triggerEntities[It.numTriggerEntities++]=n;continue}if(n.nextState.solid){It.solidEntities[It.numSolidEntities++]=n;continue}}}function bi(e,t,n,r,i,s){var o=f.BoxTrace(e,t,n,r,0,s);return o.entityNum=o.fraction!==1?T:x,Ei(o,e,t,n,r,i,s),o}function wi(e,t){var n=f.PointContents(e,0);for(var r=0;r<It.numSolidEntities;r++){var i=It.solidEntities[r],s=i.currentState;if(s.number===t)continue;if(s.solid!==v)continue;var o=f.InlineModel(s.modelIndex);if(!o)continue;n|=f.TransformedPointContents(e,o,i.lerpOrigin,i.lerpAngles)}return n}function Ei(e,t,n,r,i,s,o){var u=vec3.create(),a=vec3.create();for(var l=0;l<It.numSolidEntities;l++){var c=It.solidEntities[l],h=c.currentState;if(h.number===s)continue;var d;if(h.solid===v)d=f.InlineModel(h.modelIndex),vec3.set(c.lerpAngles,a),p.EvaluateTrajectory(c.currentState.pos,It.physicsTime,u);else{var m=h.solid&255,g=h.solid>>8&255,y=(h.solid>>16&255)-32,b=vec3.create(),w=vec3.create();b[0]=b[1]=-m,w[0]=w[1]=m,b[2]=-g,w[2]=y,d=f.TempBoxModel(b,w),a[0]=a[1]=a[2]=0,vec3.set(c.lerpOrigin,u)}var E=f.TransformedBoxTrace(t,n,r,i,d,o,u,a);E.allSolid||E.fraction<e.fraction?(E.entityNum=h.number,E.clone(e)):E.startSolid&&(e.startSolid=!0);if(e.allSolid)return}}function Si(e){var t=It.snap.ps.clone(It.predictedPlayerState),r=It.snap,s=It.nextSnap;if(e){var o=new i.UserCmd,u=a.GetCurrentUserCmdNumber();a.GetUserCmd(u,o),p.UpdateViewAngles(t,o)}if(It.nextFrameTeleport)return;if(!s||s.serverTime<=r.serverTime)return;var f=(It.time-r.serverTime)/(s.serverTime-r.serverTime);for(var l=0;l<3;l++)t.origin[l]=r.ps.origin[l]+f*(s.ps.origin[l]-r.ps.origin[l]),e||(t.viewangles[l]=n.LerpAngle(r.ps.viewangles[l],s.ps.viewangles[l],f)),t.velocity[l]=r.ps.velocity[l]+f*(s.ps.velocity[l]-r.ps.velocity[l])}function xi(){It.hyperspace=!1,It.validPPS||(It.validPPS=!0,It.snap.ps.clone(It.predictedPlayerState));if(It.snap.ps.pm_flags&U.FOLLOW){Si(!1);return}if(bn()){Si(!0);return}var e=It.predictedPlayerState.clone(),t=a.GetCurrentUserCmdNumber(),n=t-d+1,r=new i.UserCmd;a.GetUserCmd(n,r);if(r.serverTime>It.snap.ps.commandTime&&r.serverTime<It.time){wn()&&Wt("exceeded PACKET_BACKUP on commands");return}var s=new i.UserCmd;a.GetUserCmd(t,s),It.nextSnap&&!It.nextFrameTeleport&&!It.thisFrameTeleport?(It.nextSnap.ps.clone(It.predictedPlayerState),It.physicsTime=It.nextSnap.serverTime):(It.snap.ps.clone(It.predictedPlayerState),It.physicsTime=It.snap.serverTime),On()<8?On(8):On()>33&&On(33),It.pmove.pmove_fixed=An(),It.pmove.pmove_msec=On(),It.pmove.ps=It.predictedPlayerState,It.pmove.trace=bi,It.pmove.pointContents=wi,It.pmove.ps.pm_type===R.DEAD?It.pmove.tracemask=V.PLAYERSOLID&~q.BODY:It.pmove.tracemask=V.PLAYERSOLID;var o=!1;for(var u=n;u<=t;u++){a.GetUserCmd(u,It.pmove.cmd),It.pmove.pmove_fixed&&p.UpdateViewAngles(It.pmove.ps,It.pmove.cmd);if(It.pmove.cmd.serverTime<=It.predictedPlayerState.commandTime)continue;if(It.pmove.cmd.serverTime>s.serverTime)continue;It.pmove.gauntletHit=!1,It.pmove.pmove_fixed&&(It.pmove.cmd.serverTime=(It.pmove.cmd.serverTime+On()-1)/On()*On()),p.Pmove(It.pmove),o=!0,Ti()}wn()>1&&Wt("["+It.pmove.cmd.serverTime+" : "+It.time+"]");if(!o){wn()&&Wt("not moved");return}di(It.predictedPlayerState,e)}function Ti(){if(It.predictedPlayerState.pm_type===R.DEAD)return;var e=It.predictedPlayerState.pm_type===R.SPECTATOR;if(It.predictedPlayerState.pm_type!==R.NORMAL&&!e)return;for(var t=0;t<It.numTriggerEntities;t++){var n=It.triggerEntities[t],r=n.currentState;if(r.eType===et.ITEM&&!e){Ni(n);continue}if(r.solid!==v)continue;var i=f.InlineModel(r.modelIndex);if(!i)continue;var s=f.BoxTrace(It.predictedPlayerState.origin,It.predictedPlayerState.origin,It.pmove.mins,It.pmove.maxs,i,-1);if(!s.startSolid)continue;r.eType===et.TELEPORT_TRIGGER?It.hyperspace=!0:r.eType==et.PUSH_TRIGGER&&p.TouchJumpPad(It.predictedPlayerState,r)}It.predictedPlayerState.jumppad_frame!=It.predictedPlayerState.pmove_framecount&&(It.predictedPlayerState.jumppad_frame=0,It.predictedPlayerState.jumppad_ent=0)}function Ni(e){if(!p.PlayerTouchesItem(It.predictedPlayerState,e.currentState,It.time))return;if(e.miscTime===It.time)return;if(!p.CanItemBeGrabbed(null,e.currentState,It.predictedPlayerState))return;var t=p.ItemList[e.currentState.modelIndex];if(qt.gametype===z.CTF){if(It.predictedPlayerState.persistant[Y.TEAM]==Q.RED&&t.giTag==K.REDFLAG)return;if(It.predictedPlayerState.persistant[Y.TEAM]==Q.BLUE&&t.giTag==K.BLUEFLAG)return}p.AddPredictableEventToPlayerstate(It.predictedPlayerState,nt.ITEM_PICKUP,e.currentState.modelIndex),e.currentState.eFlags|=tt.NODRAW,e.miscTime=It.time,t.giType===X.WEAPON&&(It.predictedPlayerState.stats[$.WEAPONS]|=1<<t.giTag,It.predictedPlayerState.ammo[t.giTag]||(It.predictedPlayerState.ammo[t.giTag]=1))}function Ci(e){while(qt.serverCommandSequence<e){var t;(t=a.GetServerCommand(++qt.serverCommandSequence))&&ki(t)}}function ki(e){if(e.type==="cs"){var t=e.data.k,n=e.data.v;Ai(t,n);return}if(e.type==="cp"){Wt("SHOULD CENTER PRINT:",e.data);return}if(e.type==="print"){Wt("print",e.data);return}if(e.type==="chat"){c.StartLocalSound(qt.media.talkSound),Wt("chat",e.data.name,e.data.text);return}if(e.type==="tchat"){c.StartLocalSound(qt.media.talkSound),Wt("tchat",e.data.name,e.data.text);return}if(e.type==="scores"){_i(e.data);return}if(e.type==="map_restart"){Di();return}Wt("Unknown client game command:",e.type)}function Li(){for(var e in qt.gameState){if(!qt.gameState.hasOwnProperty(e))continue;Ai(e,qt.gameState[e])}}function Ai(e,t){if(e==="music")un();else if(e==="serverInfo")Oi();else if(e==="warmup")Mi();else if(e==="score1")qt.score1=t;else if(e==="score2")qt.score2=t;else if(e==="levelStartTime")qt.levelStartTime=t;else if(e==="voteTime")qt.voteTime=t,qt.voteModified=!0;else if(e==="voteYes")qt.voteYes=t,qt.voteModified=!0;else if(e==="voteNo")qt.voteNo=t,qt.voteModified=!0;else if(e==="voteString")qt.voteString=t;else if(e==="intermission")It.intermissionStarted=t;else if(e.indexOf("player")===0){var n=parseInt(e.substr(6),10);zr(n)}else e==="flagstatus"&&qt.gametype==z.CTF&&(qt.redflag=t[0],qt.blueflag=t[1])}function Oi(){var e=on("serverInfo");qt.gametype=e.g_gametype,qt.fraglimit=e.g_fraglimit,qt.capturelimit=e.g_capturelimit,qt.timelimit=e.g_timelimit,qt.maxclients=e.sv_maxClients,qt.mapname=e.sv_mapname}function Mi(){var e=on("warmup");console.log("ParseWarmup",e),It.warmupCount=-1,e>0&&It.warmup<=0&&c.StartLocalSound(qt.media.countPrepareSound),It.warmup=e}function _i(e){It.teamScoreRed=e.red,It.teamScoreBlue=e.blue,It.scores=new Array(e.scores);for(var t=0;t<e.scores.length;t++){var n=e.scores[t],r=It.scores[t]=new Mt;r.clientInfo=qt.clientinfo[n.clientNum],r.score=n.score,r.ping=n.ping,r.time=n.time,r.accuracy=n.accuracy,r.impressiveCount=n.impressive,r.excellentCount=n.excellent,r.guantletCount=n.guantlet,r.defendCount=n.defend,r.assistCount=n.assist,r.perfect=n.perfect,r.captures=n.captures,r.team=qt.clientinfo[n.clientNum].team,qt.clientinfo[n.clientNum].score=n.score,qt.clientinfo[n.clientNum].powerups=n.powerups}zt.setGametype(ft[qt.gametype]),zt.setScores(It.scores)}function Di(){wn()&&Wt("MapRestart"),kr(),It.fraglimitWarnings=0,It.timelimitWarnings=0,It.intermissionStarted=!1,qt.voteTime=0,It.mapRestart=!0,un()}function Pi(){var e,t=a.GetCurrentSnapshotNumber();It.latestSnapshotTime=t.serverTime,t.snapshotNumber!==It.latestSnapshotNum&&(t.snapshotNumber<It.latestSnapshotNum&&Xt("ProcessSnapshots: info.snapshotNumber < cg.latestSnapshotNum"),It.latestSnapshotNum=t.snapshotNumber);while(!It.snap){e=Hi();if(!e)return;e.snapFlags&m||Bi(e)}for(;;){if(!It.nextSnap){e=Hi();if(!e)break;ji(e),It.nextSnap.serverTime<It.snap.serverTime&&Xt("ProcessSnapshots: Server time went backwards")}if(It.time>=It.snap.serverTime&&It.time<It.nextSnap.serverTime)break;Fi()}It.snap===null&&Xt("ProcessSnapshots: cg.snap == NULL"),It.time<It.snap.serverTime&&(It.time=It.snap.serverTime),It.nextSnap&&It.nextSnap.serverTime<=It.time&&Xt("ProcessSnapshots: cg.nextSnap.serverTime <= cg.time")}function Hi(){It.latestSnapshotNum>qt.processedSnapshotNum+1e3&&console.warn("ReadNextSnapshot: way out of range, "+It.latestSnapshotNum+" > "+qt.processedSnapshotNum);while(qt.processedSnapshotNum<It.latestSnapshotNum){qt.processedSnapshotNum++;var e=a.GetSnapshot(qt.processedSnapshotNum);if(e)return Qn(e),e}return null}function Bi(e){It.snap=e,Wt("Setting initial snapshot"),p.PlayerStateToEntityState(e.ps,It.entities[e.ps.clientNum].currentState),yi(),Ci(e.serverCommandNum),gi();for(var t=0;t<e.numEntities;t++){var n=e.entities[t],r=It.entities[n.number];n.clone(r.currentState),r.interpolate=!1,r.currentValid=!0,qi(r),Er(r)}}function ji(e){It.nextSnap=e,p.PlayerStateToEntityState(e.ps,It.entities[e.ps.clientNum].nextState),It.entities[It.snap.ps.clientNum].interpolate=!0;for(var t=0;t<e.numEntities;t++){var n=e.entities[t],r=It.entities[n.number];n.clone(r.nextState),!r.currentValid||(r.currentState.eFlags^n.eFlags)&tt.TELEPORT_BIT?r.interpolate=!1:r.interpolate=!0}It.snap&&(e.ps.eFlags^It.snap.ps.eFlags)&tt.TELEPORT_BIT?It.nextFrameTeleport=!0:It.nextFrameTeleport=!1,(It.nextSnap.snapFlags^It.snap.snapFlags)&g&&(It.nextFrameTeleport=!0),yi()}function Fi(){It.snap||Xt("TransitionSnapshot: NULL cg.snap"),It.nextSnap||Xt("TransitionSnapshot: NULL cg.nextSnap"),Ci(It.nextSnap.serverCommandNum);for(var e=0;e<It.snap.numEntities;e++){var t=It.entities[It.snap.entities[e].number];t.currentValid=!1}var n=It.snap;It.snap=It.nextSnap,p.PlayerStateToEntityState(It.snap.ps,It.entities[It.snap.ps.clientNum].currentState),It.entities[It.snap.ps.clientNum].interpolate=!1;for(var e=0;e<It.snap.numEntities;e++){var t=It.entities[It.snap.entities[e].number];Ii(t),t.snapshotTime=It.snap.serverTime}It.nextSnap=null;if(n){var r=n.ps,i=It.snap.ps;(i.eFlags^r.eFlags)&tt.TELEPORT_BIT&&(It.thisFrameTeleport=!0),It.snap.ps.pm_flags&U.FOLLOW&&di(i,r)}}function Ii(e){e.nextState.clone(e.currentState),e.currentValid=!0,e.interpolate||qi(e),e.interpolate=!1,Er(e)}function qi(e){e.snapshotTime<It.time-H&&(e.previousEvent=0),e.trailTime=It.snap.serverTime,vec3.set(e.currentState.origin,e.lerpOrigin),vec3.set(e.currentState.angles,e.lerpAngles)}function Ri(){var e=It.predictedPlayerState;It.refdef.x=0,It.refdef.y=0,It.refdef.width=o.GetViewportWidth(),It.refdef.height=o.GetViewportHeight(),It.bobCycle=(e.bobCycle&128)>>7,It.bobFracSin=Math.abs(Math.sin((e.bobCycle&127)/127*Math.PI)),It.xyspeed=Math.sqrt(e.velocity[0]*e.velocity[0]+e.velocity[1]*e.velocity[1]),vec3.set(e.origin,It.refdef.vieworg),vec3.set(e.viewangles,It.refdefViewAngles),It.renderingThirdPerson?$i():Ui(),n.AnglesToAxis(It.refdefViewAngles,It.refdef.viewaxis),It.refdef.rdflags=0,It.hyperspace&&(It.refdef.rdflags|=at.NOWORLDMODEL|at.HYPERSPACE),Qi()}function Ui(){It.refdef.vieworg[2]+=It.predictedPlayerState.viewheight,zi()}function zi(){var e=It.time-It.stepTime;e<pt&&(It.refdef.vieworg[2]-=It.stepChange*(pt-e)/pt)}function $i(){var e=vec3.create(),t=vec3.create(),r=vec3.create(),i=vec3.create(),s=vec3.create(It.refdefViewAngles);It.predictedPlayerState.pm_type===R.DEAD&&(s[n.YAW]=It.predictedPlayerState.stats[$.DEAD_YAW],It.refdefViewAngles[n.YAW]=It.predictedPlayerState.stats[$.DEAD_YAW]),s[n.PITCH]>45&&(s[n.PITCH]=45),n.AnglesToVectors(s,e,null,null),It.refdef.vieworg[2]+=It.predictedPlayerState.viewheight,vec3.add(It.refdef.vieworg,vec3.scale(e,Wi,vec3.create()),i);var o=vec3.create(It.refdef.vieworg);o[2]+=8,It.refdefViewAngles[n.PITCH]*=.5,n.AnglesToVectors(It.refdefViewAngles,e,t,r);var u=Math.cos(Sn()/180*Math.PI),a=Math.sin(Sn()/180*Math.PI);vec3.add(o,vec3.scale(e,-xn()*u,vec3.create())),vec3.add(o,vec3.scale(t,-xn()*a,vec3.create()));var f=bi(It.refdef.vieworg,o,Xi,Vi,It.predictedPlayerState.clientNum,V.SOLID);f.fraction!==1&&(vec3.set(f.endPos,o),o[2]+=(1-f.fraction)*32,f=bi(It.refdef.vieworg,o,Xi,Vi,It.predictedPlayerState.clientNum,V.SOLID),vec3.set(f.endPos,o)),vec3.set(o,It.refdef.vieworg),vec3.subtract(i,It.refdef.vieworg);var l=Math.sqrt(i[0]*i[0]+i[1]*i[1]);l<1&&(l=1),It.refdefViewAngles[n.PITCH]=-180/Math.PI*Math.atan2(i[2],l),It.refdefViewAngles[n.YAW]-=Sn()}function Qi(){var e,t;if(It.predictedPlayerState.pm_type===R.INTERMISSION)e=90;else{e=mn(),e<1?e=1:e>160&&(e=160);var n=gn();n<1?n=1:n>160&&(n=160);var r;It.zoomed?(r=(It.time-It.zoomTime)/gt,r>1?e=n:e+=r*(n-e)):(r=(It.time-It.zoomTime)/gt,r<=1&&(e=n+r*(e-n)))}var i=It.refdef.width/Math.tan(e/360*Math.PI);t=Math.atan2(It.refdef.height,i)*360/Math.PI;var s=wi(It.refdef.vieworg,-1);if(s&(q.WATER|q.SLIME|q.LAVA)){var o=It.time/1e3*Ki*Math.PI*2,u=Ji*Math.sin(o);e+=u,t-=u}It.refdef.fovX=e,It.refdef.fovY=t,It.zoomed?It.zoomSensitivity=It.refdef.fovY/75:It.zoomSensitivity=1}function Gi(e){return It.snap.ps.ammo[e]?It.snap.ps.stats[$.WEAPONS]&1<<e?!0:!1:!1}function Yi(){if(!It.snap)return;if(It.snap.ps.pm_flags&U.FOLLOW)return;It.weaponSelectTime=It.time;var e=It.weaponSelect;for(var t=0;t<E;t++){It.weaponSelect++,It.weaponSelect===E&&(It.weaponSelect=0);if(It.weaponSelect===J.GAUNTLET)continue;if(Gi(It.weaponSelect))break}t===E&&(It.weaponSelect=e)}function Zi(){if(!It.snap)return;if(It.snap.ps.pm_flags&U.FOLLOW)return;var e=It.weaponSelect;for(var t=0;t<E;t++){It.weaponSelect--,It.weaponSelect===-1&&(It.weaponSelect=E-1);if(It.weaponSelect===J.GAUNTLET)continue;if(Gi(It.weaponSelect))break}t===E&&(It.weaponSelect=e)}function es(e){if(!It.snap)return;if(It.snap.ps.pm_flags&U.FOLLOW)return;var t=parseInt(e,10);if(t<1||t>E-1)return;if(!(It.snap.ps.stats[$.WEAPONS]&1<<t))return;It.weaponSelect=t}function ts(e,t,r){var s=r.currentState.weapon,o=sn(X.WEAPON,s);if(!o)return;var u=new l.RefEntity;vec3.set(e.lightingOrigin,u.lightingOrigin),u.renderfx=e.renderfx,u.hModel=o.models.primary;if(!u.hModel)return;t||(r.pe.lightningFiring=!1,r.currentState.eFlags&tt.FIRING&&o.sounds.firing?(c.AddLoopingSound(r.currentState.number,r.lerpOrigin,n.vec3origin,o.sounds.firing),r.pe.lightningFiring=!0):o.sounds.ready&&c.AddLoopingSound(r.currentState.number,r.lerpOrigin,n.vec3origin,o.sounds.ready));var a=new i.Orientation;l.LerpTag(a,e.hModel,e.oldFrame,e.frame,1-e.backlerp,"tag_weapon"),vec3.set(e.origin,u.origin),vec3.add(u.origin,vec3.scale(e.axis[0],a.origin[0],vec3.create())),vec3.add(u.origin,vec3.scale(e.axis[1],a.origin[1],vec3.create())),vec3.add(u.origin,vec3.scale(e.axis[2],a.origin[2],vec3.create())),n.AxisMultiply(a.axis,e.axis,u.axis),u.backlerp=e.backlerp,as(u,r.currentState.powerups);if(o.models.barrel){var f=new l.RefEntity;vec3.set(e.lightingOrigin,f.lightingOrigin),f.renderfx=e.renderfx,f.hModel=o.models.barrel;var h=vec3.create();h[n.YAW]=0,h[n.PITCH]=0,h[n.ROLL]=us(r),n.AnglesToAxis(h,f.axis),hr(f,u,o.models.primary,"tag_barrel"),as(f,r.currentState.powerups)}var p=It.entities[r.currentState.clientNum];if(s!==J.LIGHTNING&&s!==J.GAUNTLET&&s!==J.GRAPPLING_HOOK||!(p.currentState.eFlags&tt.FIRING))if(It.time-r.muzzleFlashTime>yt)return;var d=new l.RefEntity;vec3.set(e.lightingOrigin,d.lightingOrigin),d.renderfx=e.renderfx,d.hModel=o.models.flash;if(!d.hModel)return;var h=vec3.create();h[n.YAW]=0,h[n.PITCH]=0,h[n.ROLL]=n.crandom()*10,n.AnglesToAxis(h,d.axis),hr(d,u,o.models.primary,"tag_flash"),l.AddRefEntityToScene(d);if(t||It.renderingThirdPerson||r.currentState.number!==It.predictedPlayerState.clientNum)gs(p,d.origin),(o.flashDlightColor[0]||o.flashDlightColor[1]||o.flashDlightColor[2])&&l.AddLightToScene(d.origin,300+Math.random()*32,o.flashDlightColor[0],o.flashDlightColor[1],o.flashDlightColor[2])}function ns(e){if(e.persistant[Y.SPECTATOR_STATE]!==G.NOT)return;if(e.pm_type===R.INTERMISSION)return;if(It.renderingThirdPerson)return;var t=It.predictedPlayerEntity,r=qt.clientinfo[t.currentState.clientNum];if(!r.infoValid)return;var i=new l.RefEntity,s=sn(X.WEAPON,e.weapon),o=vec3.create();rs(i.origin,o);var u=0;mn.integer>90&&(u=-0.2*(mn.integer-90)),vec3.add(i.origin,vec3.scale(It.refdef.viewaxis[2],u,vec3.create())),n.AnglesToAxis(o,i.axis),i.frame=is(r,t.pe.torso.frame),i.oldFrame=is(r,t.pe.torso.oldFrame),i.backlerp=t.pe.torso.backlerp,i.hModel=s.models.hand;if(!i.hModel)return;i.renderfx=ut.DEPTHHACK|ut.FIRST_PERSON|ut.MINLIGHT,ts(i,e,It.predictedPlayerEntity)}function rs(e,t){var r,i;vec3.set(It.refdef.vieworg,e),vec3.set(It.refdefViewAngles,t),It.bobCycle&1?r=-It.xyspeed:r=It.xyspeed,t[n.ROLL]+=r*It.bobFracSin*.005,t[n.YAW]+=r*It.bobFracSin*.01,t[n.PITCH]+=It.xyspeed*It.bobFracSin*.005,r=It.xyspeed+40,i=Math.sin(It.time*.001),t[n.ROLL]+=r*i*.01,t[n.YAW]+=r*i*.01,t[n.PITCH]+=r*i*.01}function is(e,t){return t>=e.animations[it.TORSO_DROP].firstFrame&&t<e.animations[it.TORSO_DROP].firstFrame+9?t-e.animations[it.TORSO_DROP].firstFrame+6:t>=e.animations[it.TORSO_ATTACK].firstFrame&&t<e.animations[it.TORSO_ATTACK].firstFrame+6?1+t-e.animations[it.TORSO_ATTACK].firstFrame:t>=e.animations[it.TORSO_ATTACK2].firstFrame&&t<e.animations[it.TORSO_ATTACK2].firstFrame+6?1+t-e.animations[it.TORSO_ATTACK2].firstFrame:0}function us(e){var t=It.time-e.pe.barrelTime,r;if(e.pe.barrelSpinning)r=e.pe.barrelAngle+t*ss;else{t>os&&(t=os);var i=.5*(ss+(os-t)/os);r=e.pe.barrelAngle+t*i}return e.pe.barrelSpinning===!(e.currentState.eFlags&tt.FIRING)&&(e.pe.barrelTime=It.time,e.pe.barrelAngle=n.AngleNormalize360(r),e.pe.barrelSpinning=!!(e.currentState.eFlags&tt.FIRING)),r}function as(e,t){t&1<<K.INVIS?(e.customShader=qt.media.invisShader,l.AddRefEntityToScene(e)):(l.AddRefEntityToScene(e),t&1<<K.BATTLESUIT&&(e.customShader=qt.media.battleWeaponShader,l.AddRefEntityToScene(e)),t&1<<K.QUAD&&(e.customShader=qt.media.quadWeaponShader,l.AddRefEntityToScene(e)))}function fs(){It.weaponSelectTime=It.time;for(var e=E-1;e>0;e--)if(Gi(e)){It.weaponSelect=e;break}}function ls(e){var t=e.currentState;if(t.weapon===J.NONE)return;if(t.weapon>=J.NUM_WEAPONS){Xt("FireWeapon: es.weapon >= WP.NUM_WEAPONS");return}var r=sn(X.WEAPON,t.weapon);e.muzzleFlashTime=It.time;if(t.weapon===J.LIGHTNING&&e.pe.lightningFiring)return;t.weapon===J.RAILGUN&&(e.pe.railFireTime=It.time);if(e.currentState.powerups&1<<K.QUAD){var i=sn(X.POWERUP,K.QUAD);c.StartSound(null,e.currentState.number,i.sounds.use)}for(var s=0;s<4;s++)if(!r.sounds["flash"+s])break;s>0&&(s=n.irrandom(0,s-1),c.StartSound(null,t.number,r.sounds["flash"+s]))}function cs(e,t,r,i,s){var o=null,u=0,a=0,f=0,l=32,h=0,p=vec3.create(),d=!1,v=600,m=-1,g=sn(X.WEAPON,e);switch(e){case J.MACHINEGUN:o=qt.media.bulletFlashModel,a=g.shaders.bulletExplosion,u=qt.media.bulletMarkShader,m=n.irrandom(0,2),m===0?f=g.sounds.ric0:m===1?f=g.sounds.ric1:f=g.sounds.ric2,l=8;break;case J.SHOTGUN:o=qt.media.bulletFlashModel,a=g.shaders.bulletExplosion,u=qt.media.bulletMarkShader,f=0,l=4;break;case J.GRENADE_LAUNCHER:o=qt.media.dishFlashModel,a=g.shaders.explosion,f=qt.media.sfx_rockexp,u=qt.media.burnMarkShader,l=64,h=300,d=!0;break;case J.ROCKET_LAUNCHER:o=qt.media.dishFlashModel,a=g.shaders.explosion,f=g.sounds.explosion,u=qt.media.burnMarkShader,l=64,h=300,d=!0,v=1e3,p[0]=1,p[1]=.75,p[2]=0;break;case J.LIGHTNING:m=n.irrandom(0,2),m===0?f=g.sounds.hit0:m===1?f=g.sounds.hit1:f=g.sounds.hit2,u=qt.media.holeMarkShader,l=12;break;case J.RAILGUN:o=qt.media.ringFlashModel,a=g.shaders.explosion,f=g.sounds.explosion,u=qt.media.energyMarkShader,l=24;break;case J.PLASMAGUN:o=qt.media.ringFlashModel,a=g.shaders.explosion,f=g.sounds.explosion,u=qt.media.energyMarkShader,l=16;break;case J.BFG:o=qt.media.dishFlashModel,a=g.shaders.explosion,f=qt.media.sfx_rockexp,u=qt.media.burnMarkShader,l=32,d=!0}f&&c.StartSound(r,-1,f);if(o){var y=Gn(r,i,o,a,v,d);y.light=h,vec3.set(p,y.lightColor)}var b=u===qt.media.energyMarkShader;nr(u,r,i,Math.random()*360,1,1,1,1,b,l,!1)}function hs(e,t,n,r){sr(t,r);switch(e){case J.GRENADE_LAUNCHER:case J.ROCKET_LAUNCHER:case J.PLASMAGUN:case J.BFG:cs(e,0,t,n,Tt.FLESH);break;default:}}function ps(e,t,n,r,i){r?sr(e,i):cs(J.MACHINEGUN,0,e,n,Tt.DEFAULT)}function ds(e,t,n){var r,i,s;r=bi(e,t,null,null,n,V.SHOT);if(r.surfaceFlags&I.NOIMPACT)return;if(It.entities[r.entityNum].currentState.eType==et.PLAYER)hs(J.SHOTGUN,r.endPos,r.plane.normal,r.entityNum);else{if(r.surfaceFlags&I.NOIMPACT)return;r.surfaceFlags&I.METALSTEPS?cs(J.SHOTGUN,0,r.endPos,r.plane.normal,Tt.METAL):cs(J.SHOTGUN,0,r.endPos,r.plane.normal,Tt.DEFAULT)}}function vs(e,t,r,i){var s,o,u,a=vec3.create(),f=vec3.create(),l=vec3.create(),c=vec3.create();vec3.normalize(t,f),n.PerpendicularVector(f,l),vec3.cross(f,l,c);for(s=0;s<k;s++)o=n.crandom()*C*16,u=n.crandom()*C*16,vec3.add(e,vec3.scale(f,131072,vec3.create()),a),vec3.add(a,vec3.scale(l,o,vec3.create())),vec3.add(a,vec3.scale(c,u,vec3.create())),ds(e,a,i)}function ms(e){var t=vec3.subtract(e.origin2,e.pos.trBase,vec3.create());vec3.normalize(t),vec3.scale(t,32),vec3.add(t,e.pos.trBase);var n=wi(e.pos.trBase,0);if(!(n&q.WATER)){var r=vec3.createFrom(0,0,8);ir(t,r,32,1,1,1,.33,900,It.time,0,Dt.PUFF_DONT_SCALE,qt.media.shotgunSmokePuffShader)}vs(e.pos.trBase,e.origin2,e.eventParm,e.otherEntityNum)}function gs(e,t){var r=new l.RefEntity,i=vec3.create(),s=vec3.create(),o=vec3.create();if(e.currentState.weapon!==J.LIGHTNING)return;var u=sn(X.WEAPON,J.LIGHTNING);if(e.currentState.number===It.predictedPlayerState.clientNum&&Cn()!==0){var a=vec3.create();for(var f=0;f<3;f++){var c=e.lerpAngles[f]-It.refdefViewAngles[f];c>180&&(c-=360),c<-180&&(c+=360),a[f]=It.refdefViewAngles[f]+c*(1-Cn()),a[f]<0&&(a[f]+=360),a[f]>360&&(a[f]-=360)}n.AnglesToVectors(a,i,null,null),vec3.set(e.lerpOrigin,s)}else n.AnglesToVectors(e.lerpAngles,i,null,null),vec3.set(e.lerpOrigin,s);var h=e.currentState.legsAnim&~D;h===it.LEGS_WALKCR||h===it.LEGS_IDLECR?s[2]+=M:s[2]+=O,vec3.add(s,vec3.scale(i,14,vec3.create()),s),vec3.add(s,vec3.scale(i,L,vec3.create()),o);var p=bi(s,o,n.vec3origin,n.vec3origin,e.currentState.number,V.SHOT);vec3.set(p.endPos,r.oldOrigin),vec3.set(t,r.origin),r.reType=ot.LIGHTNING,r.customShader=u.shaders.lightning,l.AddRefEntityToScene(r);if(p.fraction<1){var d=vec3.create(),v=vec3.create();vec3.subtract(r.oldOrigin,r.origin,v),vec3.normalize(v),r=new l.RefEntity,r.hModel=u.models.explosion,vec3.add(p.endPos,vec3.scale(v,-16,vec3.create()),r.origin),d[0]=n.rrandom(0,360),d[1]=n.rrandom(0,360),d[2]=n.rrandom(0,360),n.AnglesToAxis(d,r.axis),l.AddRefEntityToScene(r)}}function ys(e,t){var n=vec3.create(),r=vec3.create(),i=vec3.create(),s=50,o=e.currentState,u=e.trailTime;e.trailTime=It.time,p.EvaluateTrajectory(o.pos,It.time,r);if(o.pos.trType===F.STATIONARY)return;p.EvaluateTrajectory(o.pos,e.trailTime,i);var a=s*Math.floor((u+s)/s);for(;a<=e.trailTime;a+=s){p.EvaluateTrajectory(o.pos,a,i);var f=ir(i,n,t.trailRadius,1,1,1,.33,t.trailTime,a,0,0,qt.media.smokePuffShader);f.leType=_t.SCALE_FADE}}function bs(e,t){ys(e,t)}function ws(e,t){var r=Lr(),i=r.refent,s=e.currentState,o=vec3.create(),u=vec3.create(),a=vec3.create(),f=vec3.create(),c=vec3.create(),h=[vec3.create(),vec3.create(),vec3.create()],d=1,v=sn(X.WEAPON,J.PLASMAGUN);p.EvaluateTrajectory(s.pos,It.time,a),o[0]=60-120*n.crandom(),o[1]=40-80*n.crandom(),o[2]=100-200*n.crandom(),r.leType=_t.MOVE_SCALE_FADE,r.startTime=It.time,r.endTime=r.startTime+600,r.pos.trType=F.GRAVITY,r.pos.trTime=It.time,n.AnglesToAxis(e.lerpAngles,h),f[0]=2,f[1]=2,f[2]=2,c[0]=f[0]*h[0][0]+f[1]*h[1][0]+f[2]*h[2][0],c[1]=f[0]*h[0][1]+f[1]*h[1][1]+f[2]*h[2][1],c[2]=f[0]*h[0][2]+f[1]*h[1][2]+f[2]*h[2][2],vec3.add(a,c,l.origin),vec3.set(i.origin,r.pos.trBase),wi(i.origin,-1)&q.WATER&&(d=.1),u[0]=o[0]*h[0][0]+o[1]*h[1][0]+o[2]*h[2][0],u[1]=o[0]*h[0][1]+o[1]*h[1][1]+o[2]*h[2][1],u[2]=o[0]*h[0][2]+o[1]*h[1][2]+o[2]*h[2][2],vec3.scale(u,d,r.pos.trDelta),n.AxisCopy(n.axisDefault,i.axis),i.shaderTime=It.time/1e3,i.reType=ot.SPRITE,i.radius=.25,i.customShader=v.shaders.missile,r.bounceFactor=.3,i.shaderRGBA[3]=63,r.color[3]=.25,r.angles.trType=F.LINEAR,r.angles.trTime=It.time,r.angles.trBase[0]=n.irrandom(0,31),r.angles.trBase[1]=n.irrandom(0,31),r.angles.trBase[2]=n.irrandom(0,31),r.angles.trDelta[0]=1,r.angles.trDelta[1]=.5,r.angles.trDelta[2]=0}function Ts(e,t,r){var i=Lr(),s=i.refent,o=sn(X.WEAPON,J.RAILGUN);t[2]-=4,i.leType=_t.FADE_RGB,i.startTime=It.time,i.endTime=It.time+Tn(),i.lifeRate=1/(i.endTime-i.startTime),s.shaderTime=It.time/1e3,s.reType=ot.RAIL_CORE,s.customShader=o.shaders.core,vec3.set(t,s.origin),vec3.set(r,s.oldOrigin),s.shaderRGBA[0]=255,s.shaderRGBA[1]=0,s.shaderRGBA[2]=0,s.shaderRGBA[3]=255,i.color[0]=.75,i.color[1]=0,i.color[2]=0,i.color[3]=1,n.AxisClear(s.axis)}var o=t.sys,u=t.com,a=t.cl,f=t.cm,l=t.re,c=t.snd,h=t.ui,p=s.CreateInstance(ln()),d=i.CMD_BACKUP,v=i.SOLID_BMODEL,m=i.SNAPFLAG_NOT_ACTIVE,g=i.SNAPFLAG_SERVERCOUNT,y=i.MAX_CLIENTS,b=i.MAX_GENTITIES,w=i.MAX_POWERUPS,E=i.MAX_WEAPONS,S=i.MAX_PS_EVENTS,x=i.ENTITYNUM_NONE,T=i.ENTITYNUM_WORLD,N=p.RANK_TIED_FLAG,C=p.DEFAULT_SHOTGUN_SPREAD,k=p.DEFAULT_SHOTGUN_COUNT,L=p.LIGHTNING_RANGE,A=p.SCORE_NOT_PRESENT,O=p.DEFAULT_VIEWHEIGHT,M=p.CROUCH_VIEWHEIGHT,D=p.ANIM_TOGGLEBIT,P=p.EV_EVENT_BITS,H=p.EVENT_VALID_MSEC,B=i.CVF,j=i.BUTTON,F=i.TR,I=i.SURF,q=i.CONTENTS,R=p.PM,U=p.PMF,z=p.GT,W=p.WS,X=p.IT,V=p.MASK,$=p.STAT,J=p.WP,K=p.PW,Q=p.TEAM,G=p.SPECTATOR,Y=p.PERS,Z=p.PLAYEREVENTS,et=p.ET,tt=p.EF,nt=p.EV,rt=p.GTS,it=p.ANIM,st=p.MOD,ot=l.RT,ut=l.RF,at=l.RDF,ft=p.GametypeNames,lt="sarge",ct="sarge",ht=512,pt=200,dt=100,vt=200,mt=1e3,gt=150,yt=20,bt=1e3,wt=32,Et=10,St=20,xt={NORMAL:0,BOOT:1,FLESH:2,MECH:3,ENERGY:4,METAL:5,SPLASH:6,TOTAL:7},Tt={DEFAULT:0,METAL:1,FLESH:2},Nt={MALE:0,FEMALE:1,NEUTER:2},Ct=function(){this.initialized=!1,this.frameInterpolation=0,this.intermissionStarted=!1,this.thisFrameTeleport=!1,this.nextFrameTeleport=!1,this.time=0,this.oldTime=0,this.frameTime=0,this.physicsTime=0,this.latestSnapshotNum=0,this.latestSnapshotTime=0,this.snap=null,this.nextSnap=null,this.entities=new Array(b),this.renderingThirdPerson=!1,this.timelimitWarnings=0,this.fraglimitWarnings=0,this.mapRestart=!1,this.pmove=new p.PmoveInfo,this.solidEntities=[],this.numSolidEntities=0,this.triggerEntities=[],this.numTriggerEntities=0,this.hyperspace=!1,this.validPPS=!1,this.predictedErrorTime=0,this.predictedError=vec3.create(),this.predictedPlayerState=new i.PlayerState,this.predictedPlayerEntity=new Ot,this.stepChange=0,this.stepTime=0,this.duckChange=0,this.duckTime=0,this.landChange=0,this.landTime=0,this.itemInfo=[],this.weaponSelect=0,this.autoAngles=vec3.create(),this.autoAnglesFast=vec3.create(),this.refdef=new l.RefDef,this.refdefViewAngles=vec3.create(),this.zoomed=!1,this.zoomTime=0,this.zoomSensitivity=0,this.scoresRequestTime=0,this.showScores=!1,this.scores=null,this.teamScoreRed=0,this.teamScoreBlue=0,this.crosshairName=0,this.crosshairNameTime=0,this.rewardStack=0,this.rewardTime=0,this.rewardCount=new Array(Et),this.rewardShader=new Array(Et),this.rewardSound=new Array(Et),this.soundBufferIn=0,this.soundBufferOut=0,this.soundTime=0,this.soundBuffer=new Array(St),this.warmup=0,this.warmupCount=0,this.localEntities=null,this.activeLocalEntities=null,this.freeLocalEntities=null,this.bobCycle=0,this.bobFracSin=0,this.xyspeed=0;for(var e=0;e<b;e++)this.entities[e]=new Ot},kt=function(){this.gameState=null,this.mapname=null,this.processedSnapshotNum=0,this.gametype=0,this.fraglimit=0,this.capturelimit=0,this.timelimit=0,this.maxclients=0,this.mapname=0,this.voteTime=0,this.voteYes=0,this.voteNo=0,this.voteModified=!1,this.voteString=null,this.teamVoteTime=new Array(2),this.teamVoteYes=new Array(2),this.teamVoteNo=new Array(2),this.teamVoteModified=new Array(2),this.teamVoteString=new Array(2),this.levelStartTime=0,this.score1=0,this.score2=0,this.redflag=0,this.blueflag=0,this.flagStatus=0,this.inlineDrawModels=null,this.inlineModelMidpoints=null,this.clientinfo=new Array(y),this.media={};for(var e=0;e<y;e++)this.clientinfo[e]=new jt},Lt=function(){this.legs=new At,this.torso=new At,this.flag=new At,this.painTime=0,this.painDirection=0,this.lightningFiring=!1,this.railFireTime=0,this.barrelAngle=0,this.barrelTime=0,this.barrelSpinning=!1},At=function(){this.oldFrame=0,this.oldFrameTime=0,this.frame=0,this.frameTime=0,this.backlerp=0,this.yawAngle=0,this.yawing=!1,this.pitchAngle=0,this.pitching=!1,this.animationNumber=0,this.animation=null,this.animationTime=0},Ot=function(){this.currentState=new i.EntityState,this.nextState=new i.EntityState,this.interpolate=!1,this.currentValid=!1,this.muzzleFlashTime=0,this.previousEvent=0,this.trailTime=0,this.miscTime=0,this.snapshotTime=0,this.pe=new Lt,this.extrapolated=!1,this.rawOrigin=vec3.create(),this.rawAngles=vec3.create(),this.lerpOrigin=vec3.create(),this.lerpAngles=vec3.create()},Mt=function(){this.clientInfo=0,this.team=0,this.score=0,this.ping=0,this.time=0,this.powerups=0,this.accuracy=0,this.impressiveCount=0,this.excellentCount=0,this.gauntletCount=0,this.defendCount=0,this.assistCount=0,this.captures=0,this.perfect=0},_t={MARK:0,EXPLOSION:1,SPRITE_EXPLOSION:2,FRAGMENT:3,MOVE_SCALE_FADE:4,FALL_SCALE_FADE:5,FADE_RGB:6,SCALE_FADE:7,SCOREPLUM:8},Dt={PUFF_DONT_SCALE:1,TUMBLE:2,SOUND1:4,SOUND2:8},Pt={NONE:0,BURN:1,BLOOD:2},Ht={NONE:0,BLOOD:1,BRASS:2},Bt=function(){this.reset()};Bt.prototype.reset=function(){this.prev=null,this.next=null,this.leType=0,this.leFlags=0,this.startTime=0,this.endTime=0,this.fadeTime=0,this.alphaFade=!1,this.pos=new i.Trajectory,this.angles=new i.Trajectory,this.bounceFactor=0,this.color=[0,0,0,0],this.radius=0,this.light=0,this.lightColor=vec3.create(),this.leMarkType=0,this.leBounceSoundType=0,this.refent=new l.RefEntity};var jt=function(){this.reset()};jt.prototype.reset=function(){this.infoValid=!1,this.name=null,this.team=Q.FREE,this.powerups=0,this.modelName=null,this.skinName=null,this.headModelName=null,this.headSkinName=null,this.fixedlegs=!1,this.fixedtorso=!1,this.footsteps=xt.NORMAL,this.gender=Nt.NEUTER,this.legsModel=-1,this.legsSkin=-1,this.torsoModel=-1,this.torsoSkin=-1,this.headModel=-1,this.headSkin=-1,this.animations=new Array(it.MAX_TOTALANIMATIONS),this.sounds=new Array(hi.length);for(var e=0;e<it.MAX_TOTALANIMATIONS;e++)this.animations[e]=new p.Animation};var Ft=function(){this.models={},this.shaders={},this.gfx={},this.sounds={},this.weaponMidpoint=vec3.create(),this.trailRadius=0,this.trailTime=0},It,qt,Rt,Ut,zt,mn,gn,yn,bn,wn,En,Sn,xn,Tn,Nn,Cn,kn,Ln,An,On,Pn=30,Hn=new Array(Pn),Bn=0,jn=0,Yn=128,Zn=384,er=1e4,tr=1e3,or=250,ur=250,ti=.3,ni=[0,22,45,-22,0,22,-45,-22],oi=128,hi=["*death1","*death2","*death3","*jump1","*pain25_1","*pain50_1","*pain75_1","*pain100_1","*falling1","*gasp","*drown","*fall1","*taunt"],Wi=512,Xi=vec3.createFrom(-4,-4,-4),Vi=vec3.createFrom(4,4,4),Ji=1,Ki=.4,ss=.9,os=1e3,Es=4,Ss=1,xs=5;return{Init:Vt,Shutdown:$t,Frame:Jt}}return{CreateInstance:function(e){return new o(e)}}}),function(e){function t(){}function i(e,t){if(r)return t.indexOf(e);var n=t.length;while(n--)if(t[n]===e)return n;return-1}var n=t.prototype,r=Array.prototype.indexOf?!0:!1;n._getEvents=function(){return this._events||(this._events={})},n.getListeners=function(e){var t=this._getEvents();return t[e]||(t[e]=[])},n.addListener=function(e,t){var n=this.getListeners(e);return i(t,n)===-1&&n.push(t),this},n.on=n.addListener,n.removeListener=function(e,t){var n=this.getListeners(e),r=i(t,n);return r!==-1&&(n.splice(r,1),n.length===0&&this.removeEvent(e)),this},n.off=n.removeListener,n.addListeners=function(e,t){return this.manipulateListeners(!1,e,t)},n.removeListeners=function(e,t){return this.manipulateListeners(!0,e,t)},n.manipulateListeners=function(e,t,n){var r,i,s=e?this.removeListener:this.addListener,o=e?this.removeListeners:this.addListeners;if(typeof t=="object")for(r in t)t.hasOwnProperty(r)&&(i=t[r])&&(typeof i=="function"?s.call(this,r,i):o.call(this,r,i));else{r=n.length;while(r--)s.call(this,t,n[r])}return this},n.removeEvent=function(e){return e?delete this._getEvents()[e]:delete this._events,this},n.emitEvent=function(e,t){var n=this.getListeners(e),r=n.length,i;while(r--)i=t?n[r].apply(null,t):n[r](),i===!0&&this.removeListener(e,n[r]);return this},n.trigger=n.emitEvent,typeof define=="function"&&define.amd?define("EventEmitter",[],function(){return t}):e.EventEmitter=t}(this),define("common/asset-cache",["EventEmitter"],function(e){var t=function(e){this.assets=[{name:"*default",obj:e}],this.callbacks={}};return t.prototype=new e,t.prototype.constructor=t,t.prototype.register=function(e,t){var n={name:e,obj:t};this.assets.push(n)},t.prototype.load=function(){var e=this.assets,t=Array.prototype.slice.call(arguments),n=t[0],r=t[t.length-1];t[t.length-1]=function(e,t){r(t)},this.findByName.apply(this,t)},t.prototype.findByHandle=function(e){var t=this.assets;return typeof e=="undefined"||e<1||e>=t.length?t[0].obj:t[e].obj},t.prototype.findByName=function(){var e=this.assets,t=this.callbacks,n=Array.prototype.slice.call(arguments),r=n[0],i=n[arguments.length-1];for(var s=0;s<e.length;s++){var o=e[s];if(o.name===r)return i(o.obj,s)}if(t[r]){t[r].push(i);return}t[r]=[i],n[n.length-1]=function(n,i){var s,o;n?(s=0,o=e[0]):(s=e.length,o={name:r,obj:i},e.push(o));var u=t[r];for(var a=0;a<u.length;a++)u[a](o.obj,s);delete t[r]},this.trigger("load",n)},t}),define("common/shader-compiler",["common/text-tokenizer"],function(e){function u(t,r){var s=new e(t),o=new i;o.name=s.next();if(s.next()!=="{")return null;while(!s.EOF()){var u=s.next().toLowerCase();if(u=="}")break;switch(u){case"{":var l=a(o,r,s);l.isLightmap&&l.hasBlendFunc&&(l.blendSrc="GL_DST_COLOR",l.blendDest="GL_ZERO"),o.stages.push(l);break;case"sort":var c=s.next().toLowerCase();switch(c){case"portal":o.sort=n.PORTAL;break;case"sky":o.sort=n.ENVIRONMENT;break;case"opaque":o.sort=n.OPAQUE;break;case"decal":o.sort=n.DECAL;break;case"seeThrough":o.sort=n.SEE_THROUGH;break;case"banner":o.sort=n.BANNER;break;case"additive":o.sort=n.BLEND1;break;case"nearest":o.sort=n.NEAREST;break;case"underwater":o.sort=n.UNDERWATER;break;default:o.sort=parseInt(c,10)}break;case"cull":o.cull=s.next();break;case"deformvertexes":var h={type:s.next().toLowerCase()};switch(h.type){case"wave":h.spread=1/parseFloat(s.next()),h.waveform=f(s);break;default:h=null}h&&o.vertexDeforms.push(h);break;case"surfaceparm":o.surfaceParms.push(s.next().toLowerCase());continue;case"polygonoffset":o.polygonOffset=!0;break;case"entitymergable":o.entityMergable=!0;break;case"portal":o.sort=n.PORTAL;break;case"fogparms":o.fog=!0,o.sort=n.FOG;break;case"skyparms":o.sky=!0,o.sort=n.ENVIRONMENT;break;default:}}o.polygonOffset&&!o.sort&&(o.sort=n.DECAL);for(var p=0;p<o.stages.length;p++){var l=o.stages[p];o.stages[0].hasBlendFunc&&l.hasBlendFunc&&(o.sort||(l.depthWrite?o.sort=n.SEE_THROUGH:o.sort=n.BLEND0))}return o.sort||(o.sort=n.OPAQUE),o}function a(e,t,n){var r=new s;while(!n.EOF()){var i=n.next();if(i=="}")break;switch(i.toLowerCase()){case"clampmap":r.clamp=!0;case"map":var o=n.next();o||error("WARNING: missing parameter for 'map' keyword in script '"+e.name+"'"),o==="$whiteimage"?o="*white":o=="$lightmap"&&(r.isLightmap=!0,t<0?o="*white":o="*lightmap"),r.maps.push(o);break;case"animmap":r.animFrame=0,r.animFreq=parseFloat(n.next());var u=n.next();while(u.match(/\.[^\/.]+$/)){var o=u;r.maps.push(o),u=n.next()}n.prev();break;case"rgbgen":r.rgbGen=n.next().toLowerCase();switch(r.rgbGen){case"wave":r.rgbWaveform=f(n),r.rgbWaveform||(r.rgbGen="identity")}break;case"alphagen":r.alphaGen=n.next().toLowerCase();switch(r.alphaGen){case"wave":r.alphaWaveform=f(n),r.alphaWaveform||(r.alphaGen="1.0");break;case"portal":e.portalRange=parseFloat(n.next().toLowerCase());break;default:}break;case"alphafunc":r.alphaFunc=n.next().toUpperCase();break;case"blendfunc":r.blendSrc=n.next().toUpperCase(),r.hasBlendFunc=!0,r.depthWriteOverride||(r.depthWrite=!1);switch(r.blendSrc){case"ADD":r.blendSrc="GL_ONE",r.blendDest="GL_ONE";break;case"BLEND":r.blendSrc="GL_SRC_ALPHA",r.blendDest="GL_ONE_MINUS_SRC_ALPHA";break;case"FILTER":r.blendSrc="GL_DST_COLOR",r.blendDest="GL_ZERO";break;default:r.blendDest=n.next().toUpperCase()}break;case"depthfunc":r.depthFunc=n.next().toLowerCase();break;case"depthwrite":r.depthWrite=!0,r.depthWriteOverride=!0;break;case"tcmod":var a={type:n.next().toLowerCase()};switch(a.type){case"rotate":a.angle=parseFloat(n.next())*(3.1415/180);break;case"scale":a.scaleX=parseFloat(n.next()),a.scaleY=parseFloat(n.next());break;case"scroll":a.sSpeed=parseFloat(n.next()),a.tSpeed=parseFloat(n.next());break;case"stretch":a.waveform=f(n),a.waveform||(a.type=null);break;case"turb":a.turbulance={base:parseFloat(n.next()),amp:parseFloat(n.next()),phase:parseFloat(n.next()),freq:parseFloat(n.next())};break;default:a.type=null}a.type&&r.tcMods.push(a);break;case"tcgen":r.tcGen=n.next();break;default:}}return r.blendSrc=="GL_ONE"&&r.blendDest=="GL_ZERO"&&(r.hasBlendFunc=!1,r.depthWrite=!0),r}function f(e){return{funcName:e.next().toLowerCase(),base:parseFloat(e.next()),amp:parseFloat(e.next()),phase:parseFloat(e.next()),freq:parseFloat(e.next())}}function l(e,t,n){var r=c(t,n),i=r.getFragmentSource(),s=r.getVertexSource(),o=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(o,i),e.compileShader(o);if(!e.getShaderParameter(o,e.COMPILE_STATUS))return console.log("Could not compile fragment shader:"),console.log(e.getShaderInfoLog(o)),console.log(s),console.log(i),e.deleteShader(o),null;var u=e.createShader(e.VERTEX_SHADER);e.shaderSource(u,s),e.compileShader(u);if(!e.getShaderParameter(u,e.COMPILE_STATUS))return console.log("Could not compile vertex shader:"),console.log(e.getShaderInfoLog(u)),console.log(s),console.log(i),e.deleteShader(u),null;var a=e.createProgram();e.attachShader(a,u),e.attachShader(a,o),e.linkProgram(a);if(!e.getProgramParameter(a,e.LINK_STATUS))return console.log("Could not link shaders"),console.log(s),console.log(i),e.deleteProgram(a),e.deleteShader(u),e.deleteShader(o),null;var f,l,h,p=e.getProgramParameter(a,e.ACTIVE_ATTRIBUTES);a.attrib={};for(f=0;f<p;f++)l=e.getActiveAttrib(a,f),a.attrib[l.name]=e.getAttribLocation(a,l.name);var d=e.getProgramParameter(a,e.ACTIVE_UNIFORMS);a.uniform={};for(f=0;f<d;f++)h=e.getActiveUniform(a,f),a.uniform[h.name]=e.getUniformLocation(a,h.name);return a}function c(e,n){var i=new o;i.addAttrib("position","vec3"),i.addAttrib("normal","vec3"),i.addVarying("vPosition","vec3"),i.addVarying("vNormal","vec3"),i.addUniform("modelViewMatrix","mat4"),i.addUniform("projectionMatrix","mat4"),i.addUniform("viewPosition","vec3"),i.addUniform("time","float"),n&r.POSITION_LERP&&(i.addAttrib("position2","vec3"),i.addAttrib("normal2","vec3"),i.addUniform("backlerp","float")),n&r.DLIGHTS&&(i.addUniform("dlightPositions["+t+"]","vec3"),i.addUniform("dlightInfo["+t+"]","vec4")),n&r.POSITION_LERP?i.addVertexLines(["vec3 defPosition = position + backlerp * (position2 - position);","vec3 defNormal = normal + backlerp * (normal2 - normal);"]):i.addVertexLines(["vec3 defPosition = position;","vec3 defNormal = normal;"]),i.addVertexLines(["vPosition = defPosition;","vNormal = defNormal;"]);var s=!1,u=!1,a=!1;for(var f=0;f<e.stages.length;f++){var l=e.stages[f];switch(l.rgbGen){case"vertex":case"exactvertex":s=!0;break;case"entity":u=!0;break;case"lightingdiffuse":a=!0}switch(l.alphaGen){case"vertex":case"lightingspecular":s=!0;break;case"entity":u=!0}}s&&(i.addAttrib("color","vec4"),i.addVarying("vColor","vec4"),i.addVertexLines(["vColor = color;"])),u&&i.addUniform("entityColor","vec4"),a&&(i.addUniform("lightDir","vec3"),i.addUniform("ambientLight","vec3"),i.addUniform("directedLight","vec3"),i.addVarying("vDiffuseScale","float"),i.addVertexLines(["vDiffuseScale = max(0.0, dot(defNormal, lightDir));"]));for(var f=0;f<e.vertexDeforms.length;f++){var c=e.vertexDeforms[f];switch(c.type){case"wave":var d="deform"+f,v="deformOff"+f;i.addVertexLines(["float "+v+" = (position.x + position.y + position.z) * "+c.spread.toFixed(4)+";"]);var m=c.waveform.phase;c.waveform.phase=m.toFixed(4)+" + "+v,i.addVertexLines([i.createWaveform(d,c.waveform,!0)]),c.waveform.phase=m,i.addVertexLines(["defPosition += defNormal * "+d+";"]);break;default:}}var g=e.sky?"0.0":"1.0";i.addVertexLines(["vec4 worldPosition = modelViewMatrix * vec4(defPosition, "+g+");"]);for(var f=0;f<e.stages.length;f++){var l=e.stages[f];h(i,e,l,f)}i.addVertexLines(["gl_Position = projectionMatrix * worldPosition;"]),e.sky&&i.addVertexLines(["gl_Position.w = gl_Position.z + 0.001;"]),i.addFragmentLines(["vec4 passColor;"]),e.fog&&i.addFragmentLines(["vec4 fragColor = vec4(1.0, 1.0, 1.0, 1.0);","float z = (gl_FragCoord.z / gl_FragCoord.w) / 4000.0;","fragColor.a = z;"]);for(var f=0;f<e.stages.length;f++){var l=e.stages[f];p(i,e,l,f)}if(n&r.DLIGHTS){var y="vec4 dlightPass() {\n	vec4 fragColor = vec4(0.0, 0.0, 0.0, 1.0);\n	vec3 dir;\n	float distance;\n";for(var f=0;f<t;f++)y+="	if (dlightInfo["+f+"].w > 0.0) {\n"+"		dir = vPosition.xyz - dlightPositions["+f+"].xyz;\n"+"		distance = 1.0 - min((length(dir) / dlightInfo["+f+"].w), 1.0);\n"+"		fragColor.rgb += dlightInfo["+f+"].rgb * distance;\n"+"	}\n";y+="	return fragColor;\n}\n",i.addFragmentFunction("dlightPass",y),i.addFragmentLines(["passColor = dlightPass();",i.createBlend("passColor","fragColor","GL_DST_COLOR","GL_ONE")])}return i.addFragmentLines(["gl_FragColor = fragColor;"]),i}function h(e,t,n,r){var i="vertPass"+r,s="vTexCoord"+r;e.addVarying(s,"vec2"),n.isLightmap?e.addAttrib("lightCoord","vec2"):e.addAttrib("texCoord","vec2");var o="vec2 "+i+"(vec4 worldPosition, vec3 normal) {\n";o+="	vec2 vTexCoord;\n",n.tcGen==="environment"?o+=["	vec3 viewer = normalize(viewPosition - position);\n","float d = dot(normal, viewer);\n","vec3 reflected = normal * 2.0 * d - viewer;\n","vTexCoord = vec2(0.5 + reflected.y * 0.5, 0.5 - reflected.z * 0.5);\n"].join("\n	"):n.isLightmap?o+="	vTexCoord = lightCoord;\n":o+="	vTexCoord = texCoord;\n";switch(n.alphaGen){case"lightingspecular":e.addVertexFunction("specular","float specular() {\n	vec3 lightOrigin = vec3(-960.0, 1980.0, 96.0);\n	vec3 lightDir = normalize(lightOrigin - position);\n	float d = dot(normal, lightDir);\n	vec3 reflected = normal * 2.0 * d - lightDir;\n	vec3 viewer = viewPosition - position;\n	float ilength = inversesqrt(dot(viewer, viewer));\n	float l = dot(reflected, viewer) * ilength;\n	if (l > 0.0) {\n		l = l*l*l;\n	} else {\n		l = 0.0;\n	}\n	return l;}"),e.addVertexLines(["vColor.a = min(specular(), 1.0);"]);break;default:}for(var u=0;u<n.tcMods.length;u++){var a=n.tcMods[u];switch(a.type){case"rotate":o+=["	float r = "+a.angle.toFixed(4)+" * time;","vTexCoord -= vec2(0.5, 0.5);","vTexCoord = vec2(vTexCoord.s * cos(r) - vTexCoord.t * sin(r), vTexCoord.t * cos(r) + vTexCoord.s * sin(r));","vTexCoord += vec2(0.5, 0.5);\n"].join("\n	");break;case"scroll":o+="	vTexCoord += vec2("+a.sSpeed.toFixed(4)+" * time, "+a.tSpeed.toFixed(4)+" * time);\n";break;case"scale":o+="	vTexCoord *= vec2("+a.scaleX.toFixed(4)+", "+a.scaleY.toFixed(4)+");\n";break;case"stretch":o+=["	"+e.createWaveform("stretchWave",a.waveform,!0),"stretchWave = 1.0 / stretchWave;","vTexCoord *= stretchWave;","vTexCoord += vec2(0.5 - (0.5 * stretchWave), 0.5 - (0.5 * stretchWave));\n"].join("\n	");break;case"turb":var f="turbTime"+u;o+=["	float "+f+" = "+a.turbulance.phase.toFixed(4)+" + time * "+a.turbulance.freq.toFixed(4)+";","vTexCoord.s += sin( ( ( position.x + position.z )* 1.0/128.0 * 0.125 + "+f+" ) * 6.283) * "+a.turbulance.amp.toFixed(4)+";","vTexCoord.t += sin( ( position.y * 1.0/128.0 * 0.125 + "+f+" ) * 6.283) * "+a.turbulance.amp.toFixed(4)+";\n"].join("\n	");break;default:}}o+="	return vTexCoord;\n",o+="}",e.addVertexFunction(i,o),e.addVertexLines([s+" = "+i+"(worldPosition, defNormal);"])}function p(e,t,n,r){var i="fragPass"+r,s="texSampler"+r,o="vTexCoord"+r;e.addUniform(s,"sampler2D");var u="vec4 "+i+"(sampler2D texture, vec2 vTexCoord) {\n";u+="	vec4 texColor = texture2D(texture, vTexCoord);\n";switch(n.rgbGen){case"vertex":case"exactvertex":u+="	vec3 rgb = texColor.rgb * vColor.rgb;\n";break;case"entity":u+="	vec3 rgb = texColor.rgb * entityColor.rgb;\n";break;case"lightingdiffuse":u+="	vec3 diffuse = ambientLight + vDiffuseScale * directedLight;\n",u+="	vec3 rgb = texColor.rgb * diffuse;\n";break;case"wave":u+="	"+e.createWaveform("rgbWave",n.rgbWaveform,!1)+"\n",u+="	vec3 rgb = texColor.rgb * rgbWave;\n";break;default:u+="	vec3 rgb = texColor.rgb;\n"}switch(n.alphaGen){case"vertex":case"lightingspecular":u+="	float alpha = texColor.a * vColor.a;\n";break;case"entity":u+="	float alpha = texColor.a * entityColor.a;\n";break;case"wave":u+="	"+e.createWaveform("alphaWave",n.alphaWaveform,!1),u+="	float alpha = texColor.a * alphaWave;\n";break;case"portal":u+="	float alpha = clamp(length(vPosition - viewPosition) / "+t.portalRange.toFixed(1)+", 0.0, 1.0);\n";break;default:u+="	float alpha = texColor.a;\n"}if(n.alphaFunc)switch(n.alphaFunc){case"GT0":u+="	if (alpha == 0.0) { discard; }\n";break;case"LT128":u+="	if (alpha >= 0.5) { discard; }\n";break;case"GE128":u+="	if (alpha < 0.5) { discard; }\n";break;default:}u+="	return vec4(rgb, alpha);\n",u+="}",e.addFragmentFunction(i,u),r===0&&!t.fog?e.addFragmentLines(["vec4 fragColor = "+i+"("+s+", "+o+");"]):e.addFragmentLines(["passColor = "+i+"("+s+", "+o+");",e.createBlend("passColor","fragColor",n.blendSrc,n.blendDest)])}var t=32,n={BAD:0,PORTAL:1,ENVIRONMENT:2,OPAQUE:3,DECAL:4,SEE_THROUGH:5,BANNER:6,FOG:7,UNDERWATER:8,BLEND0:9,BLEND1:10,BLEND2:11,BLEND3:12,BLEND6:13,STENCIL_SHADOW:14,ALMOST_NEAREST:15,NEAREST:16},r={POSITION_LERP:1,DLIGHTS:2},i=function(){this.name=null,this.sort=0,this.surfaceParms=[],this.cull="front",this.sky=!1,this.fog=!1,this.polygonOffset=!1,this.entityMergable=!1,this.positionLerp=!1,this.portalRange=0,this.stages=[],this.vertexDeforms=[]},s=function(){this.maps=[],this.animFreq=0,this.clamp=!1,this.tcGen="base",this.rgbGen="identity",this.rgbWaveform=null,this.alphaGen="1.0",this.alphaFunc=null,this.alphaWaveform=null,this.blendSrc="GL_ONE",this.blendDest="GL_ZERO",this.hasBlendFunc=!1,this.tcMods=[],this.depthFunc="lequal",this.depthWrite=!0,this.isLightmap=!1},o=function(){this.attribs={},this.varyings={},this.uniforms={},this.vertexFunctions={},this.fragmentFunctions={},this.vertexLines=[],this.fragmentLines=[]};return o.prototype.addAttrib=function(e,t){this.attribs[e]=t},o.prototype.addVarying=function(e,t){this.varyings[e]=t},o.prototype.addUniform=function(e,t){this.uniforms[e]=t},o.prototype.addVertexFunction=function(e,t){this.vertexFunctions[e]=t},o.prototype.addFragmentFunction=function(e,t){this.fragmentFunctions[e]=t},o.prototype.addVertexLines=function(e){var t;for(t in e)this.vertexLines.push(e[t])},o.prototype.addFragmentLines=function(e){var t;for(t in e)this.fragmentLines.push(e[t])},o.prototype.createWaveform=function(e,t,n){if(!t)return"float "+e+" = 0.0;";typeof t.phase=="number"&&(t.phase=t.phase.toFixed(4));var r="time",i;switch(t.funcName){case"sin":return"float "+e+" = "+t.base.toFixed(4)+" + sin(("+t.phase+" + "+r+" * "+t.freq.toFixed(4)+") * 6.283) * "+t.amp.toFixed(4)+";";case"square":i="square",this.addSquareFunc(n);break;case"triangle":i="triangle",this.addTriangleFunc(n);break;case"sawtooth":i="fract";break;case"inversesawtooth":i="1.0 - fract";break;default:return"float "+e+" = 0.0;"}return"float "+e+" = "+t.base.toFixed(4)+" + ("+i+"("+t.phase+" + "+r+" * "+t.freq.toFixed(4)+")) * "+t.amp.toFixed(4)+";"},o.prototype.addSquareFunc=function(e){var t=["float square(float val) {","	return (mod(floor(val*2.0)+1.0, 2.0) * 2.0) - 1.0;","}"].join("\n");e?this.addVertexFunction("square",t):this.addFragmentFunction("square",t)},o.prototype.addTriangleFunc=function(e){var t=["float triangle(float val) {","	return abs(2.0 * fract(val) - 1.0);","}"].join("\n");e?this.addVertexFunction("triangle",t):this.addFragmentFunction("triangle",t)},o.prototype.createBlend=function(e,t,n,r){var i,s;switch(n){case"GL_ZERO":i="";break;case"GL_ONE":i=e;break;case"GL_DST_COLOR":i=e+" * "+t;break;case"GL_ONE_MINUS_DST_COLOR":i=e+" * (1.0 - "+t+")";break;case"GL_SRC_ALPHA":i=e+" * "+e+".a";break;case"GL_ONE_MINUS_SRC_ALPHA":i=e+" * (1.0 - "+e+".a)";break;case"GL_DST_ALPHA":i=e+" * "+t+".a";break;case"GL_ONE_MINUS_DST_ALPHA":i=e+" * (1.0 - "+t+".a)";break;default:i=e}switch(r){case"GL_ZERO":s="";break;case"GL_ONE":s=t;break;case"GL_SRC_COLOR":s=t+" * "+e;break;case"GL_ONE_MINUS_SRC_COLOR":s=t+" * (1.0 - "+e+")";break;case"GL_SRC_ALPHA":s=t+" * "+e+".a";break;case"GL_ONE_MINUS_SRC_ALPHA":s=t+" * (1.0 - "+e+".a)";break;case"GL_DST_ALPHA":s=t+" * "+t+".a";break;case"GL_ONE_MINUS_DST_ALPHA":s=t+" * (1.0 - "+t+".a)";break;default:s=t}return t+" = "+i+(i!==""&&s!==""?" + ":"")+s+";"},o.prototype.getVertexSource=function(){var e="#ifdef GL_ES\n	precision highp float;\n#endif\n";for(var t in this.attribs)e+="attribute "+this.attribs[t]+" "+t+";\n";for(var t in this.varyings)e+="varying "+this.varyings[t]+" "+t+";\n";for(var t in this.uniforms)e+="uniform "+this.uniforms[t]+" "+t+";\n";e+="\n";for(var t in this.vertexFunctions)e+=this.vertexFunctions[t]+"\n";return e+="void main() {\n	",e+=this.vertexLines.join("\n	"),e+="\n}\n",e},o.prototype.getFragmentSource=function(){var e="#ifdef GL_ES\n	precision highp float;\n#endif\n";for(var t in this.varyings)e+="varying "+this.varyings[t]+" "+t+";\n";for(var t in this.uniforms)e+="uniform "+this.uniforms[t]+" "+t+";\n";e+="\n";for(var t in this.fragmentFunctions)e+=this.fragmentFunctions[t]+"\n";return e+="void main() {\n	",e+=this.fragmentLines.join("\n	"),e+="\n}\n",e},{MAX_DLIGHTS:t,SS:n,CFLAGS:r,Script:i,ScriptStage:s,parse:u,compile:l}}),define("renderer/re",["underscore","async","glmatrix","ByteBuffer","common/qmath","common/qshared","common/asset-cache","common/bsp-serializer","common/shader-compiler","common/text-tokenizer"],function(e,t,n,r,i,s,o,u,a,f){function l(n){function Mt(){var e=Array.prototype.slice.call(arguments);e.splice(0,0,"RE:"),Function.apply.call(console.log,console,e)}function _t(e){c.Error(e)}function Dt(e){Mt("Initializing"),kt=new H,Lt=new V,At=l.GetGLContext(),Pn(),dn(),ci(),Ir(),as(),mr(),Qt(),kt.entityGeo=new Z,kt.entityGeo.dynamic=!0,kt.entityGeo.attributes.index=an("index",4095,"uint"),kt.entityGeo.attributes.position=an("position",4095,"vec3"),kt.entityGeo.attributes.normal=an("normal",4095,"vec3"),kt.entityGeo.attributes.texCoord=an("texCoord",4095,"vec2"),kt.entityGeo.attributes.color=an("color",4095,"vec4"),Zr(function(t){if(t){_t("Failed to load shader scripts.");return}e()})}function Pt(){Mt("Shutting down"),l.CancelFileCallbacks("renderer"),hi()}function Bt(e){for(var t in Ht){var n=At.getExtension(Ht[t]+e);if(n)return n}return null}function jt(e){var t,n=kt.or,r=vec3.create(),i=[vec3.create(),vec3.create(),vec3.create(),vec3.create(),vec3.create(),vec3.create(),vec3.create(),vec3.create()];for(t=0;t<8;t++)r[0]=e[t&1][0],r[1]=e[t>>1&1][1],r[2]=e[t>>2&1][2],vec3.set(n.origin,i[t]),vec3.add(i[t],vec3.scale(n.axis[0],r[0],vec3.create())),vec3.add(i[t],vec3.scale(n.axis[1],r[1],vec3.create())),vec3.add(i[t],vec3.scale(n.axis[2],r[2],vec3.create()));var s=0,o=[0,0,0,0,0,0,0,0],u=kt.viewParms;for(t=0;t<4;t++){var a=u.frustum[t],f=0,l=0;for(var c=0;c<8;c++){o[c]=vec3.dot(i[c],a.normal);if(o[c]>a.dist){f=1;if(l)break}else l=1}if(!f)return P.OUT;s|=l}return s?P.CLIP:P.IN}function Ft(e,t){var n=vec3.create();return Kt(e,n),It(n,t)}function It(e,t){var n=kt.viewParms,r=!1;for(var i=0;i<4;i++){var s=n.frustum[i],o=vec3.dot(e,s.normal)-s.dist;if(o<-t)return P.OUT;o<=t&&(r=!0)}return r?P.CLIP:P.IN}function qt(e){var t=mat4.create();t[0]=e.axis[0][0],t[4]=e.axis[0][1],t[8]=e.axis[0][2],t[12]=-e.origin[0]*t[0]+ -e.origin[1]*t[4]+ -e.origin[2]*t[8],t[1]=e.axis[1][0],t[5]=e.axis[1][1],t[9]=e.axis[1][2],t[13]=-e.origin[0]*t[1]+ -e.origin[1]*t[5]+ -e.origin[2]*t[9],t[2]=e.axis[2][0],t[6]=e.axis[2][1],t[10]=e.axis[2][2],t[14]=-e.origin[0]*t[2]+ -e.origin[1]*t[6]+ -e.origin[2]*t[10],t[3]=0,t[7]=0,t[11]=0,t[15]=1,mat4.multiply(Ot,t,e.modelMatrix),vec3.set(e.origin,e.viewOrigin)}function Rt(e,t,n){if(e.reType!==I.MODEL){t.or.clone(n);return}vec3.set(e.origin,n.origin),vec3.set(e.axis[0],n.axis[0]),vec3.set(e.axis[1],n.axis[1]),vec3.set(e.axis[2],n.axis[2]);var r=n.modelMatrix;r[0]=n.axis[0][0],r[4]=n.axis[1][0],r[8]=n.axis[2][0],r[12]=n.origin[0],r[1]=n.axis[0][1],r[5]=n.axis[1][1],r[9]=n.axis[2][1],r[13]=n.origin[1],r[2]=n.axis[0][2],r[6]=n.axis[1][2],r[10]=n.axis[2][2],r[14]=n.origin[2],r[3]=0,r[7]=0,r[11]=0,r[15]=1,mat4.multiply(t.or.modelMatrix,n.modelMatrix,n.modelMatrix);var s=vec3.subtract(t.or.origin,n.origin,vec3.create()),o=1;e.nonNormalizedAxes&&(o=vec3.length(e.axis[0]),o?o=1/o:o=0),i.RotatePoint(s,n.axis),vec3.scale(s,o,n.viewOrigin)}function Ut(){var e=kt.viewParms,t=bn(),n=t*Math.tan(e.fovY*Math.PI/360),r=-n,i=t*Math.tan(e.fovX*Math.PI/360),s=-i,o=i-s,u=n-r;e.projectionMatrix[0]=2*t/o,e.projectionMatrix[4]=0,e.projectionMatrix[8]=(i+s)/o,e.projectionMatrix[12]=0,e.projectionMatrix[1]=0,e.projectionMatrix[5]=2*t/u,e.projectionMatrix[9]=(n+r)/u,e.projectionMatrix[13]=0,e.projectionMatrix[3]=0,e.projectionMatrix[7]=0,e.projectionMatrix[11]=-1,e.projectionMatrix[15]=0}function Wt(){var e=kt.viewParms;Vt();var t=bn(),n=e.zFar,r=n-t;e.projectionMatrix[2]=0,e.projectionMatrix[6]=0,e.projectionMatrix[10]=-(n+t)/r,e.projectionMatrix[14]=-2*n*t/r}function Xt(){var e=kt.viewParms,t=e.fovX/180*Math.PI*.5,n=Math.sin(t),r=Math.cos(t);vec3.scale(e.or.axis[0],n,e.frustum[0].normal),vec3.add(e.frustum[0].normal,vec3.scale(e.or.axis[1],r,vec3.create())),vec3.scale(e.or.axis[0],n,e.frustum[1].normal),vec3.add(e.frustum[1].normal,vec3.scale(e.or.axis[1],-r,vec3.create())),t=e.fovY/180*Math.PI*.5,n=Math.sin(t),r=Math.cos(t),vec3.scale(e.or.axis[0],n,e.frustum[2].normal),vec3.add(e.frustum[2].normal,vec3.scale(e.or.axis[2],r,vec3.create())),vec3.scale(e.or.axis[0],n,e.frustum[3].normal),vec3.add(e.frustum[3].normal,vec3.scale(e.or.axis[2],-r,vec3.create()));for(var s=0;s<4;s++)e.frustum[s].type=i.PLANE_NON_AXIAL,e.frustum[s].dist=vec3.dot(e.or.origin,e.frustum[s].normal),e.frustum[s].signbits=i.GetPlaneSignbits(e.frustum[s].normal)}function Vt(){var e=kt.viewParms,t=0;for(var n=0;n<8;n++){var r=vec3.create();n&1?r[0]=e.visBounds[0][0]:r[0]=e.visBounds[1][0],n&2?r[1]=e.visBounds[0][1]:r[1]=e.visBounds[1][1],n&4?r[2]=e.visBounds[0][2]:r[2]=e.visBounds[1][2];var i=vec3.subtract(r,e.or.origin,vec3.create()),s=vec3.squaredLength(i);s>t&&(t=s)}e.zFar=Math.sqrt(t)}function $t(e){e.clone(kt.viewParms),kt.viewParms.frameCount=kt.frameCount++,kt.viewCount++,qt(kt.viewParms.or),Xt(),Ut();var t=kt.refdef.numDrawGeom;Hn();var n=kt.refdef.numDrawGeom;jn(t,n);var r=kt.refdef,i=Lt.drawGeom,s=kt.sortedShaders;for(var o=t;o<n;o++){var u=i[o],a=u.geo,f=s[(u.sort>>O)%D],l=(u.sort>>A)%d;if(f.sort>S.PORTAL)break;f.sort===S.BAD&&_t("Shader '"+f.name+"' with sort === SS.BAD");if(Or(a,l))break}Gt(t,n)}function Jt(e,t){var n=kt.or;t[0]=e[0]*n.axis[0][0]+e[1]*n.axis[1][0]+e[2]*n.axis[2][0],t[1]=e[1]*n.axis[0][1]+e[1]*n.axis[1][1]+e[2]*n.axis[2][1],t[2]=e[2]*n.axis[0][2]+e[1]*n.axis[1][2]+e[2]*n.axis[2][2]}function Kt(e,t){var n=kt.or;t[0]=e[0]*n.axis[0][0]+e[1]*n.axis[1][0]+e[2]*n.axis[2][0]+n.origin[0],t[1]=e[1]*n.axis[0][1]+e[1]*n.axis[1][1]+e[2]*n.axis[2][1]+n.origin[1],t[2]=e[2]*n.axis[0][2]+e[1]*n.axis[1][2]+e[2]*n.axis[2][2]+n.origin[2]}function Qt(){}function Gt(e,t){kt.refdef.clone(Lt.refdef),kt.viewParms.clone(Lt.viewParms);var n=kt.world,r=n.shaders,i=Lt.refdef,s=Lt.viewParms,o=Lt.drawGeom,u=kt.sortedShaders;Yt(),tn();var a=null,f=-1,l;Lt.currentEntity=null;var c=Lt.refdef.timeSecs;for(var h=e;h<t;h++){var p=o[h],m=p.geo,g=u[(p.sort>>O)%D],y=(p.sort>>A)%d,b=g.entityMergable||Lt.currentEntity&&Lt.currentEntity.reType===I.POLY,w=b&&g===a;w||(a&&rn(a),nn(g,m),a=g),f!==y&&(y!==v?(Lt.currentEntity=Lt.refents[y],Lt.refdef.timeSecs=c-Lt.currentEntity.shaderTime,Lt.shaderTime=Lt.refdef.timeSecs,Rt(Lt.currentEntity,Lt.viewParms,Lt.or)):(Lt.currentEntity=null,Lt.refdef.timeSecs=c,Lt.shaderTime=Lt.refdef.timeSecs,s.or.clone(Lt.or)),f=y),m instanceof Q?Gn(m):m instanceof Y?Yn(m):m instanceof Z?Zn(m):m instanceof G&&oi(m)}f!==-1&&rn(),_n()&&en(),Mn()&&un()}function Yt(){At.viewport(0,0,Lt.viewParms.width,Lt.viewParms.height),At.scissor(0,0,Lt.viewParms.width,Lt.viewParms.height),At.clearColor(0,0,0,1),At.clearDepth(1),At.enable(At.DEPTH_TEST),At.depthMask(!0),At.clear(At.DEPTH_BUFFER_BIT);if(Lt.refdef.rdflags&R.HYPERSPACE){Zt();return}}function Zt(){var e=Lt.refdef.time%256/255;At.clearColor(e,e,e,1),At.clear(At.COLOR_BUFFER_BIT)}function en(){}function tn(){var e=Lt.dlightPositions,t=Lt.dlightInfo;for(var n=0;n<m;n++){var r=Lt.dlights[n];e[n*3+0]=r.origin[0],e[n*3+1]=r.origin[1],e[n*3+2]=r.origin[2],t[n*4+0]=r.color[0],t[n*4+1]=r.color[1],t[n*4+2]=r.color[2],t[n*4+3]=n>=Lt.refdef.numDlights?0:r.radius}}function nn(e,t){Lt.currentShader=e,Lt.currentGeo=t,Lt.shaderTime=Lt.refdef.timeSecs,Lt.dlightBits=0}function rn(){var e=Lt.currentShader,t=Lt.currentGeo,n=e.program,r=t.attributes.index.index;kt.counts.shaders++,kt.counts.indexes+=r,hn(e),pn(e),fn(t,e),At.drawElements(At.TRIANGLES,r,At.UNSIGNED_SHORT,0),An()&&sn(),On()&&on(),ln(t)}function sn(){var e=Lt.tess,t=e.indexOffset,n=e.indexCount||e.index.elementCount;if(!e.xyz){_t("Can't draw triangles without xyz.");return}var r=e.index,i=Lt.debugBuffers.index;i.index=0;for(var s=0;s<n;s+=3)i.data[i.index++]=r.data[t+s+0],i.data[i.index++]=r.data[t+s+1],i.data[i.index++]=r.data[t+s+1],i.data[i.index++]=r.data[t+s+2],i.data[i.index++]=r.data[t+s+2],i.data[i.index++]=r.data[t+s+0];i.modified=!0;var o=zr("<debug>");hn(o),pn(o),BindBuffer(i),BindBuffer(e.xyz,o.program.attrib.position),At.drawElements(At.LINES,i.index,At.UNSIGNED_SHORT,0)}function on(){var e=Lt.tess,t=e.indexCount||e.index.elementCount,n=e.indexOffset;if(!e.xyz||!e.normal){_t("Can't draw normal without xyz and normal.");return}var r=e.index,i=e.xyz,s=e.normal,o=Lt.debugBuffers.index,u=Lt.debugBuffers.xyz;o.index=0,u.index=0;var a=0,f=vec3.create(),l=vec3.create();for(var c=0;c<t;c++)a=r.data[n+c],f[0]=i.data[a*3+0],f[1]=i.data[a*3+1],f[2]=i.data[a*3+2],l[0]=s.data[a*3+0],l[1]=s.data[a*3+1],l[2]=s.data[a*3+2],u.data[u.index++]=f[0],u.data[u.index++]=f[1],u.data[u.index++]=f[2],o.data[o.index++]=c*2,u.data[u.index++]=f[0]+l[0]*2,u.data[u.index++]=f[1]+l[1]*2,u.data[u.index++]=f[2]+l[2]*2,o.data[o.index++]=c*2+1;u.modified=!0,o.modified=!0;var h=zr("<debug>");hn(h),pn(h),BindBuffer(o),BindBuffer(u,h.program.attrib.position),At.drawElements(At.LINES,o.elementCount,At.UNSIGNED_SHORT,0)}function un(){var e=Lt.viewParms,t=Lt.debugBuffers.index,n=Lt.debugBuffers.xyz;n.index=0,t.index=0,e.or.clone(Lt.or);var r=vec3.add(vec3.scale(Lt.or.axis[0],128,vec3.create()),e.or.origin),s=vec3.create(),o=vec3.create(),u=vec3.create();for(var a=0;a<4;a++){var f=e.frustum[a],l=vec3.dot(e.or.origin,f.normal);if(l!==f.dist){_t("Frustum plane distance is invalid.");return}vec3.set(f.normal,s),i.ProjectPointOnPlane(e.or.axis[0],s,o),vec3.normalize(o),vec3.cross(f.normal,o,u),vec3.scale(u,32),vec3.scale(o,512);var c=n.elementCount;n.data[n.index++]=r[0]-u[0],n.data[n.index++]=r[1]-u[1],n.data[n.index++]=r[2]-u[2],n.data[n.index++]=r[0]+u[0],n.data[n.index++]=r[1]+u[1],n.data[n.index++]=r[2]+u[2],n.data[n.index++]=r[0]+o[0]+u[0],n.data[n.index++]=r[1]+o[1]+u[1],n.data[n.index++]=r[2]+o[2]+u[2],n.data[n.index++]=r[0]+o[0]-u[0],n.data[n.index++]=r[1]+o[1]-u[1],n.data[n.index++]=r[2]+o[2]-u[2],t.data[t.index++]=c+0,t.data[t.index++]=c+1,t.data[t.index++]=c+2,t.data[t.index++]=c+3,t.data[t.index++]=c+0,t.data[t.index++]=c+2}n.modified=!0,t.modified=!0;var h=zr("<debug>");hn(h),pn(h),BindBuffer(t),BindBuffer(n,h.program.attrib.position),At.drawElements(At.LINE_STRIP,t.elementCount,At.UNSIGNED_SHORT,0)}function an(e,t,n){var r=new J;e==="index"?r.type=At.ELEMENT_ARRAY_BUFFER:r.type=At.ARRAY_BUFFER;switch(n){case"uint":r.array=new Uint16Array(t),r.size=1,r.dataType=At.UNSIGNED_SHORT;break;case"vec2":r.array=new Float32Array(t*2),r.size=2,r.dataType=At.FLOAT;break;case"vec3":r.array=new Float32Array(t*3),r.size=3,r.dataType=At.FLOAT;break;case"vec4":r.array=new Float32Array(t*4),r.size=4,r.dataType=At.FLOAT}return r.buffer=At.createBuffer(),r}function fn(e,t){var n=e.attributes,r=t.program;for(var i in n){if(!n.hasOwnProperty(i))continue;var s=n[i];if(s.type===At.ARRAY_BUFFER&&typeof r.attrib[i]=="undefined")continue;At.bindBuffer(s.type,s.buffer);if(s.update){var o=s.array.subarray(0,s.index);At.bufferData(s.type,o,At.DYNAMIC_DRAW),s.update=!1}if(s.type===At.ARRAY_BUFFER){var u=2;s.dataType===At.FLOAT&&(u=4),At.enableVertexAttribArray(r.attrib[i]),At.vertexAttribPointer(r.attrib[i],s.size,s.dataType,!1,0,s.offset*u)}}}function ln(e){if(!e.dynamic)return;var t=e.attributes;for(var n in t){if(!t.hasOwnProperty(n))continue;var r=t[n];r.index=0}}function hn(e){var t=Lt.tess,n=e.program;e!==cn&&(e.cull?(At.enable(At.CULL_FACE),At.cullFace(e.cull)):At.disable(At.CULL_FACE),e.hasBlendFunc?(At.enable(At.BLEND),At.blendFunc(e.blendSrc,e.blendDest)):At.disable(At.BLEND),e.depthWrite?(At.depthMask(!0),At.depthFunc(e.depthFunc)):At.depthMask(!1),e.polygonOffset?(At.enable(At.POLYGON_OFFSET_FILL),At.polygonOffset(-1,-2)):At.disable(At.POLYGON_OFFSET_FILL)),e!==cn&&At.useProgram(n);for(var r=0;r<e.stages.length;r++){var i=e.stages[r],s=i.textures[0];if(e===cn&&!i.animFreq)continue;if(i.animFreq){var o=Math.floor(Lt.shaderTime*i.animFreq)%i.textures.length;s=i.textures[o]}At.activeTexture(At.TEXTURE0+r),At.uniform1i(n.uniform["texSampler"+r],r),At.bindTexture(At.TEXTURE_2D,s.texnum)}cn=e}function pn(e){var t=e.program;At.uniformMatrix4fv(t.uniform.modelViewMatrix,!1,Lt.or.modelMatrix),At.uniformMatrix4fv(t.uniform.projectionMatrix,!1,Lt.viewParms.projectionMatrix),t.uniform.viewPosition!==undefined&&At.uniform3fv(t.uniform.viewPosition,Lt.or.viewOrigin),t.uniform.time!==undefined&&At.uniform1f(t.uniform.time,Lt.shaderTime),t.uniform["dlightPositions[0]"]!==undefined&&At.uniform3fv(t.uniform["dlightPositions[0]"],Lt.dlightPositions),t.uniform["dlightInfo[0]"]!==undefined&&At.uniform4fv(t.uniform["dlightInfo[0]"],Lt.dlightInfo);if(Lt.currentEntity!==null){var n=Lt.currentEntity;t.uniform.entityColor!==undefined&&At.uniform4fv(t.uniform.entityColor,n.shaderRGBA),t.uniform.lightDir!==undefined&&At.uniform3fv(t.uniform.lightDir,n.lightDir),t.uniform.ambientLight!==undefined&&At.uniform3fv(t.uniform.ambientLight,n.ambientLight),t.uniform.directedLight!==undefined&&At.uniform3fv(t.uniform.directedLight,n.directedLight);if(t.uniform.backlerp!==undefined){var r=n.oldFrame===n.frame?0:n.backlerp;At.uniform1f(t.uniform.backlerp,r)}}}function dn(){c.AddCmd("showcluster",vn),c.AddCmd("dlightnext",mn),c.AddCmd("dlightprev",gn)}function vn(){var e=Rn(kt.viewParms.pvsOrigin);Mt("Current cluster: "+e.cluster)}function mn(){var e=Dn();e++,e>=m&&(e=-1),Mt("ACTIVE DLIGHT",e),Dn(e)}function gn(){var e=Dn();e--,e<-1&&(e=m-1),Mt("ACTIVE DLIGHT",e),Dn(e)}function Pn(){yn=c.AddCvar("r_nocull",0),bn=c.AddCvar("r_znear",4),wn=c.AddCvar("r_lodscale",5,g.CHEAT),En=c.AddCvar("r_subdivisions",4),Sn=c.AddCvar("r_overBrightBits",0,g.ARCHIVE),xn=c.AddCvar("r_mapOverBrightBits",2,g.ARCHIVE),Tn=c.AddCvar("r_ambientScale",.6),Nn=c.AddCvar("r_directedScale",1),Cn=c.AddCvar("r_railCoreWidth",6,g.ARCHIVE),kn=c.AddCvar("r_dlights",1,g.ARCHIVE),Ln=c.AddCvar("r_pauseVis",0,g.CHEAT),An=c.AddCvar("r_showTris",0,g.CHEAT),On=c.AddCvar("r_showNormals",0,g.CHEAT),Mn=c.AddCvar("r_showFrustum",0,g.CHEAT),_n=c.AddCvar("r_showCollision",0,g.CHEAT),Dn=c.AddCvar("r_activeDlight",-1,g.CHEAT)}function Hn(){Fn(),Jn(),Wt()}function Bn(e,t){var n=kt.refdef.numDrawGeom%N;Lt.drawGeom[n].sort=t.sortedIndex<<O|kt.currentEntityNum<<A,Lt.drawGeom[n].geo=e,kt.refdef.numDrawGeom++}function jn(e,t){i.RadixSort(Lt.drawGeom,"sort",e,t)}function Fn(){if(kt.refdef.rdflags&R.NOWORLDMODEL)return;kt.currentEntityNum=v,qn(),i.ClearBounds(kt.viewParms.visBounds[0],kt.viewParms.visBounds[1]),kt.skyShader&&Bn(kt.skydomeGeo,kt.skyShader),zn(kt.world.nodes[0],15)}function In(e){var t=br(e.hModel),n=t.bmodel,r=kt.world.surfaces,i=jt(n.bounds);if(i===P.OUT)return;ar(e);for(var s=0;s<n.numSurfaces;s++){var o=r[n.firstSurface+s];Wn(o,!0)}}function qn(){var e=kt.world,t=e.nodes,n=Rn(kt.viewParms.pvsOrigin),r=n.cluster;if(kt.viewCluster===r)return;kt.viewCluster=r,kt.visCount++;if(kt.viewCluster===-1){for(var i=0,s=t.length;i<s;i++)t[i].contents!==b.SOLID&&(t[i].visframe=kt.visCount);return}for(var i=0,s=t.length;i<s;i++){var o=t[i],u=o.cluster;if(u<0||u>=e.numClusters)continue;if(!Un(kt.viewCluster,u))continue;var a=o;while(a){if(a.visframe===kt.visCount)break;a.visframe=kt.visCount,a=a.parent}}}function Rn(e){kt.world||c.Error("PointInLeaf: bad model");var t=kt.world.nodes[0];for(;;){if(!t.children)break;var n=t.plane,r=vec3.dot(e,n.normal)-n.dist;r>0?t=t.children[0]:t=t.children[1]}return t}function Un(e,t){var n=kt.world;if(!n||!n.vis||e===t||e==-1)return!0;var r=e*n.clusterBytes;return(n.vis[r+(t>>3)]&1<<(t&7))!==0}function zn(e,t){kt.counts.nodes++;for(;;){if(e.visframe!==kt.visCount)return;if(!yn()){var n;if(t&1){n=i.BoxOnPlaneSide(e.mins,e.maxs,kt.viewParms.frustum[0]);if(n===i.SIDE_BACK)return;n===i.SIDE_FRONT&&(t&=-2)}if(t&2){n=i.BoxOnPlaneSide(e.mins,e.maxs,kt.viewParms.frustum[1]);if(n===i.SIDE_BACK)return;n===i.SIDE_FRONT&&(t&=-3)}if(t&4){n=i.BoxOnPlaneSide(e.mins,e.maxs,kt.viewParms.frustum[2]);if(n===i.SIDE_BACK)return;n==i.SIDE_FRONT&&(t&=-5)}if(t&8){n=i.BoxOnPlaneSide(e.mins,e.maxs,kt.viewParms.frustum[3]);if(n===i.SIDE_BACK)return;n===i.SIDE_FRONT&&(t&=-9)}}if(!e.children)break;zn(e.children[0],t),e=e.children[1]}kt.counts.leafs++;var r=kt.viewParms;e.mins[0]<r.visBounds[0][0]&&(r.visBounds[0][0]=e.mins[0]),e.mins[1]<r.visBounds[0][1]&&(r.visBounds[0][1]=e.mins[1]),e.mins[2]<r.visBounds[0][2]&&(r.visBounds[0][2]=e.mins[2]),e.maxs[0]>r.visBounds[1][0]&&(r.visBounds[1][0]=e.maxs[0]),e.maxs[1]>r.visBounds[1][1]&&(r.visBounds[1][1]=e.maxs[1]),e.maxs[2]>r.visBounds[1][2]&&(r.visBounds[1][2]=e.maxs[2]);var s=kt.world.surfaces,o=kt.world.leafSurfaces;for(var u=0;u<e.numLeafSurfaces;u++){var a=s[o[e.firstLeafSurface+u]];Wn(a,!1)}}function Wn(e,t){if(!e.geo)return;kt.counts.surfaces++;if(e.geo.viewCount===kt.viewCount)return;e.geo.viewCount=kt.viewCount,e.geo.dlightBits=Xn(e),Bn(e.geo,e.shader)}function Xn(e){var t=0;return e.surfaceType===rt.FACE?t=Vn(e):e.surfaceType===rt.TRIANGLES&&(t=$n(e)),t}function Vn(e){var t=0;for(var n=0;n<kt.refdef.numDlights;n++){var r=Lt.dlights[n],i=vec3.dot(r.origin,e.plane.normal)-e.plane.dist;if(i>=-r.radius||i<=r.radius)t|=1<<n}return t}function $n(e){var t=(1<<kt.refdef.numDlights)-1;return t}function Jn(){for(var e=0;e<kt.refdef.numRefEnts;e++){var t=Lt.refents[e];kt.currentEntityNum=e;if(t.renderfx&q.FIRST_PERSON&&kt.viewParms.isPortal)continue;switch(t.reType){case I.PORTALSURFACE:break;case I.POLY:case I.SPRITE:case I.BEAM:case I.LIGHTNING:case I.RAIL_CORE:if(t.renderfx&q.THIRD_PERSON&&!kt.viewParms.isPortal)continue;var n=Ur(t.customShader);Bn(kt.entityGeo,n,0);break;case I.MODEL:Rt(t,kt.viewParms,kt.or);var r=br(t.hModel);switch(r.type){case it.MD3:Kn(t);break;case it.BRUSH:In(t)}break;default:c.Error("AddEntityGeos: BadGeometry")}}}function Kn(e){var t=br(e.hModel);if(t.type===it.BAD)return;var n=e.renderfx&q.THIRD_PERSON&&!kt.viewParms.isPortal,r=t.md3,i=Qn(r,e);if(i===P.OUT)return;n||ar(e);for(var s=0;s<r.surfaces.length;s++){var o=r.surfaces[s],u;if(e.customShader)u=Ur(e.customShader);else if(e.customSkin){var a=cs(e.customSkin);u=kt.defaultShader;for(var f=0;f<a.surfaces.length;f++)if(a.surfaces[f].name===o.name){u=a.surfaces[f].shader;break}}else o.shaders.length<=0?u=kt.defaultShader:u=o.shaders[e.skinNum%o.shaders.length];n||Bn(o.geo,u,0)}}function Qn(e,t){var n=e.frames[t.frame],r=e.frames[t.oldFrame];if(!t.nonNormalizedAxes)if(t.frame===t.oldframe)switch(Ft(n.localOrigin,n.radius)){case P.OUT:return kt.counts.culledModelOut++,P.OUT;case P.IN:return kt.counts.culledModelIn++,P.IN;case P.CLIP:kt.counts.culledModelClip++}else{var i=Ft(n.localOrigin,n.radius),s;n===r?s=i:s=Ft(r.localOrigin,r.radius);if(i===s){if(i===P.OUT)return kt.counts.culledModelOut++,P.OUT;if(i===P.IN)return kt.counts.culledModelIn++,P.IN;kt.counts.culledModelClip++}}var o=[vec3.create(),vec3.create()];for(var u=0;u<3;u++)o[0][u]=r.bounds[0][u]<n.bounds[0][u]?r.bounds[0][u]:n.bounds[0][u],o[1][u]=r.bounds[1][u]>n.bounds[1][u]?r.bounds[1][u]:n.bounds[1][u];switch(jt(o)){case P.OUT:return kt.counts.culledModelOut++,P.OUT;case P.IN:return kt.counts.culledModelIn++,P.IN;case P.CLIP:return kt.counts.culledModelClip++,P.CLIP;default:c.Error("Invalid cull result")}}function Gn(e){Lt.dlightBits|=e.dlightBits;if(e.initialized)return;var t=kt.world.verts,n=kt.world.meshVerts,r=e.attributes.index=an("index",e.numIndexes,"uint"),i=e.attributes.position=an("position",e.numVerts,"vec3"),s=e.attributes.normal=an("normal",e.numVerts,"vec3"),o=e.attributes.texCoord=an("texCoord",e.numVerts,"vec2"),u=e.attributes.lightCoord=an("lightCoord",e.numVerts,"vec2"),a=e.attributes.color=an("color",e.numVerts,"vec4");for(var f=0;f<e.faces.length;f++){var l=e.faces[f],c=i.index/i.size;for(var h=0;h<l.vertCount;h++){var p=t[l.vertex+h];i.array[i.index++]=p.pos[0],i.array[i.index++]=p.pos[1],i.array[i.index++]=p.pos[2],s.array[s.index++]=p.normal[0],s.array[s.index++]=p.normal[1],s.array[s.index++]=p.normal[2],o.array[o.index++]=p.texCoord[0],o.array[o.index++]=p.texCoord[1],u.array[u.index++]=p.lmCoord[0],u.array[u.index++]=p.lmCoord[1],a.array[a.index++]=p.color[0],a.array[a.index++]=p.color[1],a.array[a.index++]=p.color[2],a.array[a.index++]=p.color[3]}for(var h=0;h<l.meshVertCount;h++)r.array[r.index++]=c+n[l.meshVert+h]}r.update=!0,i.update=!0,s.update=!0,o.update=!0,u.update=!0,a.update=!0,e.initialized=!0,e.faces=null}function Yn(e){var t=e.surface,n=t.numFrames,r=t.numVerts,i=Lt.currentEntity;if(e.initialized){e.attributes.position.offset=i.frame*r*3,e.attributes.normal.offset=e.attributes.position.offset,e.attributes.position2.offset=i.oldFrame*r*3,e.attributes.normal2.offset=e.attributes.position2.offset;return}var s=t.indexes.length,o=e.attributes.index=an("index",s,"uint"),u=e.attributes.position=an("position",n*r,"vec3"),a=e.attributes.position2=u.clone(),f=e.attributes.normal=an("normal",n*r,"vec3"),l=e.attributes.normal2=f.clone(),c=e.attributes.texCoord=an("texCoord",r,"vec2");for(var h=0;h<n;h++)for(var p=0;p<r;p++){var d=h*r+p;u.array[u.index++]=t.xyz[d][0],u.array[u.index++]=t.xyz[d][1],u.array[u.index++]=t.xyz[d][2],f.array[f.index++]=t.normals[d][0],f.array[f.index++]=t.normals[d][1],f.array[f.index++]=t.normals[d][2],h===0&&(c.array[c.index++]=t.st[p][0],c.array[c.index++]=t.st[p][1])}for(var h=0;h<t.indexes.length;h++)o.array[o.index++]=t.indexes[h];e.attributes.position.offset=i.frame*r*3,e.attributes.normal.offset=i.frame*r*3,e.attributes.position2.index=e.attributes.position.index,e.attributes.position2.offset=i.oldFrame*r*3,e.attributes.normal2.index=e.attributes.normal.index,e.attributes.normal2.offset=i.oldFrame*r*3,u.update=!0,a.update=!0,f.update=!0,l.update=!0,c.update=!0,o.update=!0,e.initialized=!0}function Zn(e){switch(Lt.currentEntity.reType){case I.POLY:er(e);break;case I.SPRITE:tr(e);break;case I.RAIL_CORE:rr(e);break;case I.LIGHTNING:nr(e)}}function er(e){var t=Lt.currentEntity,n=e.attributes.index,r=e.attributes.position,i=e.attributes.normal,s=e.attributes.texCoord,o=e.attributes.color,u=r.index/r.size,a=t.polyVerts.length;for(var f=0;f<a;f++){var l=t.polyVerts[f];r.array[r.index++]=l.xyz[0],r.array[r.index++]=l.xyz[1],r.array[r.index++]=l.xyz[2],i.array[i.index++]=0,i.array[i.index++]=0,i.array[i.index++]=0,s.array[s.index++]=l.st[0],s.array[s.index++]=l.st[1],o.array[o.index++]=l.modulate[0],o.array[o.index++]=l.modulate[1],o.array[o.index++]=l.modulate[2],o.array[o.index++]=l.modulate[3]}for(var f=0;f<a-2;f++)n.array[n.index++]=u+0,n.array[n.index++]=u+f+1,n.array[n.index++]=u+f+2;n.update=!0,r.update=!0,i.update=!0,s.update=!0,o.update=!0}function tr(e){var t=Lt.currentEntity,n=t.radius,r=vec3.create(),i=vec3.create();if(t.rotation===0)vec3.scale(Lt.viewParms.or.axis[1],n,r),vec3.scale(Lt.viewParms.or.axis[2],n,i);else{var s=Math.PI*t.rotation/180,o=Math.sin(s),u=Math.cos(s);vec3.scale(Lt.viewParms.or.axis[1],u*n,r),vec3.add(r,vec3.scale(Lt.viewParms.or.axis[2],-o*n,vec3.create()),r),vec3.scale(Lt.viewParms.or.axis[2],u*n,i),vec3.add(i,vec3.scale(Lt.viewParms.or.axis[1],o*n,vec3.create()),i)}sr(e,t.origin,r,i,t.shaderRGBA)}function nr(e){var t=Lt.currentEntity,n=vec3.create(t.origin),r=vec3.create(t.oldOrigin),s=vec3.subtract(r,n,vec3.create());vec3.normalize(s);var o=vec3.subtract(n,Lt.viewParms.or.origin,vec3.create());vec3.normalize(o);var u=vec3.subtract(r,Lt.viewParms.or.origin,vec3.create());vec3.normalize(u);var a=vec3.cross(o,u,vec3.create());vec3.normalize(a);for(var f=0;f<4;f++)ir(e,n,r,a,8,t.shaderRGBA),i.RotatePointAroundVector(a,s,45)}function rr(e){var t=Lt.currentEntity,n=vec3.create(t.origin),r=vec3.create(t.oldOrigin),i=vec3.subtract(n,Lt.viewParms.or.origin,vec3.create());vec3.normalize(i);var s=vec3.subtract(r,Lt.viewParms.or.origin,vec3.create());vec3.normalize(s);var o=vec3.cross(i,s,vec3.create());vec3.normalize(o),ir(e,n,r,o,Cn(),t.shaderRGBA)}function ir(e,t,n,r,i,s){var o=vec3.subtract(n,t,vec3.create()),u=vec3.length(o),a=u/256,f=vec3.scale(o,-0.5,vec3.create()),l=vec3.scale(r,i,vec3.create()),c=vec3.subtract(t,f);or(e,c,f,l,s,0,0,a,1)}function sr(e,t,n,r,i){or(e,t,n,r,i,0,0,1,1)}function or(e,t,n,r,i,s,o,u,a){var f=e.attributes.index,l=e.attributes.position,c=e.attributes.normal,h=e.attributes.texCoord,p=e.attributes.color,d=l.index/l.size;f.array[f.index++]=d,f.array[f.index++]=d+1,f.array[f.index++]=d+3,f.array[f.index++]=d+3,f.array[f.index++]=d+1,f.array[f.index++]=d+2,l.array[l.index++]=t[0]+n[0]+r[0],l.array[l.index++]=t[1]+n[1]+r[1],l.array[l.index++]=t[2]+n[2]+r[2],l.array[l.index++]=t[0]-n[0]+r[0],l.array[l.index++]=t[1]-n[1]+r[1],l.array[l.index++]=t[2]-n[2]+r[2],l.array[l.index++]=t[0]-n[0]-r[0],l.array[l.index++]=t[1]-n[1]-r[1],l.array[l.index++]=t[2]-n[2]-r[2],l.array[l.index++]=t[0]+n[0]-r[0],l.array[l.index++]=t[1]+n[1]-r[1],l.array[l.index++]=t[2]+n[2]-r[2];var v=vec3.negate(Lt.viewParms.or.axis[0],vec3.create());c.array[c.index++]=v[0],c.array[c.index++]=v[1],c.array[c.index++]=v[2],c.array[c.index++]=v[0],c.array[c.index++]=v[1],c.array[c.index++]=v[2],c.array[c.index++]=v[0],c.array[c.index++]=v[1],c.array[c.index++]=v[2],c.array[c.index++]=v[0],c.array[c.index++]=v[1],c.array[c.index++]=v[2],h.array[h.index++]=s,h.array[h.index++]=o,h.array[h.index++]=u,h.array[h.index++]=o,h.array[h.index++]=u,h.array[h.index++]=a,h.array[h.index++]=s,h.array[h.index++]=a,p.array[p.index++]=i[0],p.array[p.index++]=i[1],p.array[p.index++]=i[2],p.array[p.index++]=i[3],p.array[p.index++]=i[0],p.array[p.index++]=i[1],p.array[p.index++]=i[2],p.array[p.index++]=i[3],p.array[p.index++]=i[0],p.array[p.index++]=i[1],p.array[p.index++]=i[2],p.array[p.index++]=i[3],p.array[p.index++]=i[0],p.array[p.index++]=i[1],p.array[p.index++]=i[2],p.array[p.index++]=i[3],f.update=!0,l.update=!0,c.update=!0,h.update=!0,p.update=!0}function ur(e){var t=kt.world,n=t.lightGridData,r=vec3.create(),i=vec3.create(),s=vec3.create();if(!n)return;e.renderfx&q.LIGHTING_ORIGIN?vec3.set(e.lightingOrigin,r):vec3.set(e.origin,r),vec3.subtract(r,t.lightGridOrigin);for(var o=0;o<3;o++){var u=r[o]*t.lightGridInverseSize[o];i[o]=Math.floor(u),s[o]=u-i[o],i[o]<0?i[o]=0:i[o]>=t.lightGridBounds[o]-1&&(i[o]=t.lightGridBounds[o]-1)}e.ambientLight=vec3.create(),e.directedLight=vec3.create();var a=[8,8*t.lightGridBounds[0],8*t.lightGridBounds[0]*t.lightGridBounds[1]],f=i[0]*a[0]+i[1]*a[1]+i[2]*a[2],l=vec3.create(),c=vec3.create(),h=0;for(var o=0;o<8;o++){var p=1,d=f;for(var v=0;v<3;v++)o&1<<v?(p*=s[v],d+=a[v]):p*=1-s[v];if(n[d]+n[d+1]+n[d+2]===0)continue;h+=p,e.ambientLight[0]+=p*n[d+0],e.ambientLight[1]+=p*n[d+1],e.ambientLight[2]+=p*n[d+2],e.directedLight[0]+=p*n[d+3],e.directedLight[1]+=p*n[d+4],e.directedLight[2]+=p*n[d+5];var m=n[d+7],g=n[d+6],y=m*2*Math.PI/255,b=g*2*Math.PI/255;l[0]=Math.cos(y)*Math.sin(b),l[1]=Math.sin(y)*Math.sin(b),l[2]=Math.cos(b),vec3.add(c,vec3.scale(l,p,vec3.create()))}h>0&&h<.99&&(h=1/h,vec3.scale(e.ambientLight,h),vec3.scale(e.directedLight,h)),vec3.scale(e.ambientLight,Tn()),vec3.scale(e.directedLight,Nn()),vec3.normalize(c,e.lightDir)}function ar(e){var t=vec3.create();if(e.lightingCalculated)return;e.lightingCalculated=!0,e.renderfx&q.LIGHTING_ORIGIN?vec3.set(e.lightingOrigin,t):vec3.set(e.origin,t),ur(e),e.ambientLight[0]+=kt.identityLight*32,e.ambientLight[1]+=kt.identityLight*32,e.ambientLight[2]+=kt.identityLight*32;var n=vec3.create(),r=vec3.length(e.directedLight);vec3.scale(e.lightDir,r,n),vec3.normalize(n);for(var i=0;i<3;i++)e.ambientLight[i]>kt.identityLightByte&&(e.ambientLight[i]=kt.identityLightByte);e.lightDir[0]=vec3.dot(n,e.axis[0]),e.lightDir[1]=vec3.dot(n,e.axis[1]),e.lightDir[2]=vec3.dot(n,e.axis[2]),vec3.scale(e.ambientLight,1/255),vec3.scale(e.directedLight,1/255)}function fr(e,t){var n=kt.world.verts,r=kt.world.meshVerts;kt.viewCount++;var s=vec3.normalize(t,vec3.create()),o=vec3.create(),u=vec3.create(),a=vec3.create();i.ClearBounds(o,u);for(var f=0;f<e.length;f++)i.AddPointToBounds(e[f],o,u),vec3.add(e[f],t,a),i.AddPointToBounds(a,o,u),vec3.add(e[f],vec3.scale(s,-20,vec3.create()),a),i.AddPointToBounds(a,o,u);var l=vec3.create(),c=vec3.create(),h=e.length,p=new Array(h+2);for(var f=0;f<p.length;f++)p[f]=new i.Plane;for(var f=0;f<h;f++){var d=p[f];vec3.subtract(e[(f+1)%h],e[f],l),vec3.add(e[f],t,c),vec3.subtract(e[f],c,c),vec3.cross(l,c,d.normal),vec3.normalize(d.normal),d.dist=vec3.dot(d.normal,e[f])}var v=p[h];vec3.set(s,v.normal),v.dist=vec3.dot(v.normal,e[0])-32;var m=p[h+1];vec3.negate(s,m.normal),m.dist=vec3.dot(m.normal,e[0])-20;var g=[];lr(kt.world.nodes[0],o,u,s,g);var y=[];for(var f=0;f<g.length;f++){var b=g[f],w=[];if(b.surfaceType===rt.FACE){if(vec3.dot(b.plane.normal,s)>-0.5)continue;for(var E=0;E<b.meshVertCount;E+=3){for(var S=0;S<3;S++){var x=n[b.vertex+r[b.meshVert+E+S]];w[S]=vec3.create(x.pos)}cr(w,p,y)}}}return y}function lr(e,t,n,r,s){while(e.children){var o=i.BoxOnPlaneSide(t,n,e.plane);o===i.SIDE_FRONT?e=e.children[0]:o===i.SIDE_BACK?e=e.children[1]:(lr(e.children[0],t,n,r,s),e=e.children[1])}var u=kt.world.surfaces,a=kt.world.leafSurfaces;for(var f=0;f<e.numLeafSurfaces;f++){var l=u[a[e.firstLeafSurface+f]];if(l.shader.surfaceFlags&(y.NOIMPACT|y.NOMARKS)||l.shader.contentFlags&b.FOG)l.viewCount=kt.viewCount;else if(l.surfaceType===rt.FACE){var o=i.BoxOnPlaneSide(t,n,l.plane);o===i.SIDE_FRONT||o===i.SIDE_BACK?l.viewCount=kt.viewCount:vec3.dot(l.plane.normal,r)>-0.5&&(l.viewCount=kt.viewCount)}else l.surfaceType!==rt.GRID&&l.surfaceType!==rt.TRIANGLES&&(l.viewCount=kt.viewCount);l.viewCount!==kt.viewCount&&(l.viewCount=kt.viewCount,s.push(l))}}function cr(e,t,n){var r=e;for(var i=0;i<t.length;i++){r=vr(r,t[i],.5);if(!r||r.length===0)break}if(!r||r.length===0)return;n.push(r)}function vr(e,t,n){var r=new Array(e.length),i=new Array(e.length),s=vec3.create(),o;for(o=0;o<e.length;o++){var u=vec3.dot(e[o],t.normal)-t.dist;r[o]=u,u>n?i[o]=hr:u<-n?i[o]=pr:i[o]=dr,s[i[o]]++}i[o]=i[0],r[o]=r[0];if(!s[hr])return null;var a=[];if(!s[pr]){for(var o=0;o<e.length;o++)a.push(vec3.set(e[o],vec3.create()));return a}for(var o=0;o<e.length;o++){var f=e[o];if(i[o]===dr){a.push(vec3.set(f,vec3.create()));continue}i[o]===hr&&a.push(vec3.set(f,vec3.create()));if(i[o+1]===dr||i[o+1]===i[o])continue;var l=e[(o+1)%e.length],u=r[o]-r[o+1],c=0;u!==0&&(c=r[o]/u),a.push(vec3.add(vec3.scale(vec3.subtract(l,f,vec3.create()),c),f))}return a}function mr(){kt.models=new o(gr()),kt.models.on("load",wr)}function gr(){var e=new st;return e.type=it.BAD,e}function yr(t,n,r){if(!t)return Mt("RegisterModel: null name"),r(0);e.isFunction(n)&&(r=n,n=null),t=t.replace(/\.[^\/.]+$/,""),kt.models.load(t,n,r)}function br(e){return kt.models.findByHandle(e)}function wr(e,t,n){if(e.charAt(0)==="*"){var r=new st;r.type=it.BRUSH,r.name=e,r.bmodel=t,n(null,r);return}var i=e+".md3";Er(i,function(t,r){if(t)return n(t);var i=new st;i.type=it.MD3,i.name=e,i.md3=r,n(null,i)})}function Er(e,n){var i=new mt;l.ReadFile(e,"binary",function(s,o){if(s)return n(s);var u=new r(o,r.LITTLE_ENDIAN),a=new wt;a.ident=u.readInt(),a.version=u.readInt();if(a.version!==ut)return n(new Error("LoadMd3: "+e+" has wrong version ("+a.version+" should be "+ut+")"));a.name=u.readASCIIString(T),a.flags=u.readInt(),a.numFrames=u.readInt(),a.numTags=u.readInt(),a.numSurfaces=u.readInt(),a.numSkins=u.readInt(),a.ofsFrames=u.readInt(),a.ofsTags=u.readInt(),a.ofsSurfaces=u.readInt(),a.ofsEnd=u.readInt();if(a.numFrames<1)return n(new Error("LoadMd3: "+e+" has no frames"));i.name=a.name,i.frames=new Array(a.numFrames),i.tags=new Array(a.numFrames*a.numTags),i.surfaces=new Array(a.numSurfaces),i.skins=new Array(a.numSkins),u.index=a.ofsFrames;for(var f=0;f<a.numFrames;f++){var l=i.frames[f]=new yt;for(var c=0;c<6;c++)l.bounds[Math.floor(c/3)][c%3]=u.readFloat();for(var c=0;c<3;c++)l.localOrigin[c]=u.readFloat();l.radius=u.readFloat(),l.name=u.readASCIIString(16)}u.index=a.ofsTags;for(var f=0;f<a.numFrames*a.numTags;f++){var h=i.tags[f]=new bt;h.name=u.readASCIIString(T);for(var c=0;c<3;c++)h.origin[c]=u.readFloat();for(var c=0;c<9;c++)h.axis[Math.floor(c/3)][c%3]=u.readFloat()}var p=a.ofsSurfaces;for(var f=0;f<a.numSurfaces;f++){u.index=p;var d=new Et;d.ident=u.readInt(),d.name=u.readASCIIString(T),d.flags=u.readInt(),d.numFrames=u.readInt(),d.numShaders=u.readInt(),d.numVerts=u.readInt(),d.numTriangles=u.readInt(),d.ofsTriangles=u.readInt(),d.ofsShaders=u.readInt(),d.ofsSt=u.readInt(),d.ofsXyzNormals=u.readInt(),d.ofsEnd=u.readInt();if(d.numVerts>C)return n(new Error("LoadMd3: "+e+" has more than "+C+" verts on a surface ("+d.numVerts+")"));if(d.numTriangles*3>k)return n(new Error("LoadMd3: "+e+" has more than "+k/3+" triangles on a surface ("+d.numTriangles+")"));var v=i.surfaces[f]=new gt;v.name=d.name.toLowerCase().replace(/_\d+/,""),v.numFrames=d.numFrames,v.numVerts=d.numVerts,v.shaders=new Array(d.numShaders),v.indexes=new Array(d.numTriangles*3),v.st=new Array(d.numVerts),v.xyz=new Array(d.numFrames*d.numVerts),v.normals=new Array(d.numFrames*d.numVerts),v.geo=new Y,v.geo.surface=v,u.index=p+d.ofsShaders;for(var c=0;c<d.numShaders;c++){var m=u.readASCIIString(T).replace(/\.[^\/.]+$/,"");v.shaders[c]=m}u.index=p+d.ofsTriangles;for(var c=0;c<d.numTriangles;c++)for(var g=0;g<3;g++)v.indexes[c*3+g]=u.readInt();u.index=p+d.ofsSt;for(var c=0;c<d.numVerts;c++){var y=v.st[c]=[0,0];y[0]=u.readFloat(),y[1]=u.readFloat()}u.index=p+d.ofsXyzNormals;for(var c=0;c<d.numFrames*d.numVerts;c++){var b=v.xyz[c]=vec3.create(),w=v.normals[c]=vec3.create();for(var g=0;g<3;g++)b[g]=u.readShort()*vt;var E=u.readByte(),S=u.readByte(),N=E*2*Math.PI/255,L=S*2*Math.PI/255;w[0]=Math.cos(L)*Math.sin(N),w[1]=Math.sin(L)*Math.sin(N),w[2]=Math.cos(N),vec3.normalize(w)}p+=d.ofsEnd}var A=[];i.surfaces.forEach(function(e){e.shaders.forEach(function(t,n){A.push(function(r){zr(t,-2,x.POSITION_LERP,function(t){e.shaders[n]=t,r(null)})})})}),t.parallel(A,function(e){n(null,i)})},"renderer")}function Sr(e,t,n){t>=e.frames.length&&(t=e.frames.length-1);var r=e.tags.length/e.frames.length,i=t*r;for(var s=0;s<r;s++){var o=e.tags[i+s];if(o.name===n)return o}return null}function xr(e,t,n,r,s,o){var u=br(t);if(u.type===it.BAD)return!1;if(!u.md3)return i.AxisClear(e.axis),vec3.create(e.origin),!1;var a=Sr(u.md3,n,o),f=Sr(u.md3,r,o);if(!a||!f)return i.AxisClear(e.axis),vec3.create(e.origin),!1;var l=s,c=1-s;for(var h=0;h<3;h++)e.origin[h]=a.origin[h]*c+f.origin[h]*l,e.axis[0][h]=a.axis[0][h]*c+f.axis[0][h]*l,e.axis[1][h]=a.axis[1][h]*c+f.axis[1][h]*l,e.axis[2][h]=a.axis[2][h]*c+f.axis[2][h]*l;return vec3.normalize(e.axis[0]),vec3.normalize(e.axis[1]),vec3.normalize(e.axis[2]),!0}function Tr(e,t,n){var r=br(e);if(r.type==it.BRUSH){vec3.set(r.bmodel.bounds[0],t),vec3.set(r.bmodel.bounds[1],n);return}if(r.type==it.MD3){var i=r.md3,s=i.frames[0];vec3.set(s.bounds[0],t),vec3.set(s.bounds[1],n);return}t[0]=t[1]=t[2]=0,n[0]=n[1]=n[2]=0}function Cr(e,t,n){n.pos[0]=.5*(e.pos[0]+t.pos[0]),n.pos[1]=.5*(e.pos[1]+t.pos[1]),n.pos[2]=.5*(e.pos[2]+t.pos[2]),n.lmCoord[0]=.5*(e.lmCoord[0]+t.lmCoord[0]),n.lmCoord[1]=.5*(e.lmCoord[1]+t.lmCoord[1]),n.texCoord[0]=.5*(e.texCoord[0]+t.texCoord[0]),n.texCoord[1]=.5*(e.texCoord[1]+t.texCoord[1]),n.color[0]=e.color[0]+t.color[0]>>1,n.color[1]=e.color[1]+t.color[1]>>1,n.color[2]=e.color[2]+t.color[2]>>1,n.color[3]=e.color[3]+t.color[3]>>1}function kr(e,t,n){var r;if(t>n)for(var i=0;i<n;i++)for(var s=i+1;s<t;s++)s<n?(r=e[s][i],e[s][i]=e[i][s],e[i][s]=r):e[s][i]=e[i][s];else for(var i=0;i<t;i++)for(var s=i+1;s<n;s++)s<t?(r=e[i][s],e[i][s]=e[s][i],e[s][i]=r):e[i][s]=e[s][i]}function Lr(e,t,n){var r={pos:vec3.create(),lmCoord:[0,0],texCoord:[0,0],color:[0,0,0,0],normal:vec3.createFrom(0,0,1)},i={pos:vec3.create(),lmCoord:[0,0],texCoord:[0,0],color:[0,0,0,0],normal:vec3.createFrom(0,0,1)};for(var s=0;s<t;s++)for(var o=1;o<n;o+=2)Cr(e[o][s],e[o-1][s],r),Cr(e[o][s],e[o+1][s],i),Cr(r,i,e[o][s]);for(var o=0;o<n;o++)for(var s=1;s<t;s+=2)Cr(e[o][s],e[o][s-1],r),Cr(e[o][s],e[o][s+1],i),Cr(r,i,e[o][s])}function Ar(e,t,n,r){var i=new Array(Nr);for(var s=0;s<Nr;s++)i[s]=new Array(Nr);for(var o=0;o<t;o++)for(var s=0;s<n;s++)i[s][o]=e[s*t+o];for(var u=0;u<2;u++){for(var o=0;o+2<t;o+=2){var a=0;for(var s=0;s<n;s++){var f=vec3.create();for(var l=0;l<3;l++)f[l]=(i[s][o].pos[l]+i[s][o+1].pos[l]*2+i[s][o+2].pos[l])*.25;vec3.subtract(f,i[s][o].pos);var c=vec3.subtract(i[s][o+2].pos,i[s][o].pos,vec3.create());vec3.normalize(c);var h=vec3.dot(f,c),p=vec3.scale(c,h,vec3.create()),d=vec3.subtract(f,p),v=vec3.length(d);v>a&&(a=v)}if(a<.1)continue;if(t+2>Nr)continue;if(a<=r)continue;t+=2;for(var s=0;s<n;s++){var m={pos:vec3.create(),lmCoord:[0,0],texCoord:[0,0],color:[0,0,0,0],normal:[0,0,1]},g={pos:vec3.create(),lmCoord:[0,0],texCoord:[0,0],color:[0,0,0,0],normal:[0,0,1]},y={pos:vec3.create(),lmCoord:[0,0],texCoord:[0,0],color:[0,0,0,0],normal:[0,0,1]};Cr(i[s][o],i[s][o+1],m),Cr(i[s][o+1],i[s][o+2],g),Cr(m,g,y);for(var b=t-1;b>o+3;b--)i[s][b]=i[s][b-2];i[s][o+1]=m,i[s][o+2]=y,i[s][o+3]=g}o-=2}kr(i,t,n);var w=t;t=n,n=w}Lr(i,t,n);var E=new Array(t*n);for(var s=0;s<n;s++)for(var o=0;o<t;o++)E[s*t+o]=i[s][o];return{verts:E,width:t,height:n}}function Or(e,t){if(kt.viewParms.isPortal)return Mt("WARNING: recursive mirror / portal found"),!1;if(Mr(e))return!1;var n=kt.viewParms.clone(),r=kt.viewParms;r.isPortal=!0;var o=new s.Orientation,u=new s.Orientation;return _r(r,e,t,o,u)?(Pr(n.or.origin,o,u,r.or.origin),vec3.subtract(i.vec3origin,u.axis[0],r.portalPlane.normal),r.portalPlane.dist=vec3.dot(u.origin,r.portalPlane.normal),Hr(n.or.axis[0],o,u,r.or.axis[0]),Hr(n.or.axis[1],o,u,r.or.axis[1]),Hr(n.or.axis[2],o,u,r.or.axis[2]),$t(r),n.clone(kt.viewParms),!0):!1}function Mr(e){var t=e.attributes.index,n=e.attributes.position,r=e.attributes.normal,i=1e8,s=t.index/3,o=vec3.create(),u=vec3.create();for(var a=0;a<t.index;a+=3){var f=t.array[a]*3;u[0]=n.array[f+0],u[1]=n.array[f+1],u[2]=n.array[f+2],vec3.subtract(u,kt.viewParms.or.origin,o);var l=vec3.squaredLength(o);l<i&&(i=l),vec3.dot(o,r.array[t.array[a]])>=0&&s--}return s?kt.viewParms.isMirror?!1:i>e.shader.portalRange*e.shader.portalRange?!0:!1:!0}function _r(e,t,n,r,s){var o,u=Dr(t);if(n!==v){var a=kt.refents[n];Rt(a,kt.viewParms,kt.or),Jt(u.normal,o.normal),o.dist=u.dist+vec3.dot(o.normal,kt.or.origin),u.dist=u.dist+vec3.dot(u.normal,kt.or.origin)}else o=u;vec3.set(o.normal,r.axis[0]),i.PerpendicularVector(r.axis[0],r.axis[1]),vec3.cross(r.axis[0],r.axis[1],r.axis[2]);for(var f=0;f<kt.refdef.numRefEnts;f++){var a=Lt.refents[f];if(a.reType!==I.PORTALSURFACE)continue;var l=vec3.dot(a.origin,u.normal)-u.dist;if(l>64||l<-64)continue;vec3.set(a.oldOrigin,e.pvsOrigin);if(a.oldOrigin[0]==a.origin[0]&&a.oldOrigin[1]==a.origin[1]&&a.oldOrigin[2]==a.origin[2])return vec3.scale(o.normal,o.dist,r.origin),vec3.set(r.origin,s.origin),vec3.subtract(i.vec3origin,r.axis[0],s.axis[0]),vec3.set(r.axis[1],s.axis[1]),vec3.set(r.axis[2],s.axis[2]),e.isMirror=!0,!0;l=vec3.dot(a.origin,o.normal)-o.dist,vec3.add(vec3.scale(r.axis[0],-l,vec3.create()),a.origin,r.origin),vec3.set(a.oldOrigin,s.origin),i.AxisCopy(a.axis,s.axis),vec3.subtract(i.vec3origin,s.axis[0],s.axis[0]),vec3.subtract(i.vec3origin,s.axis[1],s.axis[1]);var c=vec3.create();if(a.oldFrame)if(a.frame){var l=kt.refdef.time/1e3*a.frame;vec3.set(s.axis[1],c),i.RotatePointAroundVector(c,s.axis[0],l,s.axis[1]),vec3.cross(s.axis[0],s.axis[1],s.axis[2])}else{var l=Math.sin(kt.refdef.time*.003);l=a.skinNum+l*4,vec3.set(s.axis[1],c),i.RotatePointAroundVector(c,s.axis[0],l,s.axis[1]),vec3.cross(s.axis[0],s.axis[1],s.axis[2])}else if(a.skinNum){var l=a.skinNum;vec3.set(s.axis[1],c),i.RotatePointAroundVector(c,s.axis[0],l,s.axis[1]),vec3.cross(s.axis[0],s.axis[1],s.axis[2])}return e.isMirror=!1,!0}return!1}function Dr(e){var t=e.attributes.index,n=e.attributes.position,r=t.array[0]*3,s=vec3.createFrom(n.array[r+0],n.array[r+1],n.array[r+2]),o=t.array[1]*3,u=vec3.createFrom(n.array[o+0],n.array[o+1],n.array[o+2]),a=t.array[2]*3,f=vec3.createFrom(n.array[a+0],n.array[a+1],n.array[a+2]),l=i.PlaneFromPoints(s,u,f);return l}function Pr(e,t,n,r){var i=vec3.subtract(e,t.origin,vec3.create()),s=vec3.create();for(var o=0;o<3;o++){var u=vec3.dot(i,t.axis[o]);vec3.add(s,vec3.scale(n.axis[o],u,vec3.create()))}vec3.add(s,n.origin,r)}function Hr(e,t,n,r){r[0]=r[1]=r[2]=0;for(var i=0;i<3;i++){var s=vec3.dot(e,t.axis[i]);vec3.add(r,vec3.scale(n.axis[i],s,vec3.create()))}}function Br(e){if(!kt.world){c.Error("RenderScene: NULL worldmodel");return}var t=kt.refdef;e.clone(t),t.timeSecs=t.time/1e3,t.numDrawGeom=0,t.numRefEnts=kt.numRefEnts,t.numDlights=kt.numDlights;var n=new F;n.x=e.x,n.y=e.y,n.width=e.width,n.height=e.height,n.fovX=e.fovX,n.fovY=e.fovY,vec3.set(e.vieworg,n.or.origin),vec3.set(e.viewaxis[0],n.or.axis[0]),vec3.set(e.viewaxis[1],n.or.axis[1]),vec3.set(e.viewaxis[2],n.or.axis[2]),vec3.set(e.vieworg,n.pvsOrigin),kt.counts.shaders=0,kt.counts.nodes=0,kt.counts.leafs=0,kt.counts.surfaces=0,kt.counts.indexes=0,kt.counts.culledModelOut=0,kt.counts.culledModelIn=0,kt.counts.culledModelClip=0,$t(n),kt.numRefEnts=0,kt.numDlights=0}function jr(e){if(kt.numRefEnts>=d)return;(e.reType<0||e.reType>=I.MAX_REF_ENTITY_TYPE)&&c.Error("AddRefEntityToScene: bad reType "+e.reType);var t=Lt.refents[kt.numRefEnts];e.clone(t),t.lightingCalculated=!1,kt.numRefEnts++}function Fr(e,t,n,r,i){if(kt.numDlights>=m)return;if(t<=0)return;var s=Lt.dlights[kt.numDlights++];vec3.set(e,s.origin),s.radius=t/2,s.color[0]=n,s.color[1]=r,s.color[2]=i}function Ir(){kt.defaultShader=qr(),kt.shaders=new o(kt.defaultShader),kt.shaders.on("load",Wr)}function qr(){var e=new a.Script;e.name="*default",e.sort=S.OPAQUE;var t=new a.ScriptStage;return t.maps[0]="*default",t.rgbGen="vertex",e.stages.push(t),Xr(e,0)}function Rr(e,t){e=e.replace(/\.[^\.]+$/,""),kt.shaders.load(e,0,0,t)}function Ur(e){return kt.shaders.findByHandle(e)}function zr(e,t,n,r){kt.shaders.findByName(e,t,n,r)}function Wr(e,t,n,r){var i;if(kt.scriptBodies[e]){var s=kt.scriptBodies[e];i=a.parse(s,t)}else{i=new a.Script,i.name=e,i.sort=S.OPAQUE;var o=new a.ScriptStage;o.maps[0]=e,i.stages.push(o),t===-1?o.rgbGen="vertex":t===-2?o.rgbGen="lightingdiffuse":(o=new a.ScriptStage,o.maps[0]="*lightmap",o.isLightmap=!0,o.blendSrc="GL_DST_COLOR",o.blendDest="GL_ZERO",i.stages.push(o))}Xr(i,n,function(e,t){if(e)return r(e);t.sky&&(kt.skyShader=t),r(null,t)})}function Xr(e,n,r){var i=new St;i.name=e.name,i.sort=e.sort,i.surfaceFlags=Qr(e.surfaceParms),i.contentFlags=Gr(e.surfaceParms),i.cull=Vr(e.cull),i.sky=e.sky,i.fog=e.fog,i.polygonOffset=e.polygonOffset,i.entityMergable=e.entityMergable,kn()&&i.sort===S.OPAQUE&&(n|=x.DLIGHTS),i.surfaceFlags&y.NODRAW||(i.program=a.compile(At,e,n));var s=e.stages[0];e.fog?(i.hasBlendFunc=!0,i.blendSrc=At.SRC_ALPHA,i.blendDest=At.ONE_MINUS_SRC_ALPHA):s&&s.hasBlendFunc&&(i.hasBlendFunc=!0,i.blendSrc=Jr(s.blendSrc),i.blendDest=Jr(s.blendDest)),s&&s.depthWrite&&(i.depthWrite=!0,i.depthFunc=$r(s.depthFunc));var o=[];return e.stages.forEach(function(e){var t=new xt;e.maps.forEach(function(n,r){o.push(function(i){mi(n,e.clamp,function(e){t.textures[r]=e,i(null)})})}),t.animFreq=e.animFreq,i.stages.push(t)}),Yr(i),t.parallel(o,function(){r&&r(null,i)}),i}function Vr(e){if(!e)return At.FRONT;e=e.toLowerCase();if(e=="none"||e=="twosided"||e=="disable")return null;if(e=="back"||e=="backside"||e=="backsided")return At.BACK}function $r(e){if(!e)return At.LEQUAL;switch(e.toLowerCase()){case"gequal":return At.GEQUAL;case"lequal":return At.LEQUAL;case"equal":return At.EQUAL;case"greater":return At.GREATER;case"less":return At.LESS;default:return At.LEQUAL}}function Jr(e){if(!e)return At.ONE;switch(e.toUpperCase()){case"GL_ONE":return At.ONE;case"GL_ZERO":return At.ZERO;case"GL_DST_COLOR":return At.DST_COLOR;case"GL_ONE_MINUS_DST_COLOR":return At.ONE_MINUS_DST_COLOR;case"GL_SRC_ALPHA":return At.SRC_ALPHA;case"GL_ONE_MINUS_SRC_ALPHA":return At.ONE_MINUS_SRC_ALPHA;case"GL_SRC_COLOR":return At.SRC_COLOR;case"GL_ONE_MINUS_SRC_COLOR":return At.ONE_MINUS_SRC_COLOR;default:return At.ONE}}function Qr(e){var t=0;for(var n=0;n<e.length;n++){var r=Kr[e[n]];if(!r)continue;t|=r.surface}return t}function Gr(e){var t=0;for(var n=0;n<e.length;n++){var r=Kr[e[n]];if(!r)continue;t|=r.contents}return t}function Yr(e){if(kt.sortedShaders.length===D){_t("RegisterShader - MAX_SHADERS hit");return}var t=kt.sortedShaders,n=e.sort;for(var r=t.length-1;r>=0;r--){if(t[r].sort<=n)break;t[r+1]=t[r],t[r+1].sortedIndex++}e.sortedIndex=r+1,t[r+1]=e}function Zr(e){l.ReadFile("scripts/all.shader","utf8",function(t,n){if(t)return e(t);ei(n),e(null)},"renderer")}function ei(e,t){var n=new f(e);while(!n.EOF()){var r=n.next(),i=0,s=r+" ";do{var o=n.next();o==="{"?i++:o==="}"&&i--,s+=o+" "}while(i&&!n.EOF());kt.scriptBodies[r]=s}}function oi(e){if(e.initialized)return;var t=kt.world.verts,n=6*ti*ti*6,r=6*(ti+1)*(ti+1),i=e.attributes.index=an("index",n,"uint"),s=e.attributes.position=an("position",r,"vec3"),o=e.attributes.normal=an("normal",r,"vec3"),u=e.attributes.texCoord=an("texCoord",r,"vec2"),a=vec3.create();for(var f=0;f<6;f++){var l=s.index/s.size;for(var c=0;c<=ti;c++)for(var h=0;h<=ti;h++){ai(h/ti,c/ti,f,ii,si,a);var p=1/(2*vec3.dot(a,a))*(-2*a[2]*ni+2*Math.sqrt(Math.pow(a[2],2)*Math.pow(ni,2)+2*Math.pow(a[0],2)*ni*ri+Math.pow(a[0],2)*Math.pow(ri,2)+2*Math.pow(a[1],2)*ni*ri+Math.pow(a[1],2)*Math.pow(ri,2)+2*Math.pow(a[2],2)*ni*ri+Math.pow(a[2],2)*Math.pow(ri,2))),d=vec3.scale(a,p,vec3.create());d[2]+=ni,vec3.normalize(d);var v=Math.acos(d[0]),m=Math.acos(d[1]);s.array[s.index++]=a[0],s.array[s.index++]=a[1],s.array[s.index++]=a[2],o.array[o.index++]=0,o.array[o.index++]=0,o.array[o.index++]=0,u.array[u.index++]=v,u.array[u.index++]=m}for(var c=0,g=ti+1;c<g-1;c++)for(var h=0,y=ti+1;h<y-1;h++)i.array[i.index++]=l+h+c*y,i.array[i.index++]=l+h+(c+1)*y,i.array[i.index++]=l+h+1+c*y,i.array[i.index++]=l+h+(c+1)*y,i.array[i.index++]=l+h+1+(c+1)*y,i.array[i.index++]=l+h+1+c*y}i.update=!0,s.update=!0,o.update=!0,u.update=!0,e.initialized=!0}function ai(e,t,n,r,i,s){for(var o=0;o<3;o++){var u=ui[n][o],a=i[o]-r[o];switch(u){case-1:s[o]=r[o]+(a-e*a);break;case 1:s[o]=r[o]+e*a;break;case-2:s[o]=r[o]+(a-t*a);break;case 2:s[o]=r[o]+t*a;break;case-3:case 3:s[o]=u<0?r[o]:i[o]}}}function fi(){var e=Lt.tess,t=e.shader;e.xyz=Lt.skyBuffers.xyz,e.texCoord=Lt.skyBuffers.texCoord,e.index=Lt.skyBuffers.index,e.indexOffset=0,e.indexCount=0,StageIteratorGeneric()}function ci(){kt.ext_s3tc=Bt("WEBGL_compressed_texture_s3tc"),pi(),kt.textures=new o(di()),kt.textures.on("load",gi),vi()}function hi(){}function pi(){kt.overbrightBits=Sn(),kt.identityLight=1/(1<<kt.overbrightBits)}function di(){var e=new Uint8Array(16384),t=0;for(var n=0;n<64;n++)for(var r=0;r<64;r++)n%16<8&&r%16<8||n%16>=8&&r%16>=8?(e[t++]=127,e[t++]=168,e[t++]=255,e[t++]=255):(e[t++]=255,e[t++]=255,e[t++]=255,e[t++]=255);var i=new Tt;return i.texnum=bi(e,64,64,!1),i}function vi(){yi("*white",new Uint8Array([255,255,255,255]),1,1)}function mi(e,t,n){e=e.replace(/\.[^\/.]+$/,""),li[e]&&(e=li[e]),kt.textures.findByName(e,t,n)}function gi(e,t,n){if(!e)return n(new Error("Empty texture name"));e+=".dds",l.ReadFile(e,"binary",function(r,i){if(r)return Mt("Failed to load texture",e),n(r);var s=new Tt;return s.name=e,s.texnum=bi(i,null,null,t),n(null,s)},"renderer")}function yi(e,t,n,r,i){var s=new Tt;s.name=e,s.texnum=bi(t,n,r,i),kt.textures.register(e,s)}function bi(e,t,n,r){var i=At.createTexture(),s=1;At.bindTexture(At.TEXTURE_2D,i);if(e instanceof ArrayBuffer)s=us(At,kt.ext_s3tc,e,!0),At.texParameteri(At.TEXTURE_2D,At.TEXTURE_MAG_FILTER,At.LINEAR),At.texParameteri(At.TEXTURE_2D,At.TEXTURE_MIN_FILTER,s>1?At.LINEAR_MIPMAP_LINEAR:At.LINEAR);else if(e instanceof Uint8Array)At.texImage2D(At.TEXTURE_2D,0,At.RGBA,t,n,0,At.RGBA,At.UNSIGNED_BYTE,e),At.texParameteri(At.TEXTURE_2D,At.TEXTURE_MAG_FILTER,At.LINEAR),At.texParameteri(At.TEXTURE_2D,At.TEXTURE_MIN_FILTER,At.LINEAR_MIPMAP_LINEAR);else{At.texImage2D(At.TEXTURE_2D,0,At.RGBA,t,n,0,At.RGBA,At.UNSIGNED_BYTE,null);for(var o=0;o<e.length;o++){var u=e[o];At.texSubImage2D(At.TEXTURE_2D,0,u.x,u.y,u.width,u.height,At.RGBA,At.UNSIGNED_BYTE,u.buffer)}At.texParameteri(At.TEXTURE_2D,At.TEXTURE_MAG_FILTER,At.LINEAR),At.texParameteri(At.TEXTURE_2D,At.TEXTURE_MIN_FILTER,At.LINEAR_MIPMAP_LINEAR)}return r&&(At.texParameterf(At.TEXTURE_2D,At.TEXTURE_WRAP_S,At.CLAMP_TO_EDGE),At.texParameterf(At.TEXTURE_2D,At.TEXTURE_WRAP_T,At.CLAMP_TO_EDGE)),s<=1&&At.generateMipmap(At.TEXTURE_2D),i}function Vi(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}function $i(e){return String.fromCharCode(e&255,e>>8&255,e>>16&255,e>>24&255)}function os(e,t,n,r){var i=new Uint16Array(4),s=new Uint16Array(n*r),o=n*r/4,u=0,a=0,f=0,l=0,c=0,h=0,p=0,d=0,v=0,m=n/4,g=r/4;for(var y=0;y<g;y++)for(var b=0;b<m;b++)f=t+4*(y*m+b),i[0]=e[f],i[1]=e[f+1],l=i[0]&31,c=i[0]&2016,h=i[0]&63488,p=i[1]&31,d=i[1]&2016,v=i[1]&63488,i[2]=5*l+3*p>>3|5*c+3*d>>3&2016|5*h+3*v>>3&63488,i[3]=5*p+3*l>>3|5*d+3*c>>3&2016|5*v+3*h>>3&63488,u=e[f+2],a=y*4*n+b*4,s[a]=i[u&3],s[a+1]=i[u>>2&3],s[a+2]=i[u>>4&3],s[a+3]=i[u>>6&3],a+=n,s[a]=i[u>>8&3],s[a+1]=i[u>>10&3],s[a+2]=i[u>>12&3],s[a+3]=i[u>>14],u=e[f+3],a+=n,s[a]=i[u&3],s[a+1]=i[u>>2&3],s[a+2]=i[u>>4&3],s[a+3]=i[u>>6&3],a+=n,s[a]=i[u>>8&3],s[a+1]=i[u>>10&3],s[a+2]=i[u>>12&3],s[a+3]=i[u>>14];return s}function us(e,t,n,r){var i=new Int32Array(n,0,Gi),s,o,u,a,f,l,c,h,p,d,v;if(i[Yi]!==wi)return Mt("Invalid magic number in DDS header"),0;if(!i[is]&Ui)return Mt("Unsupported format, must contain a FourCC code"),0;s=i[ss];switch(s){case Ji:o=8,u=t?t.COMPRESSED_RGB_S3TC_DXT1_EXT:null;break;case Ki:o=16,u=t?t.COMPRESSED_RGBA_S3TC_DXT3_EXT:null;break;case Qi:o=16,u=t?t.COMPRESSED_RGBA_S3TC_DXT5_EXT:null;break;default:return Mt("Unsupported FourCC code:",$i(s)),null}d=1,i[es]&Ci&&r!==!1&&(d=Math.max(1,i[rs])),a=i[ns],f=i[ts],c=i[Zi]+4;if(t)for(v=0;v<d;++v)l=Math.max(4,a)/4*Math.max(4,f)/4*o,p=new Uint8Array(n,c,l),e.compressedTexImage2D(e.TEXTURE_2D,v,u,a,f,0,p),c+=l,a=Math.max(a*.5,1),f=Math.max(f*.5,1);else{if(s!=Ji)return console.error("No manual decoder for",$i(s),"and no native support"),0;l=Math.max(4,a)/4*Math.max(4,f)/4*o,p=new Uint16Array(n),h=os(p,c/2,a,f),e.texImage2D(e.TEXTURE_2D,0,e.RGB,a,f,0,e.RGB,e.UNSIGNED_SHORT_5_6_5,h),r&&e.generateMipmap(e.TEXTURE_2D)}return d}function as(){kt.skins=new o(fs()),kt.skins.on("load",hs)}function fs(){var e=new Nt,t=new Ct;return t.shader=kt.defaultShader,e}function ls(e,t){e=e.replace(/\.[^\/.]+$/,""),kt.skins.load(e,t)}function cs(e){return kt.skins.findByHandle(e)}function hs(e,n){var r=e+".skin";l.ReadFile(r,"utf8",function(r,i){if(r)return Mt("Failed to load skin",e),n(r);var s=new Nt;s.name=e;var o=[],u=i.replace(/^\s+|\s+$/g,"").split(/\r\n/);u.forEach(function(e){var t=e.split(/,/),n=t[0].toLowerCase(),r=t[1];if(n.indexOf("tag_")!==-1)return;var i=new Ct;i.name=n,s.surfaces.push(i),o.push(function(e){zr(r,-2,x.POSITION_LERP,function(t){i.shader=t,e(null)})})}),t.parallel(o,function(){n(null,s)})},"renderer")}function ps(e,t){var n=kt.world=new et;n.shaders=e.shaders,n.planes=e.planes,n.numClusters=e.numClusters,n.clusterBytes=e.clusterBytes,n.vis=e.vis,ms(e.nodes,e.leafs,e.leafSurfaces),Es(e.bmodels),Ss(e.lightmaps),xs(e.lightGridData,e.lightGridOrigin,e.lightGridSize,e.lightGridInverseSize,e.lightGridBounds),gs(e.surfaces,e.verts,e.indexes,function(){Ts();for(var e=1;e<n.bmodels.length;e++)Ns(n.bmodels[e]);t()})}function ds(e,t){typeof t=="undefined"&&(t=0);var n=xn()-kt.overbrightBits,r=e[t+0]<<n,i=e[t+1]<<n,s=e[t+2]<<n;if((r|i|s)>255){var o=r>i?r:i;o=o>s?o:s,r=r*255/o,i=i*255/o,s=s*255/o}e[t+0]=r,e[t+1]=i,e[t+2]=s,e[t+3]=e[t+3]}function vs(e,t,n){var r=kt.world.shaders;(e<0||e>=r.length)&&c.Error("ShaderForShaderNum: bad num "+e);var i=r[e];zr(i.shaderName,t,0,n)}function ms(e,t,n){var r=kt.world,i=r.planes;r.leafSurfaces=n;var s=r.nodes=new Array(e.length+t.length);for(var o=0;o<s.length;o++)s[o]=new tt;for(var o=0;o<e.length;o++){var u=e[o],a=s[o];a.plane=i[u.planeNum],a.children=new Array(2);for(var f=0;f<2;f++){var l=u.childrenNum[f];l>=0?a.children[f]=s[l]:a.children[f]=s[e.length+(-1-l)]}vec3.set(u.mins,a.mins),vec3.set(u.maxs,a.maxs)}for(var o=0;o<t.length;o++){var c=t[o],h=s[e.length+o];h.cluster=c.cluster,h.area=c.area,vec3.set(c.mins,h.mins),vec3.set(c.maxs,h.maxs),h.firstLeafSurface=c.firstLeafSurface,h.numLeafSurfaces=c.numLeafSurfaces,h.firstLeafBrush=c.firstLeafBrush,h.numLeafBrushes=c.numLeafBrushes,c.cluster>=r.numClusters&&(r.numClusters=c.cluster+1)}var p=function(e,t){e.parent=t;if(!e.children)return;p(e.children[0],e),p(e.children[1],e)};p(s[0],null)}function gs(e,n,r,i){var s=kt.world;s.verts=n,s.meshVerts=r,n.forEach(function(e){ds(e.color),vec4.scale(e.color,1/255)});var o=s.surfaces=new Array(e.length),u=[];e.forEach(function(e,t){var n=o[t]=new nt;n.surfaceType=rt.BAD,n.fogIndex=e.fogNum+1,n.vertex=e.vertex,n.vertCount=e.vertCount,n.meshVert=e.meshVert,n.meshVertCount=e.meshVertCount,n.lightmapNum=e.lightmapNum,n.patchWidth=e.patchWidth,n.patchHeight=e.patchHeight,e.surfaceType===E.PLANAR?ys(n,e):e.surfaceType===E.TRIANGLE_SOUP?bs(n):e.surfaceType===E.PATCH&&ws(n,En()),u.push(function(t){vs(e.shaderNum,e.lightmapNum,function(e){n.shader=e,t(null)})})});var n=kt.world.verts,a=kt.world.meshVerts,f=kt.world.lightmaps,l=new Array(n.length);for(var c=0;c<o.length;c++){var h=o[c],p=f[h.lightmapNum];p||(p=f[0]);for(var d=0;d<h.vertCount;d++){var v=h.vertex+d;if(!l[v]){var m=n[v];m.lmCoord[0]=m.lmCoord[0]*p.texCoords.xScale+p.texCoords.x,m.lmCoord[1]=m.lmCoord[1]*p.texCoords.yScale+p.texCoords.y,l[v]=!0}}for(var d=0;d<h.meshVertCount;d++){var v=h.vertex+a[h.meshVert+d];if(!l[v]){var m=n[v];m.lmCoord[0]=m.lmCoord[0]*p.texCoords.xScale+p.texCoords.x,m.lmCoord[1]=m.lmCoord[1]*p.texCoords.yScale+p.texCoords.y,l[v]=!0}}}kt.world.lightmaps=null,t.parallel(u,function(){i()})}function ys(e,t){var n=kt.world.verts;e.surfaceType=rt.FACE,e.plane.normal=vec3.create(t.lightmapVecs[2]),e.plane.dist=vec3.dot(n[e.vertex].pos,e.plane.normal),e.plane.signbits=i.GetPlaneSignbits(e.plane.normal),e.plane.type=i.PlaneTypeForNormal(e.plane.normal)}function bs(e){e.surfaceType=rt.TRIANGLES}function ws(e,t){var n=kt.world.verts,r=kt.world.meshVerts,i=n.slice(e.vertex,e.vertex+e.vertCount),s=Ar(i,e.patchWidth,e.patchHeight,t);e.surfaceType=rt.FACE,e.vertex=n.length,e.vertCount=s.verts.length,e.meshVert=r.length,e.meshVertCount=(s.width-1)*(s.height-1)*6,n.push.apply(n,s.verts);for(var o=0;o<s.height-1;o++)for(var u=0;u<s.width-1;u++){var a=o*s.width+u+1,f=a-1,l=f+s.width,c=l+1;r.push(f),r.push(l),r.push(a),r.push(a),r.push(l),r.push(c)}}function Es(e){if(!e){kt.world.bmodels=[];return}var t=kt.world;t.bmodels=e;for(var n=0;n<e.length;n++)yr("*"+n,e[n],function(){})}function Ss(e){var t=kt.world,n=128,r=128,i=n*r,s=e.length/(i*3),o=2;while(o*o<s)o*=2;var u=o*n,a=0,f=0,l=0,c=kt.world.lightmaps=[];for(var h=0;h<s;++h){var p=new Array(i*4);for(var d=0;d<i*4;d+=4){var v=[e[a++],e[a++],e[a++]];ds(v),p[d]=v[0],p[d+1]=v[1],p[d+2]=v[2],p[d+3]=255}c.push({x:f,y:l,width:n,height:r,buffer:new Uint8Array(p),texCoords:{x:f/u,y:l/u,xScale:n/u,yScale:r/u}}),f+=n,f>=u&&(l+=r,f=0)}yi("*lightmap",c,u,u)}function xs(e,t,n,r,i){if(!e)return;var s=kt.world;s.lightGridData=e,vec3.set(t,s.lightGridOrigin),vec3.set(n,s.lightGridSize),vec3.set(r,s.lightGridInverseSize),vec3.set(i,s.lightGridBounds);var o=s.lightGridBounds[0]*s.lightGridBounds[1]*s.lightGridBounds[2];for(var u=0;u<o;u++)ds(s.lightGridData,u*8),ds(s.lightGridData,u*8+3)}function Ts(){var e=kt.world,t=e.nodes,n=e.leafSurfaces,r=e.surfaces,i={},s=0,o=function(e){for(var t=0;t<e.numLeafSurfaces;t++){var u=r[n[e.firstLeafSurface+t]],a=u.shader;if(u.geo)continue;if(a.sky)continue;if(a.surfaceFlags&y.NODRAW)continue;var f=a.name;a.sort===S.PORTAL&&(f+=s++);var l=i[f];l||(l=i[f]=new Q,l.shader=a,l.numVerts=0,l.numIndexes=0,l.faces=[]),l.numVerts+=u.vertCount,l.numIndexes+=u.meshVertCount,l.faces.push(u),u.geo=l}e.children&&(o(e.children[0]),o(e.children[1]))};o(t[0]);for(var u in i){if(!i.hasOwnProperty(u))continue;Gn(i[u])}}function Ns(e){var t=kt.world.surfaces,n={};for(var r=0;r<e.numSurfaces;r++){var i=t[e.firstSurface+r],s=i.shader,o=s.name,u=n[o];u||(u=n[o]=new Q,u.shader=s,u.numVerts=0,u.numIndexes=0,u.faces=[]),u.numVerts+=i.vertCount,u.numIndexes+=i.meshVertCount,u.faces.push(i),i.geo=u}for(var a in n){if(!n.hasOwnProperty(a))continue;Gn(n[a])}}var l=n.sys,c=n.com,h=n.cm,p=s.GENTITYNUM_BITS,d=s.MAX_GENTITIES,v=s.ENTITYNUM_WORLD,m=a.MAX_DLIGHTS,g=s.CVF,y=s.SURF,b=s.CONTENTS,w=c.ERR,E=u.MST,S=a.SS,x=a.CFLAGS,T=64,N=4096,C=4096,k=6*C,L=2,A=7,O=A+p,M=14,D=1<<M,P={IN:0,CLIP:1,OUT:2},H=function(){this.viewCluster=-1,this.refdef=new j,this.viewParms=new F,this.or=new s.Orientation,this.currentEntityNum=0,this.world=null,this.counts=new B,this.skyShader=null,this.skydomeGeo=new G,this.visCount=0,this.frameCount=0,this.sceneCount=0,this.viewCount=0,this.numRefEnts=0,this.numDlights=0,this.identityLight=0,this.overbrightBits=0,this.scriptBodies=[],this.shaders=null,this.sortedShaders=[],this.defaultShader=null,this.textures=null,this.skins=null,this.models=null,this.ext_s3tc=null},B=function(){this.shaders=0,this.nodes=0,this.leafs=0,this.surfaces=0,this.vertexes=0,this.indexes=0,this.culledModelOut=0,this.culledModelIn=0,this.culledModelClip=0},j=function(){this.x=0,this.y=0,this.width=0,this.height=0,this.fovX=0,this.fovY=0,this.vieworg=vec3.create(),this.viewaxis=[vec3.create(),vec3.create(),vec3.create()],this.time=0,this.timeSecs=0,this.rdflags=0,this.numDrawGeom=0,this.numRefEnts=0,this.numDlights=0};j.prototype.clone=function(e){return typeof e=="undefined"&&(e=new j),e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e.fovX=this.fovX,e.fovY=this.fovY,vec3.set(this.vieworg,e.vieworg),vec3.set(this.viewaxis[0],e.viewaxis[0]),vec3.set(this.viewaxis[1],e.viewaxis[1]),vec3.set(this.viewaxis[2],e.viewaxis[2]),e.time=this.time,e.timeSecs=this.timeSecs,e.rdflags=this.rdflags,e.numDrawGeom=this.numDrawGeom,e.numRefEnts=this.numRefEnts,e.numDlights=this.numDlights,e};var F=function(){this.or=new s.Orientation,this.isPortal=!1,this.isMirror=!1,this.pvsOrigin=vec3.create(),this.portalPlane=new i.Plane,this.x=0,this.y=0,this.width=0,this.height=0,this.fovX=0,this.fovY=0,this.frustum=[new i.Plane,new i.Plane,new i.Plane,new i.Plane],this.visBounds=[vec3.create(),vec3.create()],this.zFar=0,this.projectionMatrix=mat4.create(),this.frameCount=0};F.prototype.clone=function(e){return typeof e=="undefined"&&(e=new F),this.or.clone(e.or),e.isPortal=this.isPortal,e.isMirror=this.isMirror,vec3.set(this.pvsOrigin,e.pvsOrigin),this.portalPlane.clone(e.portalPlane),e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e.fovX=this.fovX,e.fovY=this.fovY,this.frustum[0].clone(e.frustum[0]),this.frustum[1].clone(e.frustum[1]),this.frustum[2].clone(e.frustum[2]),this.frustum[3].clone(e.frustum[3]),vec3.set(this.visBounds[0],e.visBounds[0]),vec3.set(this.visBounds[1],e.visBounds[1]),e.zFar=this.zFar,mat4.set(this.projectionMatrix,e.projectionMatrix),e.frameCount=this.frameCount,e};var I={MODEL:0,POLY:1,SPRITE:2,BEAM:3,RAIL_CORE:4,RAIL_RINGS:5,LIGHTNING:6,PORTALSURFACE:7,MAX_REF_ENTITY_TYPE:8},q={MINLIGHT:1,THIRD_PERSON:2,FIRST_PERSON:4,DEPTHHACK:8,NOSHADOW:64,LIGHTING_ORIGIN:128,SHADOW_PLANE:256,WRAP_FRAMES:512},R={NOWORLDMODEL:1,HYPERSPACE:2},U=10,z=function(){this.reType=0,this.renderfx=0,this.origin=vec3.create(),this.lightingOrigin=vec3.create(),this.axis=[vec3.create(),vec3.create(),vec3.create()],this.nonNormalizedAxes=!1,this.frame=0,this.oldOrigin=vec3.create(),this.oldFrame=0,this.backlerp=0,this.skinNum=0,this.customSkin=0,this.customShader=0,this.shaderRGBA=[0,0,0,0],this.shaderTexCoord=[0,0],this.shaderTime=0,this.radius=0,this.rotation=0,this.polyVerts=[],this.lightingCalculated=!1,this.lightDir=vec3.create(),this.ambientLight=vec3.create(),this.directedLight=vec3.create()};z.prototype.clone=function(e){typeof e=="undefined"&&(e=new z),e.reType=this.reType,e.renderfx=this.renderfx,e.hModel=this.hModel,vec3.set(this.origin,e.origin),vec3.set(this.lightingOrigin,e.lightingOrigin),vec3.set(this.axis[0],e.axis[0]),vec3.set(this.axis[1],e.axis[1]),vec3.set(this.axis[2],e.axis[2]),e.nonNormalizedAxes=this.nonNormalizedAxes,e.frame=this.frame,vec3.set(this.oldOrigin,e.oldOrigin),e.oldFrame=this.oldFrame,e.backlerp=this.backlerp,e.skinNum=this.skinNum,e.customSkin=this.customSkin,e.customShader=this.customShader,e.shaderRGBA[0]=this.shaderRGBA[0],e.shaderRGBA[1]=this.shaderRGBA[1],e.shaderRGBA[2]=this.shaderRGBA[2],e.shaderRGBA[3]=this.shaderRGBA[3],e.shaderTexCoord[0]=this.shaderTexCoord[0],e.shaderTexCoord[1]=this.shaderTexCoord[1],e.shaderTime=this.shaderTime,e.radius=this.radius,e.rotation=this.rotation,e.lightingCalculated=this.lightingCalculated,vec3.set(this.lightDir,e.lightDir),vec3.set(this.ambientLight,e.ambientLight),vec3.set(this.directedLight,e.directedLight),e.polyVerts=new Array(this.polyVerts.length);for(var t=0;t<this.polyVerts.length;t++)e.polyVerts[t]=this.polyVerts[t].clone();return e};var W=function(){this.xyz=vec3.create(),this.st=[0,0],this.modulate=[0,0,0,0]};W.prototype.clone=function(e){return typeof e=="undefined"&&(e=new W),vec3.set(this.xyz,e.xyz),e.st[0]=this.st[0],e.st[1]=this.st[1],vec4.set(this.modulate,e.modulate),e};var X=function(){this.origin=vec3.create(),this.color=vec3.create(),this.radius=0},V=function(){this.refdef=new j,this.viewParms=new F,this.or=new s.Orientation,this.currentEntity=null,this.currentShader=null,this.currentGeo=null,this.shaderTime=0,this.dlightBits=0,this.entityGeo=null,this.debugGeo=null,this.collisionGeo=null,this.dlightPositions=new Float32Array(m*3),this.dlightInfo=new Float32Array(m*4),this.drawGeom=new Array(N),this.refents=new Array(d),this.dlights=new Array(m);for(var e=0;e<N;e++)this.drawGeom[e]=new $;for(var e=0;e<d;e++)this.refents[e]=new z;for(var e=0;e<m;e++)this.dlights[e]=new X},$=function(){this.sort=0,this.geo=null},J=function(){this.type=0,this.array=null,this.index=0,this.offset=0,this.size=0,this.dataType=0,this.buffer=null,this.update=!1};J.prototype.clone=function(e){return typeof e=="undefined"&&(e=new J),e.type=this.type,e.array=this.array,e.index=this.index,e.offset=this.offset,e.size=this.size,e.dataType=this.dataType,e.buffer=this.buffer,e.update=this.update,e};var K=function(){this.attributes={},this.dynamic=!1},Q=function(){K.call(this),this.initialized=!1,this.shader=null,this.numVerts=0,this.numIndexes=0,this.faces=[],this.dlightBits=0};Q.prototype=new K,Q.prototype.constructor=Q;var G=function(){K.call(this),this.initialized=!1};G.prototype=new K,G.prototype.constructor=G;var Y=function(){K.call(this),this.initialized=!1,this.surface=null};Y.prototype=new K,Y.prototype.constructor=G;var Z=function(){K.call(this)};Z.prototype=new K,Z.prototype.constructor=Z;var et=function(){this.shaders=null,this.planes=null,this.nodes=null,this.leafSurfaces=null,this.bmodels=null,this.verts=null,this.meshVerts=null,this.fogs=null,this.surfaces=null,this.lightmaps=null,this.lightGridOrigin=vec3.create(),this.lightGridSize=vec3.createFrom(64,64,128),this.lightGridInverseSize=vec3.create(),this.lightGridBounds=vec3.create(),this.lightGridData=null,this.numClusters=0,this.clusterBytes=0,this.vis=null},tt=function(){this.parent=null,this.mins=vec3.create(),this.maxs=vec3.create(),this.plane=null,this.children=null,this.cluster=0,this.area=0,this.firstLeafSurface=0,this.numLeafSurfaces=0,this.firstLeafBrush=0,this.numLeafBrushes=0},nt=function(){this.surfaceType=rt.BAD,this.shader=null,this.fogIndex=0,this.vertex=0,this.vertCount=0,this.meshVert=0,this.meshVertCount=0,this.lightmapNum=0,this.normal=vec3.create(),this.patchWidth=0,this.patchHeight=0,this.plane=new i.Plane,this.geo=null},rt={BAD:0,FACE:1,GRID:2,TRIANGLES:3},it={BAD:0,BRUSH:1,MD3:2},st=function(){this.type=it.BAD,this.name=null,this.bmodel=null,this.md3=null},ot=("3".charCodeAt()<<24)+("P".charCodeAt()<<16)+("D".charCodeAt()<<8)+"I".charCodeAt(),ut=15,at=3,ft=8192,lt=4096,ct=256,ht=1024,pt=32,dt=16,vt=1/64,mt=function(){this.name=null,this.flags=0,this.frames=null,this.tags=null,this.surfaces=null,this.skins=null},gt=function(){this.name=null,this.numFrames=0,this.numVerts=0,this.shaders=null,this.st=null,this.indexes=null,this.xyz=null,this.normals=null,this.model=null,this.geo=null},yt=function(){this.bounds=[vec3.create(),vec3.create()],this.localOrigin=vec3.create(),this.radius=0,this.name=null},bt=function(){this.name=null,this.origin=vec3.create(),this.axis=[vec3.create(),vec3.create(),vec3.create()]},wt=function(){this.ident=0,this.version=0,this.name=null,this.flags=0,this.numFrames=0,this.numTags=0,this.numSurfaces=0,this.numSkins=0,this.ofsFrames=0,this.ofsTags=0,this.ofsSurfaces=0,this.ofsEnd=0},Et=function(){this.ident=0,this.name=null,this.flags=0,this.numFrames=0,this.numShaders=0,this.numVerts=0,this.numTriangles=0,this.ofsTriangles=0,this.ofsShaders=0,this.ofsSt=0,this.ofsXyzNormals=0,this.ofsEnd=0},St=function(){this.name=null,this.sort=0,this.surfaceFlags=0,this.contentFlags=0,this.cull=0,this.sky=!1,this.fog=!1,this.hasBlendFunc=!1,this.blendSrc=0,this.blendDest=0,this.depthWrite=!1,this.depthFunc=0,this.polygonOffset=!1,this.entityMergable=!1,this.stages=[],this.sortedIndex=0},xt=function(){this.textures=[],this.animFreq=0},Tt=function(){this.name=null,this.texnum=null},Nt=function(){this.name=null,this.surfaces=[]},Ct=function(){this.name=null,this.shader=null},kt,Lt,At,Ot=mat4.create([0,0,-1,0,-1,0,0,0,0,1,0,0,0,0,0,1]),Ht=["","WEBKIT_","MOZ_"],zt=.01,cn=null,yn,bn,wn,En,Sn,xn,Tn,Nn,Cn,kn,Ln,An,On,Mn,_n,kn,Dn,hr=0,pr=1,dr=2,Nr=129,Kr={water:{surface:0,contents:b.WATER},slime:{surface:0,contents:b.SLIME},lava:{surface:0,contents:b.LAVA},playerclip:{surface:0,contents:b.PLAYERCLIP},monsterclip:{surface:0,contents:b.MONSTERCLIP},nodrop:{surface:0,contents:b.NODROP},nonsolid:{surface:y.NONSOLID,contents:0},origin:{surface:0,contents:b.ORIGIN},trans:{surface:0,contents:b.TRANSLUCENT},detail:{surface:0,contents:b.DETAIL},structural:{surface:0,contents:b.STRUCTURAL},areaportal:{surface:0,contents:b.AREAPORTAL},clusterportal:{surface:0,contents:b.CLUSTERPORTAL},donotenter:{surface:0,contents:b.DONOTENTER},fog:{surface:0,contents:b.FOG},sky:{surface:y.SKY,contents:0},lightfilter:{surface:y.LIGHTFILTER,contents:0},alphashadow:{surface:y.ALPHASHADOW,contents:0},hint:{surface:y.HINT,contents:0},slick:{surface:y.SLICK,contents:0},noimpact:{surface:y.NOIMPACT,contents:0},nomarks:{surface:y.NOMARKS,contents:0},ladder:{surface:y.LADDER,contents:0},nodamage:{surface:y.NODAMAGE,contents:0},metalsteps:{surface:y.METALSTEPS,contents:0},flesh:{surface:y.FLESH,contents:0},nosteps:{surface:y.NOSTEPS,contents:0},nodraw:{surface:y.NODRAW,contents:0},pointlight:{surface:y.POINTLIGHT,contents:0},nolightmap:{surface:y.NOLIGHTMAP,contents:0},nodlight:{surface:y.NODLIGHT,contents:0},dust:{surface:y.DUST,contents:0}},ti=8,ni=4096,ri=512,ii=vec3.createFrom(-256,-256,-256),si=vec3.createFrom(256,256,256),ui=[[3,-1,2],[-3,1,2],[1,3,2],[-1,-3,2],[-2,-1,3],[2,-1,-3]],li={"textures/base_trim/techborder":"textures/base_trim/basemetalsupport","textures/gothic_block/blocks15_c":"textures/gothic_block/blocks20b","textures/gothic_block/blocks15_relief2":"textures/gothic_block/gkc15b","textures/gothic_block/blocks15cgeomtrn":"textures/gothic_block/demon_block15fx","textures/gothic_block/blocks17j":"textures/gothic_block/blocks17g","textures/gothic_block/blocks17k":"textures/gothic_block/killblock_i","textures/gothic_block/killblock_i2":"textures/gothic_block/killblock_i","textures/gothic_block/killblock_i3":"textures/gothic_block/killblock_i","textures/gothic_block/killblock_j":"textures/gothic_block/killblock_i","textures/gothic_block/killblock_j2":"textures/gothic_block/killblock_i","textures/gothic_block/killblock_k":"textures/gothic_block/killblock_i","textures/gothic_ceiling/ceilingtech_big":"textures/gothic_ceiling/ceilingtech02_d","textures/gothic_door/metal_door_a":"textures/gothic_door/skull_door_e","textures/gothic_door/metal_door_b":"textures/gothic_door/skull_door_c","textures/gothic_door/metal_door_c":"textures/gothic_door/skull_door_b","textures/gothic_door/metal_door_d":"textures/gothic_door/skull_door_a","textures/gothic_floor/blocks17floor":"textures/gothic_floor/blocks17floor2","textures/gothic_floor/largerblock3b2":"textures/gothic_floor/largerblock3b3","textures/gothic_floor/largerblock3b3dim":"textures/gothic_floor/largerblock3b3","textures/gothic_floor/largerblock3b3x128":"textures/gothic_floor/largerblock3b3","textures/gothic_floor/q1metal7_97":"textures/gothic_floor/q1metal7_99","textures/gothic_floor/q1metal7_98d_256x256":"textures/gothic_floor/q1metal7_99","textures/gothic_floor/xstepborder3_alpha":"textures/gothic_floor/xstepborder3","textures/gothic_floor/xstepborder3_shiney":"textures/gothic_floor/xstepborder3","textures/gothic_floor/xstepborder5":"textures/gothic_floor/xstairtop6","textures/gothic_light/skulllight01":"textures/gothic_light/ironcrosslt2","textures/gothic_light/gothic_light2_2k":"textures/gothic_light/gothic_light3_2k","textures/gothic_trim/baseboard01":"textures/gothic_trim/baseboard04","textures/gothic_trim/baseboard10":"textures/gothic_trim/baseboard10_d","textures/gothic_trim/baseboard10_e":"textures/gothic_trim/baseboard10_d","textures/gothic_trim/baseboard9c_com_b":"textures/gothic_trim/baseboard09_c3","textures/gothic_trim/border2":"textures/gothic_trim/window_a_base","textures/gothic_trim/border6":"textures/gothic_trim/baseboard04","textures/gothic_trim/border10":"textures/gothic_trim/baseboard09_g","textures/gothic_trim/border11":"textures/gothic_trim/baseboard09_g","textures/gothic_trim/metalsupport4":"textures/gothic_trim/metalsupport4b","textures/gothic_trim/metalsupport4c":"textures/gothic_trim/metalsupport4b","textures/gothic_trim/metalsupport4g":"textures/gothic_trim/km_arena1tower4","textures/gothic_trim/metalsupport4g_1":"textures/gothic_trim/km_arena1tower4","textures/gothic_trim/metalsupport4i_bit":"textures/gothic_trim/km_arena1tower4","textures/gothic_trim/metalsupport4j":"textures/gothic_trim/km_arena1tower4","textures/gothic_trim/metalsupport4small":"textures/gothic_trim/metalsupsolid","textures/gothic_trim/metlsupport4i_shiney":"textures/gothic_trim/xsupportborderside_shiney","textures/gothic_trim/baseboard01":"textures/gothic_trim/baseboard04","textures/gothic_trim/pitted_roof":"textures/gothic_trim/metalsupport4b","textures/gothic_trim/pitted_rustblack":"textures/gothic_trim/pitted_rust3","textures/gothic_trim/pitted_rust3_black":"textures/gothic_trim/pitted_rust3","textures/gothic_trim/q1metal7_12":"textures/gothic_trim/q1metal7","textures/gothic_trim/supportborderside_rot":"textures/gothic_trim/supportborderside","textures/gothic_trim/zinc":"textures/gothic_trim/metalsupsolid","textures/gothic_wall/iron01_c5":"textures/gothic_wall/iron01_b","textures/gothic_wall/xpipecolumn_gray128":"textures/gothic_wall/xiantourneycolumn_b4","textures/sfx/bounce_concrete":"textures/sfx/bouncepad01block18b","textures/sfx/bounce_largeblock3":"textures/sfx/bouncepad01block18b","textures/sfx/bounce_largeblock3b":"textures/sfx/bouncepad01block18b","textures/sfx/bounce_xq1metalbig":"textures/sfx/bouncepad1q1metal7_99","textures/sfx/blackness":"gfx/colors/black","textures/skin/skin5":"textures/skin/skin6","textures/skies/pjbasesky":"textures/skies/topclouds"},wi=542327876,Ei=1,Si=2,xi=4,Ti=8,Ni=4096,Ci=131072,ki=524288,Li=8388608,Ai=8,Oi=4194304,Mi=4096,_i=512,Di=1024,Pi=2048,Hi=4096,Bi=8192,ji=16384,Fi=32768,Ii=2097152,qi=1,Ri=2,Ui=4,zi=64,Wi=512,Xi=131072,Ji=Vi("DXT1"),Ki=Vi("DXT3"),Qi=Vi("DXT5"),Gi=31,Yi=0,Zi=1,es=2,ts=3,ns=4,rs=7,is=20,ss=21;return{RT:I,RF:q,RDF:R,RefDef:j,ViewParms:F,RefEntity:z,PolyVert:W,Init:Dt,Shutdown:Pt,LoadWorld:ps,NumInlineModels:function(){return kt.world.bmodels.length},RenderScene:Br,AddRefEntityToScene:jr,AddLightToScene:Fr,GetCounts:function(){return kt.counts},RegisterShader:Rr,RegisterModel:yr,RegisterSkin:ls,LerpTag:xr,ModelBounds:Tr,MarkFragments:fr}}return{CreateInstance:function(e){return new l(e)}}}),define("sound/snd",["underscore","glmatrix","common/qshared","common/asset-cache"],function(e,t,n,r){function i(e){function l(){var e=Array.prototype.slice.call(arguments);e.splice(0,0,"SND:"),Function.apply.call(console.log,console,e)}function c(e){i.Error(e)}function h(e){window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||undefined;if(window.AudioContext===undefined)return l("AudioContext not supported!"),e();var t=document.createElement("audio");if(!t.canPlayType||t.canPlayType("audio/ogg")==="")return l("OGG audio not supported"),e();f=new s,P(),f.ctx=new window.AudioContext,f.volume_main=f.ctx.createGainNode(),f.volume_main.connect(f.ctx.destination),f.volume_main.gain.value=L(),f.volume_music=f.ctx.createGainNode(),f.volume_music.connect(f.volume_main),f.volume_music.gain.value=D(),f.volume_sfx=f.ctx.createGainNode(),f.volume_sfx.connect(f.volume_main),f.volume_sfx.gain.value=_(),m(),e()}function p(){if(!f)return}function d(){if(!f)return;_.modified&&(f.volume_main.gain.value=_(),_.modified=!1),D.modified&&(f.volume_music.gain.value=D(),D.modified=!1),v()}function v(){for(var e=0;e<f.sources.length;e++){var t=f.sources[e],n=t.bufsrc;if(n.playbackState===n.FINISHED_STATE){f.sources.splice(e,1),e--;continue}t.looping&&!t.loopAddedThisFrame&&t.bufsrc.noteOff(0),t.loopAddedThisFrame=!1;if(t.tracking){var r=f.entities[t.entityNum];t.panner.setPosition(r.origin[0],r.origin[1],r.origin[2])}}}function m(){f.sounds=new r(g()),f.sounds.on("load",w)}function g(){var e=new o;return e}function y(e,t){if(!f)return t(0);e+=".ogg",f.sounds.load(e,t)}function b(e){return f.sounds.findByHandle(e)}function w(e,n){if(!e)return n(new Error("Empty texture name"));t.ReadFile(e,"binary",function(t,r){if(t)return l("Failed to load sound '"+e+"'"),n(t);f.ctx.decodeAudioData(r,function(t){var r=new o;r.name=e,r.buffer=t,n(null,r)})})}function E(e,t,n,r){if(!f)return;e&&t>=0&&c("Must specify either an origin or an entityNum, not both.");if(r)for(var i=0;i<f.sources.length;i++)if(f.sources[i].hSound===n)return f.sources[i];if(t===f.localEntityNum)return S(n,r);var s=b(n);if(!s||!s.buffer)return;var o=f.sources.length,a=f.sources[o]=new u;a.hSound=n,a.entityNum=t;var l=a.bufsrc=f.ctx.createBufferSource();l.buffer=s.buffer,r&&(l.looping=!0,l.loop=!0);var h=a.panner=f.ctx.createPanner();h.connect(f.volume_sfx),h.panningModel=h.EQUALPOWER,h.distanceModel=h.LINEAR_DISTANCE,h.refDistance=A(),h.maxDistance=O();if(e)h.setPosition(e[0],e[1],e[2]);else{a.tracking=!0;var p=f.entities[t];h.setPosition(p.origin[0],p.origin[1],p.origin[2])}return l.connect(h),l.noteOn(f.ctx.currentTime),a}function S(e,t){if(!f)return;var n=b(e);if(!n||!n.buffer)return;var r=f.sources.length,i=f.sources[r]=new u;i.hSound=e;var s=i.bufsrc=f.ctx.createBufferSource();return s.buffer=n.buffer,s.connect(f.volume_sfx),t&&(s.looping=!0,s.loop=!0),s.noteOn(f.ctx.currentTime),i}function x(e,t,n,r){var i=E(undefined,e,r,!0);i.loopAddedThisFrame=!0,i.looping=!0}function T(e,t){if(!f||!e)return;y(e,function(e){var n=b(e);if(!n||!n.buffer)return;var r=new u,i=r.bufsrc=f.ctx.createBufferSource();i.buffer=n.buffer,i.loop=t,i.connect(f.volume_music),i.noteOn(0)})}function N(){if(!f)return}function C(e,t,n){if(!f)return;f.localEntityNum=e,f.ctx.listener.setPosition(t[0],t[1],t[2]),f.ctx.listener.setOrientation(n[0][0],n[0][1],n[0][2],n[2][0],n[2][1],n[2][2])}function k(e,t){if(!f)return;(e<0||e>n.MAX_GENTITIES)&&c("UpdateEntityPosition: bad entitynum",e),vec3.set(t,f.entities[e].origin)}function P(){L=i.AddCvar("s_gain",1,0),A=i.AddCvar("s_graceDistance",512,0),O=i.AddCvar("s_maxDistance",1024,0),M=i.AddCvar("s_rolloff",2,0),_=i.AddCvar("s_volume",.7,n.CVF.ARCHIVE),D=i.AddCvar("s_musicVolume",.5,n.CVF.ARCHIVE)}var t=e.SYS,i=e.COM,s=function(){this.ctx=null,this.volume_main=null,this.volume_music=null,this.volume_sfx=null,this.sounds=null,this.sources=[],this.entities=new Array(n.MAX_GENTITIES),this.localEntityNum=0;for(var e=0;e<n.MAX_GENTITIES;e++)this.entities[e]=new a},o=function(){this.name=null,this.buffer=null},u=function(){this.hSound=-1,this.entityNum=-1,this.bufsrc=null,this.panner=null,this.looping=!1,this.tracking=!1,this.loopAddedThisFrame=!1},a=function(){this.origin=vec3.create()},f,L,A,O,M,_,D;return{Init:h,Shutdown:p,Frame:d,RegisterSound:y,StartSound:E,StartLocalSound:S,StartBackgroundTrack:T,AddLoopingSound:x,Respatialize:C,UpdateEntityPosition:k}}return{CreateInstance:function(e){return new i(e)}}}),function(e,t){function _(e){var t=M[e]={};return v.each(e.split(y),function(e,n){t[n]=!0}),t}function H(e,n,r){if(r===t&&e.nodeType===1){var i="data-"+n.replace(P,"-$1").toLowerCase();r=e.getAttribute(i);if(typeof r=="string"){try{r=r==="true"?!0:r==="false"?!1:r==="null"?null:+r+""===r?+r:D.test(r)?v.parseJSON(r):r}catch(s){}v.data(e,n,r)}else r=t}return r}function B(e){var t;for(t in e){if(t==="data"&&v.isEmptyObject(e[t]))continue;if(t!=="toJSON")return!1}return!0}function et(){return!1}function tt(){return!0}function ut(e){return!e||!e.parentNode||e.parentNode.nodeType===11}function at(e,t){do e=e[t];while(e&&e.nodeType!==1);return e}function ft(e,t,n){t=t||0;if(v.isFunction(t))return v.grep(e,function(e,r){var i=!!t.call(e,r,e);return i===n});if(t.nodeType)return v.grep(e,function(e,r){return e===t===n});if(typeof t=="string"){var r=v.grep(e,function(e){return e.nodeType===1});if(it.test(t))return v.filter(t,r,!n);t=v.filter(t,r)}return v.grep(e,function(e,r){return v.inArray(e,t)>=0===n})}function lt(e){var t=ct.split("|"),n=e.createDocumentFragment();if(n.createElement)while(t.length)n.createElement(t.pop());return n}function Lt(e,t){return e.getElementsByTagName(t)[0]||e.appendChild(e.ownerDocument.createElement(t))}function At(e,t){if(t.nodeType!==1||!v.hasData(e))return;var n,r,i,s=v._data(e),o=v._data(t,s),u=s.events;if(u){delete o.handle,o.events={};for(n in u)for(r=0,i=u[n].length;r<i;r++)v.event.add(t,n,u[n][r])}o.data&&(o.data=v.extend({},o.data))}function Ot(e,t){var n;if(t.nodeType!==1)return;t.clearAttributes&&t.clearAttributes(),t.mergeAttributes&&t.mergeAttributes(e),n=t.nodeName.toLowerCase(),n==="object"?(t.parentNode&&(t.outerHTML=e.outerHTML),v.support.html5Clone&&e.innerHTML&&!v.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):n==="input"&&Et.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):n==="option"?t.selected=e.defaultSelected:n==="input"||n==="textarea"?t.defaultValue=e.defaultValue:n==="script"&&t.text!==e.text&&(t.text=e.text),t.removeAttribute(v.expando)}function Mt(e){return typeof e.getElementsByTagName!="undefined"?e.getElementsByTagName("*"):typeof e.querySelectorAll!="undefined"?e.querySelectorAll("*"):[]}function _t(e){Et.test(e.type)&&(e.defaultChecked=e.checked)}function Qt(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=Jt.length;while(i--){t=Jt[i]+n;if(t in e)return t}return r}function Gt(e,t){return e=t||e,v.css(e,"display")==="none"||!v.contains(e.ownerDocument,e)}function Yt(e,t){var n,r,i=[],s=0,o=e.length;for(;s<o;s++){n=e[s];if(!n.style)continue;i[s]=v._data(n,"olddisplay"),t?(!i[s]&&n.style.display==="none"&&(n.style.display=""),n.style.display===""&&Gt(n)&&(i[s]=v._data(n,"olddisplay",nn(n.nodeName)))):(r=Dt(n,"display"),!i[s]&&r!=="none"&&v._data(n,"olddisplay",r))}for(s=0;s<o;s++){n=e[s];if(!n.style)continue;if(!t||n.style.display==="none"||n.style.display==="")n.style.display=t?i[s]||"":"none"}return e}function Zt(e,t,n){var r=Rt.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function en(e,t,n,r){var i=n===(r?"border":"content")?4:t==="width"?1:0,s=0;for(;i<4;i+=2)n==="margin"&&(s+=v.css(e,n+$t[i],!0)),r?(n==="content"&&(s-=parseFloat(Dt(e,"padding"+$t[i]))||0),n!=="margin"&&(s-=parseFloat(Dt(e,"border"+$t[i]+"Width"))||0)):(s+=parseFloat(Dt(e,"padding"+$t[i]))||0,n!=="padding"&&(s+=parseFloat(Dt(e,"border"+$t[i]+"Width"))||0));return s}function tn(e,t,n){var r=t==="width"?e.offsetWidth:e.offsetHeight,i=!0,s=v.support.boxSizing&&v.css(e,"boxSizing")==="border-box";if(r<=0||r==null){r=Dt(e,t);if(r<0||r==null)r=e.style[t];if(Ut.test(r))return r;i=s&&(v.support.boxSizingReliable||r===e.style[t]),r=parseFloat(r)||0}return r+en(e,t,n||(s?"border":"content"),i)+"px"}function nn(e){if(Wt[e])return Wt[e];var t=v("<"+e+">").appendTo(i.body),n=t.css("display");t.remove();if(n==="none"||n===""){Pt=i.body.appendChild(Pt||v.extend(i.createElement("iframe"),{frameBorder:0,width:0,height:0}));if(!Ht||!Pt.createElement)Ht=(Pt.contentWindow||Pt.contentDocument).document,Ht.write("<!doctype html><html><body>"),Ht.close();t=Ht.body.appendChild(Ht.createElement(e)),n=Dt(t,"display"),i.body.removeChild(Pt)}return Wt[e]=n,n}function fn(e,t,n,r){var i;if(v.isArray(t))v.each(t,function(t,i){n||sn.test(e)?r(e,i):fn(e+"["+(typeof i=="object"?t:"")+"]",i,n,r)});else if(!n&&v.type(t)==="object")for(i in t)fn(e+"["+i+"]",t[i],n,r);else r(e,t)}function Cn(e){return function(t,n){typeof t!="string"&&(n=t,t="*");var r,i,s,o=t.toLowerCase().split(y),u=0,a=o.length;if(v.isFunction(n))for(;u<a;u++)r=o[u],s=/^\+/.test(r),s&&(r=r.substr(1)||"*"),i=e[r]=e[r]||[],i[s?"unshift":"push"](n)}}function kn(e,n,r,i,s,o){s=s||n.dataTypes[0],o=o||{},o[s]=!0;var u,a=e[s],f=0,l=a?a.length:0,c=e===Sn;for(;f<l&&(c||!u);f++)u=a[f](n,r,i),typeof u=="string"&&(!c||o[u]?u=t:(n.dataTypes.unshift(u),u=kn(e,n,r,i,u,o)));return(c||!u)&&!o["*"]&&(u=kn(e,n,r,i,"*",o)),u}function Ln(e,n){var r,i,s=v.ajaxSettings.flatOptions||{};for(r in n)n[r]!==t&&((s[r]?e:i||(i={}))[r]=n[r]);i&&v.extend(!0,e,i)}function An(e,n,r){var i,s,o,u,a=e.contents,f=e.dataTypes,l=e.responseFields;for(s in l)s in r&&(n[l[s]]=r[s]);while(f[0]==="*")f.shift(),i===t&&(i=e.mimeType||n.getResponseHeader("content-type"));if(i)for(s in a)if(a[s]&&a[s].test(i)){f.unshift(s);break}if(f[0]in r)o=f[0];else{for(s in r){if(!f[0]||e.converters[s+" "+f[0]]){o=s;break}u||(u=s)}o=o||u}if(o)return o!==f[0]&&f.unshift(o),r[o]}function On(e,t){var n,r,i,s,o=e.dataTypes.slice(),u=o[0],a={},f=0;e.dataFilter&&(t=e.dataFilter(t,e.dataType));if(o[1])for(n in e.converters)a[n.toLowerCase()]=e.converters[n];for(;i=o[++f];)if(i!=="*"){if(u!=="*"&&u!==i){n=a[u+" "+i]||a["* "+i];if(!n)for(r in a){s=r.split(" ");if(s[1]===i){n=a[u+" "+s[0]]||a["* "+s[0]];if(n){n===!0?n=a[r]:a[r]!==!0&&(i=s[0],o.splice(f--,0,i));break}}}if(n!==!0)if(n&&e["throws"])t=n(t);else try{t=n(t)}catch(l){return{state:"parsererror",error:n?l:"No conversion from "+u+" to "+i}}}u=i}return{state:"success",data:t}}function Fn(){try{return new e.XMLHttpRequest}catch(t){}}function In(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function $n(){return setTimeout(function(){qn=t},0),qn=v.now()}function Jn(e,t){v.each(t,function(t,n){var r=(Vn[t]||[]).concat(Vn["*"]),i=0,s=r.length;for(;i<s;i++)if(r[i].call(e,t,n))return})}function Kn(e,t,n){var r,i=0,s=0,o=Xn.length,u=v.Deferred().always(function(){delete a.elem}),a=function(){var t=qn||$n(),n=Math.max(0,f.startTime+f.duration-t),r=1-(n/f.duration||0),i=0,s=f.tweens.length;for(;i<s;i++)f.tweens[i].run(r);return u.notifyWith(e,[f,r,n]),r<1&&s?n:(u.resolveWith(e,[f]),!1)},f=u.promise({elem:e,props:v.extend({},t),opts:v.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:qn||$n(),duration:n.duration,tweens:[],createTween:function(t,n,r){var i=v.Tween(e,f.opts,t,n,f.opts.specialEasing[t]||f.opts.easing);return f.tweens.push(i),i},stop:function(t){var n=0,r=t?f.tweens.length:0;for(;n<r;n++)f.tweens[n].run(1);return t?u.resolveWith(e,[f,t]):u.rejectWith(e,[f,t]),this}}),l=f.props;Qn(l,f.opts.specialEasing);for(;i<o;i++){r=Xn[i].call(f,e,l,f.opts);if(r)return r}return Jn(f,l),v.isFunction(f.opts.start)&&f.opts.start.call(e,f),v.fx.timer(v.extend(a,{anim:f,queue:f.opts.queue,elem:e})),f.progress(f.opts.progress).done(f.opts.done,f.opts.complete).fail(f.opts.fail).always(f.opts.always)}function Qn(e,t){var n,r,i,s,o;for(n in e){r=v.camelCase(n),i=t[r],s=e[n],v.isArray(s)&&(i=s[1],s=e[n]=s[0]),n!==r&&(e[r]=s,delete e[n]),o=v.cssHooks[r];if(o&&"expand"in o){s=o.expand(s),delete e[r];for(n in s)n in e||(e[n]=s[n],t[n]=i)}else t[r]=i}}function Gn(e,t,n){var r,i,s,o,u,a,f,l,c=this,h=e.style,p={},d=[],m=e.nodeType&&Gt(e);n.queue||(f=v._queueHooks(e,"fx"),f.unqueued==null&&(f.unqueued=0,l=f.empty.fire,f.empty.fire=function(){f.unqueued||l()}),f.unqueued++,c.always(function(){c.always(function(){f.unqueued--,v.queue(e,"fx").length||f.empty.fire()})})),e.nodeType===1&&("height"in t||"width"in t)&&(n.overflow=[h.overflow,h.overflowX,h.overflowY],v.css(e,"display")==="inline"&&v.css(e,"float")==="none"&&(!v.support.inlineBlockNeedsLayout||nn(e.nodeName)==="inline"?h.display="inline-block":h.zoom=1)),n.overflow&&(h.overflow="hidden",v.support.shrinkWrapBlocks||c.done(function(){h.overflow=n.overflow[0],h.overflowX=n.overflow[1],h.overflowY=n.overflow[2]}));for(r in t){s=t[r];if(Un.exec(s)){delete t[r];if(s===(m?"hide":"show"))continue;d.push(r)}}o=d.length;if(o){u=v._data(e,"fxshow")||v._data(e,"fxshow",{}),m?v(e).show():c.done(function(){v(e).hide()}),c.done(function(){var t;v.removeData(e,"fxshow",!0);for(t in p)v.style(e,t,p[t])});for(r=0;r<o;r++)i=d[r],a=c.createTween(i,m?u[i]:0),p[i]=u[i]||v.style(e,i),i in u||(u[i]=a.start,m&&(a.end=a.start,a.start=i==="width"||i==="height"?1:0))}}function Yn(e,t,n,r,i){return new Yn.prototype.init(e,t,n,r,i)}function Zn(e,t){var n,r={height:e},i=0;t=t?1:0;for(;i<4;i+=2-t)n=$t[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function tr(e){return v.isWindow(e)?e:e.nodeType===9?e.defaultView||e.parentWindow:!1}var n,r,i=e.document,s=e.location,o=e.navigator,u=e.jQuery,a=e.$,f=Array.prototype.push,l=Array.prototype.slice,c=Array.prototype.indexOf,h=Object.prototype.toString,p=Object.prototype.hasOwnProperty,d=String.prototype.trim,v=function(e,t){return new v.fn.init(e,t,n)},m=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,g=/\S/,y=/\s+/,b=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,w=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,E=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,S=/^[\],:{}\s]*$/,x=/(?:^|:|,)(?:\s*\[)+/g,T=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,N=/"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g,C=/^-ms-/,k=/-([\da-z])/gi,L=function(e,t){return(t+"").toUpperCase()},A=function(){i.addEventListener?(i.removeEventListener("DOMContentLoaded",A,!1),v.ready()):i.readyState==="complete"&&(i.detachEvent("onreadystatechange",A),v.ready())},O={};v.fn=v.prototype={constructor:v,init:function(e,n,r){var s,o,u,a;if(!e)return this;if(e.nodeType)return this.context=this[0]=e,this.length=1,this;if(typeof e=="string"){e.charAt(0)==="<"&&e.charAt(e.length-1)===">"&&e.length>=3?s=[null,e,null]:s=w.exec(e);if(s&&(s[1]||!n)){if(s[1])return n=n instanceof v?n[0]:n,a=n&&n.nodeType?n.ownerDocument||n:i,e=v.parseHTML(s[1],a,!0),E.test(s[1])&&v.isPlainObject(n)&&this.attr.call(e,n,!0),v.merge(this,e);o=i.getElementById(s[2]);if(o&&o.parentNode){if(o.id!==s[2])return r.find(e);this.length=1,this[0]=o}return this.context=i,this.selector=e,this}return!n||n.jquery?(n||r).find(e):this.constructor(n).find(e)}return v.isFunction(e)?r.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),v.makeArray(e,this))},selector:"",jquery:"1.8.2",length:0,size:function(){return this.length},toArray:function(){return l.call(this)},get:function(e){return e==null?this.toArray():e<0?this[this.length+e]:this[e]},pushStack:function(e,t,n){var r=v.merge(this.constructor(),e);return r.prevObject=this,r.context=this.context,t==="find"?r.selector=this.selector+(this.selector?" ":"")+n:t&&(r.selector=this.selector+"."+t+"("+n+")"),r},each:function(e,t){return v.each(this,e,t)},ready:function(e){return v.ready.promise().done(e),this},eq:function(e){return e=+e,e===-1?this.slice(e):this.slice(e,e+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(l.apply(this,arguments),"slice",l.call(arguments).join(","))},map:function(e){return this.pushStack(v.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:f,sort:[].sort,splice:[].splice},v.fn.init.prototype=v.fn,v.extend=v.fn.extend=function(){var e,n,r,i,s,o,u=arguments[0]||{},a=1,f=arguments.length,l=!1;typeof u=="boolean"&&(l=u,u=arguments[1]||{},a=2),typeof u!="object"&&!v.isFunction(u)&&(u={}),f===a&&(u=this,--a);for(;a<f;a++)if((e=arguments[a])!=null)for(n in e){r=u[n],i=e[n];if(u===i)continue;l&&i&&(v.isPlainObject(i)||(s=v.isArray(i)))?(s?(s=!1,o=r&&v.isArray(r)?r:[]):o=r&&v.isPlainObject(r)?r:{},u[n]=v.extend(l,o,i)):i!==t&&(u[n]=i)}return u},v.extend({noConflict:function(t){return e.$===v&&(e.$=a),t&&e.jQuery===v&&(e.jQuery=u),v},isReady:!1,readyWait:1,holdReady:function(e){e?v.readyWait++:v.ready(!0)},ready:function(e){if(e===!0?--v.readyWait:v.isReady)return;if(!i.body)return setTimeout(v.ready,1);v.isReady=!0;if(e!==!0&&--v.readyWait>0)return;r.resolveWith(i,[v]),v.fn.trigger&&v(i).trigger("ready").off("ready")},isFunction:function(e){return v.type(e)==="function"},isArray:Array.isArray||function(e){return v.type(e)==="array"},isWindow:function(e){return e!=null&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return e==null?String(e):O[h.call(e)]||"object"},isPlainObject:function(e){if(!e||v.type(e)!=="object"||e.nodeType||v.isWindow(e))return!1;try{if(e.constructor&&!p.call(e,"constructor")&&!p.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(n){return!1}var r;for(r in e);return r===t||p.call(e,r)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw new Error(e)},parseHTML:function(e,t,n){var r;return!e||typeof e!="string"?null:(typeof t=="boolean"&&(n=t,t=0),t=t||i,(r=E.exec(e))?[t.createElement(r[1])]:(r=v.buildFragment([e],t,n?null:[]),v.merge([],(r.cacheable?v.clone(r.fragment):r.fragment).childNodes)))},parseJSON:function(t){if(!t||typeof t!="string")return null;t=v.trim(t);if(e.JSON&&e.JSON.parse)return e.JSON.parse(t);if(S.test(t.replace(T,"@").replace(N,"]").replace(x,"")))return(new Function("return "+t))();v.error("Invalid JSON: "+t)},parseXML:function(n){var r,i;if(!n||typeof n!="string")return null;try{e.DOMParser?(i=new DOMParser,r=i.parseFromString(n,"text/xml")):(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(n))}catch(s){r=t}return(!r||!r.documentElement||r.getElementsByTagName("parsererror").length)&&v.error("Invalid XML: "+n),r},noop:function(){},globalEval:function(t){t&&g.test(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(C,"ms-").replace(k,L)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,n,r){var i,s=0,o=e.length,u=o===t||v.isFunction(e);if(r){if(u){for(i in e)if(n.apply(e[i],r)===!1)break}else for(;s<o;)if(n.apply(e[s++],r)===!1)break}else if(u){for(i in e)if(n.call(e[i],i,e[i])===!1)break}else for(;s<o;)if(n.call(e[s],s,e[s++])===!1)break;return e},trim:d&&!d.call("")?function(e){return e==null?"":d.call(e)}:function(e){return e==null?"":(e+"").replace(b,"")},makeArray:function(e,t){var n,r=t||[];return e!=null&&(n=v.type(e),e.length==null||n==="string"||n==="function"||n==="regexp"||v.isWindow(e)?f.call(r,e):v.merge(r,e)),r},inArray:function(e,t,n){var r;if(t){if(c)return c.call(t,e,n);r=t.length,n=n?n<0?Math.max(0,r+n):n:0;for(;n<r;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,n){var r=n.length,i=e.length,s=0;if(typeof r=="number")for(;s<r;s++)e[i++]=n[s];else while(n[s]!==t)e[i++]=n[s++];return e.length=i,e},grep:function(e,t,n){var r,i=[],s=0,o=e.length;n=!!n;for(;s<o;s++)r=!!t(e[s],s),n!==r&&i.push(e[s]);return i},map:function(e,n,r){var i,s,o=[],u=0,a=e.length,f=e instanceof v||a!==t&&typeof a=="number"&&(a>0&&e[0]&&e[a-1]||a===0||v.isArray(e));if(f)for(;u<a;u++)i=n(e[u],u,r),i!=null&&(o[o.length]=i);else for(s in e)i=n(e[s],s,r),i!=null&&(o[o.length]=i);return o.concat.apply([],o)},guid:1,proxy:function(e,n){var r,i,s;return typeof n=="string"&&(r=e[n],n=e,e=r),v.isFunction(e)?(i=l.call(arguments,2),s=function(){return e.apply(n,i.concat(l.call(arguments)))},s.guid=e.guid=e.guid||v.guid++,s):t},access:function(e,n,r,i,s,o,u){var a,f=r==null,l=0,c=e.length;if(r&&typeof r=="object"){for(l in r)v.access(e,n,l,r[l],1,o,i);s=1}else if(i!==t){a=u===t&&v.isFunction(i),f&&(a?(a=n,n=function(e,t,n){return a.call(v(e),n)}):(n.call(e,i),n=null));if(n)for(;l<c;l++)n(e[l],r,a?i.call(e[l],l,n(e[l],r)):i,u);s=1}return s?e:f?n.call(e):c?n(e[0],r):o},now:function(){return(new Date).getTime()}}),v.ready.promise=function(t){if(!r){r=v.Deferred();if(i.readyState==="complete")setTimeout(v.ready,1);else if(i.addEventListener)i.addEventListener("DOMContentLoaded",A,!1),e.addEventListener("load",v.ready,!1);else{i.attachEvent("onreadystatechange",A),e.attachEvent("onload",v.ready);var n=!1;try{n=e.frameElement==null&&i.documentElement}catch(s){}n&&n.doScroll&&function o(){if(!v.isReady){try{n.doScroll("left")}catch(e){return setTimeout(o,50)}v.ready()}}()}}return r.promise(t)},v.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(e,t){O["[object "+t+"]"]=t.toLowerCase()}),n=v(i);var M={};v.Callbacks=function(e){e=typeof e=="string"?M[e]||_(e):v.extend({},e);var n,r,i,s,o,u,a=[],f=!e.once&&[],l=function(t){n=e.memory&&t,r=!0,u=s||0,s=0,o=a.length,i=!0;for(;a&&u<o;u++)if(a[u].apply(t[0],t[1])===!1&&e.stopOnFalse){n=!1;break}i=!1,a&&(f?f.length&&l(f.shift()):n?a=[]:c.disable())},c={add:function(){if(a){var t=a.length;(function r(t){v.each(t,function(t,n){var i=v.type(n);i==="function"&&(!e.unique||!c.has(n))?a.push(n):n&&n.length&&i!=="string"&&r(n)})})(arguments),i?o=a.length:n&&(s=t,l(n))}return this},remove:function(){return a&&v.each(arguments,function(e,t){var n;while((n=v.inArray(t,a,n))>-1)a.splice(n,1),i&&(n<=o&&o--,n<=u&&u--)}),this},has:function(e){return v.inArray(e,a)>-1},empty:function(){return a=[],this},disable:function(){return a=f=n=t,this},disabled:function(){return!a},lock:function(){return f=t,n||c.disable(),this},locked:function(){return!f},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],a&&(!r||f)&&(i?f.push(t):l(t)),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!r}};return c},v.extend({Deferred:function(e){var t=[["resolve","done",v.Callbacks("once memory"),"resolved"],["reject","fail",v.Callbacks("once memory"),"rejected"],["notify","progress",v.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return v.Deferred(function(n){v.each(t,function(t,r){var s=r[0],o=e[t];i[r[1]](v.isFunction(o)?function(){var e=o.apply(this,arguments);e&&v.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[s+"With"](this===i?n:this,[e])}:n[s])}),e=null}).promise()},promise:function(e){return e!=null?v.extend(e,r):r}},i={};return r.pipe=r.then,v.each(t,function(e,s){var o=s[2],u=s[3];r[s[1]]=o.add,u&&o.add(function(){n=u},t[e^1][2].disable,t[2][2].lock),i[s[0]]=o.fire,i[s[0]+"With"]=o.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=l.call(arguments),r=n.length,i=r!==1||e&&v.isFunction(e.promise)?r:0,s=i===1?e:v.Deferred(),o=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?l.call(arguments):r,n===u?s.notifyWith(t,n):--i||s.resolveWith(t,n)}},u,a,f;if(r>1){u=new Array(r),a=new Array(r),f=new Array(r);for(;t<r;t++)n[t]&&v.isFunction(n[t].promise)?n[t].promise().done(o(t,f,n)).fail(s.reject).progress(o(t,a,u)):--i}return i||s.resolveWith(f,n),s.promise()}}),v.support=function(){var t,n,r,s,o,u,a,f,l,c,h,p=i.createElement("div");p.setAttribute("className","t"),p.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",n=p.getElementsByTagName("*"),r=p.getElementsByTagName("a")[0],r.style.cssText="top:1px;float:left;opacity:.5";if(!n||!n.length)return{};s=i.createElement("select"),o=s.appendChild(i.createElement("option")),u=p.getElementsByTagName("input")[0],t={leadingWhitespace:p.firstChild.nodeType===3,tbody:!p.getElementsByTagName("tbody").length,htmlSerialize:!!p.getElementsByTagName("link").length,style:/top/.test(r.getAttribute("style")),hrefNormalized:r.getAttribute("href")==="/a",opacity:/^0.5/.test(r.style.opacity),cssFloat:!!r.style.cssFloat,checkOn:u.value==="on",optSelected:o.selected,getSetAttribute:p.className!=="t",enctype:!!i.createElement("form").enctype,html5Clone:i.createElement("nav").cloneNode(!0).outerHTML!=="<:nav></:nav>",boxModel:i.compatMode==="CSS1Compat",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},u.checked=!0,t.noCloneChecked=u.cloneNode(!0).checked,s.disabled=!0,t.optDisabled=!o.disabled;try{delete p.test}catch(d){t.deleteExpando=!1}!p.addEventListener&&p.attachEvent&&p.fireEvent&&(p.attachEvent("onclick",h=function(){t.noCloneEvent=!1}),p.cloneNode(!0).fireEvent("onclick"),p.detachEvent("onclick",h)),u=i.createElement("input"),u.value="t",u.setAttribute("type","radio"),t.radioValue=u.value==="t",u.setAttribute("checked","checked"),u.setAttribute("name","t"),p.appendChild(u),a=i.createDocumentFragment(),a.appendChild(p.lastChild),t.checkClone=a.cloneNode(!0).cloneNode(!0).lastChild.checked,t.appendChecked=u.checked,a.removeChild(u),a.appendChild(p);if(p.attachEvent)for(l in{submit:!0,change:!0,focusin:!0})f="on"+l,c=f in p,c||(p.setAttribute(f,"return;"),c=typeof p[f]=="function"),t[l+"Bubbles"]=c;return v(function(){var n,r,s,o,u="padding:0;margin:0;border:0;display:block;overflow:hidden;",a=i.getElementsByTagName("body")[0];if(!a)return;n=i.createElement("div"),n.style.cssText="visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px",a.insertBefore(n,a.firstChild),r=i.createElement("div"),n.appendChild(r),r.innerHTML="<table><tr><td></td><td>t</td></tr></table>",s=r.getElementsByTagName("td"),s[0].style.cssText="padding:0;margin:0;border:0;display:none",c=s[0].offsetHeight===0,s[0].style.display="",s[1].style.display="none",t.reliableHiddenOffsets=c&&s[0].offsetHeight===0,r.innerHTML="",r.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",t.boxSizing=r.offsetWidth===4,t.doesNotIncludeMarginInBodyOffset=a.offsetTop!==1,e.getComputedStyle&&(t.pixelPosition=(e.getComputedStyle(r,null)||{}).top!=="1%",t.boxSizingReliable=(e.getComputedStyle(r,null)||{width:"4px"}).width==="4px",o=i.createElement("div"),o.style.cssText=r.style.cssText=u,o.style.marginRight=o.style.width="0",r.style.width="1px",r.appendChild(o),t.reliableMarginRight=!parseFloat((e.getComputedStyle(o,null)||{}).marginRight)),typeof r.style.zoom!="undefined"&&(r.innerHTML="",r.style.cssText=u+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=r.offsetWidth===3,r.style.display="block",r.style.overflow="visible",r.innerHTML="<div></div>",r.firstChild.style.width="5px",t.shrinkWrapBlocks=r.offsetWidth!==3,n.style.zoom=1),a.removeChild(n),n=r=s=o=null}),a.removeChild(p),n=r=s=o=u=a=p=null,t}();var D=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,P=/([A-Z])/g;v.extend({cache:{},deletedIds:[],uuid:0,expando:"jQuery"+(v.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(e){return e=e.nodeType?v.cache[e[v.expando]]:e[v.expando],!!e&&!B(e)},data:function(e,n,r,i){if(!v.acceptData(e))return;var s,o,u=v.expando,a=typeof n=="string",f=e.nodeType,l=f?v.cache:e,c=f?e[u]:e[u]&&u;if((!c||!l[c]||!i&&!l[c].data)&&a&&r===t)return;c||(f?e[u]=c=v.deletedIds.pop()||v.guid++:c=u),l[c]||(l[c]={},f||(l[c].toJSON=v.noop));if(typeof n=="object"||typeof n=="function")i?l[c]=v.extend(l[c],n):l[c].data=v.extend(l[c].data,n);return s=l[c],i||(s.data||(s.data={}),s=s.data),r!==t&&(s[v.camelCase(n)]=r),a?(o=s[n],o==null&&(o=s[v.camelCase(n)])):o=s,o},removeData:function(e,t,n){if(!v.acceptData(e))return;var r,i,s,o=e.nodeType,u=o?v.cache:e,a=o?e[v.expando]:v.expando;if(!u[a])return;if(t){r=n?u[a]:u[a].data;if(r){v.isArray(t)||(t in r?t=[t]:(t=v.camelCase(t),t in r?t=[t]:t=t.split(" ")));for(i=0,s=t.length;i<s;i++)delete r[t[i]];if(!(n?B:v.isEmptyObject)(r))return}}if(!n){delete u[a].data;if(!B(u[a]))return}o?v.cleanData([e],!0):v.support.deleteExpando||u!=u.window?delete u[a]:u[a]=null},_data:function(e,t,n){return v.data(e,t,n,!0)},acceptData:function(e){var t=e.nodeName&&v.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),v.fn.extend({data:function(e,n){var r,i,s,o,u,a=this[0],f=0,l=null;if(e===t){if(this.length){l=v.data(a);if(a.nodeType===1&&!v._data(a,"parsedAttrs")){s=a.attributes;for(u=s.length;f<u;f++)o=s[f].name,o.indexOf("data-")||(o=v.camelCase(o.substring(5)),H(a,o,l[o]));v._data(a,"parsedAttrs",!0)}}return l}return typeof e=="object"?this.each(function(){v.data(this,e)}):(r=e.split(".",2),r[1]=r[1]?"."+r[1]:"",i=r[1]+"!",v.access(this,function(n){if(n===t)return l=this.triggerHandler("getData"+i,[r[0]]),l===t&&a&&(l=v.data(a,e),l=H(a,e,l)),l===t&&r[1]?this.data(r[0]):l;r[1]=n,this.each(function(){var t=v(this);t.triggerHandler("setData"+i,r),v.data(this,e,n),t.triggerHandler("changeData"+i,r)})},null,n,arguments.length>1,null,!1))},removeData:function(e){return this.each(function(){v.removeData(this,e)})}}),v.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=v._data(e,t),n&&(!r||v.isArray(n)?r=v._data(e,t,v.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=v.queue(e,t),r=n.length,i=n.shift(),s=v._queueHooks(e,t),o=function(){v.dequeue(e,t)};i==="inprogress"&&(i=n.shift(),r--),i&&(t==="fx"&&n.unshift("inprogress"),delete s.stop,i.call(e,o,s)),!r&&s&&s.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return v._data(e,n)||v._data(e,n,{empty:v.Callbacks("once memory").add(function(){v.removeData(e,t+"queue",!0),v.removeData(e,n,!0)})})}}),v.fn.extend({queue:function(e,n){var r=2;return typeof e!="string"&&(n=e,e="fx",r--),arguments.length<r?v.queue(this[0],e):n===t?this:this.each(function(){var t=v.queue(this,e,n);v._queueHooks(this,e),e==="fx"&&t[0]!=="inprogress"&&v.dequeue(this,e)})},dequeue:function(e){return this.each(function(){v.dequeue(this,e)})},delay:function(e,t){return e=v.fx?v.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){var r,i=1,s=v.Deferred(),o=this,u=this.length,a=function(){--i||s.resolveWith(o,[o])};typeof e!="string"&&(n=e,e=t),e=e||"fx";while(u--)r=v._data(o[u],e+"queueHooks"),r&&r.empty&&(i++,r.empty.add(a));return a(),s.promise(n)}});var j,F,I,q=/[\t\r\n]/g,R=/\r/g,U=/^(?:button|input)$/i,z=/^(?:button|input|object|select|textarea)$/i,W=/^a(?:rea|)$/i,X=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,V=v.support.getSetAttribute;v.fn.extend({attr:function(e,t){return v.access(this,v.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){v.removeAttr(this,e)})},prop:function(e,t){return v.access(this,v.prop,e,t,arguments.length>1)},removeProp:function(e){return e=v.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(n){}})},addClass:function(e){var t,n,r,i,s,o,u;if(v.isFunction(e))return this.each(function(t){v(this).addClass(e.call(this,t,this.className))});if(e&&typeof e=="string"){t=e.split(y);for(n=0,r=this.length;n<r;n++){i=this[n];if(i.nodeType===1)if(!i.className&&t.length===1)i.className=e;else{s=" "+i.className+" ";for(o=0,u=t.length;o<u;o++)s.indexOf(" "+t[o]+" ")<0&&(s+=t[o]+" ");i.className=v.trim(s)}}}return this},removeClass:function(e){var n,r,i,s,o,u,a;if(v.isFunction(e))return this.each(function(t){v(this).removeClass(e.call(this,t,this.className))});if(e&&typeof e=="string"||e===t){n=(e||"").split(y);for(u=0,a=this.length;u<a;u++){i=this[u];if(i.nodeType===1&&i.className){r=(" "+i.className+" ").replace(q," ");for(s=0,o=n.length;s<o;s++)while(r.indexOf(" "+n[s]+" ")>=0)r=r.replace(" "+n[s]+" "," ");i.className=e?v.trim(r):""}}}return this},toggleClass:function(e,t){var n=typeof e,r=typeof t=="boolean";return v.isFunction(e)?this.each(function(n){v(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if(n==="string"){var i,s=0,o=v(this),u=t,a=e.split(y);while(i=a[s++])u=r?u:!o.hasClass(i),o[u?"addClass":"removeClass"](i)}else if(n==="undefined"||n==="boolean")this.className&&v._data(this,"__className__",this.className),this.className=this.className||e===!1?"":v._data(this,"__className__")||""})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;n<r;n++)if(this[n].nodeType===1&&(" "+this[n].className+" ").replace(q," ").indexOf(t)>=0)return!0;return!1},val:function(e){var n,r,i,s=this[0];if(!arguments.length){if(s)return n=v.valHooks[s.type]||v.valHooks[s.nodeName.toLowerCase()],n&&"get"in n&&(r=n.get(s,"value"))!==t?r:(r=s.value,typeof r=="string"?r.replace(R,""):r==null?"":r);return}return i=v.isFunction(e),this.each(function(r){var s,o=v(this);if(this.nodeType!==1)return;i?s=e.call(this,r,o.val()):s=e,s==null?s="":typeof s=="number"?s+="":v.isArray(s)&&(s=v.map(s,function(e){return e==null?"":e+""})),n=v.valHooks[this.type]||v.valHooks[this.nodeName.toLowerCase()];if(!n||!("set"in n)||n.set(this,s,"value")===t)this.value=s})}}),v.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r,i,s=e.selectedIndex,o=[],u=e.options,a=e.type==="select-one";if(s<0)return null;n=a?s:0,r=a?s+1:u.length;for(;n<r;n++){i=u[n];if(i.selected&&(v.support.optDisabled?!i.disabled:i.getAttribute("disabled")===null)&&(!i.parentNode.disabled||!v.nodeName(i.parentNode,"optgroup"))){t=v(i).val();if(a)return t;o.push(t)}}return a&&!o.length&&u.length?v(u[s]).val():o},set:function(e,t){var n=v.makeArray(t);return v(e).find("option").each(function(){this.selected=v.inArray(v(this).val(),n)>=0}),n.length||(e.selectedIndex=-1),n}}},attrFn:{},attr:function(e,n,r,i){var s,o,u,a=e.nodeType;if(!e||a===3||a===8||a===2)return;if(i&&v.isFunction(v.fn[n]))return v(e)[n](r);if(typeof e.getAttribute=="undefined")return v.prop(e,n,r);u=a!==1||!v.isXMLDoc(e),u&&(n=n.toLowerCase(),o=v.attrHooks[n]||(X.test(n)?F:j));if(r!==t){if(r===null){v.removeAttr(e,n);return}return o&&"set"in o&&u&&(s=o.set(e,r,n))!==t?s:(e.setAttribute(n,r+""),r)}return o&&"get"in o&&u&&(s=o.get(e,n))!==null?s:(s=e.getAttribute(n),s===null?t:s)},removeAttr:function(e,t){var n,r,i,s,o=0;if(t&&e.nodeType===1){r=t.split(y);for(;o<r.length;o++)i=r[o],i&&(n=v.propFix[i]||i,s=X.test(i),s||v.attr(e,i,""),e.removeAttribute(V?i:n),s&&n in e&&(e[n]=!1))}},attrHooks:{type:{set:function(e,t){if(U.test(e.nodeName)&&e.parentNode)v.error("type property can't be changed");else if(!v.support.radioValue&&t==="radio"&&v.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}},value:{get:function(e,t){return j&&v.nodeName(e,"button")?j.get(e,t):t in e?e.value:null},set:function(e,t,n){if(j&&v.nodeName(e,"button"))return j.set(e,t,n);e.value=t}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(e,n,r){var i,s,o,u=e.nodeType;if(!e||u===3||u===8||u===2)return;return o=u!==1||!v.isXMLDoc(e),o&&(n=v.propFix[n]||n,s=v.propHooks[n]),r!==t?s&&"set"in s&&(i=s.set(e,r,n))!==t?i:e[n]=r:s&&"get"in s&&(i=s.get(e,n))!==null?i:e[n]},propHooks:{tabIndex:{get:function(e){var n=e.getAttributeNode("tabindex");return n&&n.specified?parseInt(n.value,10):z.test(e.nodeName)||W.test(e.nodeName)&&e.href?0:t}}}}),F={get:function(e,n){var r,i=v.prop(e,n);return i===!0||typeof i!="boolean"&&(r=e.getAttributeNode(n))&&r.nodeValue!==!1?n.toLowerCase():t},set:function(e,t,n){var r;return t===!1?v.removeAttr(e,n):(r=v.propFix[n]||n,r in e&&(e[r]=!0),e.setAttribute(n,n.toLowerCase())),n}},V||(I={name:!0,id:!0,coords:!0},j=v.valHooks.button={get:function(e,n){var r;return r=e.getAttributeNode(n),r&&(I[n]?r.value!=="":r.specified)?r.value:t},set:function(e,t,n){var r=e.getAttributeNode(n);return r||(r=i.createAttribute(n),e.setAttributeNode(r)),r.value=t+""}},v.each(["width","height"],function(e,t){v.attrHooks[t]=v.extend(v.attrHooks[t],{set:function(e,n){if(n==="")return e.setAttribute(t,"auto"),n}})}),v.attrHooks.contenteditable={get:j.get,set:function(e,t,n){t===""&&(t="false"),j.set(e,t,n)}}),v.support.hrefNormalized||v.each(["href","src","width","height"],function(e,n){v.attrHooks[n]=v.extend(v.attrHooks[n],{get:function(e){var r=e.getAttribute(n,2);return r===null?t:r}})}),v.support.style||(v.attrHooks.style={get:function(e){return e.style.cssText.toLowerCase()||t},set:function(e,t){return e.style.cssText=t+""}}),v.support.optSelected||(v.propHooks.selected=v.extend(v.propHooks.selected,{get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}})),v.support.enctype||(v.propFix.enctype="encoding"),v.support.checkOn||v.each(["radio","checkbox"],function(){v.valHooks[this]={get:function(e){return e.getAttribute("value")===null?"on":e.value}}}),v.each(["radio","checkbox"],function(){v.valHooks[this]=v.extend(v.valHooks[this],{set:function(e,t){if(v.isArray(t))return e.checked=v.inArray(v(e).val(),t)>=0}})});var $=/^(?:textarea|input|select)$/i,J=/^([^\.]*|)(?:\.(.+)|)$/,K=/(?:^|\s)hover(\.\S+|)\b/,Q=/^key/,G=/^(?:mouse|contextmenu)|click/,Y=/^(?:focusinfocus|focusoutblur)$/,Z=function(e){return v.event.special.hover?e:e.replace(K,"mouseenter$1 mouseleave$1")};v.event={add:function(e,n,r,i,s){var o,u,a,f,l,c,h,p,d,m,g;if(e.nodeType===3||e.nodeType===8||!n||!r||!(o=v._data(e)))return;r.handler&&(d=r,r=d.handler,s=d.selector),r.guid||(r.guid=v.guid++),a=o.events,a||(o.events=a={}),u=o.handle,u||(o.handle=u=function(e){return typeof v=="undefined"||!!e&&v.event.triggered===e.type?t:v.event.dispatch.apply(u.elem,arguments)},u.elem=e),n=v.trim(Z(n)).split(" ");for(f=0;f<n.length;f++){l=J.exec(n[f])||[],c=l[1],h=(l[2]||"").split(".").sort(),g=v.event.special[c]||{},c=(s?g.delegateType:g.bindType)||c,g=v.event.special[c]||{},p=v.extend({type:c,origType:l[1],data:i,handler:r,guid:r.guid,selector:s,needsContext:s&&v.expr.match.needsContext.test(s),namespace:h.join(".")},d),m=a[c];if(!m){m=a[c]=[],m.delegateCount=0;if(!g.setup||g.setup.call(e,i,h,u)===!1)e.addEventListener?e.addEventListener(c,u,!1):e.attachEvent&&e.attachEvent("on"+c,u)}g.add&&(g.add.call(e,p),p.handler.guid||(p.handler.guid=r.guid)),s?m.splice(m.delegateCount++,0,p):m.push(p),v.event.global[c]=!0}e=null},global:{},remove:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,m,g=v.hasData(e)&&v._data(e);if(!g||!(h=g.events))return;t=v.trim(Z(t||"")).split(" ");for(s=0;s<t.length;s++){o=J.exec(t[s])||[],u=a=o[1],f=o[2];if(!u){for(u in h)v.event.remove(e,u+t[s],n,r,!0);continue}p=v.event.special[u]||{},u=(r?p.delegateType:p.bindType)||u,d=h[u]||[],l=d.length,f=f?new RegExp("(^|\\.)"+f.split(".").sort().join("\\.(?:.*\\.|)")+"(\\.|$)"):null;for(c=0;c<d.length;c++)m=d[c],(i||a===m.origType)&&(!n||n.guid===m.guid)&&(!f||f.test(m.namespace))&&(!r||r===m.selector||r==="**"&&m.selector)&&(d.splice(c--,1),m.selector&&d.delegateCount--,p.remove&&p.remove.call(e,m));d.length===0&&l!==d.length&&((!p.teardown||p.teardown.call(e,f,g.handle)===!1)&&v.removeEvent(e,u,g.handle),delete h[u])}v.isEmptyObject(h)&&(delete g.handle,v.removeData(e,"events",!0))},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(n,r,s,o){if(!s||s.nodeType!==3&&s.nodeType!==8){var u,a,f,l,c,h,p,d,m,g,y=n.type||n,b=[];if(Y.test(y+v.event.triggered))return;y.indexOf("!")>=0&&(y=y.slice(0,-1),a=!0),y.indexOf(".")>=0&&(b=y.split("."),y=b.shift(),b.sort());if((!s||v.event.customEvent[y])&&!v.event.global[y])return;n=typeof n=="object"?n[v.expando]?n:new v.Event(y,n):new v.Event(y),n.type=y,n.isTrigger=!0,n.exclusive=a,n.namespace=b.join("."),n.namespace_re=n.namespace?new RegExp("(^|\\.)"+b.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,h=y.indexOf(":")<0?"on"+y:"";if(!s){u=v.cache;for(f in u)u[f].events&&u[f].events[y]&&v.event.trigger(n,r,u[f].handle.elem,!0);return}n.result=t,n.target||(n.target=s),r=r!=null?v.makeArray(r):[],r.unshift(n),p=v.event.special[y]||{};if(p.trigger&&p.trigger.apply(s,r)===!1)return;m=[[s,p.bindType||y]];if(!o&&!p.noBubble&&!v.isWindow(s)){g=p.delegateType||y,l=Y.test(g+y)?s:s.parentNode;for(c=s;l;l=l.parentNode)m.push([l,g]),c=l;c===(s.ownerDocument||i)&&m.push([c.defaultView||c.parentWindow||e,g])}for(f=0;f<m.length&&!n.isPropagationStopped();f++)l=m[f][0],n.type=m[f][1],d=(v._data(l,"events")||{})[n.type]&&v._data(l,"handle"),d&&d.apply(l,r),d=h&&l[h],d&&v.acceptData(l)&&d.apply&&d.apply(l,r)===!1&&n.preventDefault();return n.type=y,!o&&!n.isDefaultPrevented()&&(!p._default||p._default.apply(s.ownerDocument,r)===!1)&&(y!=="click"||!v.nodeName(s,"a"))&&v.acceptData(s)&&h&&s[y]&&(y!=="focus"&&y!=="blur"||n.target.offsetWidth!==0)&&!v.isWindow(s)&&(c=s[h],c&&(s[h]=null),v.event.triggered=y,s[y](),v.event.triggered=t,c&&(s[h]=c)),n.result}return},dispatch:function(n){n=v.event.fix(n||e.event);var r,i,s,o,u,a,f,c,h,p,d=(v._data(this,"events")||{})[n.type]||[],m=d.delegateCount,g=l.call(arguments),y=!n.exclusive&&!n.namespace,b=v.event.special[n.type]||{},w=[];g[0]=n,n.delegateTarget=this;if(b.preDispatch&&b.preDispatch.call(this,n)===!1)return;if(m&&(!n.button||n.type!=="click"))for(s=n.target;s!=this;s=s.parentNode||this)if(s.disabled!==!0||n.type!=="click"){u={},f=[];for(r=0;r<m;r++)c=d[r],h=c.selector,u[h]===t&&(u[h]=c.needsContext?v(h,this).index(s)>=0:v.find(h,this,null,[s]).length),u[h]&&f.push(c);f.length&&w.push({elem:s,matches:f})}d.length>m&&w.push({elem:this,matches:d.slice(m)});for(r=0;r<w.length&&!n.isPropagationStopped();r++){a=w[r],n.currentTarget=a.elem;for(i=0;i<a.matches.length&&!n.isImmediatePropagationStopped();i++){c=a.matches[i];if(y||!n.namespace&&!c.namespace||n.namespace_re&&n.namespace_re.test(c.namespace))n.data=c.data,n.handleObj=c,o=((v.event.special[c.origType]||{}).handle||c.handler).apply(a.elem,g),o!==t&&(n.result=o,o===!1&&(n.preventDefault(),n.stopPropagation()))}}return b.postDispatch&&b.postDispatch.call(this,n),n.result},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return e.which==null&&(e.which=t.charCode!=null?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,n){var r,s,o,u=n.button,a=n.fromElement;return e.pageX==null&&n.clientX!=null&&(r=e.target.ownerDocument||i,s=r.documentElement,o=r.body,e.pageX=n.clientX+(s&&s.scrollLeft||o&&o.scrollLeft||0)-(s&&s.clientLeft||o&&o.clientLeft||0),e.pageY=n.clientY+(s&&s.scrollTop||o&&o.scrollTop||0)-(s&&s.clientTop||o&&o.clientTop||0)),!e.relatedTarget&&a&&(e.relatedTarget=a===e.target?n.toElement:a),!e.which&&u!==t&&(e.which=u&1?1:u&2?3:u&4?2:0),e}},fix:function(e){if(e[v.expando])return e;var t,n,r=e,s=v.event.fixHooks[e.type]||{},o=s.props?this.props.concat(s.props):this.props;e=v.Event(r);for(t=o.length;t;)n=o[--t],e[n]=r[n];return e.target||(e.target=r.srcElement||i),e.target.nodeType===3&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,s.filter?s.filter(e,r):e},special:{load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(e,t,n){v.isWindow(this)&&(this.onbeforeunload=n)},teardown:function(e,t){this.onbeforeunload===t&&(this.onbeforeunload=null)}}},simulate:function(e,t,n,r){var i=v.extend(new v.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?v.event.trigger(i,null,t):v.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},v.event.handle=v.event.dispatch,v.removeEvent=i.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var r="on"+t;e.detachEvent&&(typeof e[r]=="undefined"&&(e[r]=null),e.detachEvent(r,n))},v.Event=function(e,t){if(!(this instanceof v.Event))return new v.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?tt:et):this.type=e,t&&v.extend(this,t),this.timeStamp=e&&e.timeStamp||v.now(),this[v.expando]=!0},v.Event.prototype={preventDefault:function(){this.isDefaultPrevented=tt;var e=this.originalEvent;if(!e)return;e.preventDefault?e.preventDefault():e.returnValue=!1},stopPropagation:function(){this.isPropagationStopped=tt;var e=this.originalEvent;if(!e)return;e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=tt,this.stopPropagation()},isDefaultPrevented:et,isPropagationStopped:et,isImmediatePropagationStopped:et},v.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){v.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,s=e.handleObj,o=s.selector;if(!i||i!==r&&!v.contains(r,i))e.type=s.origType,n=s.handler.apply(this,arguments),e.type=t;return n}}}),v.support.submitBubbles||(v.event.special.submit={setup:function(){if(v.nodeName(this,"form"))return!1;v.event.add(this,"click._submit keypress._submit",function(e){var n=e.target,r=v.nodeName(n,"input")||v.nodeName(n,"button")?n.form:t;r&&!v._data(r,"_submit_attached")&&(v.event.add(r,"submit._submit",function(e){e._submit_bubble=!0}),v._data(r,"_submit_attached",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&v.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){if(v.nodeName(this,"form"))return!1;v.event.remove(this,"._submit")}}),v.support.changeBubbles||(v.event.special.change={setup:function(){if($.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio")v.event.add(this,"propertychange._change",function(e){e.originalEvent.propertyName==="checked"&&(this._just_changed=!0)}),v.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),v.event.simulate("change",this,e,!0)});return!1}v.event.add(this,"beforeactivate._change",function(e){var t=e.target;$.test(t.nodeName)&&!v._data(t,"_change_attached")&&(v.event.add(t,"change._change",function(e){this.parentNode&&!e.isSimulated&&!e.isTrigger&&v.event.simulate("change",this.parentNode,e,!0)}),v._data(t,"_change_attached",!0))})},handle:function(e){var t=e.target;if(this!==t||e.isSimulated||e.isTrigger||t.type!=="radio"&&t.type!=="checkbox")return e.handleObj.handler.apply(this,arguments)},teardown:function(){return v.event.remove(this,"._change"),!$.test(this.nodeName)}}),v.support.focusinBubbles||v.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){v.event.simulate(t,e.target,v.event.fix(e),!0)};v.event.special[t]={setup:function(){n++===0&&i.addEventListener(e,r,!0)},teardown:function(){--n===0&&i.removeEventListener(e,r,!0)}}}),v.fn.extend({on:function(e,n,r,i,s){var o,u;if(typeof e=="object"){typeof n!="string"&&(r=r||n,n=t);for(u in e)this.on(u,n,r,e[u],s);return this}r==null&&i==null?(i=n,r=n=t):i==null&&(typeof n=="string"?(i=r,r=t):(i=r,r=n,n=t));if(i===!1)i=et;else if(!i)return this;return s===1&&(o=i,i=function(e){return v().off(e),o.apply(this,arguments)},i.guid=o.guid||(o.guid=v.guid++)),this.each(function(){v.event.add(this,e,i,r,n)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,n,r){var i,s;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,v(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if(typeof e=="object"){for(s in e)this.off(s,n,e[s]);return this}if(n===!1||typeof n=="function")r=n,n=t;return r===!1&&(r=et),this.each(function(){v.event.remove(this,e,r,n)})},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},live:function(e,t,n){return v(this.context).on(e,this.selector,t,n),this},die:function(e,t){return v(this.context).off(e,this.selector||"**",t),this},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return arguments.length===1?this.off(e,"**"):this.off(t,e||"**",n)},trigger:function(e,t){return this.each(function(){v.event.trigger(e,t,this)})},triggerHandler:function(e,t){if(this[0])return v.event.trigger(e,t,this[0],!0)},toggle:function(e){var t=arguments,n=e.guid||v.guid++,r=0,i=function(n){var i=(v._data(this,"lastToggle"+e.guid)||0)%r;return v._data(this,"lastToggle"+e.guid,i+1),n.preventDefault(),t[i].apply(this,arguments)||!1};i.guid=n;while(r<t.length)t[r++].guid=n;return this.click(i)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),v.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){v.fn[t]=function(e,n){return n==null&&(n=e,e=null),arguments.length>0?this.on(t,null,e,n):this.trigger(t)},Q.test(t)&&(v.event.fixHooks[t]=v.event.keyHooks),G.test(t)&&(v.event.fixHooks[t]=v.event.mouseHooks)}),function(e,t){function nt(e,t,n,r){n=n||[],t=t||g;var i,s,a,f,l=t.nodeType;if(!e||typeof e!="string")return n;if(l!==1&&l!==9)return[];a=o(t);if(!a&&!r)if(i=R.exec(e))if(f=i[1]){if(l===9){s=t.getElementById(f);if(!s||!s.parentNode)return n;if(s.id===f)return n.push(s),n}else if(t.ownerDocument&&(s=t.ownerDocument.getElementById(f))&&u(t,s)&&s.id===f)return n.push(s),n}else{if(i[2])return S.apply(n,x.call(t.getElementsByTagName(e),0)),n;if((f=i[3])&&Z&&t.getElementsByClassName)return S.apply(n,x.call(t.getElementsByClassName(f),0)),n}return vt(e.replace(j,"$1"),t,n,r,a)}function rt(e){return function(t){var n=t.nodeName.toLowerCase();return n==="input"&&t.type===e}}function it(e){return function(t){var n=t.nodeName.toLowerCase();return(n==="input"||n==="button")&&t.type===e}}function st(e){return N(function(t){return t=+t,N(function(n,r){var i,s=e([],n.length,t),o=s.length;while(o--)n[i=s[o]]&&(n[i]=!(r[i]=n[i]))})})}function ot(e,t,n){if(e===t)return n;var r=e.nextSibling;while(r){if(r===t)return-1;r=r.nextSibling}return 1}function ut(e,t){var n,r,s,o,u,a,f,l=L[d][e];if(l)return t?0:l.slice(0);u=e,a=[],f=i.preFilter;while(u){if(!n||(r=F.exec(u)))r&&(u=u.slice(r[0].length)),a.push(s=[]);n=!1;if(r=I.exec(u))s.push(n=new m(r.shift())),u=u.slice(n.length),n.type=r[0].replace(j," ");for(o in i.filter)(r=J[o].exec(u))&&(!f[o]||(r=f[o](r,g,!0)))&&(s.push(n=new m(r.shift())),u=u.slice(n.length),n.type=o,n.matches=r);if(!n)break}return t?u.length:u?nt.error(e):L(e,a).slice(0)}function at(e,t,r){var i=t.dir,s=r&&t.dir==="parentNode",o=w++;return t.first?function(t,n,r){while(t=t[i])if(s||t.nodeType===1)return e(t,n,r)}:function(t,r,u){if(!u){var a,f=b+" "+o+" ",l=f+n;while(t=t[i])if(s||t.nodeType===1){if((a=t[d])===l)return t.sizset;if(typeof a=="string"&&a.indexOf(f)===0){if(t.sizset)return t}else{t[d]=l;if(e(t,r,u))return t.sizset=!0,t;t.sizset=!1}}}else while(t=t[i])if(s||t.nodeType===1)if(e(t,r,u))return t}}function ft(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function lt(e,t,n,r,i){var s,o=[],u=0,a=e.length,f=t!=null;for(;u<a;u++)if(s=e[u])if(!n||n(s,r,i))o.push(s),f&&t.push(u);return o}function ct(e,t,n,r,i,s){return r&&!r[d]&&(r=ct(r)),i&&!i[d]&&(i=ct(i,s)),N(function(s,o,u,a){if(s&&i)return;var f,l,c,h=[],p=[],d=o.length,v=s||dt(t||"*",u.nodeType?[u]:u,[],s),m=e&&(s||!t)?lt(v,h,e,u,a):v,g=n?i||(s?e:d||r)?[]:o:m;n&&n(m,g,u,a);if(r){c=lt(g,p),r(c,[],u,a),f=c.length;while(f--)if(l=c[f])g[p[f]]=!(m[p[f]]=l)}if(s){f=e&&g.length;while(f--)if(l=g[f])s[h[f]]=!(o[h[f]]=l)}else g=lt(g===o?g.splice(d,g.length):g),i?i(null,o,g,a):S.apply(o,g)})}function ht(e){var t,n,r,s=e.length,o=i.relative[e[0].type],u=o||i.relative[" "],a=o?1:0,f=at(function(e){return e===t},u,!0),l=at(function(e){return T.call(t,e)>-1},u,!0),h=[function(e,n,r){return!o&&(r||n!==c)||((t=n).nodeType?f(e,n,r):l(e,n,r))}];for(;a<s;a++)if(n=i.relative[e[a].type])h=[at(ft(h),n)];else{n=i.filter[e[a].type].apply(null,e[a].matches);if(n[d]){r=++a;for(;r<s;r++)if(i.relative[e[r].type])break;return ct(a>1&&ft(h),a>1&&e.slice(0,a-1).join("").replace(j,"$1"),n,a<r&&ht(e.slice(a,r)),r<s&&ht(e=e.slice(r)),r<s&&e.join(""))}h.push(n)}return ft(h)}function pt(e,t){var r=t.length>0,s=e.length>0,o=function(u,a,f,l,h){var p,d,v,m=[],y=0,w="0",x=u&&[],T=h!=null,N=c,C=u||s&&i.find.TAG("*",h&&a.parentNode||a),k=b+=N==null?1:Math.E;T&&(c=a!==g&&a,n=o.el);for(;(p=C[w])!=null;w++){if(s&&p){for(d=0;v=e[d];d++)if(v(p,a,f)){l.push(p);break}T&&(b=k,n=++o.el)}r&&((p=!v&&p)&&y--,u&&x.push(p))}y+=w;if(r&&w!==y){for(d=0;v=t[d];d++)v(x,m,a,f);if(u){if(y>0)while(w--)!x[w]&&!m[w]&&(m[w]=E.call(l));m=lt(m)}S.apply(l,m),T&&!u&&m.length>0&&y+t.length>1&&nt.uniqueSort(l)}return T&&(b=k,c=N),x};return o.el=0,r?N(o):o}function dt(e,t,n,r){var i=0,s=t.length;for(;i<s;i++)nt(e,t[i],n,r);return n}function vt(e,t,n,r,s){var o,u,f,l,c,h=ut(e),p=h.length;if(!r&&h.length===1){u=h[0]=h[0].slice(0);if(u.length>2&&(f=u[0]).type==="ID"&&t.nodeType===9&&!s&&i.relative[u[1].type]){t=i.find.ID(f.matches[0].replace($,""),t,s)[0];if(!t)return n;e=e.slice(u.shift().length)}for(o=J.POS.test(e)?-1:u.length-1;o>=0;o--){f=u[o];if(i.relative[l=f.type])break;if(c=i.find[l])if(r=c(f.matches[0].replace($,""),z.test(u[0].type)&&t.parentNode||t,s)){u.splice(o,1),e=r.length&&u.join("");if(!e)return S.apply(n,x.call(r,0)),n;break}}}return a(e,h)(r,t,s,n,z.test(e)),n}function mt(){}var n,r,i,s,o,u,a,f,l,c,h=!0,p="undefined",d=("sizcache"+Math.random()).replace(".",""),m=String,g=e.document,y=g.documentElement,b=0,w=0,E=[].pop,S=[].push,x=[].slice,T=[].indexOf||function(e){var t=0,n=this.length;for(;t<n;t++)if(this[t]===e)return t;return-1},N=function(e,t){return e[d]=t==null||t,e},C=function(){var e={},t=[];return N(function(n,r){return t.push(n)>i.cacheLength&&delete e[t.shift()],e[n]=r},e)},k=C(),L=C(),A=C(),O="[\\x20\\t\\r\\n\\f]",M="(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+",_=M.replace("w","w#"),D="([*^$|!~]?=)",P="\\["+O+"*("+M+")"+O+"*(?:"+D+O+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+_+")|)|)"+O+"*\\]",H=":("+M+")(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|([^()[\\]]*|(?:(?:"+P+")|[^:]|\\\\.)*|.*))\\)|)",B=":(even|odd|eq|gt|lt|nth|first|last)(?:\\("+O+"*((?:-\\d)?\\d*)"+O+"*\\)|)(?=[^-]|$)",j=new RegExp("^"+O+"+|((?:^|[^\\\\])(?:\\\\.)*)"+O+"+$","g"),F=new RegExp("^"+O+"*,"+O+"*"),I=new RegExp("^"+O+"*([\\x20\\t\\r\\n\\f>+~])"+O+"*"),q=new RegExp(H),R=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,U=/^:not/,z=/[\x20\t\r\n\f]*[+~]/,W=/:not\($/,X=/h\d/i,V=/input|select|textarea|button/i,$=/\\(?!\\)/g,J={ID:new RegExp("^#("+M+")"),CLASS:new RegExp("^\\.("+M+")"),NAME:new RegExp("^\\[name=['\"]?("+M+")['\"]?\\]"),TAG:new RegExp("^("+M.replace("w","w*")+")"),ATTR:new RegExp("^"+P),PSEUDO:new RegExp("^"+H),POS:new RegExp(B,"i"),CHILD:new RegExp("^:(only|nth|first|last)-child(?:\\("+O+"*(even|odd|(([+-]|)(\\d*)n|)"+O+"*(?:([+-]|)"+O+"*(\\d+)|))"+O+"*\\)|)","i"),needsContext:new RegExp("^"+O+"*[>+~]|"+B,"i")},K=function(e){var t=g.createElement("div");try{return e(t)}catch(n){return!1}finally{t=null}},Q=K(function(e){return e.appendChild(g.createComment("")),!e.getElementsByTagName("*").length}),G=K(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild&&typeof e.firstChild.getAttribute!==p&&e.firstChild.getAttribute("href")==="#"}),Y=K(function(e){e.innerHTML="<select></select>";var t=typeof e.lastChild.getAttribute("multiple");return t!=="boolean"&&t!=="string"}),Z=K(function(e){return e.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",!e.getElementsByClassName||!e.getElementsByClassName("e").length?!1:(e.lastChild.className="e",e.getElementsByClassName("e").length===2)}),et=K(function(e){e.id=d+0,e.innerHTML="<a name='"+d+"'></a><div name='"+d+"'></div>",y.insertBefore(e,y.firstChild);var t=g.getElementsByName&&g.getElementsByName(d).length===2+g.getElementsByName(d+0).length;return r=!g.getElementById(d),y.removeChild(e),t});try{x.call(y.childNodes,0)[0].nodeType}catch(tt){x=function(e){var t,n=[];for(;t=this[e];e++)n.push(t);return n}}nt.matches=function(e,t){return nt(e,null,null,t)},nt.matchesSelector=function(e,t){return nt(t,null,null,[e]).length>0},s=nt.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(i===1||i===9||i===11){if(typeof e.textContent=="string")return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=s(e)}else if(i===3||i===4)return e.nodeValue}else for(;t=e[r];r++)n+=s(t);return n},o=nt.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?t.nodeName!=="HTML":!1},u=nt.contains=y.contains?function(e,t){var n=e.nodeType===9?e.documentElement:e,r=t&&t.parentNode;return e===r||!!(r&&r.nodeType===1&&n.contains&&n.contains(r))}:y.compareDocumentPosition?function(e,t){return t&&!!(e.compareDocumentPosition(t)&16)}:function(e,t){while(t=t.parentNode)if(t===e)return!0;return!1},nt.attr=function(e,t){var n,r=o(e);return r||(t=t.toLowerCase()),(n=i.attrHandle[t])?n(e):r||Y?e.getAttribute(t):(n=e.getAttributeNode(t),n?typeof e[t]=="boolean"?e[t]?t:null:n.specified?n.value:null:null)},i=nt.selectors={cacheLength:50,createPseudo:N,match:J,attrHandle:G?{}:{href:function(e){return e.getAttribute("href",2)},type:function(e){return e.getAttribute("type")}},find:{ID:r?function(e,t,n){if(typeof t.getElementById!==p&&!n){var r=t.getElementById(e);return r&&r.parentNode?[r]:[]}}:function(e,n,r){if(typeof n.getElementById!==p&&!r){var i=n.getElementById(e);return i?i.id===e||typeof i.getAttributeNode!==p&&i.getAttributeNode("id").value===e?[i]:t:[]}},TAG:Q?function(e,t){if(typeof t.getElementsByTagName!==p)return t.getElementsByTagName(e)}:function(e,t){var n=t.getElementsByTagName(e);if(e==="*"){var r,i=[],s=0;for(;r=n[s];s++)r.nodeType===1&&i.push(r);return i}return n},NAME:et&&function(e,t){if(typeof t.getElementsByName!==p)return t.getElementsByName(name)},CLASS:Z&&function(e,t,n){if(typeof t.getElementsByClassName!==p&&!n)return t.getElementsByClassName(e)}},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace($,""),e[3]=(e[4]||e[5]||"").replace($,""),e[2]==="~="&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),e[1]==="nth"?(e[2]||nt.error(e[0]),e[3]=+(e[3]?e[4]+(e[5]||1):2*(e[2]==="even"||e[2]==="odd")),e[4]=+(e[6]+e[7]||e[2]==="odd")):e[2]&&nt.error(e[0]),e},PSEUDO:function(e){var t,n;if(J.CHILD.test(e[0]))return null;if(e[3])e[2]=e[3];else if(t=e[4])q.test(t)&&(n=ut(t,!0))&&(n=t.indexOf(")",t.length-n)-t.length)&&(t=t.slice(0,n),e[0]=e[0].slice(0,n)),e[2]=t;return e.slice(0,3)}},filter:{ID:r?function(e){return e=e.replace($,""),function(t){return t.getAttribute("id")===e}}:function(e){return e=e.replace($,""),function(t){var n=typeof t.getAttributeNode!==p&&t.getAttributeNode("id");return n&&n.value===e}},TAG:function(e){return e==="*"?function(){return!0}:(e=e.replace($,"").toLowerCase(),function(t){return t.nodeName&&t.nodeName.toLowerCase()===e})},CLASS:function(e){var t=k[d][e];return t||(t=k(e,new RegExp("(^|"+O+")"+e+"("+O+"|$)"))),function(e){return t.test(e.className||typeof e.getAttribute!==p&&e.getAttribute("class")||"")}},ATTR:function(e,t,n){return function(r,i){var s=nt.attr(r,e);return s==null?t==="!=":t?(s+="",t==="="?s===n:t==="!="?s!==n:t==="^="?n&&s.indexOf(n)===0:t==="*="?n&&s.indexOf(n)>-1:t==="$="?n&&s.substr(s.length-n.length)===n:t==="~="?(" "+s+" ").indexOf(n)>-1:t==="|="?s===n||s.substr(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r){return e==="nth"?function(e){var t,i,s=e.parentNode;if(n===1&&r===0)return!0;if(s){i=0;for(t=s.firstChild;t;t=t.nextSibling)if(t.nodeType===1){i++;if(e===t)break}}return i-=r,i===n||i%n===0&&i/n>=0}:function(t){var n=t;switch(e){case"only":case"first":while(n=n.previousSibling)if(n.nodeType===1)return!1;if(e==="first")return!0;n=t;case"last":while(n=n.nextSibling)if(n.nodeType===1)return!1;return!0}}},PSEUDO:function(e,t){var n,r=i.pseudos[e]||i.setFilters[e.toLowerCase()]||nt.error("unsupported pseudo: "+e);return r[d]?r(t):r.length>1?(n=[e,e,"",t],i.setFilters.hasOwnProperty(e.toLowerCase())?N(function(e,n){var i,s=r(e,t),o=s.length;while(o--)i=T.call(e,s[o]),e[i]=!(n[i]=s[o])}):function(e){return r(e,0,n)}):r}},pseudos:{not:N(function(e){var t=[],n=[],r=a(e.replace(j,"$1"));return r[d]?N(function(e,t,n,i){var s,o=r(e,null,i,[]),u=e.length;while(u--)if(s=o[u])e[u]=!(t[u]=s)}):function(e,i,s){return t[0]=e,r(t,null,s,n),!n.pop()}}),has:N(function(e){return function(t){return nt(e,t).length>0}}),contains:N(function(e){return function(t){return(t.textContent||t.innerText||s(t)).indexOf(e)>-1}}),enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&!!e.checked||t==="option"&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},parent:function(e){return!i.pseudos.empty(e)},empty:function(e){var t;e=e.firstChild;while(e){if(e.nodeName>"@"||(t=e.nodeType)===3||t===4)return!1;e=e.nextSibling}return!0},header:function(e){return X.test(e.nodeName)},text:function(e){var t,n;return e.nodeName.toLowerCase()==="input"&&(t=e.type)==="text"&&((n=e.getAttribute("type"))==null||n.toLowerCase()===t)},radio:rt("radio"),checkbox:rt("checkbox"),file:rt("file"),password:rt("password"),image:rt("image"),submit:it("submit"),reset:it("reset"),button:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&e.type==="button"||t==="button"},input:function(e){return V.test(e.nodeName)},focus:function(e){var t=e.ownerDocument;return e===t.activeElement&&(!t.hasFocus||t.hasFocus())&&(!!e.type||!!e.href)},active:function(e){return e===e.ownerDocument.activeElement},first:st(function(e,t,n){return[0]}),last:st(function(e,t,n){return[t-1]}),eq:st(function(e,t,n){return[n<0?n+t:n]}),even:st(function(e,t,n){for(var r=0;r<t;r+=2)e.push(r);return e}),odd:st(function(e,t,n){for(var r=1;r<t;r+=2)e.push(r);return e}),lt:st(function(e,t,n){for(var r=n<0?n+t:n;--r>=0;)e.push(r);return e}),gt:st(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}},f=y.compareDocumentPosition?function(e,t){return e===t?(l=!0,0):(!e.compareDocumentPosition||!t.compareDocumentPosition?e.compareDocumentPosition:e.compareDocumentPosition(t)&4)?-1:1}:function(e,t){if(e===t)return l=!0,0;if(e.sourceIndex&&t.sourceIndex)return e.sourceIndex-t.sourceIndex;var n,r,i=[],s=[],o=e.parentNode,u=t.parentNode,a=o;if(o===u)return ot(e,t);if(!o)return-1;if(!u)return 1;while(a)i.unshift(a),a=a.parentNode;a=u;while(a)s.unshift(a),a=a.parentNode;n=i.length,r=s.length;for(var f=0;f<n&&f<r;f++)if(i[f]!==s[f])return ot(i[f],s[f]);return f===n?ot(e,s[f],-1):ot(i[f],t,1)},[0,0].sort(f),h=!l,nt.uniqueSort=function(e){var t,n=1;l=h,e.sort(f);if(l)for(;t=e[n];n++)t===e[n-1]&&e.splice(n--,1);return e},nt.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},a=nt.compile=function(e,t){var n,r=[],i=[],s=A[d][e];if(!s){t||(t=ut(e)),n=t.length;while(n--)s=ht(t[n]),s[d]?r.push(s):i.push(s);s=A(e,pt(i,r))}return s},g.querySelectorAll&&function(){var e,t=vt,n=/'|\\/g,r=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,i=[":focus"],s=[":active",":focus"],u=y.matchesSelector||y.mozMatchesSelector||y.webkitMatchesSelector||y.oMatchesSelector||y.msMatchesSelector;K(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||i.push("\\["+O+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),e.querySelectorAll(":checked").length||i.push(":checked")}),K(function(e){e.innerHTML="<p test=''></p>",e.querySelectorAll("[test^='']").length&&i.push("[*^$]="+O+"*(?:\"\"|'')"),e.innerHTML="<input type='hidden'/>",e.querySelectorAll(":enabled").length||i.push(":enabled",":disabled")}),i=new RegExp(i.join("|")),vt=function(e,r,s,o,u){if(!o&&!u&&(!i||!i.test(e))){var a,f,l=!0,c=d,h=r,p=r.nodeType===9&&e;if(r.nodeType===1&&r.nodeName.toLowerCase()!=="object"){a=ut(e),(l=r.getAttribute("id"))?c=l.replace(n,"\\$&"):r.setAttribute("id",c),c="[id='"+c+"'] ",f=a.length;while(f--)a[f]=c+a[f].join("");h=z.test(e)&&r.parentNode||r,p=a.join(",")}if(p)try{return S.apply(s,x.call(h.querySelectorAll(p),0)),s}catch(v){}finally{l||r.removeAttribute("id")}}return t(e,r,s,o,u)},u&&(K(function(t){e=u.call(t,"div");try{u.call(t,"[test!='']:sizzle"),s.push("!=",H)}catch(n){}}),s=new RegExp(s.join("|")),nt.matchesSelector=function(t,n){n=n.replace(r,"='$1']");if(!o(t)&&!s.test(n)&&(!i||!i.test(n)))try{var a=u.call(t,n);if(a||e||t.document&&t.document.nodeType!==11)return a}catch(f){}return nt(n,null,null,[t]).length>0})}(),i.pseudos.nth=i.pseudos.eq,i.filters=mt.prototype=i.pseudos,i.setFilters=new mt,nt.attr=v.attr,v.find=nt,v.expr=nt.selectors,v.expr[":"]=v.expr.pseudos,v.unique=nt.uniqueSort,v.text=nt.getText,v.isXMLDoc=nt.isXML,v.contains=nt.contains}(e);var nt=/Until$/,rt=/^(?:parents|prev(?:Until|All))/,it=/^.[^:#\[\.,]*$/,st=v.expr.match.needsContext,ot={children:!0,contents:!0,next:!0,prev:!0};v.fn.extend({find:function(e){var t,n,r,i,s,o,u=this;if(typeof e!="string")return v(e).filter(function(){for(t=0,n=u.length;t<n;t++)if(v.contains(u[t],this))return!0});o=this.pushStack("","find",e);for(t=0,n=this.length;t<n;t++){r=o.length,v.find(e,this[t],o);if(t>0)for(i=r;i<o.length;i++)for(s=0;s<r;s++)if(o[s]===o[i]){o.splice(i--,1);break}}return o},has:function(e){var t,n=v(e,this),r=n.length;return this.filter(function(){for(t=0;t<r;t++)if(v.contains(this,n[t]))return!0})},not:function(e){return this.pushStack(ft(this,e,!1),"not",e)},filter:function(e){return this.pushStack(ft(this,e,!0),"filter",e)},is:function(e){return!!e&&(typeof e=="string"?st.test(e)?v(e,this.context).index(this[0])>=0:v.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){var n,r=0,i=this.length,s=[],o=st.test(e)||typeof e!="string"?v(e,t||this.context):0;for(;r<i;r++){n=this[r];while(n&&n.ownerDocument&&n!==t&&n.nodeType!==11){if(o?o.index(n)>-1:v.find.matchesSelector(n,e)){s.push(n);break}n=n.parentNode}}return s=s.length>1?v.unique(s):s,this.pushStack(s,"closest",e)},index:function(e){return e?typeof e=="string"?v.inArray(this[0],v(e)):v.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(e,t){var n=typeof e=="string"?v(e,t):v.makeArray(e&&e.nodeType?[e]:e),r=v.merge(this.get(),n);return this.pushStack(ut(n[0])||ut(r[0])?r:v.unique(r))},addBack:function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}}),v.fn.andSelf=v.fn.addBack,v.each({parent:function(e){var t=e.parentNode;return t&&t.nodeType!==11?t:null},parents:function(e){return v.dir(e,"parentNode")},parentsUntil:function(e,t,n){return v.dir(e,"parentNode",n)},next:function(e){return at(e,"nextSibling")},prev:function(e){return at(e,"previousSibling")},nextAll:function(e){return v.dir(e,"nextSibling")},prevAll:function(e){return v.dir(e,"previousSibling")},nextUntil:function(e,t,n){return v.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return v.dir(e,"previousSibling",n)},siblings:function(e){return v.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return v.sibling(e.firstChild)},contents:function(e){return v.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:v.merge([],e.childNodes)}},function(e,t){v.fn[e]=function(n,r){var i=v.map(this,t,n);return nt.test(e)||(r=n),r&&typeof r=="string"&&(i=v.filter(r,i)),i=this.length>1&&!ot[e]?v.unique(i):i,this.length>1&&rt.test(e)&&(i=i.reverse()),this.pushStack(i,e,l.call(arguments).join(","))}}),v.extend({filter:function(e,t,n){return n&&(e=":not("+e+")"),t.length===1?v.find.matchesSelector(t[0],e)?[t[0]]:[]:v.find.matches(e,t)},dir:function(e,n,r){var i=[],s=e[n];while(s&&s.nodeType!==9&&(r===t||s.nodeType!==1||!v(s).is(r)))s.nodeType===1&&i.push(s),s=s[n];return i},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)e.nodeType===1&&e!==t&&n.push(e);return n}});var ct="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",ht=/ jQuery\d+="(?:null|\d+)"/g,pt=/^\s+/,dt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,vt=/<([\w:]+)/,mt=/<tbody/i,gt=/<|&#?\w+;/,yt=/<(?:script|style|link)/i,bt=/<(?:script|object|embed|option|style)/i,wt=new RegExp("<(?:"+ct+")[\\s/>]","i"),Et=/^(?:checkbox|radio)$/,St=/checked\s*(?:[^=]|=\s*.checked.)/i,xt=/\/(java|ecma)script/i,Tt=/^\s*<!(?:\[CDATA\[|\-\-)|[\]\-]{2}>\s*$/g,Nt={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},Ct=lt(i),kt=Ct.appendChild(i.createElement("div"));Nt.optgroup=Nt.option,Nt.tbody=Nt.tfoot=Nt.colgroup=Nt.caption=Nt.thead,Nt.th=Nt.td,v.support.htmlSerialize||(Nt._default=[1,"X<div>","</div>"]),v.fn.extend({text:function(e){return v.access(this,function(e){return e===t?v.text(this):this.empty().append((this[0]&&this[0].ownerDocument||i).createTextNode(e))},null,e,arguments.length)},wrapAll:function(e){if(v.isFunction(e))return this.each(function(t){v(this).wrapAll(e.call(this,t))});if(this[0]){var t=v(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstChild&&e.firstChild.nodeType===1)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return v.isFunction(e)?this.each(function(t){v(this).wrapInner(e.call(this,t))}):this.each(function(){var t=v(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=v.isFunction(e);return this.each(function(n){v(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){v.nodeName(this,"body")||v(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(e){(this.nodeType===1||this.nodeType===11)&&this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){(this.nodeType===1||this.nodeType===11)&&this.insertBefore(e,this.firstChild)})},before:function(){if(!ut(this[0]))return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this)});if(arguments.length){var e=v.clean(arguments);return this.pushStack(v.merge(e,this),"before",this.selector)}},after:function(){if(!ut(this[0]))return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this.nextSibling)});if(arguments.length){var e=v.clean(arguments);return this.pushStack(v.merge(this,e),"after",this.selector)}},remove:function(e,t){var n,r=0;for(;(n=this[r])!=null;r++)if(!e||v.filter(e,[n]).length)!t&&n.nodeType===1&&(v.cleanData(n.getElementsByTagName("*")),v.cleanData([n])),n.parentNode&&n.parentNode.removeChild(n);return this},empty:function(){var e,t=0;for(;(e=this[t])!=null;t++){e.nodeType===1&&v.cleanData(e.getElementsByTagName("*"));while(e.firstChild)e.removeChild(e.firstChild)}return this},clone:function(e,t){return e=e==null?!1:e,t=t==null?e:t,this.map(function(){return v.clone(this,e,t)})},html:function(e){return v.access(this,function(e){var n=this[0]||{},r=0,i=this.length;if(e===t)return n.nodeType===1?n.innerHTML.replace(ht,""):t;if(typeof e=="string"&&!yt.test(e)&&(v.support.htmlSerialize||!wt.test(e))&&(v.support.leadingWhitespace||!pt.test(e))&&!Nt[(vt.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(dt,"<$1></$2>");try{for(;r<i;r++)n=this[r]||{},n.nodeType===1&&(v.cleanData(n.getElementsByTagName("*")),n.innerHTML=e);n=0}catch(s){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(e){return ut(this[0])?this.length?this.pushStack(v(v.isFunction(e)?e():e),"replaceWith",e):this:v.isFunction(e)?this.each(function(t){var n=v(this),r=n.html();n.replaceWith(e.call(this,t,r))}):(typeof e!="string"&&(e=v(e).detach()),this.each(function(){var t=this.nextSibling,n=this.parentNode;v(this).remove(),t?v(t).before(e):v(n).append(e)}))},detach:function(e){return this.remove(e,!0)},domManip:function(e,n,r){e=[].concat.apply([],e);var i,s,o,u,a=0,f=e[0],l=[],c=this.length;if(!v.support.checkClone&&c>1&&typeof f=="string"&&St.test(f))return this.each(function(){v(this).domManip(e,n,r)});if(v.isFunction(f))return this.each(function(i){var s=v(this);e[0]=f.call(this,i,n?s.html():t),s.domManip(e,n,r)});if(this[0]){i=v.buildFragment(e,this,l),o=i.fragment,s=o.firstChild,o.childNodes.length===1&&(o=s);if(s){n=n&&v.nodeName(s,"tr");for(u=i.cacheable||c-1;a<c;a++)r.call(n&&v.nodeName(this[a],"table")?Lt(this[a],"tbody"):this[a],a===u?o:v.clone(o,!0,!0))}o=s=null,l.length&&v.each(l,function(e,t){t.src?v.ajax?v.ajax({url:t.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):v.error("no ajax"):v.globalEval((t.text||t.textContent||t.innerHTML||"").replace(Tt,"")),t.parentNode&&t.parentNode.removeChild(t)})}return this}}),v.buildFragment=function(e,n,r){var s,o,u,a=e[0];return n=n||i,n=!n.nodeType&&n[0]||n,n=n.ownerDocument||n,e.length===1&&typeof a=="string"&&a.length<512&&n===i&&a.charAt(0)==="<"&&!bt.test(a)&&(v.support.checkClone||!St.test(a))&&(v.support.html5Clone||!wt.test(a))&&(o=!0,s=v.fragments[a],u=s!==t),s||(s=n.createDocumentFragment(),v.clean(e,n,s,r),o&&(v.fragments[a]=u&&s)),{fragment:s,cacheable:o}},v.fragments={},v.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){v.fn[e]=function(n){var r,i=0,s=[],o=v(n),u=o.length,a=this.length===1&&this[0].parentNode;if((a==null||a&&a.nodeType===11&&a.childNodes.length===1)&&u===1)return o[t](this[0]),this;for(;i<u;i++)r=(i>0?this.clone(!0):this).get(),v(o[i])[t](r),s=s.concat(r);return this.pushStack(s,e,o.selector)}}),v.extend({clone:function(e,t,n){var r,i,s,o;v.support.html5Clone||v.isXMLDoc(e)||!wt.test("<"+e.nodeName+">")?o=e.cloneNode(!0):(kt.innerHTML=e.outerHTML,kt.removeChild(o=kt.firstChild));if((!v.support.noCloneEvent||!v.support.noCloneChecked)&&(e.nodeType===1||e.nodeType===11)&&!v.isXMLDoc(e)){Ot(e,o),r=Mt(e),i=Mt(o);for(s=0;r[s];++s)i[s]&&Ot(r[s],i[s])}if(t){At(e,o);if(n){r=Mt(e),i=Mt(o);for(s=0;r[s];++s)At(r[s],i[s])}}return r=i=null,o},clean:function(e,t,n,r){var s,o,u,a,f,l,c,h,p,d,m,g,y=t===i&&Ct,b=[];if(!t||typeof t.createDocumentFragment=="undefined")t=i;for(s=0;(u=e[s])!=null;s++){typeof u=="number"&&(u+="");if(!u)continue;if(typeof u=="string")if(!gt.test(u))u=t.createTextNode(u);else{y=y||lt(t),c=t.createElement("div"),y.appendChild(c),u=u.replace(dt,"<$1></$2>"),a=(vt.exec(u)||["",""])[1].toLowerCase(),f=Nt[a]||Nt._default,l=f[0],c.innerHTML=f[1]+u+f[2];while(l--)c=c.lastChild;if(!v.support.tbody){h=mt.test(u),p=a==="table"&&!h?c.firstChild&&c.firstChild.childNodes:f[1]==="<table>"&&!h?c.childNodes:[];for(o=p.length-1;o>=0;--o)v.nodeName(p[o],"tbody")&&!p[o].childNodes.length&&p[o].parentNode.removeChild(p[o])}!v.support.leadingWhitespace&&pt.test(u)&&c.insertBefore(t.createTextNode(pt.exec(u)[0]),c.firstChild),u=c.childNodes,c.parentNode.removeChild(c)}u.nodeType?b.push(u):v.merge(b,u)}c&&(u=c=y=null);if(!v.support.appendChecked)for(s=0;(u=b[s])!=null;s++)v.nodeName(u,"input")?_t(u):typeof u.getElementsByTagName!="undefined"&&v.grep(u.getElementsByTagName("input"),_t);if(n){m=function(e){if(!e.type||xt.test(e.type))return r?r.push(e.parentNode?e.parentNode.removeChild(e):e):n.appendChild(e)};for(s=0;(u=b[s])!=null;s++)if(!v.nodeName(u,"script")||!m(u))n.appendChild(u),typeof u.getElementsByTagName!="undefined"&&(g=v.grep(v.merge([],u.getElementsByTagName("script")),m),b.splice.apply(b,[s+1,0].concat(g)),s+=g.length)}return b},cleanData:function(e,t){var n,r,i,s,o=0,u=v.expando,a=v.cache,f=v.support.deleteExpando,l=v.event.special;for(;(i=e[o])!=null;o++)if(t||v.acceptData(i)){r=i[u],n=r&&a[r];if(n){if(n.events)for(s in n.events)l[s]?v.event.remove(i,s):v.removeEvent(i,s,n.handle);a[r]&&(delete a[r],f?delete i[u]:i.removeAttribute?i.removeAttribute(u):i[u]=null,v.deletedIds.push(r))}}}}),function(){var e,t;v.uaMatch=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},e=v.uaMatch(o.userAgent),t={},e.browser&&(t[e.browser]=!0,t.version=e.version),t.chrome?t.webkit=!0:t.webkit&&(t.safari=!0),v.browser=t,v.sub=function(){function e(t,n){return new e.fn.init(t,n)}v.extend(!0,e,this),e.superclass=this,e.fn=e.prototype=this(),e.fn.constructor=e,e.sub=this.sub,e.fn.init=function(r,i){return i&&i instanceof v&&!(i instanceof e)&&(i=e(i)),v.fn.init.call(this,r,i,t)},e.fn.init.prototype=e.fn;var t=e(i);return e}}();var Dt,Pt,Ht,Bt=/alpha\([^)]*\)/i,jt=/opacity=([^)]*)/,Ft=/^(top|right|bottom|left)$/,It=/^(none|table(?!-c[ea]).+)/,qt=/^margin/,Rt=new RegExp("^("+m+")(.*)$","i"),Ut=new RegExp("^("+m+")(?!px)[a-z%]+$","i"),zt=new RegExp("^([-+])=("+m+")","i"),Wt={},Xt={position:"absolute",visibility:"hidden",display:"block"},Vt={letterSpacing:0,fontWeight:400},$t=["Top","Right","Bottom","Left"],Jt=["Webkit","O","Moz","ms"],Kt=v.fn.toggle;v.fn.extend({css:function(e,n){return v.access(this,function(e,n,r){return r!==t?v.style(e,n,r):v.css(e,n)},e,n,arguments.length>1)},show:function(){return Yt(this,!0)},hide:function(){return Yt(this)},toggle:function(e,t){var n=typeof e=="boolean";return v.isFunction(e)&&v.isFunction(t)?Kt.apply(this,arguments):this.each(function(){(n?e:Gt(this))?v(this).show():v(this).hide()})}}),v.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Dt(e,"opacity");return n===""?"1":n}}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":v.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,n,r,i){if(!e||e.nodeType===3||e.nodeType===8||!e.style)return;var s,o,u,a=v.camelCase(n),f=e.style;n=v.cssProps[a]||(v.cssProps[a]=Qt(f,a)),u=v.cssHooks[n]||v.cssHooks[a];if(r===t)return u&&"get"in u&&(s=u.get(e,!1,i))!==t?s:f[n];o=typeof r,o==="string"&&(s=zt.exec(r))&&(r=(s[1]+1)*s[2]+parseFloat(v.css(e,n)),o="number");if(r==null||o==="number"&&isNaN(r))return;o==="number"&&!v.cssNumber[a]&&(r+="px");if(!u||!("set"in u)||(r=u.set(e,r,i))!==t)try{f[n]=r}catch(l){}},css:function(e,n,r,i){var s,o,u,a=v.camelCase(n);return n=v.cssProps[a]||(v.cssProps[a]=Qt(e.style,a)),u=v.cssHooks[n]||v.cssHooks[a],u&&"get"in u&&(s=u.get(e,!0,i)),s===t&&(s=Dt(e,n)),s==="normal"&&n in Vt&&(s=Vt[n]),r||i!==t?(o=parseFloat(s),r||v.isNumeric(o)?o||0:s):s},swap:function(e,t,n){var r,i,s={};for(i in t)s[i]=e.style[i],e.style[i]=t[i];r=n.call(e);for(i in t)e.style[i]=s[i];return r}}),e.getComputedStyle?Dt=function(t,n){var r,i,s,o,u=e.getComputedStyle(t,null),a=t.style;return u&&(r=u[n],r===""&&!v.contains(t.ownerDocument,t)&&(r=v.style(t,n)),Ut.test(r)&&qt.test(n)&&(i=a.width,s=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=r,r=u.width,a.width=i,a.minWidth=s,a.maxWidth=o)),r}:i.documentElement.currentStyle&&(Dt=function(e,t){var n,r,i=e.currentStyle&&e.currentStyle[t],s=e.style;return i==null&&s&&s[t]&&(i=s[t]),Ut.test(i)&&!Ft.test(t)&&(n=s.left,r=e.runtimeStyle&&e.runtimeStyle.left,r&&(e.runtimeStyle.left=e.currentStyle.left),s.left=t==="fontSize"?"1em":i,i=s.pixelLeft+"px",s.left=n,r&&(e.runtimeStyle.left=r)),i===""?"auto":i}),v.each(["height","width"],function(e,t){v.cssHooks[t]={get:function(e,n,r){if(n)return e.offsetWidth===0&&It.test(Dt(e,"display"))?v.swap(e,Xt,function(){return tn(e,t,r)}):tn(e,t,r)},set:function(e,n,r){return Zt(e,n,r?en(e,t,r,v.support.boxSizing&&v.css(e,"boxSizing")==="border-box"):0)}}}),v.support.opacity||(v.cssHooks.opacity={get:function(e,t){return jt.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,r=e.currentStyle,i=v.isNumeric(t)?"alpha(opacity="+t*100+")":"",s=r&&r.filter||n.filter||"";n.zoom=1;if(t>=1&&v.trim(s.replace(Bt,""))===""&&n.removeAttribute){n.removeAttribute("filter");if(r&&!r.filter)return}n.filter=Bt.test(s)?s.replace(Bt,i):s+" "+i}}),v(function(){v.support.reliableMarginRight||(v.cssHooks.marginRight={get:function(e,t){return v.swap(e,{display:"inline-block"},function(){if(t)return Dt(e,"marginRight")})}}),!v.support.pixelPosition&&v.fn.position&&v.each(["top","left"],function(e,t){v.cssHooks[t]={get:function(e,n){if(n){var r=Dt(e,t);return Ut.test(r)?v(e).position()[t]+"px":r}}}})}),v.expr&&v.expr.filters&&(v.expr.filters.hidden=function(e){return e.offsetWidth===0&&e.offsetHeight===0||!v.support.reliableHiddenOffsets&&(e.style&&e.style.display||Dt(e,"display"))==="none"},v.expr.filters.visible=function(e){return!v.expr.filters.hidden(e)}),v.each({margin:"",padding:"",border:"Width"},function(e,t){v.cssHooks[e+t]={expand:function(n){var r,i=typeof n=="string"?n.split(" "):[n],s={};for(r=0;r<4;r++)s[e+$t[r]+t]=i[r]||i[r-2]||i[0];return s}},qt.test(e)||(v.cssHooks[e+t].set=Zt)});var rn=/%20/g,sn=/\[\]$/,on=/\r?\n/g,un=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,an=/^(?:select|textarea)/i;v.fn.extend({serialize:function(){return v.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?v.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||an.test(this.nodeName)||un.test(this.type))}).map(function(e,t){var n=v(this).val();return n==null?null:v.isArray(n)?v.map(n,function(e,n){return{name:t.name,value:e.replace(on,"\r\n")}}):{name:t.name,value:n.replace(on,"\r\n")}}).get()}}),v.param=function(e,n){var r,i=[],s=function(e,t){t=v.isFunction(t)?t():t==null?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};n===t&&(n=v.ajaxSettings&&v.ajaxSettings.traditional);if(v.isArray(e)||e.jquery&&!v.isPlainObject(e))v.each(e,function(){s(this.name,this.value)});else for(r in e)fn(r,e[r],n,s);return i.join("&").replace(rn,"+")};var ln,cn,hn=/#.*$/,pn=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,dn=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,vn=/^(?:GET|HEAD)$/,mn=/^\/\//,gn=/\?/,yn=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,bn=/([?&])_=[^&]*/,wn=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,En=v.fn.load,Sn={},xn={},Tn=["*/"]+["*"];try{cn=s.href}catch(Nn){cn=i.createElement("a"),cn.href="",cn=cn.href}ln=wn.exec(cn.toLowerCase())||[],v.fn.load=function(e,n,r){if(typeof e!="string"&&En)return En.apply(this,arguments);if(!this.length)return this;var i,s,o,u=this,a=e.indexOf(" ");return a>=0&&(i=e.slice(a,e.length),e=e.slice(0,a)),v.isFunction(n)?(r=n,n=t):n&&typeof n=="object"&&(s="POST"),v.ajax({url:e,type:s,dataType:"html",data:n,complete:function(e,t){r&&u.each(r,o||[e.responseText,t,e])}}).done(function(e){o=arguments,u.html(i?v("<div>").append(e.replace(yn,"")).find(i):e)}),this},v.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(e,t){v.fn[t]=function(e){return this.on(t,e)}}),v.each(["get","post"],function(e,n){v[n]=function(e,r,i,s){return v.isFunction(r)&&(s=s||i,i=r,r=t),v.ajax({type:n,url:e,data:r,success:i,dataType:s})}}),v.extend({getScript:function(e,n){return v.get(e,t,n,"script")},getJSON:function(e,t,n){return v.get(e,t,n,"json")},ajaxSetup:function(e,t){return t?Ln(e,v.ajaxSettings):(t=e,e=v.ajaxSettings),Ln(e,t),e},ajaxSettings:{url:cn,isLocal:dn.test(ln[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":Tn},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":e.String,"text html":!0,"text json":v.parseJSON,"text xml":v.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:Cn(Sn),ajaxTransport:Cn(xn),ajax:function(e,n){function T(e,n,s,a){var l,y,b,w,S,T=n;if(E===2)return;E=2,u&&clearTimeout(u),o=t,i=a||"",x.readyState=e>0?4:0,s&&(w=An(c,x,s));if(e>=200&&e<300||e===304)c.ifModified&&(S=x.getResponseHeader("Last-Modified"),S&&(v.lastModified[r]=S),S=x.getResponseHeader("Etag"),S&&(v.etag[r]=S)),e===304?(T="notmodified",l=!0):(l=On(c,w),T=l.state,y=l.data,b=l.error,l=!b);else{b=T;if(!T||e)T="error",e<0&&(e=0)}x.status=e,x.statusText=(n||T)+"",l?d.resolveWith(h,[y,T,x]):d.rejectWith(h,[x,T,b]),x.statusCode(g),g=t,f&&p.trigger("ajax"+(l?"Success":"Error"),[x,c,l?y:b]),m.fireWith(h,[x,T]),f&&(p.trigger("ajaxComplete",[x,c]),--v.active||v.event.trigger("ajaxStop"))}typeof e=="object"&&(n=e,e=t),n=n||{};var r,i,s,o,u,a,f,l,c=v.ajaxSetup({},n),h=c.context||c,p=h!==c&&(h.nodeType||h instanceof v)?v(h):v.event,d=v.Deferred(),m=v.Callbacks("once memory"),g=c.statusCode||{},b={},w={},E=0,S="canceled",x={readyState:0,setRequestHeader:function(e,t){if(!E){var n=e.toLowerCase();e=w[n]=w[n]||e,b[e]=t}return this},getAllResponseHeaders:function(){return E===2?i:null},getResponseHeader:function(e){var n;if(E===2){if(!s){s={};while(n=pn.exec(i))s[n[1].toLowerCase()]=n[2]}n=s[e.toLowerCase()]}return n===t?null:n},overrideMimeType:function(e){return E||(c.mimeType=e),this},abort:function(e){return e=e||S,o&&o.abort(e),T(0,e),this}};d.promise(x),x.success=x.done,x.error=x.fail,x.complete=m.add,x.statusCode=function(e){if(e){var t;if(E<2)for(t in e)g[t]=[g[t],e[t]];else t=e[x.status],x.always(t)}return this},c.url=((e||c.url)+"").replace(hn,"").replace(mn,ln[1]+"//"),c.dataTypes=v.trim(c.dataType||"*").toLowerCase().split(y),c.crossDomain==null&&(a=wn.exec(c.url.toLowerCase())||!1,c.crossDomain=a&&a.join(":")+(a[3]?"":a[1]==="http:"?80:443)!==ln.join(":")+(ln[3]?"":ln[1]==="http:"?80:443)),c.data&&c.processData&&typeof c.data!="string"&&(c.data=v.param(c.data,c.traditional)),kn(Sn,c,n,x);if(E===2)return x;f=c.global,c.type=c.type.toUpperCase(),c.hasContent=!vn.test(c.type),f&&v.active++===0&&v.event.trigger("ajaxStart");if(!c.hasContent){c.data&&(c.url+=(gn.test(c.url)?"&":"?")+c.data,delete c.data),r=c.url;if(c.cache===!1){var N=v.now(),C=c.url.replace(bn,"$1_="+N);c.url=C+(C===c.url?(gn.test(c.url)?"&":"?")+"_="+N:"")}}(c.data&&c.hasContent&&c.contentType!==!1||n.contentType)&&x.setRequestHeader("Content-Type",c.contentType),c.ifModified&&(r=r||c.url,v.lastModified[r]&&x.setRequestHeader("If-Modified-Since",v.lastModified[r]),v.etag[r]&&x.setRequestHeader("If-None-Match",v.etag[r])),x.setRequestHeader("Accept",c.dataTypes[0]&&c.accepts[c.dataTypes[0]]?c.accepts[c.dataTypes[0]]+(c.dataTypes[0]!=="*"?", "+Tn+"; q=0.01":""):c.accepts["*"]);for(l in c.headers)x.setRequestHeader(l,c.headers[l]);if(!c.beforeSend||c.beforeSend.call(h,x,c)!==!1&&E!==2){S="abort";for(l in{success:1,error:1,complete:1})x[l](c[l]);o=kn(xn,c,n,x);if(!o)T(-1,"No Transport");else{x.readyState=1,f&&p.trigger("ajaxSend",[x,c]),c.async&&c.timeout>0&&(u=setTimeout(function(){x.abort("timeout")},c.timeout));try{E=1,o.send(b,T)}catch(k){if(!(E<2))throw k;T(-1,k)}}return x}return x.abort()},active:0,lastModified:{},etag:{}});var Mn=[],_n=/\?/,Dn=/(=)\?(?=&|$)|\?\?/,Pn=v.now();v.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Mn.pop()||v.expando+"_"+Pn++;return this[e]=!0,e}}),v.ajaxPrefilter("json jsonp",function(n,r,i){var s,o,u,a=n.data,f=n.url,l=n.jsonp!==!1,c=l&&Dn.test(f),h=l&&!c&&typeof a=="string"&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&Dn.test(a);if(n.dataTypes[0]==="jsonp"||c||h)return s=n.jsonpCallback=v.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,o=e[s],c?n.url=f.replace(Dn,"$1"+s):h?n.data=a.replace(Dn,"$1"+s):l&&(n.url+=(_n.test(f)?"&":"?")+n.jsonp+"="+s),n.converters["script json"]=function(){return u||v.error(s+" was not called"),u[0]},n.dataTypes[0]="json",e[s]=function(){u=arguments},i.always(function(){e[s]=o,n[s]&&(n.jsonpCallback=r.jsonpCallback,Mn.push(s)),u&&v.isFunction(o)&&o(u[0]),u=o=t}),"script"}),v.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(e){return v.globalEval(e),e}}}),v.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),v.ajaxTransport("script",function(e){if(e.crossDomain){var n,r=i.head||i.getElementsByTagName("head")[0]||i.documentElement;return{send:function(s,o){n=i.createElement("script"),n.async="async",e.scriptCharset&&(n.charset=e.scriptCharset),n.src=e.url,n.onload=n.onreadystatechange=function(e,i){if(i||!n.readyState||/loaded|complete/.test(n.readyState))n.onload=n.onreadystatechange=null,r&&n.parentNode&&r.removeChild(n),n=t,i||o(200,"success")},r.insertBefore(n,r.firstChild)},abort:function(){n&&n.onload(0,1)}}}});var Hn,Bn=e.ActiveXObject?function(){for(var e in Hn)Hn[e](0,1)}:!1,jn=0;v.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&Fn()||In()}:Fn,function(e){v.extend(v.support,{ajax:!!e,cors:!!e&&"withCredentials"in e})}(v.ajaxSettings.xhr()),v.support.ajax&&v.ajaxTransport(function(n){if(!n.crossDomain||v.support.cors){var r;return{send:function(i,s){var o,u,a=n.xhr();n.username?a.open(n.type,n.url,n.async,n.username,n.password):a.open(n.type,n.url,n.async);if(n.xhrFields)for(u in n.xhrFields)a[u]=n.xhrFields[u];n.mimeType&&a.overrideMimeType&&a.overrideMimeType(n.mimeType),!n.crossDomain&&!i["X-Requested-With"]&&(i["X-Requested-With"]="XMLHttpRequest");try{for(u in i)a.setRequestHeader(u,i[u])}catch(f){}a.send(n.hasContent&&n.data||null),r=function(e,i){var u,f,l,c,h;try{if(r&&(i||a.readyState===4)){r=t,o&&(a.onreadystatechange=v.noop,Bn&&delete Hn[o]);if(i)a.readyState!==4&&a.abort();else{u=a.status,l=a.getAllResponseHeaders(),c={},h=a.responseXML,h&&h.documentElement&&(c.xml=h);try{c.text=a.responseText}catch(e){}try{f=a.statusText}catch(p){f=""}!u&&n.isLocal&&!n.crossDomain?u=c.text?200:404:u===1223&&(u=204)}}}catch(d){i||s(-1,d)}c&&s(u,f,c,l)},n.async?a.readyState===4?setTimeout(r,0):(o=++jn,Bn&&(Hn||(Hn={},v(e).unload(Bn)),Hn[o]=r),a.onreadystatechange=r):r()},abort:function(){r&&r(0,1)}}}});var qn,Rn,Un=/^(?:toggle|show|hide)$/,zn=new RegExp("^(?:([-+])=|)("+m+")([a-z%]*)$","i"),Wn=/queueHooks$/,Xn=[Gn],Vn={"*":[function(e,t){var n,r,i=this.createTween(e,t),s=zn.exec(t),o=i.cur(),u=+o||0,a=1,f=20;if(s){n=+s[2],r=s[3]||(v.cssNumber[e]?"":"px");if(r!=="px"&&u){u=v.css(i.elem,e,!0)||n||1;do a=a||".5",u/=a,v.style(i.elem,e,u+r);while(a!==(a=i.cur()/o)&&a!==1&&--f)}i.unit=r,i.start=u,i.end=s[1]?u+(s[1]+1)*n:n}return i}]};v.Animation=v.extend(Kn,{tweener:function(e,t){v.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;r<i;r++)n=e[r],Vn[n]=Vn[n]||[],Vn[n].unshift(t)},prefilter:function(e,t){t?Xn.unshift(e):Xn.push(e)}}),v.Tween=Yn,Yn.prototype={constructor:Yn,init:function(e,t,n,r,i,s){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=s||(v.cssNumber[n]?"":"px")},cur:function(){var e=Yn.propHooks[this.prop];return e&&e.get?e.get(this):Yn.propHooks._default.get(this)},run:function(e){var t,n=Yn.propHooks[this.prop];return this.options.duration?this.pos=t=v.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Yn.propHooks._default.set(this),this}},Yn.prototype.init.prototype=Yn.prototype,Yn.propHooks={_default:{get:function(e){var t;return e.elem[e.prop]==null||!!e.elem.style&&e.elem.style[e.prop]!=null?(t=v.css(e.elem,e.prop,!1,""),!t||t==="auto"?0:t):e.elem[e.prop]},set:function(e){v.fx.step[e.prop]?v.fx.step[e.prop](e):e.elem.style&&(e.elem.style[v.cssProps[e.prop]]!=null||v.cssHooks[e.prop])?v.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},Yn.propHooks.scrollTop=Yn.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},v.each(["toggle","show","hide"],function(e,t){var n=v.fn[t];v.fn[t]=function(r,i,s){return r==null||typeof r=="boolean"||!e&&v.isFunction(r)&&v.isFunction(i)?n.apply(this,arguments):this.animate(Zn(t,!0),r,i,s)}}),v.fn.extend({fadeTo:function(e,t,n,r){return this.filter(Gt).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=v.isEmptyObject(e),s=v.speed(t,n,r),o=function(){var t=Kn(this,v.extend({},e),s);i&&t.stop(!0)};return i||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(e,n,r){var i=function(e){var t=e.stop;delete e.stop,t(r)};return typeof e!="string"&&(r=n,n=e,e=t),n&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=e!=null&&e+"queueHooks",s=v.timers,o=v._data(this);if(n)o[n]&&o[n].stop&&i(o[n]);else for(n in o)o[n]&&o[n].stop&&Wn.test(n)&&i(o[n]);for(n=s.length;n--;)s[n].elem===this&&(e==null||s[n].queue===e)&&(s[n].anim.stop(r),t=!1,s.splice(n,1));(t||!r)&&v.dequeue(this,e)})}}),v.each({slideDown:Zn("show"),slideUp:Zn("hide"),slideToggle:Zn("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){v.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),v.speed=function(e,t,n){var r=e&&typeof e=="object"?v.extend({},e):{complete:n||!n&&t||v.isFunction(e)&&e,duration:e,easing:n&&t||t&&!v.isFunction(t)&&t};r.duration=v.fx.off?0:typeof r.duration=="number"?r.duration:r.duration in v.fx.speeds?v.fx.speeds[r.duration]:v.fx.speeds._default;if(r.queue==null||r.queue===!0)r.queue="fx";return r.old=r.complete,r.complete=function(){v.isFunction(r.old)&&r.old.call(this),r.queue&&v.dequeue(this,r.queue)},r},v.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},v.timers=[],v.fx=Yn.prototype.init,v.fx.tick=function(){var e,t=v.timers,n=0;for(;n<t.length;n++)e=t[n],!e()&&t[n]===e&&t.splice(n--,1);t.length||v.fx.stop()},v.fx.timer=function(e){e()&&v.timers.push(e)&&!Rn&&(Rn=setInterval(v.fx.tick,v.fx.interval))},v.fx.interval=13,v.fx.stop=function(){clearInterval(Rn),Rn=null},v.fx.speeds={slow:600,fast:200,_default:400},v.fx.step={},v.expr&&v.expr.filters&&(v.expr.filters.animated=function(e){return v.grep(v.timers,function(t){return e===t.elem}).length});var er=/^(?:body|html)$/i;v.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){v.offset.setOffset(this,e,t)});var n,r,i,s,o,u,a,f={top:0,left:0},l=this[0],c=l&&l.ownerDocument;if(!c)return;return(r=c.body)===l?v.offset.bodyOffset(l):(n=c.documentElement,v.contains(n,l)?(typeof l.getBoundingClientRect!="undefined"&&(f=l.getBoundingClientRect()),i=tr(c),s=n.clientTop||r.clientTop||0,o=n.clientLeft||r.clientLeft||0,u=i.pageYOffset||n.scrollTop,a=i.pageXOffset||n.scrollLeft,{top:f.top+u-s,left:f.left+a-o}):f)},v.offset={bodyOffset:function(e){var t=e.offsetTop,n=e.offsetLeft;return v.support.doesNotIncludeMarginInBodyOffset&&(t+=parseFloat(v.css(e,"marginTop"))||0,n+=parseFloat(v.css(e,"marginLeft"))||0),{top:t,left:n}},setOffset:function(e,t,n){var r=v.css(e,"position");r==="static"&&(e.style.position="relative");var i=v(e),s=i.offset(),o=v.css(e,"top"),u=v.css(e,"left"),a=(r==="absolute"||r==="fixed")&&v.inArray("auto",[o,u])>-1,f={},l={},c,h;a?(l=i.position(),c=l.top,h=l.left):(c=parseFloat(o)||0,h=parseFloat(u)||0),v.isFunction(t)&&(t=t.call(e,n,s)),t.top!=null&&(f.top=t.top-s.top+c),t.left!=null&&(f.left=t.left-s.left+h),"using"in t?t.using.call(e,f):i.css(f)}},v.fn.extend({position:function(){if(!this[0])return;var e=this[0],t=this.offsetParent(),n=this.offset(),r=er.test(t[0].nodeName)?{top:0,left:0}:t.offset();return n.top-=parseFloat(v.css(e,"marginTop"))||0,n.left-=parseFloat(v.css(e,"marginLeft"))||0,r.top+=parseFloat(v.css(t[0],"borderTopWidth"))||0,r.left+=parseFloat(v.css(t[0],"borderLeftWidth"))||0,{top:n.top-r.top,left:n.left-r.left}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||i.body;while(e&&!er.test(e.nodeName)&&v.css(e,"position")==="static")e=e.offsetParent;return e||i.body})}}),v.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var r=/Y/.test(n);v.fn[e]=function(i){return v.access(this,function(e,i,s){var o=tr(e);if(s===t)return o?n in o?o[n]:o.document.documentElement[i]:e[i];o?o.scrollTo(r?v(o).scrollLeft():s,r?s:v(o).scrollTop()):e[i]=s},e,i,arguments.length,null)}}),v.each({Height:"height",Width:"width"},function(e,n){v.each({padding:"inner"+e,content:n,"":"outer"+e},function(r,i){v.fn[i]=function(i,s){var o=arguments.length&&(r||typeof i!="boolean"),u=r||(i===!0||s===!0?"margin":"border");return v.access(this,function(n,r,i){var s;return v.isWindow(n)?n.document.documentElement["client"+e]:n.nodeType===9?(s=n.documentElement,Math.max(n.body["scroll"+e],s["scroll"+e],n.body["offset"+e],s["offset"+e],s["client"+e])):i===t?v.css(n,r,i,u):v.style(n,r,i,u)},n,o?i:t,o,null)}})}),e.jQuery=e.$=v,typeof define=="function"&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return v})}(window),function(){var e=this,t=e.Backbone,n=Array.prototype.slice,r=Array.prototype.splice,i;typeof exports!="undefined"?i=exports:i=e.Backbone={},i.VERSION="0.9.2";var s=e._;!s&&typeof require!="undefined"&&(s=require("underscore"));var o=e.jQuery||e.Zepto||e.ender;i.setDomLibrary=function(e){o=e},i.noConflict=function(){return e.Backbone=t,this},i.emulateHTTP=!1,i.emulateJSON=!1;var u=/\s+/,a=i.Events={on:function(e,t,n){var r,i,s,o,a;if(!t)return this;e=e.split(u),r=this._callbacks||(this._callbacks={});while(i=e.shift())a=r[i],s=a?a.tail:{},s.next=o={},s.context=n,s.callback=t,r[i]={tail:o,next:a?a.next:s};return this},off:function(e,t,n){var r,i,o,a,f,l;if(!(i=this._callbacks))return;if(!(e||t||n))return delete this._callbacks,this;e=e?e.split(u):s.keys(i);while(r=e.shift()){o=i[r],delete i[r];if(!o||!t&&!n)continue;a=o.tail;while((o=o.next)!==a)f=o.callback,l=o.context,(t&&f!==t||n&&l!==n)&&this.on(r,f,l)}return this},trigger:function(e){var t,r,i,s,o,a,f;if(!(i=this._callbacks))return this;a=i.all,e=e.split(u),f=n.call(arguments,1);while(t=e.shift()){if(r=i[t]){s=r.tail;while((r=r.next)!==s)r.callback.apply(r.context||this,f)}if(r=a){s=r.tail,o=[t].concat(f);while((r=r.next)!==s)r.callback.apply(r.context||this,o)}}return this}};a.bind=a.on,a.unbind=a.off;var f=i.Model=function(e,t){var n;e||(e={}),t&&t.parse&&(e=this.parse(e));if(n=C(this,"defaults"))e=s.extend({},n,e);t&&t.collection&&(this.collection=t.collection),this.attributes={},this._escapedAttributes={},this.cid=s.uniqueId("c"),this.changed={},this._silent={},this._pending={},this.set(e,{silent:!0}),this.changed={},this._silent={},this._pending={},this._previousAttributes=s.clone(this.attributes),this.initialize.apply(this,arguments)};s.extend(f.prototype,a,{changed:null,_silent:null,_pending:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return s.clone(this.attributes)},get:function(e){return this.attributes[e]},escape:function(e){var t;if(t=this._escapedAttributes[e])return t;var n=this.get(e);return this._escapedAttributes[e]=s.escape(n==null?"":""+n)},has:function(e){return this.get(e)!=null},set:function(e,t,n){var r,i,o;s.isObject(e)||e==null?(r=e,n=t):(r={},r[e]=t),n||(n={});if(!r)return this;r instanceof f&&(r=r.attributes);if(n.unset)for(i in r)r[i]=void 0;if(!this._validate(r,n))return!1;this.idAttribute in r&&(this.id=r[this.idAttribute]);var u=n.changes={},a=this.attributes,l=this._escapedAttributes,c=this._previousAttributes||{};for(i in r){o=r[i];if(!s.isEqual(a[i],o)||n.unset&&s.has(a,i))delete l[i],(n.silent?this._silent:u)[i]=!0;n.unset?delete a[i]:a[i]=o,!s.isEqual(c[i],o)||s.has(a,i)!=s.has(c,i)?(this.changed[i]=o,n.silent||(this._pending[i]=!0)):(delete this.changed[i],delete this._pending[i])}return n.silent||this.change(n),this},unset:function(e,t){return(t||(t={})).unset=!0,this.set(e,null,t)},clear:function(e){return(e||(e={})).unset=!0,this.set(s.clone(this.attributes),e)},fetch:function(e){e=e?s.clone(e):{};var t=this,n=e.success;return e.success=function(r,i,s){if(!t.set(t.parse(r,s),e))return!1;n&&n(t,r)},e.error=i.wrapError(e.error,t,e),(this.sync||i.sync).call(this,"read",this,e)},save:function(e,t,n){var r,o;s.isObject(e)||e==null?(r=e,n=t):(r={},r[e]=t),n=n?s.clone(n):{};if(n.wait){if(!this._validate(r,n))return!1;o=s.clone(this.attributes)}var u=s.extend({},n,{silent:!0});if(r&&!this.set(r,n.wait?u:n))return!1;var a=this,f=n.success;n.success=function(e,t,i){var o=a.parse(e,i);n.wait&&(delete n.wait,o=s.extend(r||{},o));if(!a.set(o,n))return!1;f?f(a,e):a.trigger("sync",a,e,n)},n.error=i.wrapError(n.error,a,n);var l=this.isNew()?"create":"update",c=(this.sync||i.sync).call(this,l,this,n);return n.wait&&this.set(o,u),c},destroy:function(e){e=e?s.clone(e):{};var t=this,n=e.success,r=function(){t.trigger("destroy",t,t.collection,e)};if(this.isNew())return r(),!1;e.success=function(i){e.wait&&r(),n?n(t,i):t.trigger("sync",t,i,e)},e.error=i.wrapError(e.error,t,e);var o=(this.sync||i.sync).call(this,"delete",this,e);return e.wait||r(),o},url:function(){var e=C(this,"urlRoot")||C(this.collection,"url")||k();return this.isNew()?e:e+(e.charAt(e.length-1)=="/"?"":"/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},change:function(e){e||(e={});var t=this._changing;this._changing=!0;for(var n in this._silent)this._pending[n]=!0;var r=s.extend({},e.changes,this._silent);this._silent={};for(var n in r)this.trigger("change:"+n,this,this.get(n),e);if(t)return this;while(!s.isEmpty(this._pending)){this._pending={},this.trigger("change",this,e);for(var n in this.changed){if(this._pending[n]||this._silent[n])continue;delete this.changed[n]}this._previousAttributes=s.clone(this.attributes)}return this._changing=!1,this},hasChanged:function(e){return arguments.length?s.has(this.changed,e):!s.isEmpty(this.changed)},changedAttributes:function(e){if(!e)return this.hasChanged()?s.clone(this.changed):!1;var t,n=!1,r=this._previousAttributes;for(var i in e){if(s.isEqual(r[i],t=e[i]))continue;(n||(n={}))[i]=t}return n},previous:function(e){return!arguments.length||!this._previousAttributes?null:this._previousAttributes[e]},previousAttributes:function(){return s.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},_validate:function(e,t){if(t.silent||!this.validate)return!0;e=s.extend({},this.attributes,e);var n=this.validate(e,t);return n?(t&&t.error?t.error(this,n,t):this.trigger("error",this,n,t),!1):!0}});var l=i.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,{silent:!0,parse:t.parse})};s.extend(l.prototype,a,{model:f,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},add:function(e,t){var n,i,o,u,a,f,l={},c={},h=[];t||(t={}),e=s.isArray(e)?e.slice():[e];for(n=0,o=e.length;n<o;n++){if(!(u=e[n]=this._prepareModel(e[n],t)))throw new Error("Can't add an invalid model to a collection");a=u.cid,f=u.id;if(l[a]||this._byCid[a]||f!=null&&(c[f]||this._byId[f])){h.push(n);continue}l[a]=c[f]=u}n=h.length;while(n--)e.splice(h[n],1);for(n=0,o=e.length;n<o;n++)(u=e[n]).on("all",this._onModelEvent,this),this._byCid[u.cid]=u,u.id!=null&&(this._byId[u.id]=u);this.length+=o,i=t.at!=null?t.at:this.models.length,r.apply(this.models,[i,0].concat(e)),this.comparator&&this.sort({silent:!0});if(t.silent)return this;for(n=0,o=this.models.length;n<o;n++){if(!l[(u=this.models[n]).cid])continue;t.index=n,u.trigger("add",u,this,t)}return this},remove:function(e,t){var n,r,i,o;t||(t={}),e=s.isArray(e)?e.slice():[e];for(n=0,r=e.length;n<r;n++){o=this.getByCid(e[n])||this.get(e[n]);if(!o)continue;delete this._byId[o.id],delete this._byCid[o.cid],i=this.indexOf(o),this.models.splice(i,1),this.length--,t.silent||(t.index=i,o.trigger("remove",o,this,t)),this._removeReference(o)}return this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,t),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,s.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},get:function(e){return e==null?void 0:this._byId[e.id!=null?e.id:e]},getByCid:function(e){return e&&this._byCid[e.cid||e]},at:function(e){return this.models[e]},where:function(e){return s.isEmpty(e)?[]:this.filter(function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},sort:function(e){e||(e={});if(!this.comparator)throw new Error("Cannot sort a set without a comparator");var t=s.bind(this.comparator,this);return this.comparator.length==1?this.models=this.sortBy(t):this.models.sort(t),e.silent||this.trigger("reset",this,e),this},pluck:function(e){return s.map(this.models,function(t){return t.get(e)})},reset:function(e,t){e||(e=[]),t||(t={});for(var n=0,r=this.models.length;n<r;n++)this._removeReference(this.models[n]);return this._reset(),this.add(e,s.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},fetch:function(e){e=e?s.clone(e):{},e.parse===undefined&&(e.parse=!0);var t=this,n=e.success;return e.success=function(r,i,s){t[e.add?"add":"reset"](t.parse(r,s),e),n&&n(t,r)},e.error=i.wrapError(e.error,t,e),(this.sync||i.sync).call(this,"read",this,e)},create:function(e,t){var n=this;t=t?s.clone(t):{},e=this._prepareModel(e,t);if(!e)return!1;t.wait||n.add(e,t);var r=t.success;return t.success=function(i,s,o){t.wait&&n.add(i,t),r?r(i,s):i.trigger("sync",e,s,t)},e.save(null,t),e},parse:function(e,t){return e},chain:function(){return s(this.models).chain()},_reset:function(e){this.length=0,this.models=[],this._byId={},this._byCid={}},_prepareModel:function(e,t){t||(t={});if(e instanceof f)e.collection||(e.collection=this);else{var n=e;t.collection=this,e=new this.model(n,t),e._validate(e.attributes,t)||(e=!1)}return e},_removeReference:function(e){this==e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if((e=="add"||e=="remove")&&n!=this)return;e=="destroy"&&this.remove(t,r),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],this._byId[t.id]=t),this.trigger.apply(this,arguments)}});var c=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","initial","rest","last","without","indexOf","shuffle","lastIndexOf","isEmpty","groupBy"];s.each(c,function(e){l.prototype[e]=function(){return s[e].apply(s,[this.models].concat(s.toArray(arguments)))}});var h=i.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},p=/:\w+/g,d=/\*\w+/g,v=/[-[\]{}()+?.,\\^$|#\s]/g;s.extend(h.prototype,a,{initialize:function(){},route:function(e,t,n){return i.history||(i.history=new m),s.isRegExp(e)||(e=this._routeToRegExp(e)),n||(n=this[t]),i.history.route(e,s.bind(function(r){var s=this._extractParameters(e,r);n&&n.apply(this,s),this.trigger.apply(this,["route:"+t].concat(s)),i.history.trigger("route",this,t,s)},this)),this},navigate:function(e,t){i.history.navigate(e,t)},_bindRoutes:function(){if(!this.routes)return;var e=[];for(var t in this.routes)e.unshift([t,this.routes[t]]);for(var n=0,r=e.length;n<r;n++)this.route(e[n][0],e[n][1],this[e[n][1]])},_routeToRegExp:function(e){return e=e.replace(v,"\\$&").replace(p,"([^/]+)").replace(d,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){return e.exec(t).slice(1)}});var m=i.History=function(){this.handlers=[],s.bindAll(this,"checkUrl")},g=/^[#\/]/,y=/msie [\w.]+/;m.started=!1,s.extend(m.prototype,a,{interval:50,getHash:function(e){var t=e?e.location:window.location,n=t.href.match(/#(.*)$/);return n?n[1]:""},getFragment:function(e,t){if(e==null)if(this._hasPushState||t){e=window.location.pathname;var n=window.location.search;n&&(e+=n)}else e=this.getHash();return e.indexOf(this.options.root)||(e=e.substr(this.options.root.length)),e.replace(g,"")},start:function(e){if(m.started)throw new Error("Backbone.history has already been started");m.started=!0,this.options=s.extend({},{root:"/"},this.options,e),this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&window.history&&window.history.pushState);var t=this.getFragment(),n=document.documentMode,r=y.exec(navigator.userAgent.toLowerCase())&&(!n||n<=7);r&&(this.iframe=o('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(t)),this._hasPushState?o(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?o(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=t;var i=window.location,u=i.pathname==this.options.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!u)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&u&&i.hash&&(this.fragment=this.getHash().replace(g,""),window.history.replaceState({},document.title,i.protocol+"//"+i.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},stop:function(){o(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),m.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();t==this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe)));if(t==this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(e){var t=this.fragment=this.getFragment(e),n=s.any(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0});return n},navigate:function(e,t){if(!m.started)return!1;if(!t||t===!0)t={trigger:t};var n=(e||"").replace(g,"");if(this.fragment==n)return;this._hasPushState?(n.indexOf(this.options.root)!=0&&(n=this.options.root+n),this.fragment=n,window.history[t.replace?"replaceState":"pushState"]({},document.title,n)):this._wantsHashChange?(this.fragment=n,this._updateHash(window.location,n,t.replace),this.iframe&&n!=this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,n,t.replace))):window.location.assign(this.options.root+e),t.trigger&&this.loadUrl(e)},_updateHash:function(e,t,n){n?e.replace(e.toString().replace(/(javascript:|#).*$/,"")+"#"+t):e.hash=t}});var b=i.View=function(e){this.cid=s.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},w=/^(\S+)\s*(.*)$/,E=["model","collection","el","id","attributes","className","tagName"];s.extend(b.prototype,a,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this},make:function(e,t,n){var r=document.createElement(e);return t&&o(r).attr(t),n&&o(r).html(n),r},setElement:function(e,t){return this.$el&&this.undelegateEvents(),this.$el=e instanceof o?e:o(e),this.el=this.$el[0],t!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=C(this,"events")))return;this.undelegateEvents();for(var t in e){var n=e[t];s.isFunction(n)||(n=this[e[t]]);if(!n)throw new Error('Method "'+e[t]+'" does not exist');var r=t.match(w),i=r[1],o=r[2];n=s.bind(n,this),i+=".delegateEvents"+this.cid,o===""?this.$el.bind(i,n):this.$el.delegate(o,i,n)}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(e){this.options&&(e=s.extend({},this.options,e));for(var t=0,n=E.length;t<n;t++){var r=E[t];e[r]&&(this[r]=e[r])}this.options=e},_ensureElement:function(){if(!this.el){var e=C(this,"attributes")||{};this.id&&(e.id=this.id),this.className&&(e["class"]=this.className),this.setElement(this.make(this.tagName,e),!1)}else this.setElement(this.el,!1)}});var S=function(e,t){var n=N(this,e,t);return n.extend=this.extend,n};f.extend=l.extend=h.extend=b.extend=S;var x={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};i.sync=function(e,t,n){var r=x[e];n||(n={});var u={type:r,dataType:"json"};return n.url||(u.url=C(t,"url")||k()),!n.data&&t&&(e=="create"||e=="update")&&(u.contentType="application/json",u.data=JSON.stringify(t.toJSON())),i.emulateJSON&&(u.contentType="application/x-www-form-urlencoded",u.data=u.data?{model:u.data}:{}),i.emulateHTTP&&(r==="PUT"||r==="DELETE")&&(i.emulateJSON&&(u.data._method=r),u.type="POST",u.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",r)}),u.type!=="GET"&&!i.emulateJSON&&(u.processData=!1),o.ajax(s.extend(u,n))},i.wrapError=function(e,t,n){return function(r,i){i=r===t?i:r,e?e(t,i,n):t.trigger("error",t,i,n)}};var T=function(){},N=function(e,t,n){var r;return t&&t.hasOwnProperty("constructor")?r=t.constructor:r=function(){e.apply(this,arguments)},s.extend(r,e),T.prototype=e.prototype,r.prototype=new T,t&&s.extend(r.prototype,t),n&&s.extend(r,n),r.prototype.constructor=r,r.__super__=e.prototype,r},C=function(e,t){return!e||!e[t]?null:s.isFunction(e[t])?e[t]():e[t]},k=function(){throw new Error('A "url" property or function must be specified')}}.call(this),define("backbone",["underscore","jquery"],function(e){return function(){var t,n;return t||e.Backbone}}(this)),define("ui/ui",["underscore","jquery","backbone","common/qshared","common/asset-cache"],function(e,t,n,r,i){function s(s){function T(e){var t;for(var n in x){if(!x.hasOwnProperty(n))continue;var r=x[n];e.find(n).each(function(){N(this,r)})}}function N(e,t){t.prototype.componentName||A("Type must define a component name property."),e[t.prototype.componentName]=new t(e)}function L(){var e=Array.prototype.slice.call(arguments);e.splice(0,0,"UI:"),Function.apply.call(console.log,console,e)}function A(e){u.Error(e)}function O(e){L("Initializing"),C=new l,document.addEventListener("fullscreenchange",st),window.addEventListener("resize",st);var n=o.GetUIContext();k=t(n),k.empty(),st();for(var r=0;r<f.length;r++){var i=t("<style>",{type:"text/css"}).append(f[r]);i.appendTo("head"),C.styles.push(i)}P(),q(),e()}function M(){L("Shutdown"),W();for(var e=0;e<C.styles.length;e++){var t=C.styles[e];t.remove()}}function D(){var e=C.views,t=R();t&&nt(t);for(var n in e){if(!e.hasOwnProperty(n))continue;var r=e[n];if(r.visFrame!==C.frameCount){it(r);continue}rt(r)}C.frameCount++}function P(){C.images=new i(H()),C.images.on("load",F)}function H(){var e=new c;return e.data="data:image/png;base64,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",e}function B(e,t){e.charAt(0)!=="*"&&!e.match(/\.[^\/.]+$/)&&(e+=".png"),C.images.load(e,t)}function j(e){return C.images.findByHandle(e)}function F(e,t){o.ReadFile(e,"binary",function(n,i){if(n)return L("Failed to load image '"+e+"'"),t(n);var s=new c;s.name=e,s.data="data:image/png;base64,"+r.atob64(new Uint8Array(i)),t(null,s)})}function q(){I=t("<span>",{"class":"pointer"}),k.append(I),k.on("qk_blur",function(){Y(!1)})}function R(){return C.activeMenus.length?C.activeMenus[C.activeMenus.length-1]:null}function U(t){e.isString(t)&&(t=et(t)),C.activeMenus.length||(k.addClass("active"),a.CaptureInput(X,V)),C.activeMenus.push(t),t.opened()}function z(){var e=C.activeMenus.pop();if(!e)return;Q(),Y(!0),C.activeMenus.length||(k.removeClass("active"),a.CaptureInput(null,null)),e.closed()}function W(){while(C.activeMenus.length)z()}function X(e){var n=!1;if(e==="mouse0"){var r=C.hoverEls&&C.hoverEls.length>0?C.hoverEls[0]:null;n=G(r)}if(C.focusEl){if(e==="mouse0"){var i=I.offset();t(C.focusEl).trigger(new h(i.left,i.top))}n||t(C.focusEl).trigger(new p(e))}}function V(e,t){if(C.mouseCallback){C.mouseCallback(e,t);return}C.mx+=e,C.my+=t,C.mx=Math.max(0,Math.min(C.mx,C.vw)),C.my=Math.max(0,Math.min(C.my,C.vh)),I.css({top:C.my+"px",left:C.mx+"px"}),K()}function J(e,n,r){var i=document.elementFromPoint(n,r);if(!i)return null;if(!t.contains(e.el,i))return[i];var s=t(i).parentsUntil(e.el,function(){var e=t(this),i=e.offset(),s={x:[i.left,i.left+e.outerWidth()],y:[i.top,i.top+e.outerHeight()]};return n>=s.x[0]&&n<=s.x[1]&&r>=s.y[0]&&r<=s.y[1]}),o=s.toArray();return o.splice(0,0,i),o}function K(){var e,n=R();if(!n){A("Calling UpdateHoverElements with no active menu");return}var r=J(n,C.mx,C.my);if(C.hoverEls)for(e=0;e<C.hoverEls.length;e++){var i=C.hoverEls[e];if(!r||r.indexOf(i)===-1)t(i).removeClass("hover"),t(i).trigger("qk_mouseleave")}if(r)for(e=0;e<r.length;e++){var s=r[e];if(!C.hoverEls||C.hoverEls.indexOf(s)===-1)t(s).addClass("hover"),t(s).trigger("qk_mouseenter")}C.hoverEls=r}function Q(){C.hoverEls&&t(C.hoverEls).removeClass("hover"),C.hoverEls=[]}function G(e){return C.focusEl===e?!1:(Y(!0),C.focusEl=e,t(e).addClass("focus"),t(e).trigger(new v),!0)}function Y(e){e&&t(C.focusEl).trigger(new m),t(C.focusEl).removeClass("focus"),C.focusEl=null}function Z(e){switch(e){case"hud":return dt;case"loading":return vt;case"scoreboard":return wt;case"main":return mt;case"message":return gt;default:throw Error("Unsupported view")}}function et(e){var t=C.views[e];return t||(t=tt(e)),t}function tt(e){var n=Z(e),r=t("<div />",{id:e}).appendTo(k),i=C.views[e]=new n({el:r});return it(i),i}function nt(t){e.isString(t)&&(t=et(t)),t.visFrame=C.frameCount}function rt(e){var t=e.el.style.display!=="none";t||e.$el.show()}function it(e){var t=e.el.style.display!=="none";t&&e.$el.hide()}function st(){C.vw=k.width(),C.vh=k.height();var e=C.views;for(var t in e){if(!e.hasOwnProperty(t))continue;ot(e[t].$el),ut(e[t].$el)}}function ot(e){var n=e.find(".centerx"),r=e.find(".centery");n.not(".centerx-bound").addClass("centerx-bound").css("display","inline-block").bind("recenter",function(){var e=t(this),n=e.offsetParent(),r=n.outerWidth()/2-e.outerWidth()/2;e.css({position:"absolute",left:r})}),r.not(".centery-bound").addClass("centery-bound").css("display","inline-block").bind("recenter",function(){var e=t(this),n=e.offsetParent(),r=n.outerHeight()/2-e.outerHeight()/2;e.css({position:"absolute",top:r})}),setTimeout(function(){n.add(r).trigger("recenter")},100)}function ut(e){e.css("font-size",C.vw/100+"px")}var o=s.SYS,u=s.COM,a=s.CL,f=["/** * Main */@font-face {	font-family: 'GibsonBold';	src: url('data:application/x-font-ttf;base64,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AABBbHRzACAAICIZArwBLABLA58BDQAAAAAAEAAAANAJCgYAAwMDBAUFBwYCBAQEBgIDAgMFBQUFBQUFBQUFAwMFBgUECQcGBgcFBQcHAwMGBQcICAUIBgUGBwcKCAYGBAMEAAUABQUEBQUDBAUDAwUDCAUFBQUEBAQFBQcFBQUDAgMABQYCBQUJBQcAAgcDCQUEBgICBQUDBQYACAMIBgMDBAYFAAcGBgcDBQAFBgEABgQHBwcHBwcJBgUFBQUDAwMDCAgICAgICAcHBwcFBQUFBQUFBwQFBQUFAwMDAwUFBQUFBQUFBQUFBQUDAAEACgsHAAMDAwUFBggHAgQEBQYCAwIEBQUFBQUFBQUFBQMDBgYGBAoIBwcIBgUICAMDBwYICAgGCAYGBwgHCwgHBwQDBAAGAAUGBQYFAwUGAwMFAwkGBgYGBAQEBgUIBgUFAwMDAAUHAgUFCgUIAAMHAwoGBQYCAgUFAwUGAAkDCQcDAwUGBgAIBgcIAwUABgcCAAYECAgICAgICgcGBgYGAwMDAwgICAgICAgICAgIBgUFBQUFBQgFBQUFBQMDAwMGBgYGBgYFBgYGBgYFAwABAAsMCAADAwMFBgYJCAIEBAUHAwQDBAYGBgYGBgYGBgYDAwYHBgULCAcICAYGCAkDBAgGCQkJBgkHBgcJCAwJCAcFAwUABgAGBwUGBgQFBgMDBgMKBgYHBgUEBAYGCAYGBgQDBAAGCAIGBgsGCQADCAQLBgUHAwMGBgQGBwAJBAoIAwMFBwYACAcICAMGAAYHAgAHBQgICAgICAsIBgYGBgMDAwMJCQkJCQkJCQkJCQcGBgYGBgYIBQYGBgYDAwMDBgYGBgYGBgYGBgYGBgMAAQAMDQgAAwMDBgYHCQgDBQUGCAMEAwQGBgYGBgYGBgYGAwMHCAcFDAkICAkHBwkKBAQIBwoKCgcKCAcICgkNCggIBQMFAAcABgcGBwcEBgcDAwcDCwcHBwcFBQUHBgkHBgYEAwQABggDBgYMBgkAAwkEDAcGCAMDBgYEBggACgQKCAMDBggHAAkICAkDBgAHCAIACAUJCQkJCQkMCAcHBwcEBAQECgoKCgoKCgoKCgoHBgYGBgYGCQYHBwcHAwMDAwcHBwcHBwYHBwcHBwYDAAEADQ4JAAQEBAYHBwoJAwUFBggDBAMFBwcHBwcHBwcHBwQEBwgHBg0KCQkKCAcKCgQECQgLCwsHCwgICQoJDgsJCQUEBQAHAAcIBggHBAYIBAQHBAwICAgHBQUFCAcKBwcHBAMEAAcJAwcHDQcKAAMKBA0IBggDAwcHBAcIAAsECwkEBAYIBwAKCAkKBAcABwkCAAgGCgoKCgoKDQkICAgIBAQEBAsLCwsLCwsKCgoKCAcHBwcHBwoGBwcHBwQEBAQICAgICAgHCAgICAgHBAACAA4PCgAEBAQHBwgLCgMGBgcJAwUDBQcHBwcHBwcHBwcEBAgJCAYOCwkKCwgICwsEBQoIDAwMCAwJCAkLCg8MCgkGBAYACAAHCAYICAUHCAQECAQMCAgICAYGBggHCwgHBwUEBQAHCgMHBw4HCwAECgUOCAcJAwMHBwUHCQAMBQwKBAQGCQgACwkKCwQHAAgJAgAJBgsLCwsLCw4KCAgICAQEBAQMDAwMDAwMCwsLCwgHBwcHBwcLBggICAgEBAQECAgICAgIBwgICAgIBwQAAgAPEAsABAQEBwgIDAsDBgYHCgQFBAUICAgICAgICAgIBAQICggHDwsKCwsJCAsMBQUKCQwNDQgNCgkKDAsQDQoKBgQGAAgACAkHCQgFBwkEBAgEDQkJCQgGBgYJCAsICAgFBAUACAoDCAgPCAwABAsFDwkHCgQECAgFCAoADQUNCgQEBwoIAAsKCgsECAAICgIACgcLCwsLCwsPCwkJCQkFBQUFDQ0NDQ0NDQwMDAwJCAgICAgICwcICAgIBAQEBAkJCQkJCQgJCQkJCQgEAAIAEBELAAUFBQgICQ0LBAYGCAoEBQQGCAgICAgICAgICAUFCQoJBxAMCwsMCQkMDQUFCwkNDg4JDgoJCw0MEQ4LCwcEBwAJAAgKBwkJBQgJBQUJBQ4JCQoJBwYGCQgMCQgIBQQFAAgLBAgIEAgNAAQMBRAJCAoEBAgIBQgKAA4FDgsFBQcKCQAMCgsMBQgACQsDAAoHDAwMDAwMEAsJCQkJBQUFBQ4ODg4ODg4NDQ0NCggICAgICAwHCQkJCQUFBQUJCQkJCQkICQkJCQkIBQACABESDAAFBQUICQoNDAQHBwgLBAYEBgkJCQkJCQkJCQkFBQkLCQgRDQsMDQoJDQ4FBQwKDg4OCg4LCgsODBIODAsHBQcACQAJCggKCQYICgUFCQUPCgoKCgcHBwoJDQoJCQYEBgAJDAQJCREJDQAEDAYRCggLBAQJCQYJCwAOBg8MBQUICwoADQsMDQUJAAkLAwALCA0NDQ0NDREMCgoKCgUFBQUODg4ODg4ODg4ODgoJCQkJCQkNCAkJCQkFBQUFCgoKCgoKCQoKCgoKCQUAAgASFA0ABQUFCQkKDg0EBwcJDAQGBAcJCQkJCQkJCQkJBQUKDAoIEg4MDQ4KCg4OBQYMCg8PDwoPDAoMDg0UDwwMCAUIAAoACQsICgoGCQoFBQoFEAoKCwoIBwcKCQ4KCQkGBQYACQwECQkSCQ4ABQ0GEgsIDAQECQkGCQwADwYQDAUFCAwKAA4MDA4FCQAKDAMADAgODg4ODg4SDQoKCgoFBQUFDw8PDw8PDw4ODg4LCQkJCQkJDggKCgoKBQUFBQoKCgoKCgkKCgoKCgkFAAIAExUNAAUFBQkKCw8NBAgICQwFBgUHCgoKCgoKCgoKCgUFCgwKCBMPDQ0PCwoPDwYGDQsQEBALEAwLDQ8OFRANDQgFCAALAAoLCQsKBgkLBQUKBRELCwsLCAgICwoPCwoKBgUGAAoNBAoKEwoPAAUOBhMLCQwFBQoKBgoMABAGEA0FBQkMCwAODA0OBQoACg0DAAwIDw8PDw8PEw0LCwsLBgYGBhAQEBAQEBAPDw8PCwoKCgoKCg8JCgoKCgUFBQULCwsLCwsKCwsLCwsKBQACABQWDgAGBgYKCgsQDgUICAoNBQcFBwoKCgoKCgoKCgoGBgsNCwkUDw0ODwwLDxAGBg4MERERCxENDA0QDhYRDg0IBggACwAKDAkMCwcKDAYGCwYSDAwMCwgICAwKDwsKCgcFBwAKDgUKChQKEAAFDwcUDAkNBQUKCgcKDQARBxEOBgYJDQsADw0ODwYKAAsNAwANCQ8PDw8PDxUODAwMDAYGBgYREREREREREBAQEAwKCgoKCgoPCQsLCwsGBgYGDAwMDAwMCgwMDAwMCgYAAgAVFw8ABgYGCgsMEA8FCAgKDgUHBQgLCwsLCwsLCwsLBgYMDgwJFRAODxAMCxARBgcODBESEgwSDgwOEQ8XEg4OCQYJAAwACw0KDAsHCgwGBgsGEwwMDQwJCAgMCxAMCwsHBQcACw4FCwsVCxEABg8HFQwKDgUFCwsHCw4AEgcSDgYGCg4MABAODhAGCwAMDgMADgkQEBAQEBAWDwwMDAwGBgYGEhISEhISEhERERENCwsLCwsLEAoLCwsLBgYGBgwMDAwMDAsMDAwMDAsGAAMAFhgPAAYGBgsLDBEPBQkJCw4FCAUIDAwMDAwMDAwMDAYGDA4MChYRDw8RDQwREgcHDw0SExMMEw4NDxIQGBMPDwkGCQAMAAwNCg0MCAsNBgYMBhMNDQ0MCQkJDQsRDAwLBwYHAAwPBQwLFgwRAAYQBxYNCg4FBQsLBwwOABMHEw8GBgoODAARDg8RBgwADA8EAA4KERERERERFw8NDQ0NBwcHBxMTExMTExMSEhISDQwMDAwMDBEKDAwMDAYGBgYNDQ0NDQ0MDQ0NDQ0MBgADABcZEAAGBgYLDA0SEAUJCQsPBggGCAwMDAwMDAwMDAwGBg0PDQoXEg8QEg0NEhMHBxANExMTDRMPDQ8TERkTEA8KBgoADQAMDgsNDQgLDQYGDQYUDQ0ODQoJCQ0MEg0MDAgGCAAMEAUMDBcMEgAGEQgXDQsPBgYMDAgMDwAUCBQQBgYLDw0AEQ8QEQYMAA0PBAAPChISEhISEhgQDQ0NDQcHBwcTExMTExMTExMTEw4MDAwMDAwSCw0NDQ0GBgYGDQ0NDQ0NDA0NDQ0NDAYAAwAYGhEABwcHDAwOExEFCgoMDwYIBgkNDQ0NDQ0NDQ0NBwcNDw0LGBIQERIODRITBwgQDhQUFA4UDw4QExEaFBAQCgcKAA0ADQ4LDg0IDA4HBw0HFQ4ODg4KCgoODBIODQwIBggADRAFDQwYDRMABhIIGA4LEAYGDAwIDQ8AFAgVEAcHCw8OABIPEBIHDQANEAQADwsSEhISEhIZEQ4ODg4HBwcHFBQUFBQUFBMTExMODQ0NDQ0NEgsNDQ0NBwcHBw4ODg4ODg0ODg4ODg0HAAMAAAAAAQAABKAAAQDDACoABwRoAAMAAP/ZAAAAAP/6ACMAAP/EACQAAP/aACgAAP/ZAC4AAP+PADEAAP/ZADIAAP/RADYAAP+zADcAAP+yADgAAP/NADkAAP/CADkAAP/QADoAAP/FADsAAP+5ADwAAP/LADwAAP+vAEgAAAAFAFQAAP/+AAQAAP/oAAAAAP/rAAAAAP/ZAAAAAP/aACkAD/+bADoAD/+nAFUAD/+5AFkAD//IAFoAD//HAFwAD//EADMAD/+VADkAD/+jADcAD/+qADwAD/+nADoAEP/HADkAEP/EAFUAEP/0ADwAEP+qADcAEP+tADoAEf+nAFkAEf/HADwAEf+nAFoAEf/HADMAEf+VAFwAEf/CADcAEf+qACkAEf+bADkAEf+jAFUAEf+5ABQAFP+1ADwAHf+pADkAHf+8ADcAHf+dADoAHf++ADwAHv+tADkAHv/BADoAHv/CADcAHv+hADkAJP+sADoAJP+sADwAJP+1AAAAJP/6ADMAJP/RADIAJP/ZACkAJP/ZADcAJP+7AAAAJP/ZAAAAJP/ZADwAJv/HACQAJv/XAAAAJv/oAAAAJv/XACQAKv/ZAAAAKv/pADwAKv/IAAAAKv/xADIAKv/xAAAAKv/rAAAAKv/xAAAAMv/rADwAMv/LACQAMv/aAAAAMv/aAAAANP/yAAAANP/sADIANP/yADwANP/LACQANP/aAAAANP/rAAAANP/yAC8AN/+5AAAAN//1ACQAN/+8AAAAN/+8AAAAOf/3ACQAOf+sAC8AOf+1ADUAOf/aADIAOf/WAAAAOf/1AAAAOf/WAAAAOf/WACQAOv+yAC8AOv+/AAAAOv/7AAAAOv+yAAAAPP/KAAAAPP/3AC8APP+1AAAAPP/1ACQAPP+zADIAPP/KADUAPP/UAAAAPP/KADkARP/IADoARP/LADcARP+wADwARP+1ADoARv+/ADkARv+8ADcARv+sADwARv+pADcAR/+tADkAR/+/ADoAR//CADwAR/+qADcASP+sADoASP/BADkASP++ADwASP+pADoASv/LADcASv+wADkASv/IADwASv+zADkAUP/QADcAUP+nADoAUP/RADwAUP+/ADkAUf/LADoAUf/NADcAUf+jADwAUf+7ADoAUv/BADkAUv++ADcAUv+tADwAUv+qADcAU/+jADkAU//LADoAU//NADwAU/+7ADcAVP+tADoAVP/BADkAVP++ADwAVP+qADoAVf/KADcAVf+gADkAVf/IADwAVf+4ADkAVv/IADcAVv+tADoAVv/LADwAVv+zAAAAV//XADoAWP/NADcAWP+jADwAWP+7ADkAWP/LADoAWf/fADcAWf+1ACQAWf/HADwAWf/NADkAWf/dAAAAWf/pAAAAWf/HACQAWv/LADwAWv/RADoAWv/jADcAWv+5AAAAWv/uADkAWv/iAAAAWv/LADoAW//aADkAW//ZADwAW//IADcAW/+1ADcAXP+1ADkAXP/dADoAXP/fAAAAXP/oACQAXP/TADwAXP/NAAAAXP/TADwAXf/CADkAXf/TADcAXf+yADoAXf/UAwAECggNAAA=') format('truetype');	font-weight: normal;	font-style: normal;}#viewport-ui {	/**	 * Don't let people accidently highlight text.	 */	-webkit-touch-callout: none;	-webkit-user-select: none;	-khtml-user-select: none;	-moz-user-select: none;	-ms-user-select: none;	user-select: none;}#viewport-ui .pointer {	display: none;	position: absolute;	top: 0;	left: 0;	width: 13px;	height: 20px;	background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA0AAAAUCAYAAABWMrcvAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAZpJREFUeNqUk79LAnEUwN9FgXh4wUGIg7g46XCI4NLgcERi0NzQXyBRc/9AU4uDBNFgY4QQgi1phIqKUy2OTimBnYFy/s7Xe0eKmuJ18Pny5b37vO+77/e+gIjnhECAWXjQiat/Sf1+v1mv12mO16alTqejBYNBLJVKLN4SG2ul0WikuVwulCQJy+Uyi3fE1lrJ7XbTDFCWZczlciw+EBZTEsMrZjIZFh8J0ZTEiKI4EXmQTEmMzWbDdDrNYnZRXCkxVqsVU6kUi8/EtimJEQQB4/E4i3lCZmkTVjyqqoLX64VWqwV0hhAKhXbtdnuWUgdzkqIo0G63oVqtAm0GRKNRDj8RnwS/KxHHMBwONafTiX6/H3VdN1qZtJZIJLityz+7R5W1SCSCjUbjmwI3VOQjEAgYks/nw16v16W4MieNx+OvwWDAFc9+gxfJZHK6WiwW49z94tVoEiczwR3iPRwOG5LD4cBarcaiOisdLvlVTguFgiF5PB6sVCqTs5pKy7DQ+b0Vi0XsdvmT8IXYWycxR8Qrsb+Y+xFgABTcmOagLuC4AAAAAElFTkSuQmCC');	z-index: 1;	/* Don't let elementFromPoint() return the actual pointer */	pointer-events: none;}#viewport-ui.active .pointer {	display: inline-block;}#viewport-ui .fullscreen {	position: fixed;	top: 0;	left: 0;	width: 100%;	height: 100%;}#viewport-ui .logo {	width: 20em;	height: 20em;	margin: 0 auto 2em;}#viewport-ui h1, #viewport-ui h2 {	font-family: 'GibsonBold', sans-serif;}#viewport-ui a {	color: #fff;	text-decoration: none;}/** * Vertical menu */.vertical-menu {}.vertical-menu h1 {	margin: 0 0 0.4em 0.1em;	font-size: 2.4em;	text-transform: uppercase;}.vertical-menu-content {	padding: 2em;	left: 0;	right: 0;}.vertical-menu-content ul {  /* sometimes menu items are in lists */	margin: 0;	padding: 0;	list-style: none;}.vertical-menu-item {	margin: 0.1em 0;	padding: 0.1em 0.3em;	font-size: 1.2em;	text-transform: uppercase;}.vertical-menu-item.hover,.vertical-menu-item.active {  /* nav tab item */	background: #fff;	color: #000;}.vertical-menu-item.hover a,.vertical-menu-item.active a {  /* nav tab item */	color: #000;}.vertical-menu-left {	position: absolute;	top: 0;	left: 0;	bottom: 0;	width: 26em;	background: rgba(0, 0, 0, 0.6);}/** * Dialogs */.dialog {	position: relative;	width: 80%;	margin: 8em auto 0;	padding: 3em 1.6em 1.2em;	background: rgba(0, 0, 0, 0.6);	color: #fff;}.dialog .close {	position: absolute;	width: 1.4em;	height: 1.4em;	top: 0;	right: 0;	font-size: 1.4em;	color: #999999;	text-align: center;}.dialog .close.hover {	color: #bfbfbf;}.dialog .dialog-heading {	position: absolute;	top: -1em;	left: -.3em;}.dialog .dialog-title {	display: inline-block;	padding: .1em .3em;	vertical-align: middle;	text-transform: uppercase;	background: #fff;	color: #000;	font-family: 'GibsonBold', sans-serif;	font-size: 2em;}.dialog .menu-item {	margin-bottom: .5em;	padding: .5em;	background: #222;}.dialog .menu-item.hover {	background: #333;}/** * Buttons */.button {	display: inline-block;	padding: .5em;	background-color: #222;	background-image: -moz-linear-gradient(top, #333, #222);	background-image: -webkit-linear-gradient(top, #333, #222);}.button.hover {	background: #333;}/** * Progress bar */.progress {	display: block;	background: -moz-linear-gradient(top, #222, #303030);	background: -webkit-linear-gradient(top, #222, #303030);	box-shadow: inset 0 1px 2px rgba(0, 0, 0, .1);	border-radius: 2px;}.progress .bar {	width: 0;	background: -moz-linear-gradient(top, #8cc84b, #448800);	background: -webkit-linear-gradient(top, #8cc84b, #448800);	box-shadow: inset 0 -1px 0 rgba(0, 0, 0, .15);	-moz-transition: width .6s ease;	-webkit-transition: width .6s ease;}/** * Controls */.control-group {	margin-bottom: .5em;}.control-label {	float: left;	padding: .5em 0 0;	width: 12em;	color: #a6e22e;	text-align: right}.control-input {	padding: .5em;	margin-left: 13em;	/* Empty fields */	min-height: 1em;}.control-input.input-text,.control-input.input-key,.control-input.input-radio {	background: rgba(34, 34, 34, 0.8);	border: 1px solid transparent;}.control-input.input-text.hover,.control-input.input-key.hover,.control-input.input-radio.hover {	background: rgba(51, 51, 51, 0.8);}.control-input.input-text.focus,.control-input.input-key.focus {	border-color: rgba(166, 226, 46, 0.8);	-webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 8px rgba(166, 226, 46, 0.6);	-moz-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 8px rgba(166, 226, 46, 0.6);	box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 8px rgba(166, 226, 46, 0.6)}.control-input.input-text {	word-wrap: break-word;}.control-input.input-radio:before {	content: 'off';}.control-input.input-radio[data-enabled=\"true\"]:before {	content: 'on';}.form-horizontal .form-actions {	margin-left: 11em;}/** * Tabs */.tab-pane {	display: none;}.tab-pane.active {	display: block;}/** * Ranges */.input-range {	position: relative;	height: 1em;}.input-range .range-track {	height: 100%;	background: -moz-linear-gradient(top, #222, #303030);	background: -webkit-linear-gradient(top, #222, #303030);	box-shadow: inset 0 1px 2px rgba(0, 0, 0, .1);}.input-range .range-slider {	position: absolute;	top: .5em;	left: 0;	background: -moz-linear-gradient(top, #8cc84b, #448800);	background: -webkit-linear-gradient(top, #8cc84b, #448800);	box-shadow: inset 0 -1px 0 rgba(0, 0, 0, .15);	width: 1em;	height: 1em;	content: '';}/********************************************************** * * Specialized * **********************************************************//** * Main menu */#main .content {	position: absolute;	top: 0;	left: 26em;	bottom: 0;	right: 0;}/** * Singleplayer menu */#singleplayer .background {	background: rgba(0, 0, 0, 0.3);}#singleplayer .level-select-wrapper {	overflow: hidden;}#singleplayer .levels {	list-style: none;	margin: 0 11em 0 0;	padding: 0;}#singleplayer .preview {	float: right;}#singleplayer .preview .preview-image {	display: none;	width: 10em;	height: 10em;}/** * Multiplayer menu */#multiplayer .background {	background: rgba(0, 0, 0, 0.3);}/** * Settings menu */#settings .sections {	display: inline-block;	margin: 0 0 0 -1em;	padding: 0;	vertical-align: middle;	list-style: none;	overflow: hidden;}#settings .sections li {	float: left;	padding: .1em .3em;	text-transform: uppercase;	background: #202020;	color: #fff;	font-size: 1.4em;	line-height: 1.4em;}#settings .sections li.hover {	background: #333;}#settings .sections li.active {	background: #8cc84b;}#settings .subsections {	display: inline-block;	margin: 0 0 1em -2em;	padding: 0;	list-style: none;	overflow: hidden;}#settings .subsections li {	float: left;}#settings .subsections li a {	display: inline-block;	background: #202020;	color: #fff;	padding: .5em .7em;	text-decoration: none;	text-transform: uppercase;}#settings .subsections li.active {	color: #fff;	background-color: #222;}#settings .subsections li.active a {	background: #8cc84b;	color: #fff;}#settings .tab-pane {	min-height: 12em;}/** * Message menu */#message {	position: absolute;	left: 0;	bottom: 7em;	padding: .7em;	background: rgba(0, 0, 0, 0.6);}#message .control-group {	margin: 0;}#message .control-label {	width: auto;}#message .control-input {	margin-left: 3em;	width: 20em;}/** * Loading view */#loading .background {	background: #222;}#loading .loading {	display: block;	text-align: center;}#loading .loading .progress {	width: 30em;	margin: 0 auto;}/** * Hud view */#hud {	padding: 1em;}#gamestate-wrapper {	position: absolute;	top: 0;	left: 0;}#gamestate-wrapper .scores {	padding: .7em;	background: -moz-linear-gradient(top, rgba(48, 48, 48, .8), rgba(16, 16, 16, .8));	background: -webkit-linear-gradient(top, rgba(48, 48, 48,  .8), rgba(16, 16, 16, .8));	box-shadow: 1px 1px 5px rgba(0, 0, 0, .5);	border-radius: 0 0 .2em 0;}#gamestate-wrapper .score-wrapper {	padding: .2em .3em;}#gamestate-wrapper .score1 {	margin-bottom: .2em;}#gamestate-wrapper .name {	display: inline-block;	width: 8em;	white-space: nowrap;	overflow: hidden;}#gamestate-wrapper .score {	text-align: right;}#gamestate-wrapper .scores .localplayer {	background: rgba(255, 255, 0, 0.4);	border: .1em solid rgba(255, 255, 0, 0.4);	border-radius: .1em;}#gamestate-wrapper .scores .team-red {	background: rgba(255, 0, 0, 0.4);	border: .1em solid rgba(255, 0, 0, 0.2);	border-radius: .1em;}#gamestate-wrapper .scores .team-red.localplayer {	border: .1em solid rgba(255, 100, 0, 1.0);}#gamestate-wrapper .scores .team-blue {	background: rgba(0, 0, 255, 0.4);	border: .1em solid rgba(0, 0, 255, 0.2);	border-radius: .1em;}#gamestate-wrapper .scores .team-blue.localplayer {	border: .1em solid rgba(0, 100, 255, 1.0);}#events-wrapper {	position: absolute;	top: 0;	left: 12em;	width: 30em;	padding: .7em;}#events {	margin: 0;	padding: 0;	list-style: none;	word-wrap: break-word;}#events .event-chat .name,#events .event-tchat .name {	margin-right: 0.7em;}#events .event-chat .text,#events .event-tchat .text {	color: #00dd00;}#crosshair {	width: 2em;	height: 2em;}#crosshair-name {	margin-top: -2.5em;}#crosshair-name.visible {	opacity: 1;	-moz-transition: opacity 0s;	-webkit-transition: opacity 0s;}#crosshair-name.hidden {	opacity: 0;	-moz-transition: opacity .2s linear 1s;	-webkit-transition: opacity .2s linear 1s;}#fps-wrapper {	position: absolute;	top: 1em;	right: 1em;}#weapons-wrapper {	position: absolute;	top: 10em;	left: 0;}#weapons-wrapper .weapons {	margin: 0;	padding: 0;	list-style: none;}#weapons-wrapper .weapons li {	display: block;	padding: .3em .5em .3em 1em;}#weapons-wrapper .weapons li.selected {	background: -moz-linear-gradient(top, rgba(48, 48, 48, .8), rgba(16, 16, 16, .8));	background: -webkit-linear-gradient(top, rgba(48, 48, 48,  .8), rgba(16, 16, 16, .8));	box-shadow: 1px 1px 5px rgba(0, 0, 0, .5);	border-radius: 0 .2em .2em 0;}#weapons-wrapper .weapons li .icon {	float: left;	display: block;	width: 2em;	height: 2em;}#weapons-wrapper .weapons li .ammo {	display: block;	margin-left: 2.2em;	padding: 0 .5em;	line-height: 2em;}#health-wrapper {	position: absolute;	right: 50%;	bottom: 0;	margin-right: 2em;}#armor-wrapper {	position: absolute;	left: 50%;	bottom: 0;	margin-left: 2em;}#health-icon,#armor-icon {	display: inline-block;	width: 2em;	height: 2em;}#health-text,#armor-text {	font-size: 4em;}#lagometer-wrapper {	position: absolute;	bottom: 1em;	left: 1em;	height: 10em;	overflow: hidden;	background: rgba(0, 0, 0, 0.7);}#lagometer-wrapper .frame-wrapper {	position: relative;	float: left;	width: 0.15625em;	height: 10em;}#lagometer-wrapper .lag-frame,#lagometer-wrapper .snapshot-frame {	position: absolute;	bottom: 0;	left: 0;	background: #ff0000;}#lagometer-wrapper .snapshot-frame {	background: #00ff00;}#counts-wrapper {	position: absolute;	bottom: 1em;	right: 1em;}#counts-wrapper .count-label {	display: inline-block;	width: 9em;	text-align: right;}#counts-wrapper .count-value {	display: inline-block;	width: 4em;}/** * Scoreboard view */#scoreboard-wrapper {	position: absolute;	top: 50%;	left: 50%;	margin-left: -27em;	margin-top: -12em;	width: 50em;	min-height: 20em;	padding: 2em;	background: rgba(0, 0, 0, 0.7);}#scoreboard-wrapper table {	width: 100%;	color: #fff;}#scoreboard-wrapper table th {	text-align: left;}#scoreboard-wrapper table.team-red {	float: left;	width: 24em;	background: #ff0000;}#scoreboard-wrapper table.team-blue {	float: right;	width: 24em;	background: #0000ff;}"],l=function(){this.styles=[],this.frameCount=0,this.views={},this.activeMenus=[],this.hoverEls=null,this.focusEl=null,this.mx=0,this.my=0,this.vw=0,this.vh=0,this.images=null},c=function(){this.name=null,this.data=null},h=function(e,t){this.type="qk_click",this.x=e,this.y=t},p=function(e){this.type="qk_keypress",this.keyName=e},d=function(e){this.type="qk_change",this.value=e},v=function(){this.type="qk_focus"},m=function(){this.type="qk_blur"},g=function(e){var n=t(e),r=function(e){n.css({"background-size":"cover","background-image":"url('"+e+"')"})};if(n.data("image")){var i=n.data("image"),s=j(0);r(s.data),B(i,function(e){var t=j(e);r(t.data)})}else if(n.data("himage")){var o=n.data("himage"),u=j(o);r(u.data)}};g.prototype.componentName="qk_img";var y=function(e){var n=this;this.$el=t(e),this._latchedValue=this.$el.text(),this._tempValue="",this.$el.bind("qk_focus",function(e){n.onFocus(e)}),this.$el.bind("qk_keypress",function(e){n.onKeyPress(e)})};y.prototype.componentName="qk_text",y.prototype.val=function(e){if(!arguments.length)return this._latchedValue;this._latchedValue=e,this.$el.text(this._latchedValue),this.$el.trigger(new d(this._latchedValue))},y.prototype.onFocus=function(e){this._tempValue=this.val(),this._tempValue===undefined&&(this._tempValue="")},y.prototype.onKeyPress=function(e){var t=e.keyName;if(t==="enter"){this.val(this._tempValue),this.$el.trigger(new m);return}t.length===1?this._tempValue+=t:t==="space"?this._tempValue+=" ":t==="backspace"&&(this._tempValue=this._tempValue.slice(0,-1)),this.$el.text(this._tempValue)};var b=function(e){var n=this;this.$el=t(e),this.$el.bind("qk_keypress",function(e){n.onKeyPress(e)})};b.prototype.componentName="qk_key",b.prototype.val=function(e){if(!arguments.length)return this.$el.text();this.$el.text(e),this.$el.trigger(new d(e))},b.prototype.onKeyPress=function(e){e.keyName==="backspace"?this.val(""):this.val(e.keyName),this.$el.trigger(new m)};var w=function(e){var n=this;this.$el=t(e),this.$el.bind("qk_click",function(e){n.onClick(e)})};w.prototype.componentName="qk_radio",w.prototype.onClick=function(e){this.toggle()},w.prototype.enabled=function(e){if(!arguments.length)return this.$el.attr("data-enabled")==="true";this.$el.attr("data-enabled",e?"true":"false"),this.$el.trigger(new d(e))},w.prototype.toggle=function(){this.enabled(!this.enabled())};var E=function(e){var n=this,r=t('<div class="range-track" />'),i=t('<div class="range-slider" />');this.$el=t(e),this.$slider=i,this.$el.append(r),this.$el.append(i),this._refreshSlider(),this.$el.bind("qk_click",function(e){n.onClick(e)})};E.prototype.componentName="qk_range",E.prototype.val=function(e){if(!arguments.length)return this.$el.data("value");this.$el.data("value",e),this._refreshSlider(),this.$el.trigger(new d(e))},E.prototype.min=function(e){if(!arguments.length)return this.$el.data("min")||0;this.$el.data("min",e),this._refreshSlider()},E.prototype.max=function(e){if(!arguments.length)return this.$el.data("max")||100;this.$el.data("max",e),this._refreshSlider()},E.prototype.onClick=function(e){var t=this.$el.offset().left,n=this.$el.width(),r=(e.x-t)/n;this.val(this.min()+r*(this.max()-this.min()))},E.prototype._refreshSlider=function(){var e=this.$el.offset().left,t=e+this.$el.width();if(!e&&!t){var n=this;setTimeout(function(){n._refreshSlider()},1);return}var r=this.max()-this.min(),i=(r/2+this.val())/r;this.$slider.css({left:i*(t-e)})};var S=function(e){var n=this;this.element=t(e),this.element.on("qk_click",function(){n.show()})};S.prototype.componentName="qk_tab",S.prototype.show=function(){var e=this.element,n=e.closest("ul"),r=e.attr("data-target"),i,s,o;r||(r=e.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,""));if(e.parent("li").hasClass("active"))return;i=n.find(".active:last a")[0],s=t(r),this.activate(e.parent("li"),n),this.activate(s,s.parent())},S.prototype.activate=function(e,t,n){var r=t.find("> .active");r.removeClass("active"),e.addClass("active"),n&&n()};var x={"[data-image], [data-himage]":g,".input-text":y,".input-key":b,".input-radio":w,".input-range":E,'[data-toggle="tab"]':S},C,k,I,at=n.View.extend({close:function(){z()},opened:function(){},closed:function(){},render:function(){this.renderView(),this._postRender()},_postRender:function(){T(this.$el),ot(this.$el),ut(this.$el)}}),ft=at.extend({template:e.template('<div id="multiplayer" class="dialog">	<div class="dialog-heading">		<div class="dialog-title">Current game</div>	</div>	<div class="form-horizontal">		<div class="team-free">Team Free</div>		<div class="team-red">Team Red</div>		<div class="team-blue">Team Blue</div>		<div class="team-spectator">Team Spectator</div>	</div></div>'),model:{address:"192.168.0.102:9001"},events:{"qk_click .team-free":"teamFree","qk_click .team-red":"teamRed","qk_click .team-blue":"teamBlue","qk_click .team-spectator":"teamSpectator"},initialize:function(){this.render()},teamFree:function(){u.ExecuteBuffer("team free")},teamRed:function(){u.ExecuteBuffer("team red")},teamBlue:function(){u.ExecuteBuffer("team blue")},teamSpectator:function(){u.ExecuteBuffer("team spectator")},renderView:function(){return this.$el.html(this.template(this.model)),this}}),lt=64,ct=6,ht=4e3,pt=n.Model.extend({defaults:function(){return{crosshairName:null,gametype:null,score1:null,score2:null,events:[],currentEvent:0,fps:0,weapons:[],weaponSelect:0,health:"N/A",ammo:[],armor:"N/A",lagometerVisible:!1,frames:{samples:new Array(lt),count:0},snapshots:{samples:new Array(lt),flags:new Array(lt),count:0},shaders:0,nodes:0,leafs:0,surfaces:0,indexes:0,culledModelOut:0,culledModelIn:0,culledModelClip:0}}}),dt=at.extend({model:null,els:{},template:e.template('<div id="crosshair" class="centerx centery" data-image="gfx/2d/crosshaira"></div><div id="crosshair-name" class="centerx centery"><%- crosshairName || \'\' %></div><div id="gamestate-wrapper">	<div class="gametype-info">	</div>	<div class="scores">		<% if (gametype === \'team\' || gametype === \'ctf\' || gametype === \'ca\') { %>			<div class="score-wrapper score1 team-red<% if (score1 && score1.localplayer) { %> localplayer<% } %>">				<span class="name">Team Red</span>				<span class="score"><% if (score1 !== null) { %><%- score1.score %><% } %></span>			</div>			<div class="score-wrapper score2 team-blue<% if (score2 && score2.localplayer) { %> localplayer<% } %>">				<span class="name">Team Blue</span>				<span class="score"><% if (score2 !== null) { %><%- score2.score %><% } %></span>			</div>		<% } else { %>			<div class="score-wrapper score1<% if (score1 && score1.localplayer) { %> localplayer<% } %>">				<span class="name"><% if (score1 !== null) { %><%- score1.rank %>. <%- score1.name %><% } %></span>				<span class="score"><% if (score1 !== null) { %><%- score1.score %><% } %></span>			</div>			<div class="score-wrapper score2<% if (score2 && score2.localplayer) { %> localplayer<% } %>">				<span class="name"><% if (score2 !== null) { %><%- score2.rank %>. <%- score2.name %><% } %></span>				<span class="score"><% if (score2 !== null) { %><%- score2.score %><% } %></span>			</div>		<% } %>	</div></div><div id="events-wrapper">	<ul id="events">		<% for (var i = 0; i < events.length; i++) { %>			<% var ev = events[i]; %>			<li class="event event-<%- ev.type %>">			<% if (ev.type === \'print\') { %>				<span class="text"><%- ev.text %></span>			<% } else if (ev.type === \'chat\' || ev.type === \'tchat\') { %>				<span class="name"><%- ev.name %>: </span><span class="text"><%- ev.text %></span>			<% } %>			</li>		<% } %>	</ul></div><div id="fps-wrapper">	<span id="fps"><%- fps %></span> FPS</div><div id="weapons-wrapper">	<ul class="weapons">		<% for (var i = 0; i < weapons.length; i++) { %>			<% if (!weapons[i]) continue; %>			<li data-index="<%- i %>" class="weapon<% if (i === weaponSelect) { %> selected<% } %>">				<span class="icon" data-himage="<%= weapons[i].gfx.icon %>"></span>				<span class="ammo"><% if (ammo[i] > 0) { print(ammo[i]); } else { print(\'&nbsp;\'); } %></span>			</li>		<% } %>	</ul></div><div id="health-wrapper">	<span id="health-text"><%- health %></span>	<span id="health-icon" data-image="icons/iconh_green.png"></span></div><div id="armor-wrapper">	<span id="armor-icon" data-image="icons/iconr_yellow.png"></span>	<span id="armor-text"><%- armor %></span></div><div id="lagometer-wrapper"<% if (!lagometerVisible) { %> style="display: none;"<% } %>>	<% for (var i = 0; i < frames.samples.length; i++) { %>		<div class="frame-wrapper">			<div data-index="<%- i %>" class="lag-frame">&nbsp</div>			<div data-index="<%- i %>" class="snapshot-frame">&nbsp</div>		</div>	<% } %></div><div id="counts-wrapper">	<div><span class="count-label">Shaders:</span> <span id="count-shaders" class="count-value"><%- shaders %></span></div>	<div><span class="count-label">Nodes:</span> <span id="count-nodes" class="count-value"><%- nodes %>/<%- leafs %></span></div>	<div><span class="count-label">Surfaces:</span> <span id="count-surfaces" class="count-value"><%- surfaces %></span></div>	<div><span class="count-label">Indexes:</span> <span id="count-indexes" class="count-value"><%- indexes %></span></div>	<div><span class="count-label">Culled mod out:</span> <span id="count-culled-model-out" class="count-value"><%- culledModelOut %></span></div>	<div><span class="count-label">Culled mod in:</span> <span id="count-culled-model-in" class="count-value"><%- culledModelIn %></span></div>	<div><span class="count-label">Culled mod clip:</span> <span id="count-culled-model-clip" class="count-value"><%- culledModelClip %></span></div></div>'),initialize:function(){var e=this;this.model=new pt,this.model.on("change:crosshairName",this.updateCrosshairName,this),this.model.on("change:gametype",this.updateScores,this),this.model.on("change:score1",this.updateScores,this),this.model.on("change:score2",this.updateScores,this),this.model.on("change:events",this.updateEvents,this),this.model.on("change:fps",this.updateFPS,this),this.model.on("change:weapons",this.updateWeapons,this),this.model.on("change:weaponSelect",this.updateWeaponSelect,this),this.model.on("change:ammo",this.updateAmmo,this),this.model.on("change:armor",this.updateArmor,this),this.model.on("change:health",this.updateHealth,this),this.model.on("change:lagometerVisible",this.updateLagometer,this),this.model.on("change:lagometerFrame",this.updateLagometerFrame,this),this.model.on("change:snapshotFrame",this.updateSnapshotFrame,this),this.model.on("change:shaders change:nodes change:leafs change:surfaces change:indexes change:culledModelOut change:culledModelIn change:culledModelClip",this.updateCounts,this),this.render()},setCrosshairName:function(e){this.model.set("crosshairName",e)},setGametype:function(e){this.model.set("gametype",e)},setScore1:function(e){this.model.set("score1",e)},setScore2:function(e){this.model.set("score2",e)},addEvent:function(e){var t=this,n=this.model.get("events");n.length>=ct&&n.shift(),n.push(e),setTimeout(function(){var r=n.indexOf(e);if(r===-1)return;n.splice(r,1),t.model.trigger("change:events",this,n)},ht),this.model.trigger("change:events",this,n)},setFPS:function(e){this.model.set("fps",e)},setWeapon:function(e,t,n){var r=this.model.get("weapons");r[e]!==t&&(r[e]=t,this.model.trigger("change:weapons",this,r))},setWeaponSelect:function(e){this.model.set("weaponSelect",e)},setAmmo:function(e,t){var n=this.model.get("ammo");n[e]!==t&&(n[e]=t,this.model.trigger("change:ammo",this,e,t))},setHealth:function(e){this.model.set("health",e)},setArmor:function(e){this.model.set("armor",e)},showLagometer:function(){this.model.set("lagometerVisible",!0)},hideLagometer:function(){this.model.set("lagometerVisible",!1)},addLagometerFrame:function(e){var t=this.model.get("frames"),n=t.count%lt;t.samples[n]=e,t.count++,this.model.trigger("change:lagometerFrame",this,n,e)},addSnapshotFrame:function(e,t){var n=this.model.get("snapshots"),r=n.count%lt;n.samples[r]=e,n.flags[r]=t,n.count++,this.model.trigger("change:snapshotFrame",this,r,e,t)},setCounts:function(e){this.model.set(e)},updateCrosshairName:function(e,n){var r=this;n!==null?(this.els.crosshairName.innerHTML=n,t(this.els.crosshairName).removeClass("hidden").addClass("visible").trigger("recenter")):t(this.els.crosshairName).removeClass("visible").addClass("hidden")},updateScores:function(e){this.render()},updateEvents:function(e,t){this.render()},updateFPS:function(e,t){this.els.fps.innerHTML=t},updateWeapons:function(e,t){this.render()},updateWeaponSelect:function(e,n){var r=e.previous("weaponSelect");t(this.els.weapons[r]).removeClass("selected"),t(this.els.weapons[n]).addClass("selected")},updateAmmo:function(e,t,n){this.els.ammo[t].innerHTML=n},updateHealth:function(e,t){this.els.health.innerHTML=t},updateArmor:function(e,t){this.els.armor.innherHTML=t},updateLagometer:function(e,n){t(this.els.lagometer).toggle(n)},updateLagometerFrame:function(e,t,n){var r=n/1e3*10,t=this.els.lagometerFrames[t];t.style.height=Math.abs(r)+"em",t.style.bottom=r<0?r+"em":0},updateSnapshotFrame:function(e,t,n,r){var i=n/1e3*10,t=this.els.snapshotFrames[t];t.style.height=Math.abs(i)+"em",t.style.bottom=i<0?i+"em":0},updateCounts:function(e){this.els.shaders.innerHTML=e.get("shaders"),this.els.nodes.innerHTML=e.get("nodes")+"/"+e.get("leafs"),this.els.surfaces.innerHTML=e.get("surfaces"),this.els.indexes.innerHTML=e.get("indexes"),this.els.culledModelOut.innerHTML=e.get("culledModelOut"),this.els.culledModelIn.innerHTML=e.get("culledModelIn"),this.els.culledModelClip.innerHTML=e.get("culledModelClip")},renderView:function(){this.el.innerHTML=this.template(this.model.toJSON()),this.els.fps=document.getElementById("fps"),this.els.shaders=document.getElementById("count-shaders"),this.els.nodes=document.getElementById("count-nodes"),this.els.surfaces=document.getElementById("count-surfaces"),this.els.indexes=document.getElementById("count-indexes"),this.els.culledModelOut=document.getElementById("count-culled-model-out"),this.els.culledModelIn=document.getElementById("count-culled-model-in"),this.els.culledModelClip=document.getElementById("count-culled-model-clip"),this.els.lagometer=document.getElementById("lagometer-wrapper"),this.els.lagometerFrames=document.querySelectorAll("#lagometer-wrapper .lag-frame"),this.els.snapshotFrames=document.querySelectorAll("#lagometer-wrapper .snapshot-frame"),this.els.crosshairName=document.getElementById("crosshair-name"),this.els.weapons=[],this.els.ammo=[];var e=document.querySelectorAll("#weapons-wrapper .weapon");for(var t=0;t<e.length;t++){var n=e[t],r=n.getAttribute("data-index");this.els.weapons[r]=n,this.els.ammo[r]=n.querySelector(".ammo")}return this.els.armor=document.getElementById("armor-text"),this.els.health=document.getElementById("health-text"),this}}),vt=at.extend({template:e.template('<div class="fullscreen background">	<div class="loading centerx centery">		<div>Loading <span class="map-name"><% if (mapName) print(mapName); %></span></div>		<div class="progress">			<div class="bar">&nbsp;</div>		</div>	</div></div>'),model:{mapName:null,percent:0},loadingEl:null,initialize:function(){this.render()},setMapName:function(e){this.model.mapName=e,this.$el.find(".map-name").text(e)},setProgress:function(e){this.model.percent=e,this.$el.find(".progress .bar").css("width",e+"%")},renderView:function(){return this.$el.html(this.template(this.model)),this}}),mt=at.extend({model:{connected:!1},template:e.template('<div class="fullscreen"<% if (!connected) { %> data-image="ui/main_menu_bg.jpg"<% } %>>	<div class="vertical-menu vertical-menu-left">		<div class="vertical-menu-content">			<div class="logo" data-image="ui/logo.png"></div>			<div class="currentgame vertical-menu-item">Current game</div>			<div class="singleplayer vertical-menu-item">Single player</div>			<div class="multiplayer vertical-menu-item">Multi player</div>			<div class="settings vertical-menu-item">Settings</div>			</div>		</div>	</div>	<div class="content"></div></div>'),events:{"qk_click .currentgame":"showCurrentGameMenu","qk_click .singleplayer":"showSinglePlayerMenu","qk_click .multiplayer":"showMultiPlayerMenu","qk_click .settings":"showSettingsMenu"},initialize:function(){this.render()},setConnected:function(e){this.model.connected=e,this.render()},showTab:function(e){var n;e==="currentgame"?n=ft:e==="singleplayer"?n=St:e==="multiplayer"?n=yt:e==="settings"&&(n=Et),new n({el:t(".content",this.$el)}),t(".vertical-menu-item",this.$el).removeClass("active").filter("."+e).addClass("active")},showCurrentGameMenu:function(){this.showTab("currentgame")},showSinglePlayerMenu:function(){this.showTab("singleplayer")},showMultiPlayerMenu:function(){this.showTab("multiplayer")},showSettingsMenu:function(){this.showTab("settings")},renderView:function(){return this.$el.html(this.template(this.model)),this}}),gt=at.extend({model:{text:""},template:e.template('<div class="control-group">	<div class="control-label">Say:</div><div name="say" class="control-input input-text"><%- text %></div></div>'),events:{'qk_change [name="say"]':"textChanged",'qk_blur [name="say"]':"textBlur"},$say:null,initialize:function(){this.render()},opened:function(){G(this.$say)},textChanged:function(e){var t=e.value;if(t==="")return;var n='say "'+t+'"';u.ExecuteBuffer(n),this.$say[0].qk_text.val("")},textBlur:function(){this.close()},renderView:function(){return this.$el.html(this.template(this.model)),this.$say=this.$el.find('[name="say"]'),this}}),yt=at.extend({template:e.template('<div id="multiplayer" class="dialog">	<div class="dialog-heading">		<div class="dialog-title">Join a server</div>	</div>	<div class="form-horizontal">		<div class="address control-group">			<div class="control-label">Address:</div><div class="control-input input-text"><%- address %></div>		</div>		<div class="form-actions">			<div class="connect button">Connect</div>		</div>	</div></div>'),model:{address:"192.168.0.102:9001"},$address:null,events:{"qk_keypress .address":"updateAddress","qk_click .connect":"connect"},initialize:function(){this.render()},updateAddress:function(e){var t=e.value;this.$address.text(t)},connect:function(){var e=this.$address.text();u.ExecuteBuffer("connect "+e)},renderView:function(){return this.$el.html(this.template(this.model)),this.$address=this.$el.find(".address .control-input"),this}}),bt=n.Model.extend({defaults:function(){return{gametype:null,scores:null}}}),wt=at.extend({template:e.template("<div id=\"scoreboard-wrapper\">	<% if (gametype === 'ffa' || gametype === 'tournament' || gametype === 'single') { %>		<table>			<thead>				<tr>					<th>Name</th>					<th>Ping</th>					<th>Score</th>				</tr>			</thead>			<tbody>				<% for (var i = 0; i < scores.length; i++) { %>					<tr>						<td><%- scores[i].clientInfo.name %></td>						<td><%- scores[i].ping %></td>						<td><%- scores[i].score %></td>					</tr>				<% } %>			</tbody>		</table>	<% } else { %>		<table class=\"team-red\">			<thead>				<tr>					<th>Name</th>					<th>Ping</th>					<th>Score</th>				</tr>			</thead>			<tbody>				<% for (var i = 0; i < scores.length; i++) { %>					<% if (scores[i].team !== 1) continue; %>					<tr>						<td><%- scores[i].clientInfo.name %></td>						<td><%- scores[i].ping %></td>						<td><%- scores[i].score %></td>					</tr>				<% } %>			</tbody>		</table>		<table class=\"team-blue\">			<thead>				<tr>					<th>Name</th>					<th>Ping</th>					<th>Score</th>				</tr>			</thead>			<tbody>				<% for (var i = 0; i < scores.length; i++) { %>					<% if (scores[i].team !== 2) continue; %>					<tr>						<td><%- scores[i].clientInfo.name %></td>						<td><%- scores[i].ping %></td>						<td><%- scores[i].score %></td>					</tr>				<% } %>			</tbody>		</table>	<% } %></div>"),model:{gametype:null,scores:null},initialize:function(){var e=this;this.model=new bt,this.model.on("change:scores",this.update,this)},setGametype:function(e){this.model.set("gametype",e)},setScores:function(e){this.model.set("scores",e)},update:function(){this.render()},renderView:function(){var e=this.model.toJSON();return this.el.innerHTML=this.template(e),this}}),Et=at.extend({template:e.template('<div id="settings" class="dialog">	<div class="dialog-heading">		<div class="dialog-title">Settings</div>		<ul class="sections">			<li class="look active"><a href="#controls" data-toggle="tab">Controls</a></li>			<li class="player"><a href="#character" data-toggle="tab">Character</a></li>			<li class="move"><a href="#game" data-toggle="tab">Game</a></li>		</ul>	</div>	<div class="tab-content">		<div class="tab-pane active" id="controls">			<ul class="subsections">				<li class="move active"><a href="#move" data-toggle="tab">Move</a></li>				<li class="look"><a href="#look" data-toggle="tab">Look</a></li>				<li class="shoot"><a href="#shoot" data-toggle="tab">Shoot</a></li>				<li class="shoot"><a href="#weapons" data-toggle="tab">Weapons</a></li>			</ul>			<div class="tab-content">				<div class="tab-pane active" id="move">					<div class="control-group">						<div class="control-label">Move forward:</div><div name="forwardKey" class="control-input input-key"><%- forwardKey %></div>					</div>					<div class="control-group">						<div class="control-label">Move left:</div><div name="leftKey" class="control-input input-key"><%- leftKey %></div>					</div>					<div class="control-group">						<div class="control-label">Move back:</div><div name="backKey" class="control-input input-key"><%- backKey %></div>					</div>					<div class="control-group">						<div class="control-label">Move right:</div><div name="rightKey" class="control-input input-key"><%- rightKey %></div>					</div>					<div class="control-group">						<div class="control-label">Jump:</div><div name="upKey" class="control-input input-key"><%- upKey %></div>					</div>				</div>				<div class="tab-pane" id="look">					<div class="control-group">						<div class="control-label">Sensitivity:</div><div name="sensitivity" class="control-input input-range" data-min="0" data-max="10" data-value="<%- sensitivity %>"></div>					</div>				</div>				<div class="tab-pane" id="shoot">					<div class="control-group">						<div class="control-label">Attack:</div><div name="attackKey" class="control-input input-key"><%- attackKey %></div>					</div>					<div class="control-group">						<div class="control-label">Zoom:</div><div name="zoomKey" class="control-input input-key"><%- zoomKey %></div>					</div>					<div class="control-group">						<div class="control-label">Next weapon:</div><div name="weapnextKey" class="control-input input-key"><%- weapnextKey %></div>					</div>					<div class="control-group">						<div class="control-label">Prev weapon:</div><div name="weapprevKey" class="control-input input-key"><%- weapprevKey %></div>					</div>				</div>				<div class="tab-pane" id="weapons">					<div class="control-group">						<div class="control-label">Gauntlet:</div><div name="weapon1Key" class="control-input input-key"><%- weapon1Key %></div>					</div>					<div class="control-group">						<div class="control-label">Machinegun:</div><div name="weapon2Key" class="control-input input-key"><%- weapon2Key %></div>					</div>					<div class="control-group">						<div class="control-label">Shotgun:</div><div name="weapon3Key" class="control-input input-key"><%- weapon3Key %></div>					</div>					<div class="control-group">						<div class="control-label">Grenade launcher:</div><div name="weapon4Key" class="control-input input-key"><%- weapon4Key %></div>					</div>					<div class="control-group">						<div class="control-label">Rocket launcher:</div><div name="weapon5Key" class="control-input input-key"><%- weapon5Key %></div>					</div>					<div class="control-group">						<div class="control-label">Lightning gun:</div><div name="weapon6Key" class="control-input input-key"><%- weapon6Key %></div>					</div>					<div class="control-group">						<div class="control-label">Railgun:</div><div name="weapon7Key" class="control-input input-key"><%- weapon7Key %></div>					</div>					<div class="control-group">						<div class="control-label">Plasma gun:</div><div name="weapon8Key" class="control-input input-key"><%- weapon8Key %></div>					</div>					<div class="control-group">						<div class="control-label">BFG:</div><div name="weapon9Key" class="control-input input-key"><%- weapon9Key %></div>					</div>				</div>			</div>		</div>		<div class="tab-pane" id="character">			<div class="name control-group">				<div class="control-label">Name:</div><div name="name" class="control-input input-text"><%- name %></div>			</div>		</div>		<div class="tab-pane" id="game">			<div class="control-group">				<div class="control-label">Autoswitch weapons:</div><div name="autoSwitch" class="control-input input-radio" data-enabled="<%- autoSwitch ? \'true\' : \'false\' %>"></div>			</div>			<div class="control-group">				<div class="control-label">Net time nudge:</div><div name="timeNudge" class="control-input input-range" data-min="-30" data-max="30" data-value="<%- timeNudge %>"></div>			</div>		</div>	</div></div>'),model:{},cvars:{sensitivity:"cl_sensitivity",name:"name",autoSwitch:"cg_autoSwitch",timeNudge:"cl_timeNudge"},cmds:{forwardKey:"+forward",leftKey:"+left",backKey:"+back",rightKey:"+right",upKey:"+jump",attackKey:"+attack",zoomKey:"+zoom",weapnextKey:"weapnext",weapprevKey:"weapprev",weapon1Key:"weapon 1",weapon2Key:"weapon 2",weapon3Key:"weapon 3",weapon4Key:"weapon 4",weapon5Key:"weapon 5",weapon6Key:"weapon 6",weapon7Key:"weapon 7",weapon8Key:"weapon 8",weapon9Key:"weapon 9"},events:{},initialize:function(){var e,t;for(e in this.cvars){if(!this.cvars.hasOwnProperty(e))continue;t='qk_change [name="'+e+'"]',this.events[t]="formChanged"}for(e in this.cmds){if(!this.cmds.hasOwnProperty(e))continue;t='qk_change [name="'+e+'"]',this.events[t]="formChanged"}this.loadConfigToModel(),this.render()},formChanged:function(e){var n=t(e.target).attr("name"),r=e.value;t(e.target).data("RadioInput")&&(r=r==="true"?1:0),this.model[n]=r;var i;for(i in this.cvars){if(!this.cvars.hasOwnProperty(i))continue;var s=this.cvars[i],o=this.model[i];u.SetCvarVal(s,o)}for(i in this.cmds){if(!this.cmds.hasOwnProperty(i))continue;var f=this.cmds[i],l=this.model[i];l!==""&&a.Bind(l,f)}},loadConfigToModel:function(){var e;for(e in this.cvars){if(!this.cvars.hasOwnProperty(e))continue;var t=this.cvars[e];this.model[e]=u.GetCvarVal(t)}for(e in this.cmds){if(!this.cmds.hasOwnProperty(e))continue;var n=this.cmds[e],r=a.GetKeyNamesForCmd(n);this.model[e]=r.length?r[0]:""}},renderView:function(){return this.$el.html(this.template(this.model)),this}}),St=at.extend({model:{previewLevel:0,levels:[{name:"q3dm7"},{name:"q3dm17"},{name:"q3tourney2"}]},template:e.template('<div id="#singleplayer" class="dialog">	<div class="dialog-heading">		<div class="dialog-title">Single player</div>	</div>	<div class="level-select-wrapper">		<div class="preview">		<% _.each(levels, function (level, i) { %>			<div class="preview-image" data-image="<%- level.imagePath %>" <% if (i === 0) { %>style="display: block;"<% } %>></div>		<% }); %>		</div>		<ul class="levels">		<% _.each(levels, function (level, i) { %>			<li class="menu-item"><%- level.name %></li>		<% }); %>		</ul>	</div></div>'),events:{"qk_mouseenter .levels li":"levelPreview","qk_click .levels li":"levelSelect"},initialize:function(){for(var e=0;e<this.model.levels.length;e++){var t=this.model.levels[e];t.imagePath="levelshots/"+t.name}this.render()},levelPreview:function(e){var n=t(e.target);t(".preview .preview-image").hide();var r=n.index();t(".preview .preview-image").eq(r).show()},levelSelect:function(e){var n=t(e.target),r=n.index(),i=this.model.levels[r];u.ExecuteBuffer("map "+i.name)},renderView:function(){return this.$el.html(this.template(this.model)),this}});return{Init:O,Shutdown:M,GetView:et,PeekMenu:R,PushMenu:U,PopMenu:z,PopAllMenus:W,RenderView:nt,Render:D,RegisterImage:B}}return{CreateInstance:function(e){return new s(e)}}}),define("client/cl",["underscore","async","glmatrix","ByteBuffer","common/qmath","common/qshared","cgame/cg","clipmap/cm","renderer/re","sound/snd","ui/ui"],function(e,t,n,r,i,s,o,u,a,f,l){function c(e){function O(){var e=Array.prototype.slice.call(arguments);e.splice(0,0,"CL:"),Function.apply.call(console.log,console,e)}function M(e){O("Initializing"),C=e,k=new b,A=new S,L||(L=new w),L.realtime=0,Et(),lt(),_()}function _(){t.parallel([p.Init,d.Init,v.Init],function(){L.initialized=!0})}function D(){t.parallel([p.Shutdown,d.Shutdown,v.Shutdown],function(){L.initialized=!1})}function P(e){if(!L.initialized)return;L.frameDelta=e,L.realTime+=L.frameDelta,B(),Mt(),j(),ot(),I(),d.Frame()}function H(e){if(A.state<E.CONNECTED)return;if(!e||!e.length)return;U(e[0],e.slice(1));return}function B(){if(A.state<E.CONNECTED)return;c.cvarModifiedFlags&s.CVF.USERINFO&&(c.cvarModifiedFlags&=~s.CVF.USERINFO,U("userinfo",c.GetCvarValues(s.CVF.USERINFO)))}function j(){if(A.state!==E.CONNECTING&&A.state!==E.CHALLENGING)return;if(L.realTime-A.connectTime<g)return;O("CheckForResend",A.state),A.connectTime=L.realTime,A.connectPacketCount++;if(!A.netchan||!A.netchan.ready){F(A.serverAddress);return}switch(A.state){case E.CHALLENGING:var e="connect "+JSON.stringify(c.GetCvarValues(s.CVF.USERINFO));c.NetchanPrint(A.netchan,e),c.cvarModifiedFlags&=~s.CVF.USERINFO;break;default:c.Error("CheckForResend: bad clc.state")}}function F(e){if(A.netchan&&!A.netchan.ready)return;A.netchan=c.NetchanSetup(s.NS.CLIENT,A.serverAddress,{onmessage:function(e){z(e)},onclose:function(e){c.Error(e?e:"Disconnected from server")}})}function I(){switch(A.state){case E.DISCONNECTED:if(!v.PeekMenu()){var e=v.GetView("main");e.setConnected(!1),v.PushMenu(e)}break;case E.CONNECTING:case E.CHALLENGING:case E.CONNECTED:case E.LOADING:case E.PRIMED:v.PopAllMenus(),v.RenderView(v.GetView("loading"));break;case E.ACTIVE:m.Frame(k.serverTime)}v.Render()}function q(){R(),A.serverAddress=c.StringToAddr("localhost"),A.state=E.CHALLENGING,A.connectTime=-99999,j()}function R(e){if(A.state===E.DISCONNECTED)return;O("Disconnected from server"),L.uiStarted&&v.PushMenu("main"),A.state>=E.CONNECTED&&(U("disconnect"),Ft()),k=new b,A=new S,A.state=E.DISCONNECTED}function U(e,t){typeof t=="undefined"&&(t={});var n={type:e,data:t};A.reliableCommands[++A.reliableSequence%c.MAX_RELIABLE_COMMANDS]=n}function z(e){if(!L.initialized)return;var t=new r(e,r.LITTLE_ENDIAN);if(e.byteLength>4&&t.view.getInt32(0,!!r.LITTLE_ENDIAN)===-1){W(t);return}if(A.state<E.CONNECTED)return;if(!c.NetchanProcess(A.netchan,t))return;A.serverMessageSequence=A.netchan.incomingSequence,It(t)}function W(e){e.readInt();var t=e.readCString();if(t==="connectResponse"){if(A.state>=E.CONNECTED){console.warn("Dup connect received. Ignored.");return}if(A.state!==E.CHALLENGING){console.warn("connectResponse packet while not connecting. Ignored.");return}O("Got connection response"),A.state=E.CONNECTED}}function X(){return{COM:{Error:c.Error}}}function V(){return{sys:n,com:{Error:c.Error,AddCvar:c.AddCvar,AddCmd:c.AddCmd},cm:h}}function $(){return{SYS:n,COM:{Error:c.Error,AddCvar:c.AddCvar}}}function J(){return{SYS:n,COM:{Error:c.Error,GetCvarVal:c.GetCvarVal,SetCvarVal:c.SetCvarVal,LoadConfig:c.LoadConfig,SaveConfig:c.SaveConfig,ExecuteBuffer:c.ExecuteBuffer},CL:{Bind:ct,UnbindAll:pt,GetKeyNamesForCmd:Tt,CaptureInput:St,Disconnect:R}}}function K(){return{sys:n,com:{Error:c.Error,AddCmd:c.AddCmd,AddCvar:c.AddCvar},cl:{LoadBsp:c.LoadBsp,LoadMap:c.LoadMap,AddClientCommand:U,GetGameState:Y,GetServerCommand:Z,GetCurrentUserCmdNumber:tt,GetUserCmd:nt,SetUserCmdValue:rt,GetCurrentSnapshotNumber:at,GetSnapshot:ft},cm:h,re:p,snd:d,ui:v}}function Q(){A.state=E.LOADING,m.Init(A.serverMessageSequence,A.lastExecutedServerCommand,A.clientNum),A.state=E.PRIMED}function G(){m.Shutdown()}function Y(){return k.gameState}function Z(e){if(e<=A.serverCommandSequence-c.MAX_RELIABLE_COMMANDS)return c.Error("GetServerCommand: a reliable command was cycled out"),null;if(e>A.serverCommandSequence)return c.Error("GetServerCommand: requested a command not received"),null;var t=A.serverCommands[e%c.MAX_RELIABLE_COMMANDS];A.lastExecutedServerCommand=e,t.type==="disconnect"&&c.Error("Server disconnected");if(t.type==="cs"){var n=t.data.k,r=t.data.v;return et(n,r),t}return t}function et(e,t){k.gameState[e]=t,e==="systemInfo"&&zt()}function tt(){return k.cmdNumber}function nt(e,t){e>k.cmdNumber&&c.Error("GetUserCmd: "+e+" >= "+k.cmdNumber);if(e<=k.cmdNumber-s.CMD_BACKUP)return null;k.cmds[e&s.CMD_BACKUP-1].clone(t)}function rt(e,t){e==="weapon"?k.cgameWeapon=t:e==="sensitivity"&&(k.cgameSensitivity=t)}function st(){k.newSnapshots=!1;var e=k.snap.serverTime-L.realTime,t=Math.abs(e-k.serverTimeDelta);t>it?(k.serverTimeDelta=e,k.oldServerTime=k.snap.serverTime,k.serverTime=k.snap.serverTime,bt()&&O("AdjustTimeDelta: <RESET>")):t>100?(k.serverTimeDelta=(k.serverTimeDelta+e)/2,bt()&&O("AdjustTimeDelta: <FAST>")):k.extrapolatedSnapshot?(k.extrapolatedSnapshot=!1,k.serverTimeDelta-=2):k.serverTimeDelta++,bt()&&O("AdjustTimeDelta: "+k.serverTimeDelta)}function ot(){if(A.state!==E.ACTIVE){if(A.state!==E.PRIMED)return;O("Waiting for first snapshot"),k.newSnapshots&&(k.newSnapshots=!1,ut());if(A.state!==E.ACTIVE)return}k.snap.valid||c.Error("SetCGameTime: !cl.snap.valid"),k.snap.serverTime<k.oldFrameServerTime&&c.Error("cl.snap.serverTime < cl.oldFrameServerTime"),k.oldFrameServerTime=k.snap.serverTime;var e=wt();e<-30?e=-30:e>30&&(e=30),k.serverTime=L.realTime+k.serverTimeDelta+e,k.serverTime<k.oldServerTime&&(k.serverTime=k.oldServerTime),k.oldServerTime=k.serverTime,L.realTime+k.serverTimeDelta>=k.snap.serverTime-5&&(k.extrapolatedSnapshot=!0),k.newSnapshots&&st()}function ut(){if(k.snap.snapFlags&s.SNAPFLAG_NOT_ACTIVE)return;A.state=E.ACTIVE,k.serverTimeDelta=k.snap.serverTime-L.realTime,k.oldServerTime=k.snap.serverTime}function at(){return{snapshotNumber:k.snap.messageNum,serverTime:k.snap.serverTime}}function ft(e){e>k.snap.messageNum&&c.Error("GetSnapshot: snapshotNumber > cl.snapshot.messageNum");if(k.snap.messageNum-e>=c.PACKET_BACKUP)return null;var t=k.snapshots[e%c.PACKET_BACKUP];if(!t.valid)return null;if(k.parseEntitiesNum-t.parseEntitiesNum>=y)return null;var n=t.clone();n.entities=new Array(n.numEntities);for(var r=0;r<n.numEntities;r++)n.entities[r]=k.parseEntities[(n.parseEntitiesNum+r)%y];return n}function lt(){c.AddCmd("bind",ct),c.AddCmd("unbind",ht),c.AddCmd("unbindall",pt),c.AddCmd("connect",dt),c.AddCmd("message",vt),c.AddCmd("+attack",function(){L.inButtons[0]=L.lastKey}),c.AddCmd("-attack",function(){}),c.AddCmd("+forward",function(){L.inForward=L.lastKey}),c.AddCmd("-forward",function(){}),c.AddCmd("+left",function(){L.inLeft=L.lastKey}),c.AddCmd("-left",function(){}),c.AddCmd("+back",function(){L.inBack=L.lastKey}),c.AddCmd("-back",function(){}),c.AddCmd("+right",function(){L.inRight=L.lastKey}),c.AddCmd("-right",function(){}),c.AddCmd("+jump",function(){L.inUp=L.lastKey}),c.AddCmd("-jump",function(){})}function ct(e,t){var n=xt(e);n.binding=t,c.cvarModifiedFlags|=s.CVF.ARCHIVE}function ht(e,t){var n=xt(e);delete n.binding}function pt(){for(var e in L.keys){if(!L.keys.hasOwnProperty(e))continue;delete L.keys[e].binding}}function dt(e){var t=e.split(":"),n=t[0],r=t[1],i=c.StringToAddr(e);if(!i){O("Bad server address",e);return}R(!1),C.Running()&&e!=="localhost"&&C.Kill(),A.serverAddress=i,A.state=E.CHALLENGING,A.connectTime=-99999,A.connectPacketCount=0}function vt(){v.PushMenu("message")}function Et(){mt=c.AddCvar("name","UnnamedPlayer",s.CVF.ARCHIVE|s.CVF.USERINFO),gt=c.AddCvar("model","sarge",s.CVF.ARCHIVE|s.CVF.USERINFO),yt=c.AddCvar("cl_sensitivity",2,s.CVF.ARCHIVE),bt=c.AddCvar("cl_showTimeDelta",0,s.CVF.ARCHIVE),wt=c.AddCvar("cl_timeNudge",0,s.CVF.ARCHIVE)}function St(e,t){L.keyCallback=e,L.mouseMoveCallback=t}function xt(e){var t=L.keys[e];return t||(t=L.keys[e]=new N,t.chr=e),t}function Tt(e){var t=[];for(var n in L.keys){if(!L.keys.hasOwnProperty(n))continue;var r=L.keys[n];r.binding===e&&t.push(n)}return t}function Nt(e,t){var n=xt(t);if(n.active)return;L.lastKey=n;if(t==="`"&&A.state==E.ACTIVE){if(!L.keyCallback){var r=v.GetView("main");r.setConnected(!0),v.PushMenu(r),r.showCurrentGameMenu()}else v.PopAllMenus();return}L.keyCallback?L.keyCallback(t):(n.downtime=e,n.active=!0,n.wasPressed=!0,At(n,!0))}function Ct(e,t){var n=xt(t);L.keyCallback||(n.partial+=e-n.downtime),n.active=!1,At(n,!1)}function kt(e,t,n){L.mouseMoveCallback?L.mouseMoveCallback(t,n):(k.mouseX[k.mouseIndex]+=t,k.mouseY[k.mouseIndex]+=n)}function Lt(e){var t=e.partial;e.partial=0,e.active&&(t+=c.frameTime-e.downtime),e.downtime=c.frameTime;var n=t/L.frameDelta;return n<0&&(n=0),n>1&&(n=1),n}function At(e,t){var n=e.binding;if(!n)return;if(!t){if(n.charAt(0)!=="+")return;n="-"+n.substr(1)}c.ExecuteBuffer(n)}function Ot(e){for(var t in L.keys){if(!L.keys.hasOwnProperty(t))continue;var n=xt(t);n.binding&&(e+="bind "+t+' "'+n.binding+'"\n')}return e}function Mt(){if(A.state<E.CONNECTED)return;_t(),Ft()}function _t(){if(A.state<E.PRIMED)return;k.cmdNumber++,k.cmds[k.cmdNumber%s.CMD_BACKUP]=Dt()}function Dt(){var e=new s.UserCmd;return Pt(e),Ht(e),Bt(e),e.weapon=k.cgameWeapon,e.serverTime=k.serverTime,e}function Pt(e){for(var t=0;t<15;t++){var n=L.inButtons[t];if(!n)continue;if(n.active||n.wasPressed)e.buttons|=1<<t;n.wasPressed=!1}}function Ht(e){var t,n=0,r=0,i=0;t=127,L.inForward&&(n+=t*Lt(L.inForward)),L.inBack&&(n-=t*Lt(L.inBack)),L.inRight&&(r+=t*Lt(L.inRight)),L.inLeft&&(r-=t*Lt(L.inLeft)),L.inUp&&(i+=t*Lt(L.inUp)),e.forwardmove=Math.max(-127,Math.min(n,127)),e.rightmove=Math.max(-127,Math.min(r,127)),e.upmove=Math.max(-127,Math.min(i,127))}function Bt(e){var t=vec3.create(k.viewangles),n=(k.mouseX[0]+k.mouseX[1])*.5,r=(k.mouseY[0]+k.mouseY[1])*.5;k.mouseIndex^=1,k.mouseX[k.mouseIndex]=0,k.mouseY[k.mouseIndex]=0,n*=yt(),r*=yt(),n*=k.cgameSensitivity,r*=k.cgameSensitivity,k.viewangles[i.YAW]-=n*.022,k.viewangles[i.PITCH]+=r*.022,k.viewangles[i.PITCH]-t[i.PITCH]>90?k.viewangles[i.PITCH]=t[i.PITCH]+90:t[i.PITCH]-k.viewangles[i.PITCH]>90&&(k.viewangles[i.PITCH]=t[i.PITCH]-90),e.angles[0]=i.AngleToShort(k.viewangles[0]),e.angles[1]=i.AngleToShort(k.viewangles[1]),e.angles[2]=i.AngleToShort(k.viewangles[2])}function Ft(){var e=new r(jt,r.LITTLE_ENDIAN),t=parseInt(k.serverId,10);e.writeInt(t),e.writeInt(A.serverMessageSequence),e.writeInt(A.serverCommandSequence);for(var n=A.reliableAcknowledge+1;n<=A.reliableSequence;n++){var i=A.reliableCommands[n%c.MAX_RELIABLE_COMMANDS];e.writeByte(c.CLM.clientCommand),e.writeInt(n),e.writeCString(JSON.stringify(i))}var i,o,u=(A.netchan.outgoingSequence-1)%c.PACKET_BACKUP,a=k.cmdNumber-k.outPackets[u].cmdNumber;if(a>1){c.error("Invalid cmd number.");return}if(a>=1){!k.snap||!k.snap.valid||A.serverMessageSequence!==k.snap.messageNum?e.writeByte(c.CLM.moveNoDelta):e.writeByte(c.CLM.move),e.writeByte(a);for(var n=0;n<a;n++){var f=(k.cmdNumber-a+n+1)%s.CMD_BACKUP,i=k.cmds[f];c.WriteDeltaUsercmd(e,o,i),o=i}}e.writeByte(c.CLM.EOF);var l=A.netchan.outgoingSequence%c.PACKET_BACKUP;k.outPackets[l].realTime=L.realTime,k.outPackets[l].serverTime=o?o.serverTime:0,k.outPackets[l].cmdNumber=k.cmdNumber,c.NetchanSend(A.netchan,e.buffer,e.index)}function It(e){A.reliableAcknowledge=e.readInt(),A.reliableAcknowledge<A.reliableSequence-c.MAX_RELIABLE_COMMANDS&&(A.reliableAcknowledge=A.reliableSequence);var t=e.readByte();t===c.SVM.serverCommand?qt(e):t===c.SVM.gamestate?Rt(e):t===c.SVM.snapshot?Wt(e):c.Error("Bad message type",t)}function qt(e){var t=e.readInt(),n=JSON.parse(e.readCString());if(A.serverCommandSequence>=t)return;A.serverCommandSequence=t;var r=t%c.MAX_RELIABLE_COMMANDS;A.serverCommands[r]=n}function Rt(e){var t=new s.EntityState;k=new b,A.serverCommandSequence=e.readInt(),O("Parsing game state",A.serverCommandSequence);for(;;){var n=e.readByte();if(n===c.SVM.EOF)break;if(n===c.SVM.configstring){var r=JSON.parse(e.readCString());k.gameState[r.k]=r.v}else if(n===c.SVM.baseline){var i=e.readShort();(i<0||i>=s.MAX_GENTITIES)&&c.Error("Baseline number out of range:",i);var o=k.entityBaselines[i];c.ReadDeltaEntityState(e,t,o,i)}else c.Error("ParseGamestate: bad command byte")}A.clientNum=e.readInt(),Ut(),Q()}function Ut(){for(var e in k.gameState){if(!k.gameState.hasOwnProperty(e))continue;et(e,k.gameState[e])}}function zt(){var e=k.gameState.systemInfo;k.serverId=e.sv_serverid,c.SetCvarVal("pmove_fixed",e.pmove_fixed),c.SetCvarVal("pmove_msec",e.pmove_msec)}function Wt(e){var t=new T;t.messageNum=A.serverMessageSequence,t.serverCommandNum=A.serverCommandSequence,t.serverTime=e.readInt();var n=e.readByte();n?t.deltaNum=t.messageNum-n:t.deltaNum=-1,t.snapFlags=e.readInt();var r;t.deltaNum<=0?t.valid=!0:(r=k.snapshots[t.deltaNum%c.PACKET_BACKUP],r.valid?r.messageNum!==t.deltaNum?O("Delta frame too old."):k.parseEntitiesNum-r.parseEntitiesNum>y-128?O("Delta parseEntitiesNum too old."):t.valid=!0:O("Delta from invalid frame (not supposed to happen!).")),r?c.ReadDeltaPlayerState(e,r.ps,t.ps):c.ReadDeltaPlayerState(e,r,t.ps),Xt(e,r,t);if(!t.valid)return;var i=k.snap.messageNum+1;t.messageNum-i>=c.PACKET_BACKUP&&(i=t.messageNum-(c.PACKET_BACKUP-1));for(;i<t.messageNum;i++)k.snapshots[i%c.PACKET_BACKUP].valid=!1;k.snap=t,k.snap.ping=999;for(var s=0;s<c.PACKET_BACKUP;s++){var o=(A.netchan.outgoingSequence-1-s)%c.PACKET_BACKUP;if(k.snap.ps.commandTime>=k.outPackets[o].serverTime){k.snap.ping=L.realTime-k.outPackets[o].realTime;break}}k.snapshots[k.snap.messageNum%c.PACKET_BACKUP]=k.snap,k.newSnapshots=!0}function Xt(e,t,n){var r,i,o,u,a;n.parseEntitiesNum=k.parseEntitiesNum,n.numEntities=0,u=0,o=null,t?u>=t.numEntities?r=99999:(o=k.parseEntities[(t.parseEntitiesNum+u)%y],r=o.number):r=99999;for(;;){var i=e.readShort();if(i===s.MAX_GENTITIES-1)break;while(r<i)Vt(e,n,r,o,!0),u++,u>=t.numEntities?r=99999:(o=k.parseEntities[(t.parseEntitiesNum+u)%y],r=o.number);if(r===i){Vt(e,n,i,o,!1),u++,u>=t.numEntities?r=99999:(o=k.parseEntities[(t.parseEntitiesNum+u)%y],r=o.number);continue}if(r>i){Vt(e,n,i,k.entityBaselines[i],!1);continue}}while(r!==99999)Vt(e,n,r,o,!0),u++,u>=t.numEntities?r=99999:(o=k.parseEntities[(t.parseEntitiesNum+u)%y],r=o.number)}function Vt(e,t,n,r,i){var o=k.parseEntities[k.parseEntitiesNum%y];i?r.clone(o):c.ReadDeltaEntityState(e,r,o,n);if(o.number===s.MAX_GENTITIES-1)return;k.parseEntitiesNum++,t.numEntities++}var n=e.sys,c=e.com,h=u.CreateInstance(X()),p=a.CreateInstance(V()),d=f.CreateInstance($()),v=l.CreateInstance(J()),m=o.CreateInstance(K()),g=3e3,y=c.PACKET_BACKUP*64,b=function(){this.snap=new T,this.serverTime=0,this.oldServerTime=0,this.oldFrameServerTime=0,this.serverTimeDelta=0,this.extrapolatedSnapshot=!1,this.newSnapshots=!1,this.gameState=[],this.mouseX=[0,0],this.mouseY=[0,0],this.mouseIndex=0,this.viewangles=vec3.create(),this.serverId=0,this.cgameWeapon=0,this.cgameSensitivity=0,this.cmds=new Array(s.CMD_BACKUP),this.cmdNumber=0,this.outPackets=new Array(c.PACKET_BACKUP),this.snapshots=new Array(c.PACKET_BACKUP),this.entityBaselines=new Array(s.MAX_GENTITIES),this.parseEntities=new Array(y),this.parseEntitiesNum=0;for(var e=0;e<c.PACKET_BACKUP;e++)this.outPackets[e]=new x;for(var e=0;e<c.PACKET_BACKUP;e++)this.snapshots[e]=new T;for(var e=0;e<s.CMD_BACKUP;e++)this.cmds[e]=new s.UserCmd;for(var e=0;e<s.MAX_GENTITIES;e++)this.entityBaselines[e]=new s.EntityState;for(var e=0;e<y;e++)this.parseEntities[e]=new s.EntityState},w=function(){this.initialized=!1,this.realTime=0,this.keyCallback=!1,this.mouseMoveCallback=!1,this.keys={},this.lastKey=null,this.inButtons=new Array(15),this.inForward=null,this.inLeft=null,this.inBack=null,this.inRight=null,this.inUp=null},E={DISCONNECTED:0,CONNECTING:1,CHALLENGING:2,CONNECTED:3,LOADING:4,PRIMED:5,ACTIVE:6},S=function(){this.state=E.DISCONNECTED,this.clientNum=-1,this.lastPacketTime=0,this.servername=null,this.serverAddress=null,this.connectTime=0,this.connectPacketCount=0,this.serverMessageSequence=0,this.reliableSequence=0,this.reliableAcknowledge=0,this.reliableCommands=new Array(c.MAX_RELIABLE_COMMANDS),this.serverCommandSequence=0,this.lastExecutedServerCommand=0,this.serverCommands=new Array(c.MAX_RELIABLE_COMMANDS),this.netchan=null},x=function(){this.cmdNumber=0,this.serverTime=0,this.realTime=0},T=function(){this.valid=!1,this.snapFlags=0,this.serverTime=0,this.messageNum=0,this.deltaNum=0,this.ping=0,this.areamask=new Array(c.MAX_MAP_AREA_BYTES),this.cmdNum=0,this.ps=new s.PlayerState,this.numEntities=0,this.parseEntitiesNum=0,this.serverCommandNum=0};T.prototype.clone=function(e){typeof e=="undefined"&&(e=new T),e.valid=this.valid,e.snapFlags=this.snapFlags,e.serverTime=this.serverTime,e.messageNum=this.messageNum,e.deltaNum=this.deltaNum,e.ping=this.ping;for(var t=0;t<c.MAX_MAP_AREA_BYTES;t++)e.areamask[t]=this.areamask[t];return e.cmdNum=this.cmdNum,this.ps.clone(e.ps),e.numEntities=this.numEntities,e.parseEntitiesNum=this.parseEntitiesNum,e.serverCommandNum=this.serverCommandNum,e};var N=function(){this.chr=null,this.active=!1,this.wasPressed=!1,this.downtime=0,this.partial=0,this.binding=null},C,k,L,A,it=500,mt,gt,yt,bt,wt,jt=new ArrayBuffer(c.MAX_MSGLEN);return{ClientSnapshot:T,Init:M,InitCGame:Q,ShutdownCGame:G,InitSubsystems:_,ShutdownSubsystems:D,Frame:P,ForwardCommandToServer:H,MapLoading:q,Disconnect:R,PacketEvent:z,KeyDownEvent:Nt,KeyUpEvent:Ct,MouseMoveEvent:kt,WriteBindings:Ot}}return{CreateInstance:function(e){return new c(e)}}}),define("common/com",["underscore","ByteBuffer","common/bsp-serializer","common/map-serializer","common/map-compiler","common/qmath","common/qshared","server/sv","client/cl"],function(e,t,n,r,i,s,o,u,a){function b(){w("set",C),w("unset",k),w("echo",L),w("exec",S)}function w(e,t){y[e]=t}function E(e){return y[e]}function S(e,t){if(!e){console.log("Enter a filename to execeute.");return}j.ReadFile(e,"utf8",function(n,r){if(n){V("Failed to execute '"+e+"'"),t&&t(n);return}r=r.replace(/^\s+|\s+$/g,"");var i=r.split(/\r\n|\r|\n/);for(var s=0;s<i.length;s++)Z(i[s]);t&&t()})}function N(){}function C(e,t){var n=O(e);n(t)}function k(e,t){var n=O(e);n(n.defaultValue)}function L(e){var t=M(e);if(!t)return;V(e,"is:",t(),", default:",t.defaultValue)}function O(e,t,n){var r=M(e);return r?(typeof t!="undefined"&&(r.defaultValue=t),typeof n!="undefined"&&(r.flags=n),P(e),r):(r=x[e]=new A(t,n),r)}function M(e){return x[e]}function _(e){var t=M(e);return t?t():null}function D(e,t){C(e,t)}function P(e){var t=M(e);return t?t.latchedValue===t.currentValue?!1:(t.latchedValue=t.currentValue,!0):!1}function H(e){var t={};for(var n in x){if(!x.hasOwnProperty(n))continue;var r=x[n];if(!(r.flags&e))continue;t[n]=r()}return t}function B(e){for(var t in x){if(!x.hasOwnProperty(t))continue;var n=x[t];if(!(n.flags&o.CVF.ARCHIVE))continue;e+="set "+t+" "+n()+"\n"}return e}function V(){var e=Array.prototype.slice.call(arguments);e.splice(0,0,"COM:"),Function.apply.call(console.log,console,e)}function $(e){V(e),F.Kill(),I.Disconnect(),j.Error(e,!1)}function J(e,t){j=e,F=u.CreateInstance(rt()),q=!!t,R=[],U=z=j.GetMilliseconds(),W=!1,X=!1,N(),b(),q?F.Init(null,t):(I=a.CreateInstance(rt()),I.Init(F),F.Init(I,null)),tt(),W=!0}function K(){z=U,U=j.GetMilliseconds();var e=U-z;et(),Q(),F.Frame(e),q||I.Frame(e)}function Q(){var e=R.shift();while(e){switch(e.type){case l.KEY:e.pressed?I.KeyDownEvent(e.time,e.keyName):I.KeyUpEvent(e.time,e.keyName);break;case l.MOUSE:I.MouseMoveEvent(e.time,e.deltaX,e.deltaY)}e=R.shift()}}function G(e){e.time=j.GetMilliseconds(),R.push(e)}function Z(e){var t=[],n;while(n=Y.exec(e))t.push(n[1]||n[2]);var r=E(t[0]);if(r){r.apply(this,t.slice(1));return}if(r===null){I.ForwardCommandToServer(t);return}V("Unknown command '"+t[0]+"'")}function et(){if(!W||!X)return;if(!(T&o.CVF.ARCHIVE))return;T&=~o.CVF.ARCHIVE,nt()}function tt(){S("default.cfg",function(){S("q3config.cfg",function(){X=!0,T&=~o.CVF.ARCHIVE})})}function nt(e){var t="q3config.cfg",n="";n=I.WriteBindings(n),n=B(n),console.log("Saving config to",t),j.WriteFile(t,n,"utf8",e)}function rt(){var e={com:{MAX_MAP_AREA_BYTES:f,PACKET_BACKUP:c,MAX_PACKET_USERCMDS:h,MAX_RELIABLE_COMMANDS:p,MAX_MSGLEN:d,CLM:v,SVM:m,Error:$,ExecuteBuffer:Z,LoadConfig:tt,SaveConfig:nt,AddCmd:w,GetCmd:E,AddCvar:O,GetCvarVal:_,SetCvarVal:D,RelatchCvar:P,GetCvarValues:H,WriteDeltaUsercmd:mt,ReadDeltaUsercmd:gt,WriteDeltaPlayerState:wt,ReadDeltaPlayerState:Et,WriteDeltaEntityState:xt,ReadDeltaEntityState:Tt,NetchanSetup:Mt,NetchanDestroy:_t,NetchanSend:Pt,NetchanPrint:Ht,NetchanProcess:Bt,StringToAddr:jt,LoadBsp:Ft,LoadMap:It},sys:j};return Object.defineProperty(e.com,"frameTime",{get:function(){return U}}),Object.defineProperty(e.com,"cvarModifiedFlags",{get:function(){return T},set:function(e){T=e}}),e}function ft(e){var t=e.match(/([^\.\[\]]+)/g);return t}function lt(e,t){var n,r;for(n=0,r=t.length;n<r-1;n++)e=e[t[n]];return e[t[r-1]]}function ct(e,t,n){var r,i;for(r=0,i=t.length;r<i-1;r++)e=e[t[r]];e[t[i-1]]=n}function ht(e){switch(e){case it:return"readFloat";case st:return"readByte";case ot:return"readUnsignedByte";case ut:return"readUnsignedShort";case at:return"readUnsignedInt";default:throw new Error("fnread: bad bit count "+e)}}function pt(e){switch(e){case it:return"writeFloat";case st:return"writeByte";case ot:return"writeUnsignedByte";case ut:return"writeUnsignedShort";case at:return"writeUnsignedInt";default:throw new Error("fnwrite: bad bit count "+e)}}function mt(e,t,n){t||(t=dt),e.writeInt(n.serverTime),e.writeUnsignedShort(n.angles[0]),e.writeUnsignedShort(n.angles[1]),e.writeUnsignedShort(n.angles[2]),e.writeByte(n.forwardmove),e.writeByte(n.rightmove),e.writeByte(n.upmove),e.writeUnsignedShort(n.buttons),e.writeUnsignedByte(n.weapon)}function gt(e,t,n){n.serverTime=e.readInt(),n.angles[0]=e.readUnsignedShort(),n.angles[1]=e.readUnsignedShort(),n.angles[2]=e.readUnsignedShort(),n.forwardmove=e.readByte(),n.rightmove=e.readByte(),n.upmove=e.readByte(),n.buttons=e.readUnsignedShort(),n.weapon=e.readUnsignedByte()}function wt(e,t,n){var r,i,s,u,a,f;t||(t=bt),i=0;for(r=0;r<yt.length;r++)s=yt[r],u=lt(t,s.path),a=lt(n,s.path),u!==a&&i++;e.writeByte(i);for(r=0;r<yt.length;r++){s=yt[r],u=lt(t,s.path),a=lt(n,s.path);if(u===a)continue;f=pt(s.bits),e.writeByte(r),e[f](lt(n,s.path))}if(o.MAX_STATS>16||o.MAX_PERSISTANT>16||o.MAX_POWERUPS>16||o.MAX_WEAPONS>16)throw new Error("Array maxes exceed bitmask length");var l=0,c=0,h=0,p=0;for(r=0;r<o.MAX_STATS;r++)n.stats[r]!==t.stats[r]&&(l|=1<<r);for(r=0;r<o.MAX_PERSISTANT;r++)n.persistant[r]!==t.persistant[r]&&(c|=1<<r);for(r=0;r<o.MAX_POWERUPS;r++)n.powerups[r]!==t.powerups[r]&&(h|=1<<r);for(r=0;r<o.MAX_WEAPONS;r++)n.ammo[r]!==t.ammo[r]&&(p|=1<<r);var d=(l?1:0)|(c?2:0)|(h?4:0)|(p?8:0);e.writeByte(d);if(l){e.writeShort(l);for(r=0;r<o.MAX_STATS;r++)l&1<<r&&e.writeShort(n.stats[r])}if(c){e.writeShort(c);for(r=0;r<o.MAX_PERSISTANT;r++)c&1<<r&&e.writeShort(n.persistant[r])}if(h){e.writeShort(h);for(r=0;r<o.MAX_POWERUPS;r++)h&1<<r&&e.writeShort(n.powerups[r])}if(p){e.writeShort(p);for(r=0;r<o.MAX_WEAPONS;r++)p&1<<r&&e.writeShort(n.ammo[r])}}function Et(e,t,n){var r,i,s,u,a,f,l;t||(t=bt),t.clone(n),i=e.readByte();for(r=0;r<i;r++)s=e.readByte(),u=yt[s],l=ht(u.bits),ct(n,u.path,e[l]());var c=e.readByte();if(c&1){var h=e.readShort();for(r=0;r<o.MAX_STATS;r++)h&1<<r&&(n.stats[r]=e.readShort())}if(c&2){var p=e.readShort();for(r=0;r<o.MAX_PERSISTANT;r++)p&1<<r&&(n.persistant[r]=e.readShort())}if(c&4){var d=e.readShort();for(r=0;r<o.MAX_POWERUPS;r++)d&1<<r&&(n.powerups[r]=e.readShort())}if(c&8){var v=e.readShort();for(r=0;r<o.MAX_WEAPONS;r++)v&1<<r&&(n.ammo[r]=e.readShort())}}function xt(e,t,n,r){var i,s,u,a,f,l;if(n===null){if(t===null)return;e.writeShort(t.number),e.writeByte(1);return}if(n.number<0||n.number>=o.MAX_GENTITIES)throw new Error("WriteDeltaEntityState: Bad entity number: ",n.number);s=0;for(i=0;i<St.length;i++)u=St[i],a=lt(t,u.path),f=lt(n,u.path),a!==f&&s++;if(s===0){if(!r)return;e.writeShort(n.number),e.writeByte(0);return}e.writeShort(n.number),e.writeByte(2),e.writeByte(s);for(i=0;i<St.length;i++){u=St[i],a=lt(t,u.path),f=lt(n,u.path);if(a===f)continue;l=pt(u.bits),e.writeByte(i),e[l](lt(n,u.path))}}function Tt(e,t,n,r){var i,s,u,a,f,l,c;if(r<0||r>=o.MAX_GENTITIES)throw new Error("Bad delta entity number: ",r);var h=e.readByte(),p=h&1,d=h&2;if(p){n.reset(),n.number=o.MAX_GENTITIES-1;return}t.clone(n),n.number=r;if(!d)return;s=e.readByte();for(i=0;i<s;i++)u=e.readByte(),a=St[u],c=ht(a.bits),ct(n,a.path,e[c]())}function Mt(e,t,n){var r=new g;r.src=e;if(t instanceof o.NetAdr)r.remoteAddress=t,r.remoteAddress.type===o.NA.LOOPBACK?r.msocket={}:r.msocket=j.NetConnect(r.remoteAddress);else{var i=new o.NetAdr;i.type=o.NA.IP,r.remoteAddress=i,r.msocket=t}return r.msocket.onopen=function(){r.ready=!0,n.onopen&&n.onopen()},r.msocket.onmessage=function(e){n.onmessage&&n.onmessage(e)},r.msocket.onclose=function(e){n.onclose&&n.onclose(e)},r.remoteAddress.type===o.NA.LOOPBACK&&(Lt[e]=r.msocket.onmessage,r.msocket.onopen()),r}function _t(e){e.ready=!1;if(e.remoteAddress.type===o.NA.LOOPBACK)return;j.NetClose(e.msocket)}function Dt(e,t,n){var r=kt[e.src];t=t.slice(0,n),r.msgs[r.send++%Ct]=t;var i=e.src===o.NS.CLIENT?o.NS.SERVER:o.NS.CLIENT,s=Lt[i];if(!s){$("No loopback handler for",i===o.NS.CLIENT?"client":"server");return}s(t)}function Pt(e,n,r){var i=new t(At,t.LITTLE_ENDIAN),s=new Uint8Array(n);i.writeInt(e.outgoingSequence++);for(var u=0;u<r;u++)i.writeUnsignedByte(s[u]);if(e.remoteAddress.type===o.NA.LOOPBACK){Dt(e,i.buffer,i.index);return}j.NetSend(e.msocket,i.buffer,i.index)}function Ht(e,n){var r=new t(At,t.LITTLE_ENDIAN);r.writeInt(-1),r.writeCString(n);if(e.remoteAddress.type===o.NA.LOOPBACK){Dt(e,r.buffer,r.index);return}j.NetSend(e.msocket,r.buffer,r.index)}function Bt(e,t){var n=t.readInt();return e.incomingSequence=n,!0}function jt(e){var t=new o.NetAdr;if(e.indexOf("localhost")!==-1)return t.type=o.NA.LOOPBACK,t;t.type=o.NA.IP;var n=e.split(":");if(!n.length)return null;var r=parseInt(n[1],10);return isNaN(r)?null:(t.ip=n[0],t.port=r,t)}function Ft(e,t){j.ReadFile("maps/"+e+".bsp","binary",function(e,r){if(e)return t(e);var i=n.deserialize(r);t(null,i)})}function It(e,t){j.ReadFile("maps/"+e+".map","utf8",function(e,n){if(e)return t(e);var s=r.deserialize(n),o=i.compile(s);t(null,o)})}var f=32,l={CLNETMSG:0,SVNETMSG:1,SVNETCLOSE:2,KEY:3,MOUSE:4},c=32,h=32,p=64,d=16384,v={bad:0,move:1,moveNoDelta:2,clientCommand:3,EOF:4},m={bad:0,gamestate:1,configstring:2,baseline:3,serverCommand:4,snapshot:5,EOF:6},g=function(){this.src=0,this.remoteAddress=null,this.incomingSequence=0,this.outgoingSequence=1,this.ready=!1,this.msocket=null},y={},x={},T=0,A=function(e,t){e=typeof e=="undefined"?0:e,t=typeof t=="undefined"?0:t;var n=function(e){if(!arguments.length)return t&o.CVF.LATCH?n.latchedValue:n.currentValue;var r=n.currentValue;isNaN(e)?n.currentValue=e:n.currentValue=+e,T|=n.flags};return n.defaultValue=e,n.currentValue=e,n.latchedValue=e,n.flags=t,n},j,F,I,q,R,U,z,W,X,Y=/([^"\s]+)|"([^"]+)"/g,it=0,st=1,ot=2,ut=3,at=4,dt=new o.UserCmd,vt=[{path:ft("angles[0]"),bits:ut},{path:ft("angles[1]"),bits:ut},{path:ft("angles[2]"),bits:ut},{path:ft("forwardmove"),bits:ot},{path:ft("rightmove"),bits:ot},{path:ft("upmove"),bits:ot},{path:ft("buttons"),bits:ut},{path:ft("weapon"),bits:ot}],yt=[{path:ft("commandTime"),bits:at},{path:ft("origin[0]"),bits:it},{path:ft("origin[1]"),bits:it},{path:ft("bobCycle"),bits:ot},{path:ft("velocity[0]"),bits:it},{path:ft("velocity[1]"),bits:it},{path:ft("viewangles[1]"),bits:it},{path:ft("viewangles[0]"),bits:it},{path:ft("weaponTime"),bits:ut},{path:ft("origin[2]"),bits:it},{path:ft("velocity[2]"),bits:it},{path:ft("legsTimer"),bits:ot},{path:ft("pm_time"),bits:ut},{path:ft("eventSequence"),bits:ut},{path:ft("torsoAnim"),bits:ot},{path:ft("movementDir"),bits:ot},{path:ft("events[0]"),bits:ot},{path:ft("legsAnim"),bits:ot},{path:ft("events[1]"),bits:ot},{path:ft("pm_flags"),bits:ut},{path:ft("groundEntityNum"),bits:ut},{path:ft("weaponState"),bits:ot},{path:ft("eFlags"),bits:ut},{path:ft("externalEvent"),bits:ut},{path:ft("gravity"),bits:ut},{path:ft("speed"),bits:ut},{path:ft("delta_angles[1]"),bits:ut},{path:ft("externalEventParm"),bits:ot},{path:ft("viewheight"),bits:ot},{path:ft("damageEvent"),bits:ot},{path:ft("damageYaw"),bits:ot},{path:ft("damagePitch"),bits:ot},{path:ft("damageCount"),bits:ot},{path:ft("generic1"),bits:ot},{path:ft("pm_type"),bits:ot},{path:ft("delta_angles[0]"),bits:ut},{path:ft("delta_angles[2]"),bits:ut},{path:ft("torsoTimer"),bits:ut},{path:ft("eventParms[0]"),bits:ot},{path:ft("eventParms[1]"),bits:ot},{path:ft("clientNum"),bits:ot},{path:ft("weapon"),bits:ot},{path:ft("viewangles[2]"),bits:it},{path:ft("jumppad_ent"),bits:ut},{path:ft("loopSound"),bits:ut}],bt=new o.PlayerState,St=[{path:ft("pos.trTime"),bits:at},{path:ft("pos.trBase[0]"),bits:it},{path:ft("pos.trBase[1]"),bits:it},{path:ft("pos.trDelta[0]"),bits:it},{path:ft("pos.trDelta[1]"),bits:it},{path:ft("pos.trBase[2]"),bits:it},{path:ft("apos.trBase[1]"),bits:it},{path:ft("pos.trDelta[2]"),bits:it},{path:ft("apos.trBase[0]"),bits:it},{path:ft("event"),bits:ut},{path:ft("angles2[1]"),bits:it},{path:ft("eType"),bits:ot},{path:ft("torsoAnim"),bits:ot},{path:ft("eventParm"),bits:ot},{path:ft("legsAnim"),bits:ot},{path:ft("groundEntityNum"),bits:ut},{path:ft("pos.trType"),bits:ot},{path:ft("eFlags"),bits:at},{path:ft("otherEntityNum"),bits:ut},{path:ft("weapon"),bits:ot},{path:ft("clientNum"),bits:ot},{path:ft("angles[1]"),bits:it},{path:ft("pos.trDuration"),bits:at},{path:ft("apos.trType"),bits:ot},{path:ft("origin[0]"),bits:it},{path:ft("origin[1]"),bits:it},{path:ft("origin[2]"),bits:it},{path:ft("solid"),bits:at},{path:ft("powerups"),bits:ut},{path:ft("modelIndex"),bits:ot},{path:ft("otherEntityNum2"),bits:ut},{path:ft("loopSound"),bits:ot},{path:ft("generic1"),bits:ot},{path:ft("origin2[2]"),bits:it},{path:ft("origin2[0]"),bits:it},{path:ft("origin2[1]"),bits:it},{path:ft("modelIndex2"),bits:ot},{path:ft("angles[0]"),bits:it},{path:ft("time"),bits:at},{path:ft("apos.trTime"),bits:at},{path:ft("apos.trDuration"),bits:at},{path:ft("apos.trBase[2]"),bits:it},{path:ft("apos.trDelta[0]"),bits:it},{path:ft("apos.trDelta[1]"),bits:it},{path:ft("apos.trDelta[2]"),bits:it},{path:ft("time2"),bits:at},{path:ft("angles[2]"),bits:it},{path:ft("angles2[0]"),bits:it},{path:ft("angles2[2]"),bits:it},{path:ft("constantLight"),bits:at},{path:ft("frame"),bits:ut}],Nt=1400,Ct=16,kt=[{msgs:new Array(Ct),send:0},{msgs:new Array(Ct),send:0}],Lt=[],At=new ArrayBuffer(d),Ot=0;return{PACKET_BACKUP:c,SE:l,Init:J,Frame:K,ExecuteBuffer:Z,QueueEvent:G}}),define("system/browser/sys",["underscore","gameshim","glmatrix","common/qshared","common/com"],function(e,t,n,r,i){function g(){var e=Array.prototype.slice.call(arguments);e.splice(0,0,"SYS:"),Function.apply.call(console.log,console,e)}function y(e,t){var n=document.getElementById("error-wrapper");n&&h.removeChild(n),n=document.createElement("div"),n.setAttribute("id","error-wrapper");if(t){var r=document.createElement("div");r.setAttribute("id","error-fatal"),r.innerHTML=e,n.appendChild(r),h.innerHTML="",h.appendChild(n)}else{var r=document.createElement("div");r.setAttribute("id","error-dialog"),n.appendChild(r);var i=document.createElement("div");i.innerHTML=e,r.appendChild(i);var s=document.createElement("div");s.setAttribute("class","accept"),s.innerHTML="OK",s.onclick=function(){h.removeChild(n),p.requestPointerLock()},r.appendChild(s),h.appendChild(n)}throw document.exitPointerLock(),new Error(e)}function b(e,t){function n(e){window.requestAnimationFrame(n,d),i.Frame()}if(t!==undefined&&t!==s){y("Requested game version '"+t+"'"+" does not match received game version '"+s+"'");return}h=e,setMatrixArrayType(Array),w(),m=T(d,["webgl","experimental-webgl"]);if(!m){y('Sorry, but your browser does not support WebGL or does not have it enabled. To get a WebGL-enabled browser, please see:<br /><br /><a href="http://get.webgl.org/" target="_blank">http://get.webgl.org/</a>',!0);return}i.Init(_(),null),W(),E(),S(),window.requestAnimationFrame(n,d)}function w(){h.innerHTML=c(),p=document.getElementById("viewport-frame"),d=document.getElementById("viewport"),v=document.getElementById("viewport-ui");for(var e=0;e<u.length;e++){var t=document.createElement("style");t.setAttribute("type","text/css"),t.innerHTML=u[e],document.getElementsByTagName("head")[0].appendChild(t)}d.width=p.offsetWidth,d.height=p.offsetHeight,document.addEventListener("fullscreenchange",N),window.addEventListener("resize",N)}function E(){window.$=function(e){i.ExecuteBuffer(e)}}function S(){var e=x();for(var t=0;t<e.length;t++)i.ExecuteBuffer(e[t])}function x(){var e,t=/\+/g,n=/([^&=]+)/g,r=function(e){return decodeURIComponent(e.replace(t," "))},i=window.location.search.substring(1),s=[];while(e=n.exec(i))s.push(r(e[1]));return s}function T(e,t){if(e.getContext)for(var n=0;n<t.length;++n)try{var r=e.getContext(t[n],{antialias:!1});if(r!==null)return r}catch(i){}return null}function N(){document.fullscreenElement?(d.width=screen.width,d.height=screen.height,p.requestPointerLock()):(d.width=p.offsetWidth,d.height=p.offsetHeight)}function C(){return d.width}function k(){return d.height}function L(){return m}function A(){return v}function M(){return Date.now()-O}function _(){return{Error:y,GetMilliseconds:M,CancelFileCallbacks:B,ReadFile:I,WriteFile:U,GetViewportWidth:C,GetViewportHeight:k,GetGLContext:L,GetUIContext:A,NetListen:nt,NetConnect:rt,NetSend:it,NetClose:st}}function B(e){var t=D[e];if(!t)return;for(var n=0;n<t.length;n++)t[n].active=!1}function j(e,t){var n=function(){if(!n.active)return;return t.apply(this,arguments)};return n.active=!0,D[e]||(D[e]=[]),D[e].push(n),n}function F(e,t){if(P)return e(P);if(window.storageInfo===undefined||window.requestFileSystem===undefined)return t(new Error("Browser does not support FileSystem APIs"));window.storageInfo.requestQuota(window.PERSISTENT,1048576,function(n){window.requestFileSystem(window.PERSISTENT,n,function(t){return P=t,e(t)},t)},t)}function I(e,t,n,r){typeof r!="undefined"&&(n=j(r,n));var i=H.indexOf(e)>-1;i?q(e,t,n):R(e,t,n)}function q(e,t,n){var r=function(t){return g("Couldn't read '"+e+"'",t.message),n(t)};F(function(t){t.root.getFile(e,{},function(e){e.file(function(e){var t=new FileReader;t.onabort=r,t.onerror=r,t.onloadend=function(){if(n)return n(null,this.result)},t.readAsText(e)},r)},r)},r)}function R(e,t,n){var r=t==="binary";e="assets/"+e+"?v="+s;var i=new XMLHttpRequest;i.open("GET",e,!0),r?(i.setRequestHeader("Content-Type","application/octet-stream"),i.responseType="arraybuffer"):i.setRequestHeader("Content-Type","text/plain"),i.addEventListener("load",function(){return i.readyState!==4||i.status!==200?n(new Error("ReadFile received response code "+i.readyState)):n(null,r?i.response:i.responseText)}),i.send(null)}function U(e,t,n,r,i){typeof i!="undefined"&&(r=j(i,r));var s=H.indexOf(e)>-1;s||y("Browser can't write to remote files"),z(e,t,n,r)}function z(e,t,n,r){var i=function(t){return g("Couldn't write to '"+e+"'",t.message),r(t)};F(function(n){n.root.getFile(e,{create:!0},function(e){e.createWriter(function(e){var n=new Blob([t],{type:"text/plain"});e.write(n);if(r)return r(null)},i)},i)},i)}function W(){p.addEventListener("keydown",$),p.addEventListener("keyup",J),p.addEventListener("mousedown",K),p.addEventListener("mouseup",Q),p.addEventListener("mousemove",Z),p.addEventListener("mousewheel",et),p.addEventListener("wheel",et),p.addEventListener("contextmenu",tt)}function X(e,t){var n=a.us,r=n["default"][e],i=n.shifted[e];return t&&i&&(r=i),r}function V(e){return"mouse"+e}function $(e){document.pointerLockElement&&(e.preventDefault(),e.stopPropagation());var t=X(e.keyCode,e.shiftKey);if(t===undefined)return;e.altKey&&t=="enter"&&p.requestFullScreen(),i.QueueEvent({type:o.KEY,pressed:!0,keyName:t})}function J(e){document.pointerLockElement&&(e.preventDefault(),e.stopPropagation());var t=X(e.keyCode);i.QueueEvent({type:o.KEY,pressed:!1,keyName:t})}function K(e){document.pointerLockElement?(e.preventDefault(),e.stopPropagation()):!document.pointerLockElement&&e.button===0&&(p.requestPointerLock(),p.setAttribute("tabindex","0"),p.focus(),e.preventDefault(),e.stopPropagation());var t=V(e.button);i.QueueEvent({type:o.KEY,pressed:!0,keyName:t})}function Q(e){document.pointerLockElement&&(e.preventDefault(),e.stopPropagation());var t=V(e.button);i.QueueEvent({type:o.KEY,pressed:!1,keyName:t})}function Z(e){var t,n;document.pointerLockElement?(t=e.movementX,n=e.movementY):(t=e.pageX-G,n=e.pageY-Y,G=e.pageX,Y=e.pageY),i.QueueEvent({type:o.MOUSE,deltaX:t,deltaY:n})}function et(e){document.pointerLockElement&&(e.preventDefault(),e.stopPropagation());var t=e.wheelDelta!==undefined?e.wheelDelta<0:e.deltaY>0,n=t?"mwheeldown":"mwheelup";i.QueueEvent({type:o.KEY,pressed:!0,keyName:n}),i.QueueEvent({type:o.KEY,pressed:!1,keyName:n})}function tt(e){document.pointerLockElement&&(e.preventDefault(),e.stopPropagation())}function nt(){y("Should not happen")}function rt(e){var t=new WebSocket("ws://"+e.ip+":"+e.port,["quakejs"]);t.binaryType="arraybuffer";var n=new f;return n.handle=t,t.onopen=function(){n.onopen&&n.onopen()},t.onmessage=function(e){n.onmessage&&n.onmessage(e.data)},t.onerror=function(e){n.onclose&&n.onclose(e)},t.onclose=function(){n.onclose&&n.onclose()},n}function it(e,t,n){var r=e.handle;t.byteLength!==n&&(t=t.slice(0,n));try{r.send(t)}catch(i){st(e)}}function st(e){var t=e.handle;try{t.close()}catch(n){}}var s=r.GAME_VERSION,o=i.SE,u=["@font-face {	font-family: 'SourceCodeProSemibold';	src: url('data:application/x-font-ttf;base64,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') format('truetype');	font-weight: normal;	font-style: normal;}/** * GENERAL */#error-wrapper {	position: absolute;	left: 0;	top: 0;	width: 100%;	height: 100%;	color: #fff;	font-family: 'SourceCodeProSemibold', sans-serif;	z-index: 999;}#error-fatal,#error-dialog {	position: absolute;	top: 50%;	left: 50%;	margin: -5em 0 0 -15em;	padding: 1em;	width: 30em;	height: 10em;}#error-fatal {	text-align: center;}#error-dialog {	background: rgba(0, 0, 0, 0.6);}#error-dialog .accept {	display: inline-block;	padding: .5em;	background-color: #222;	background-image: -moz-linear-gradient(top, #333, #222);	background-image: -webkit-linear-gradient(top, #333, #222);}#error-dialog .accept:hover {	background: #333;}/** * GAME */#viewport-frame {	position: relative;	width: 100%;	height: 100%;	min-height: 100%;	overflow: hidden;	font-family: 'SourceCodeProSemibold', sans-serif;	background: #000;}#viewport {	background: #000;}#viewport-ui {	position: absolute;	left: 0;	top: 0;	width: 100%;	height: 100%;	color: #fff;	z-index: 1;}#viewport-frame:-moz-full-screen,#viewport:-moz-full-screen,#viewport-ui:-moz-full-screen {	display: block;	position: absolute;	left: 0;	top: 0;	margin: 0;	width: 100%;	height: 100%;}#viewport-frame:-webkit-full-screen,#viewport:-webkit-full-screen,#viewport-ui:-webkit-full-screen {	display: block;	position: absolute;	left: 0;	top: 0;	margin: 0;	width: 100%;	height: 100%;}/** * EDITOR */#editor {	position: relative;	width: 100%;	height: 100%;	min-height: 100%;	overflow: hidden;}#editor #viewport-frame {	float: left;	width: 80%;}#editor #sidebar {	float: left;	width: 20%;	height: 100%;	min-height: 100%;	background: #ff0000;}",'/*! normalize.css v1.0.1 | MIT License | git.io/normalize *//* ==========================================================================   HTML5 display definitions   ========================================================================== *//* * Corrects `block` display not defined in IE 6/7/8/9 and Firefox 3. */article,aside,details,figcaption,figure,footer,header,hgroup,nav,section,summary {    display: block;}/* * Corrects `inline-block` display not defined in IE 6/7/8/9 and Firefox 3. */audio,canvas,video {    display: inline-block;    *display: inline;    *zoom: 1;}/* * Prevents modern browsers from displaying `audio` without controls. * Remove excess height in iOS 5 devices. */audio:not([controls]) {    display: none;    height: 0;}/* * Addresses styling for `hidden` attribute not present in IE 7/8/9, Firefox 3, * and Safari 4. * Known issue: no IE 6 support. */[hidden] {    display: none;}/* ==========================================================================   Base   ========================================================================== *//* * 1. Corrects text resizing oddly in IE 6/7 when body `font-size` is set using *    `em` units. * 2. Prevents iOS text size adjust after orientation change, without disabling *    user zoom. */html {    font-size: 100%; /* 1 */    -webkit-text-size-adjust: 100%; /* 2 */    -ms-text-size-adjust: 100%; /* 2 */}/* * Addresses `font-family` inconsistency between `textarea` and other form * elements. */html,button,input,select,textarea {    font-family: sans-serif;}/* * Addresses margins handled incorrectly in IE 6/7. */body {    margin: 0;}/* ==========================================================================   Links   ========================================================================== *//* * Addresses `outline` inconsistency between Chrome and other browsers. */a:focus {    outline: thin dotted;}/* * Improves readability when focused and also mouse hovered in all browsers. */a:active,a:hover {    outline: 0;}/* ==========================================================================   Typography   ========================================================================== *//* * Addresses font sizes and margins set differently in IE 6/7. * Addresses font sizes within `section` and `article` in Firefox 4+, Safari 5, * and Chrome. *//*h1 {    font-size: 2em;    margin: 0.67em 0;}h2 {    font-size: 1.5em;    margin: 0.83em 0;}h3 {    font-size: 1.17em;    margin: 1em 0;}h4 {    font-size: 1em;    margin: 1.33em 0;}h5 {    font-size: 0.83em;    margin: 1.67em 0;}h6 {    font-size: 0.75em;    margin: 2.33em 0;}*//* * Addresses styling not present in IE 7/8/9, Safari 5, and Chrome. */abbr[title] {    border-bottom: 1px dotted;}/* * Addresses style set to `bolder` in Firefox 3+, Safari 4/5, and Chrome. */b,strong {    font-weight: bold;}blockquote {    margin: 1em 40px;}/* * Addresses styling not present in Safari 5 and Chrome. */dfn {    font-style: italic;}/* * Addresses styling not present in IE 6/7/8/9. */mark {    background: #ff0;    color: #000;}/* * Addresses margins set differently in IE 6/7. */p,pre {    margin: 1em 0;}/* * Corrects font family set oddly in IE 6, Safari 4/5, and Chrome. */code,kbd,pre,samp {    font-family: monospace, serif;    _font-family: \'courier new\', monospace;    font-size: 1em;}/* * Improves readability of pre-formatted text in all browsers. */pre {    white-space: pre;    white-space: pre-wrap;    word-wrap: break-word;}/* * Addresses CSS quotes not supported in IE 6/7. */q {    quotes: none;}/* * Addresses `quotes` property not supported in Safari 4. */q:before,q:after {    content: \'\';    content: none;}/* * Addresses inconsistent and variable font size in all browsers. */small {    font-size: 80%;}/* * Prevents `sub` and `sup` affecting `line-height` in all browsers. */sub,sup {    font-size: 75%;    line-height: 0;    position: relative;    vertical-align: baseline;}sup {    top: -0.5em;}sub {    bottom: -0.25em;}/* ==========================================================================   Lists   ========================================================================== *//* * Addresses margins set differently in IE 6/7. */dl,menu,ol,ul {    margin: 1em 0;}dd {    margin: 0 0 0 40px;}/* * Addresses paddings set differently in IE 6/7. */menu,ol,ul {    padding: 0 0 0 40px;}/* * Corrects list images handled incorrectly in IE 7. */nav ul,nav ol {    list-style: none;    list-style-image: none;}/* ==========================================================================   Embedded content   ========================================================================== *//* * 1. Removes border when inside `a` element in IE 6/7/8/9 and Firefox 3. * 2. Improves image quality when scaled in IE 7. */img {    border: 0; /* 1 */    -ms-interpolation-mode: bicubic; /* 2 */}/* * Corrects overflow displayed oddly in IE 9. */svg:not(:root) {    overflow: hidden;}/* ==========================================================================   Figures   ========================================================================== *//* * Addresses margin not present in IE 6/7/8/9, Safari 5, and Opera 11. */figure {    margin: 0;}/* ==========================================================================   Forms   ========================================================================== *//* * Corrects margin displayed oddly in IE 6/7. */form {    margin: 0;}/* * Define consistent border, margin, and padding. */fieldset {    border: 1px solid #c0c0c0;    margin: 0 2px;    padding: 0.35em 0.625em 0.75em;}/* * 1. Corrects color not being inherited in IE 6/7/8/9. * 2. Corrects text not wrapping in Firefox 3. * 3. Corrects alignment displayed oddly in IE 6/7. */legend {    border: 0; /* 1 */    padding: 0;    white-space: normal; /* 2 */    *margin-left: -7px; /* 3 */}/* * 1. Corrects font size not being inherited in all browsers. * 2. Addresses margins set differently in IE 6/7, Firefox 3+, Safari 5, *    and Chrome. * 3. Improves appearance and consistency in all browsers. */button,input,select,textarea {    font-size: 100%; /* 1 */    margin: 0; /* 2 */    vertical-align: baseline; /* 3 */    *vertical-align: middle; /* 3 */}/* * Addresses Firefox 3+ setting `line-height` on `input` using `!important` in * the UA stylesheet. */button,input {    line-height: normal;}/* * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` *    and `video` controls. * 2. Corrects inability to style clickable `input` types in iOS. * 3. Improves usability and consistency of cursor style between image-type *    `input` and others. * 4. Removes inner spacing in IE 7 without affecting normal text inputs. *    Known issue: inner spacing remains in IE 6. */button,html input[type="button"], /* 1 */input[type="reset"],input[type="submit"] {    -webkit-appearance: button; /* 2 */    cursor: pointer; /* 3 */    *overflow: visible;  /* 4 */}/* * Re-set default cursor for disabled elements. */button[disabled],input[disabled] {    cursor: default;}/* * 1. Addresses box sizing set to content-box in IE 8/9. * 2. Removes excess padding in IE 8/9. * 3. Removes excess padding in IE 7. *    Known issue: excess padding remains in IE 6. */input[type="checkbox"],input[type="radio"] {    box-sizing: border-box; /* 1 */    padding: 0; /* 2 */    *height: 13px; /* 3 */    *width: 13px; /* 3 */}/* * 1. Addresses `appearance` set to `searchfield` in Safari 5 and Chrome. * 2. Addresses `box-sizing` set to `border-box` in Safari 5 and Chrome *    (include `-moz` to future-proof). */input[type="search"] {    -webkit-appearance: textfield; /* 1 */    -moz-box-sizing: content-box;    -webkit-box-sizing: content-box; /* 2 */    box-sizing: content-box;}/* * Removes inner padding and search cancel button in Safari 5 and Chrome * on OS X. */input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration {    -webkit-appearance: none;}/* * Removes inner padding and border in Firefox 3+. */button::-moz-focus-inner,input::-moz-focus-inner {    border: 0;    padding: 0;}/* * 1. Removes default vertical scrollbar in IE 6/7/8/9. * 2. Improves readability and alignment in all browsers. */textarea {    overflow: auto; /* 1 */    vertical-align: top; /* 2 */}/* ==========================================================================   Tables   ========================================================================== *//* * Remove most spacing between table cells. */table {    border-collapse: collapse;    border-spacing: 0;}'],a={us:{"default":{8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"escape",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"delete",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",91:"command",92:"_91",93:"select",96:"num0",97:"num1",98:"num2",99:"num3",100:"num4",101:"num5",102:"num6",103:"num7",104:"num8",105:"num9",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scrolllock",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},shifted:{48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",107:"+",109:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'}}},f=function(){this.handle=null,this.onmessage=null,this.onclose=null},l='<div id="viewport-frame"><canvas id="viewport"></canvas><div id="viewport-ui"></div></div>',c=e.template(l),h,p,d,v,m,O=Date.now(),D={},P,H=["q3config.cfg"];window.storageInfo=window.storageInfo||window.webkitStorageInfo,window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem;var G=0,Y=0;return{Init:b}});