/*global vec3: true, mat4: true */

define('renderer/re',
['underscore', 'glmatrix', 'ByteBuffer'],
function (_, glmatrix, ByteBuffer) {
	<%- include ../shared/shared.js %>

	function Renderer(imp) {
		<%- include re-defines.js %>
		<%- include re-main.js %>
		<%- include re-backend.js %>
		<%- include re-bsp.js %>
		<%- include re-image.js %>
		<%- include re-light.js %>
		<%- include re-model.js %>
		<%- include re-patch.js %>
		<%- include re-scene.js %>
		<%- include re-shader.js %>
		<%- include re-surface.js %>
		<%- include re-sky.js %>
		<%- include re-world.js %>

		return {
			// exported data structures
			RefDef:        RefDef,
			RefEntityType: RefEntityType,
			RenderFx:      RenderFx,
			RefEntity:     RefEntity,

			// exported fns
			Init:                  Init,
			Shutdown:              Shutdown,
			LoadMap:               LoadMap,
			RenderScene:           RenderScene,
			AddRefEntityToScene:   AddRefEntityToScene,
			GetCounts:             function () { return re.counts; },
			RegisterModel:         RegisterModel,
			RegisterSkin:          RegisterSkin,
			LerpTag:               LerpTag,
			BuildCollisionBuffers: BuildCollisionBuffers
		};
	};

	return {
		CreateInstance: function (imp) {
			return new Renderer(imp);
		}
	};
});