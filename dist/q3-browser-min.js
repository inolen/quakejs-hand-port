//     Underscore.js 1.4.1
//     http://underscorejs.org
//     (c) 2009-2012 Jeremy Ashkenas, DocumentCloud Inc.
//     Underscore may be freely distributed under the MIT license.

/**
 * ByteBuffer v0.0.1
 * Copyright (c) 2012 Tim Kurvers <http://moonsphere.net>
 *
 * Wrapper for ArrayBuffer/DataView maintaining index and default endianness.
 * Supports arbitrary reading/writing, implicit growth, clipping, cloning and
 * reversing as well as UTF-8 characters and NULL-terminated C-strings.
 *
 * The contents of this file are subject to the MIT License, under which
 * this library is licensed. See the LICENSE file for the full license.
 */

/*
 * Copyright (c) 2012 Brandon Jones, Colin MacKenzie IV
 *
 * This software is provided 'as-is', without any express or implied
 * warranty. In no event will the authors be held liable for any damages
 * arising from the use of this software.
 *
 * Permission is granted to anyone to use this software for any purpose,
 * including commercial applications, and to alter it and redistribute it
 * freely, subject to the following restrictions:
 *
 *    1. The origin of this software must not be misrepresented; you must not
 *    claim that you wrote the original software. If you use this software
 *    in a product, an acknowledgment in the product documentation would be
 *    appreciated but is not required.
 *
 *    2. Altered source versions must be plainly marked as such, and must not
 *    be misrepresented as being the original software.
 *
 *    3. This notice may not be removed or altered from any source
 *    distribution.
 */

/*!r_nocull->integer*/

/*!
 * jQuery JavaScript Library v1.8.2
 * http://jquery.com/
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright 2012 jQuery Foundation and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: Thu Sep 20 2012 21:13:05 GMT-0400 (Eastern Daylight Time)
 */

/*!
 * Sizzle CSS Selector Engine
 * Copyright 2012 jQuery Foundation and other contributors
 * Released under the MIT license
 * http://sizzlejs.com/
 */

//     (c) 2010-2012 Jeremy Ashkenas, DocumentCloud Inc.
//     Backbone may be freely distributed under the MIT license.
//     For all details and documentation:
//     http://backbonejs.org

/**
 * @license RequireJS text 2.0.3 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

(function(){var e=this,t=e._,n={},r=Array.prototype,i=Object.prototype,s=Function.prototype,o=r.push,u=r.slice,a=r.concat,f=r.unshift,l=i.toString,c=i.hasOwnProperty,h=r.forEach,p=r.map,d=r.reduce,v=r.reduceRight,m=r.filter,g=r.every,y=r.some,b=r.indexOf,w=r.lastIndexOf,E=Array.isArray,S=Object.keys,x=s.bind,T=function(e){if(e instanceof T)return e;if(!(this instanceof T))return new T(e);this._wrapped=e};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=T),exports._=T):e._=T,T.VERSION="1.4.1";var N=T.each=T.forEach=function(e,t,r){if(h&&e.forEach===h)e.forEach(t,r);else if(e.length===+e.length){for(var i=0,s=e.length;i<s;i++)if(t.call(r,e[i],i,e)===n)return}else for(var o in e)if(T.has(e,o)&&t.call(r,e[o],o,e)===n)return};T.map=T.collect=function(e,t,n){var r=[];return p&&e.map===p?e.map(t,n):(N(e,function(e,i,s){r[r.length]=t.call(n,e,i,s)}),r)},T.reduce=T.foldl=T.inject=function(e,t,n,r){var i=arguments.length>2;if(d&&e.reduce===d)return r&&(t=T.bind(t,r)),i?e.reduce(t,n):e.reduce(t);N(e,function(e,s,o){i?n=t.call(r,n,e,s,o):(n=e,i=!0)});if(!i)throw new TypeError("Reduce of empty array with no initial value");return n},T.reduceRight=T.foldr=function(e,t,n,r){var i=arguments.length>2;if(v&&e.reduceRight===v)return r&&(t=T.bind(t,r)),arguments.length>2?e.reduceRight(t,n):e.reduceRight(t);var s=e.length;if(s!==+s){var o=T.keys(e);s=o.length}N(e,function(u,a,f){a=o?o[--s]:--s,i?n=t.call(r,n,e[a],a,f):(n=e[a],i=!0)});if(!i)throw new TypeError("Reduce of empty array with no initial value");return n},T.find=T.detect=function(e,t,n){var r;return C(e,function(e,i,s){if(t.call(n,e,i,s))return r=e,!0}),r},T.filter=T.select=function(e,t,n){var r=[];return m&&e.filter===m?e.filter(t,n):(N(e,function(e,i,s){t.call(n,e,i,s)&&(r[r.length]=e)}),r)},T.reject=function(e,t,n){var r=[];return N(e,function(e,i,s){t.call(n,e,i,s)||(r[r.length]=e)}),r},T.every=T.all=function(e,t,r){t||(t=T.identity);var i=!0;return g&&e.every===g?e.every(t,r):(N(e,function(e,s,o){if(!(i=i&&t.call(r,e,s,o)))return n}),!!i)};var C=T.some=T.any=function(e,t,r){t||(t=T.identity);var i=!1;return y&&e.some===y?e.some(t,r):(N(e,function(e,s,o){if(i||(i=t.call(r,e,s,o)))return n}),!!i)};T.contains=T.include=function(e,t){var n=!1;return b&&e.indexOf===b?e.indexOf(t)!=-1:(n=C(e,function(e){return e===t}),n)},T.invoke=function(e,t){var n=u.call(arguments,2);return T.map(e,function(e){return(T.isFunction(t)?t:e[t]).apply(e,n)})},T.pluck=function(e,t){return T.map(e,function(e){return e[t]})},T.where=function(e,t){return T.isEmpty(t)?[]:T.filter(e,function(e){for(var n in t)if(t[n]!==e[n])return!1;return!0})},T.max=function(e,t,n){if(!t&&T.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!t&&T.isEmpty(e))return-Infinity;var r={computed:-Infinity};return N(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o>=r.computed&&(r={value:e,computed:o})}),r.value},T.min=function(e,t,n){if(!t&&T.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!t&&T.isEmpty(e))return Infinity;var r={computed:Infinity};return N(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o<r.computed&&(r={value:e,computed:o})}),r.value},T.shuffle=function(e){var t,n=0,r=[];return N(e,function(e){t=T.random(n++),r[n-1]=r[t],r[t]=e}),r};var k=function(e){return T.isFunction(e)?e:function(t){return t[e]}};T.sortBy=function(e,t,n){var r=k(t);return T.pluck(T.map(e,function(e,t,i){return{value:e,index:t,criteria:r.call(n,e,t,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||n===void 0)return 1;if(n<r||r===void 0)return-1}return e.index<t.index?-1:1}),"value")};var L=function(e,t,n,r){var i={},s=k(t);return N(e,function(t,o){var u=s.call(n,t,o,e);r(i,u,t)}),i};T.groupBy=function(e,t,n){return L(e,t,n,function(e,t,n){(T.has(e,t)?e[t]:e[t]=[]).push(n)})},T.countBy=function(e,t,n){return L(e,t,n,function(e,t,n){T.has(e,t)||(e[t]=0),e[t]++})},T.sortedIndex=function(e,t,n,r){n=n==null?T.identity:k(n);var i=n.call(r,t),s=0,o=e.length;while(s<o){var u=s+o>>>1;n.call(r,e[u])<i?s=u+1:o=u}return s},T.toArray=function(e){return e?e.length===+e.length?u.call(e):T.values(e):[]},T.size=function(e){return e.length===+e.length?e.length:T.keys(e).length},T.first=T.head=T.take=function(e,t,n){return t!=null&&!n?u.call(e,0,t):e[0]},T.initial=function(e,t,n){return u.call(e,0,e.length-(t==null||n?1:t))},T.last=function(e,t,n){return t!=null&&!n?u.call(e,Math.max(e.length-t,0)):e[e.length-1]},T.rest=T.tail=T.drop=function(e,t,n){return u.call(e,t==null||n?1:t)},T.compact=function(e){return T.filter(e,function(e){return!!e})};var A=function(e,t,n){return N(e,function(e){T.isArray(e)?t?o.apply(n,e):A(e,t,n):n.push(e)}),n};T.flatten=function(e,t){return A(e,t,[])},T.without=function(e){return T.difference(e,u.call(arguments,1))},T.uniq=T.unique=function(e,t,n,r){var i=n?T.map(e,n,r):e,s=[],o=[];return N(i,function(n,r){if(t?!r||o[o.length-1]!==n:!T.contains(o,n))o.push(n),s.push(e[r])}),s},T.union=function(){return T.uniq(a.apply(r,arguments))},T.intersection=function(e){var t=u.call(arguments,1);return T.filter(T.uniq(e),function(e){return T.every(t,function(t){return T.indexOf(t,e)>=0})})},T.difference=function(e){var t=a.apply(r,u.call(arguments,1));return T.filter(e,function(e){return!T.contains(t,e)})},T.zip=function(){var e=u.call(arguments),t=T.max(T.pluck(e,"length")),n=new Array(t);for(var r=0;r<t;r++)n[r]=T.pluck(e,""+r);return n},T.object=function(e,t){var n={};for(var r=0,i=e.length;r<i;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},T.indexOf=function(e,t,n){var r=0,i=e.length;if(n){if(typeof n!="number")return r=T.sortedIndex(e,t),e[r]===t?r:-1;r=n<0?Math.max(0,i+n):n}if(b&&e.indexOf===b)return e.indexOf(t,n);for(;r<i;r++)if(e[r]===t)return r;return-1},T.lastIndexOf=function(e,t,n){var r=n!=null;if(w&&e.lastIndexOf===w)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);var i=r?n:e.length;while(i--)if(e[i]===t)return i;return-1},T.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=new Array(r);while(i<r)s[i++]=e,e+=n;return s};var O=function(){};T.bind=function(t,n){var r,i;if(t.bind===x&&x)return x.apply(t,u.call(arguments,1));if(!T.isFunction(t))throw new TypeError;return i=u.call(arguments,2),r=function(){if(this instanceof r){O.prototype=t.prototype;var e=new O,s=t.apply(e,i.concat(u.call(arguments)));return Object(s)===s?s:e}return t.apply(n,i.concat(u.call(arguments)))}},T.bindAll=function(e){var t=u.call(arguments,1);return t.length==0&&(t=T.functions(e)),N(t,function(t){e[t]=T.bind(e[t],e)}),e},T.memoize=function(e,t){var n={};return t||(t=T.identity),function(){var r=t.apply(this,arguments);return T.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},T.delay=function(e,t){var n=u.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},T.defer=function(e){return T.delay.apply(T,[e,1].concat(u.call(arguments,1)))},T.throttle=function(e,t){var n,r,i,s,o,u,a=T.debounce(function(){o=s=!1},t);return function(){n=this,r=arguments;var f=function(){i=null,o&&(u=e.apply(n,r)),a()};return i||(i=setTimeout(f,t)),s?o=!0:(s=!0,u=e.apply(n,r)),a(),u}},T.debounce=function(e,t,n){var r,i;return function(){var s=this,o=arguments,u=function(){r=null,n||(i=e.apply(s,o))},a=n&&!r;return clearTimeout(r),r=setTimeout(u,t),a&&(i=e.apply(s,o)),i}},T.once=function(e){var t=!1,n;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}},T.wrap=function(e,t){return function(){var n=[e];return o.apply(n,arguments),t.apply(this,n)}},T.compose=function(){var e=arguments;return function(){var t=arguments;for(var n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},T.after=function(e,t){return e<=0?t():function(){if(--e<1)return t.apply(this,arguments)}},T.keys=S||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)T.has(e,n)&&(t[t.length]=n);return t},T.values=function(e){var t=[];for(var n in e)T.has(e,n)&&t.push(e[n]);return t},T.pairs=function(e){var t=[];for(var n in e)T.has(e,n)&&t.push([n,e[n]]);return t},T.invert=function(e){var t={};for(var n in e)T.has(e,n)&&(t[e[n]]=n);return t},T.functions=T.methods=function(e){var t=[];for(var n in e)T.isFunction(e[n])&&t.push(n);return t.sort()},T.extend=function(e){return N(u.call(arguments,1),function(t){for(var n in t)e[n]=t[n]}),e},T.pick=function(e){var t={},n=a.apply(r,u.call(arguments,1));return N(n,function(n){n in e&&(t[n]=e[n])}),t},T.omit=function(e){var t={},n=a.apply(r,u.call(arguments,1));for(var i in e)T.contains(n,i)||(t[i]=e[i]);return t},T.defaults=function(e){return N(u.call(arguments,1),function(t){for(var n in t)e[n]==null&&(e[n]=t[n])}),e},T.clone=function(e){return T.isObject(e)?T.isArray(e)?e.slice():T.extend({},e):e},T.tap=function(e,t){return t(e),e};var M=function(e,t,n,r){if(e===t)return e!==0||1/e==1/t;if(e==null||t==null)return e===t;e instanceof T&&(e=e._wrapped),t instanceof T&&(t=t._wrapped);var i=l.call(e);if(i!=l.call(t))return!1;switch(i){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if(typeof e!="object"||typeof t!="object")return!1;var s=n.length;while(s--)if(n[s]==e)return r[s]==t;n.push(e),r.push(t);var o=0,u=!0;if(i=="[object Array]"){o=e.length,u=o==t.length;if(u)while(o--)if(!(u=M(e[o],t[o],n,r)))break}else{var a=e.constructor,f=t.constructor;if(a!==f&&!(T.isFunction(a)&&a instanceof a&&T.isFunction(f)&&f instanceof f))return!1;for(var c in e)if(T.has(e,c)){o++;if(!(u=T.has(t,c)&&M(e[c],t[c],n,r)))break}if(u){for(c in t)if(T.has(t,c)&&!(o--))break;u=!o}}return n.pop(),r.pop(),u};T.isEqual=function(e,t){return M(e,t,[],[])},T.isEmpty=function(e){if(e==null)return!0;if(T.isArray(e)||T.isString(e))return e.length===0;for(var t in e)if(T.has(e,t))return!1;return!0},T.isElement=function(e){return!!e&&e.nodeType===1},T.isArray=E||function(e){return l.call(e)=="[object Array]"},T.isObject=function(e){return e===Object(e)},N(["Arguments","Function","String","Number","Date","RegExp"],function(e){T["is"+e]=function(t){return l.call(t)=="[object "+e+"]"}}),T.isArguments(arguments)||(T.isArguments=function(e){return!!e&&!!T.has(e,"callee")}),typeof /./!="function"&&(T.isFunction=function(e){return typeof e=="function"}),T.isFinite=function(e){return T.isNumber(e)&&isFinite(e)},T.isNaN=function(e){return T.isNumber(e)&&e!=+e},T.isBoolean=function(e){return e===!0||e===!1||l.call(e)=="[object Boolean]"},T.isNull=function(e){return e===null},T.isUndefined=function(e){return e===void 0},T.has=function(e,t){return c.call(e,t)},T.noConflict=function(){return e._=t,this},T.identity=function(e){return e},T.times=function(e,t,n){for(var r=0;r<e;r++)t.call(n,r)},T.random=function(e,t){return t==null&&(t=e,e=0),e+(0|Math.random()*(t-e+1))};var _={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};_.unescape=T.invert(_.escape);var D={escape:new RegExp("["+T.keys(_.escape).join("")+"]","g"),unescape:new RegExp("("+T.keys(_.unescape).join("|")+")","g")};T.each(["escape","unescape"],function(e){T[e]=function(t){return t==null?"":(""+t).replace(D[e],function(t){return _[e][t]})}}),T.result=function(e,t){if(e==null)return null;var n=e[t];return T.isFunction(n)?n.call(e):n},T.mixin=function(e){N(T.functions(e),function(t){var n=T[t]=e[t];T.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),F.call(this,n.apply(T,e))}})};var P=0;T.uniqueId=function(e){var t=P++;return e?e+t:t},T.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var H=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},j=/\\|'|\r|\n|\t|\u2028|\u2029/g;T.template=function(e,t,n){n=T.defaults({},n,T.templateSettings);var r=new RegExp([(n.escape||H).source,(n.interpolate||H).source,(n.evaluate||H).source].join("|")+"|$","g"),i=0,s="__p+='";e.replace(r,function(t,n,r,o,u){s+=e.slice(i,u).replace(j,function(e){return"\\"+B[e]}),s+=n?"'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?"'+\n((__t=("+r+"))==null?'':__t)+\n'":o?"';\n"+o+"\n__p+='":"",i=u+t.length}),s+="';\n",n.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{var o=new Function(n.variable||"obj","_",s)}catch(u){throw u.source=s,u}if(t)return o(t,T);var a=function(e){return o.call(this,e,T)};return a.source="function("+(n.variable||"obj")+"){\n"+s+"}",a},T.chain=function(e){return T(e).chain()};var F=function(e){return this._chain?T(e).chain():e};T.mixin(T),N(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];T.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),(e=="shift"||e=="splice")&&n.length===0&&delete n[0],F.call(this,n)}}),N(["concat","join","slice"],function(e){var t=r[e];T.prototype[e]=function(){return F.call(this,t.apply(this._wrapped,arguments))}}),T.extend(T.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),typeof define=="function"&&define.amd&&define("underscore",[],function(){return T})}).call(this),function(e){var t;t=function(){function u(t,n,i){var s;t==null&&(t=0),n==null&&(n=r.BIG_ENDIAN),i==null&&(i=!1),this._buffer=null,this._raw=null,this._view=null,this._order=!!n,this._implicitGrowth=!!i,this._index=0,s=e(t,!0),s||(s=new ArrayBuffer(t)),this.buffer=s}var e,t,n,r,i,s,o=this;return u.LITTLE_ENDIAN=!0,u.BIG_ENDIAN=!1,r=u,t=function(e,t){return Object.defineProperty(u.prototype,e,{get:t,enumerable:!0,configurable:!0})},i=function(e,t){return Object.defineProperty(u.prototype,e,{set:t,enumerable:!0,configurable:!0})},u.prototype._sanitizeIndex=function(){this._index<0&&(this._index=0);if(this._index>this.length)return this._index=this.length},e=function(e,t){t==null&&(t=!1);if(e.byteLength!=null)return e.buffer!=null?t?e.buffer.slice(0):e.buffer:t?e.slice(0):e;if(e.length==null)return null;try{return(new Uint8Array(e)).buffer}catch(n){return null}},t("buffer",function(){return this._buffer}),i("buffer",function(e){return this._buffer=e,this._raw=new Uint8Array(this._buffer),this._view=new DataView(this._buffer),this._sanitizeIndex()}),t("raw",function(){return this._raw}),t("view",function(){return this._view}),t("length",function(){return this._buffer.byteLength}),t("byteLength",function(){return this.length}),t("order",function(){return this._order}),i("order",function(e){return this._order=!!e}),t("implicitGrowth",function(){return this._implicitGrowth}),i("implicitGrowth",function(e){return this._implicitGrowth=!!e}),t("index",function(){return this._index}),i("index",function(e){if(e<0||e>this.length)throw new RangeError("Invalid index "+e+", should be between 0 and "+this.length);return this._index=e}),u.prototype.front=function(){return this._index=0,this},u.prototype.end=function(){return this._index=this.length,this},u.prototype.seek=function(e){return e==null&&(e=1),this.index+=e,this},t("available",function(){return this.length-this._index}),n=function(e,t){return function(n){var r;n==null&&(n=this._order);if(t>this.available)throw new Error("Cannot read "+t+" byte(s), "+this.available+" available");return r=this._view[e](this._index,n),this._index+=t,r}},s=function(e,t){return function(n,r){var i;r==null&&(r=this._order),i=this.available;if(t>i){if(!this._implicitGrowth)throw new Error("Cannot write "+n+" using "+t+" byte(s), "+i+" available");this.append(t-i)}return this._view[e](this._index,n,r),this._index+=t,this}},u.prototype.readByte=n("getInt8",1),u.prototype.readUnsignedByte=n("getUint8",1),u.prototype.readShort=n("getInt16",2),u.prototype.readUnsignedShort=n("getUint16",2),u.prototype.readInt=n("getInt32",4),u.prototype.readUnsignedInt=n("getUint32",4),u.prototype.readFloat=n("getFloat32",4),u.prototype.readDouble=n("getFloat64",8),u.prototype.writeByte=s("setInt8",1),u.prototype.writeUnsignedByte=s("setUint8",1),u.prototype.writeShort=s("setInt16",2),u.prototype.writeUnsignedShort=s("setUint16",2),u.prototype.writeInt=s("setInt32",4),u.prototype.writeUnsignedInt=s("setUint32",4),u.prototype.writeFloat=s("setFloat32",4),u.prototype.writeDouble=s("setFloat64",8),u.prototype.read=function(e){var t;e==null&&(e=this.available);if(e>this.available)throw new Error("Cannot read "+e+" byte(s), "+this.available+" available");if(e<=0)throw new RangeError("Invalid number of bytes "+e);return t=new r(this._buffer.slice(this._index,this._index+e)),this._index+=e,t},u.prototype.write=function(t){var n,r,i;if(t instanceof Uint8Array)i=t;else{r=e(t);if(!r)throw new TypeError("Cannot write "+t+", not a sequence");i=new Uint8Array(r)}n=this.available;if(i.byteLength>n){if(!this._implicitGrowth)throw new Error("Cannot write "+t+" using "+i.byteLength+" byte(s), "+this.available+" available");this.append(i.byteLength-n)}return this._raw.set(i,this._index),this._index+=i.byteLength,this},u.prototype.readString=function(e){var t,n,r,i,s,o,u,a,f,l,c,h,p;e==null&&(e=this.available);if(e>this.available)throw new Error("Cannot read "+e+" byte(s), "+this.available+" available");if(e<=0)throw new RangeError("Invalid number of bytes "+e);h=this._raw,u=[],s=0,t=n=r=i=null,p=this._index+e;while(this._index<p){t=h[this._index];if(t<128)u[s++]=t,this._index++;else{if(t<194)throw new Error("Unexpected continuation byte");if(t<224){n=h[this._index+1];if(n<128||n>191)throw new Error("Bad continuation byte");u[s++]=((t&31)<<6)+(n&63),this._index+=2}else if(t<240){n=h[this._index+1];if(n<128||n>191)throw new Error("Bad continuation byte");r=h[this._index+2];if(r<128||r>191)throw new Error("Bad continuation byte");u[s++]=((t&15)<<12)+((n&63)<<6)+(r&63),this._index+=3}else{if(!(t<245))throw new Error("Illegal byte");n=h[this._index+1];if(n<128||n>191)throw new Error("Bad continuation byte");r=h[this._index+2];if(r<128||r>191)throw new Error("Bad continuation byte");i=h[this._index+3];if(i<128||i>191)throw new Error("Bad continuation byte");a=((t&7)<<18)+((n&63)<<12)+((r&63)<<6)+(i&63),a-=65536,u[s++]=55296+((a&1047552)>>>10),u[s++]=56320+(a&1023),this._index+=4}}}c=65536,l=u.length;if(l<c)return String.fromCharCode.apply(String,u);o=[],f=0;while(f<l)o.push(String.fromCharCode.apply(String,u.slice(f,f+c))),f+=c;return o.join("")},u.prototype.writeString=function(e){var t,n,r,i,s,o,u;n=[],u=e.length,o=0,t=0;while(o<u){r=e.charCodeAt(o);if(r<=127)n[t++]=r;else if(r<=2047)n[t++]=192|(r&1984)>>>6,n[t++]=128|r&63;else if(r<=55295||r>=57344&&r<=65535)n[t++]=224|(r&61440)>>>12,n[t++]=128|(r&4032)>>>6,n[t++]=128|r&63;else{if(o===u-1)throw new Error("Unpaired surrogate "+e[o]+" (index "+o+")");s=e.charCodeAt(++o);if(r<55296||r>56319||s<56320||s>57343)throw new Error("Unpaired surrogate "+e[o]+" (index "+o+")");i=((r&1023)<<10)+(s&1023)+65536,n[t++]=240|(i&1835008)>>>18,n[t++]=128|(i&258048)>>>12,n[t++]=128|(i&4032)>>>6,n[t++]=128|i&63}++o}return this.write(n),n.length},u.prototype.readUTFChars=u.prototype.readString,u.prototype.writeUTFChars=u.prototype.writeString,u.prototype.readCString=function(){var e,t,n,r;e=this._raw,n=e.length,t=this._index;while(e[t]!==0&&t<n)++t;return n=t-this._index,n>0?(r=this.readString(n),this.readByte(),r):null},u.prototype.writeCString=function(e){var t;return t=this.writeString(e),this.writeByte(0),++t},u.prototype.readASCIIString=function(e){var t,n,r,i,s,o,u;t=this._raw,n=0,i=e||t.length,o=[];while(n<i)r=this.readByte(),r!==0&&(o[n]=r),n++;s=65536;if(i<s)return String.fromCharCode.apply(String,o);u=[],n=0;while(n<i)u.push(String.fromCharCode.apply(String,o.slice(n,n+s))),n+=s;return u.join("")},u.prototype.writeASCIIString=function(e,t){var n,r,i,s;n=this._raw,r=0,i=t||e.length,s=[];while(r<i)s[r++]=r<e.length?e.charCodeAt(r):0;return this.write(s),i},u.prototype.prepend=function(e){var t;if(e<=0)throw new RangeError("Invalid number of bytes "+e);return t=new Uint8Array(this.length+e),t.set(this._raw,e),this._index+=e,this.buffer=t.buffer,this},u.prototype.append=function(e){var t;if(e<=0)throw new RangeError("Invalid number of bytes "+e);return t=new Uint8Array(this.length+e),t.set(this._raw,0),this.buffer=t.buffer,this},u.prototype.clip=function(e,t){var n;return e==null&&(e=this._index),t==null&&(t=this.length),e<0&&(e=this.length+e),n=this._buffer.slice(e,t),this._index-=e,this.buffer=n,this},u.prototype.slice=function(e,t){var n;return e==null&&(e=0),t==null&&(t=this.length),n=new r(this._buffer.slice(e,t)),n},u.prototype.clone=function(){var e;return e=new r(this._buffer.slice(0)),e.index=this._index,e},u.prototype.reverse=function(){return Array.prototype.reverse.call(this._raw),this._index=0,this},u.prototype.toArray=function(){return Array.prototype.slice.call(this._raw,0)},u.prototype.toString=function(){var e;return e=this._order===r.BIG_ENDIAN?"big-endian":"little-endian","[ByteBuffer; Order: "+e+"; Length: "+this.length+"; Index: "+this._index+"; Available: "+this.available+"]"},u.prototype.toHex=function(e){return e==null&&(e=" "),Array.prototype.map.call(this._raw,function(e){return("00"+e.toString(16).toUpperCase()).slice(-2)}).join(e)},u.prototype.toASCII=function(e,t,n){var r;return e==null&&(e=" "),t==null&&(t=!0),n==null&&(n="ï¿½"),r=t?" ":"",Array.prototype.map.call(this._raw,function(e){return e<32||e>126?r+n:r+String.fromCharCode(e)}).join(e)},u}.call(this),typeof define=="function"&&define.amd?define("ByteBuffer",[],function(){return t}):e.ByteBuffer=t}(this),function(e,t){typeof exports=="object"?module.exports=t(global):typeof define=="function"&&define.amd?define("glmatrix",[],function(){return t(e)}):t(e)}(this,function(e){function i(e){return r=e,r}function s(){return r=typeof Float32Array!="undefined"?Float32Array:Array,r}var t=1e-6,n={};(function(){if(typeof Float32Array!="undefined"){var e=new Float32Array(1),t=new Int32Array(e.buffer);n.invsqrt=function(n){var r=n*.5;e[0]=n;var i=1.5;t[0]=1597463007-(t[0]>>1);var s=e[0];return s*(i-r*s*s)}}else n.invsqrt=function(e){return 1/Math.sqrt(e)}})();var r=null;s();var o={};o.create=function(e){var t=new r(3);return e?(t[0]=e[0],t[1]=e[1],t[2]=e[2]):t[0]=t[1]=t[2]=0,t},o.createFrom=function(e,t,n){var i=new r(3);return i[0]=e,i[1]=t,i[2]=n,i},o.set=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},o.equal=function(e,n){return e===n||Math.abs(e[0]-n[0])<t&&Math.abs(e[1]-n[1])<t&&Math.abs(e[2]-n[2])<t},o.add=function(e,t,n){return!n||e===n?(e[0]+=t[0],e[1]+=t[1],e[2]+=t[2],e):(n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n)},o.subtract=function(e,t,n){return!n||e===n?(e[0]-=t[0],e[1]-=t[1],e[2]-=t[2],e):(n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n)},o.multiply=function(e,t,n){return!n||e===n?(e[0]*=t[0],e[1]*=t[1],e[2]*=t[2],e):(n[0]=e[0]*t[0],n[1]=e[1]*t[1],n[2]=e[2]*t[2],n)},o.negate=function(e,t){return t||(t=e),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},o.scale=function(e,t,n){return!n||e===n?(e[0]*=t,e[1]*=t,e[2]*=t,e):(n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n)},o.normalize=function(e,t){t||(t=e);var n=e[0],r=e[1],i=e[2],s=Math.sqrt(n*n+r*r+i*i);return s?s===1?(t[0]=n,t[1]=r,t[2]=i,t):(s=1/s,t[0]=n*s,t[1]=r*s,t[2]=i*s,t):(t[0]=0,t[1]=0,t[2]=0,t)},o.cross=function(e,t,n){n||(n=e);var r=e[0],i=e[1],s=e[2],o=t[0],u=t[1],a=t[2];return n[0]=i*a-s*u,n[1]=s*o-r*a,n[2]=r*u-i*o,n},o.length=function(e){var t=e[0],n=e[1],r=e[2];return Math.sqrt(t*t+n*n+r*r)},o.squaredLength=function(e){var t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r},o.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},o.direction=function(e,t,n){n||(n=e);var r=e[0]-t[0],i=e[1]-t[1],s=e[2]-t[2],o=Math.sqrt(r*r+i*i+s*s);return o?(o=1/o,n[0]=r*o,n[1]=i*o,n[2]=s*o,n):(n[0]=0,n[1]=0,n[2]=0,n)},o.lerp=function(e,t,n,r){return r||(r=e),r[0]=e[0]+n*(t[0]-e[0]),r[1]=e[1]+n*(t[1]-e[1]),r[2]=e[2]+n*(t[2]-e[2]),r},o.dist=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(n*n+r*r+i*i)};var u=null,a=new r(4);o.unproject=function(e,t,n,r,i){i||(i=e),u||(u=d.create());var s=u,o=a;return o[0]=(e[0]-r[0])*2/r[2]-1,o[1]=(e[1]-r[1])*2/r[3]-1,o[2]=2*e[2]-1,o[3]=1,d.multiply(n,t,s),d.inverse(s)?(d.multiplyVec4(s,o),o[3]===0?null:(i[0]=o[0]/o[3],i[1]=o[1]/o[3],i[2]=o[2]/o[3],i)):null};var f=o.createFrom(1,0,0),l=o.createFrom(0,1,0),c=o.createFrom(0,0,1),h=o.create();o.rotationTo=function(e,t,n){n||(n=v.create());var r=o.dot(e,t),i=h;if(r>=1)v.set(m,n);else if(r<1e-6-1)o.cross(f,e,i),o.length(i)<1e-6&&o.cross(l,e,i),o.length(i)<1e-6&&o.cross(c,e,i),o.normalize(i),v.fromAngleAxis(Math.PI,i,n);else{var s=Math.sqrt((1+r)*2),u=1/s;o.cross(e,t,i),n[0]=i[0]*u,n[1]=i[1]*u,n[2]=i[2]*u,n[3]=s*.5,v.normalize(n)}return n[3]>1?n[3]=1:n[3]<-1&&(n[3]=-1),n},o.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+"]"};var p={};p.create=function(e){var t=new r(9);return e?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8]):t[0]=t[1]=t[2]=t[3]=t[4]=t[5]=t[6]=t[7]=t[8]=0,t},p.createFrom=function(e,t,n,i,s,o,u,a,f){var l=new r(9);return l[0]=e,l[1]=t,l[2]=n,l[3]=i,l[4]=s,l[5]=o,l[6]=u,l[7]=a,l[8]=f,l},p.determinant=function(e){var t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],o=e[5],u=e[6],a=e[7],f=e[8];return t*(f*s-o*a)+n*(-f*i+o*u)+r*(a*i-s*u)},p.inverse=function(e,t){var n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],u=e[5],a=e[6],f=e[7],l=e[8],c=l*o-u*f,h=-l*s+u*a,d=f*s-o*a,v=n*c+r*h+i*d,m;return v?(m=1/v,t||(t=p.create()),t[0]=c*m,t[1]=(-l*r+i*f)*m,t[2]=(u*r-i*o)*m,t[3]=h*m,t[4]=(l*n-i*a)*m,t[5]=(-u*n+i*s)*m,t[6]=d*m,t[7]=(-f*n+r*a)*m,t[8]=(o*n-r*s)*m,t):null},p.multiply=function(e,t,n){n||(n=e);var r=e[0],i=e[1],s=e[2],o=e[3],u=e[4],a=e[5],f=e[6],l=e[7],c=e[8],h=t[0],p=t[1],d=t[2],v=t[3],m=t[4],g=t[5],y=t[6],b=t[7],w=t[8];return n[0]=h*r+p*o+d*f,n[1]=h*i+p*u+d*l,n[2]=h*s+p*a+d*c,n[3]=v*r+m*o+g*f,n[4]=v*i+m*u+g*l,n[5]=v*s+m*a+g*c,n[6]=y*r+b*o+w*f,n[7]=y*i+b*u+w*l,n[8]=y*s+b*a+w*c,n},p.multiplyVec2=function(e,t,n){n||(n=t);var r=t[0],i=t[1];return n[0]=r*e[0]+i*e[3]+e[6],n[1]=r*e[1]+i*e[4]+e[7],n},p.multiplyVec3=function(e,t,n){n||(n=t);var r=t[0],i=t[1],s=t[2];return n[0]=r*e[0]+i*e[3]+s*e[6],n[1]=r*e[1]+i*e[4]+s*e[7],n[2]=r*e[2]+i*e[5]+s*e[8],n},p.set=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},p.equal=function(e,n){return e===n||Math.abs(e[0]-n[0])<t&&Math.abs(e[1]-n[1])<t&&Math.abs(e[2]-n[2])<t&&Math.abs(e[3]-n[3])<t&&Math.abs(e[4]-n[4])<t&&Math.abs(e[5]-n[5])<t&&Math.abs(e[6]-n[6])<t&&Math.abs(e[7]-n[7])<t&&Math.abs(e[8]-n[8])<t},p.identity=function(e){return e||(e=p.create()),e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},p.transpose=function(e,t){if(!t||e===t){var n=e[1],r=e[2],i=e[5];return e[1]=e[3],e[2]=e[6],e[3]=n,e[5]=e[7],e[6]=r,e[7]=i,e}return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],t},p.toMat4=function(e,t){return t||(t=d.create()),t[15]=1,t[14]=0,t[13]=0,t[12]=0,t[11]=0,t[10]=e[8],t[9]=e[7],t[8]=e[6],t[7]=0,t[6]=e[5],t[5]=e[4],t[4]=e[3],t[3]=0,t[2]=e[2],t[1]=e[1],t[0]=e[0],t},p.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+"]"};var d={};d.create=function(e){var t=new r(16);return e&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t},d.createFrom=function(e,t,n,i,s,o,u,a,f,l,c,h,p,d,v,m){var g=new r(16);return g[0]=e,g[1]=t,g[2]=n,g[3]=i,g[4]=s,g[5]=o,g[6]=u,g[7]=a,g[8]=f,g[9]=l,g[10]=c,g[11]=h,g[12]=p,g[13]=d,g[14]=v,g[15]=m,g},d.set=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},d.equal=function(e,n){return e===n||Math.abs(e[0]-n[0])<t&&Math.abs(e[1]-n[1])<t&&Math.abs(e[2]-n[2])<t&&Math.abs(e[3]-n[3])<t&&Math.abs(e[4]-n[4])<t&&Math.abs(e[5]-n[5])<t&&Math.abs(e[6]-n[6])<t&&Math.abs(e[7]-n[7])<t&&Math.abs(e[8]-n[8])<t&&Math.abs(e[9]-n[9])<t&&Math.abs(e[10]-n[10])<t&&Math.abs(e[11]-n[11])<t&&Math.abs(e[12]-n[12])<t&&Math.abs(e[13]-n[13])<t&&Math.abs(e[14]-n[14])<t&&Math.abs(e[15]-n[15])<t},d.identity=function(e){return e||(e=d.create()),e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},d.transpose=function(e,t){if(!t||e===t){var n=e[1],r=e[2],i=e[3],s=e[6],o=e[7],u=e[11];return e[1]=e[4],e[2]=e[8],e[3]=e[12],e[4]=n,e[6]=e[9],e[7]=e[13],e[8]=r,e[9]=s,e[11]=e[14],e[12]=i,e[13]=o,e[14]=u,e}return t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15],t},d.determinant=function(e){var t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],o=e[5],u=e[6],a=e[7],f=e[8],l=e[9],c=e[10],h=e[11],p=e[12],d=e[13],v=e[14],m=e[15];return p*l*u*i-f*d*u*i-p*o*c*i+s*d*c*i+f*o*v*i-s*l*v*i-p*l*r*a+f*d*r*a+p*n*c*a-t*d*c*a-f*n*v*a+t*l*v*a+p*o*r*h-s*d*r*h-p*n*u*h+t*d*u*h+s*n*v*h-t*o*v*h-f*o*r*m+s*l*r*m+f*n*u*m-t*l*u*m-s*n*c*m+t*o*c*m},d.inverse=function(e,t){t||(t=e);var n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],u=e[5],a=e[6],f=e[7],l=e[8],c=e[9],h=e[10],p=e[11],d=e[12],v=e[13],m=e[14],g=e[15],y=n*u-r*o,b=n*a-i*o,w=n*f-s*o,E=r*a-i*u,S=r*f-s*u,x=i*f-s*a,T=l*v-c*d,N=l*m-h*d,C=l*g-p*d,k=c*m-h*v,L=c*g-p*v,A=h*g-p*m,O=y*A-b*L+w*k+E*C-S*N+x*T,M;return O?(M=1/O,t[0]=(u*A-a*L+f*k)*M,t[1]=(-r*A+i*L-s*k)*M,t[2]=(v*x-m*S+g*E)*M,t[3]=(-c*x+h*S-p*E)*M,t[4]=(-o*A+a*C-f*N)*M,t[5]=(n*A-i*C+s*N)*M,t[6]=(-d*x+m*w-g*b)*M,t[7]=(l*x-h*w+p*b)*M,t[8]=(o*L-u*C+f*T)*M,t[9]=(-n*L+r*C-s*T)*M,t[10]=(d*S-v*w+g*y)*M,t[11]=(-l*S+c*w-p*y)*M,t[12]=(-o*k+u*N-a*T)*M,t[13]=(n*k-r*N+i*T)*M,t[14]=(-d*E+v*b-m*y)*M,t[15]=(l*E-c*b+h*y)*M,t):null},d.toRotationMat=function(e,t){return t||(t=d.create()),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},d.toMat3=function(e,t){return t||(t=p.create()),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},d.toInverseMat3=function(e,t){var n=e[0],r=e[1],i=e[2],s=e[4],o=e[5],u=e[6],a=e[8],f=e[9],l=e[10],c=l*o-u*f,h=-l*s+u*a,d=f*s-o*a,v=n*c+r*h+i*d,m;return v?(m=1/v,t||(t=p.create()),t[0]=c*m,t[1]=(-l*r+i*f)*m,t[2]=(u*r-i*o)*m,t[3]=h*m,t[4]=(l*n-i*a)*m,t[5]=(-u*n+i*s)*m,t[6]=d*m,t[7]=(-f*n+r*a)*m,t[8]=(o*n-r*s)*m,t):null},d.multiply=function(e,t,n){n||(n=e);var r=e[0],i=e[1],s=e[2],o=e[3],u=e[4],a=e[5],f=e[6],l=e[7],c=e[8],h=e[9],p=e[10],d=e[11],v=e[12],m=e[13],g=e[14],y=e[15],b=t[0],w=t[1],E=t[2],S=t[3];return n[0]=b*r+w*u+E*c+S*v,n[1]=b*i+w*a+E*h+S*m,n[2]=b*s+w*f+E*p+S*g,n[3]=b*o+w*l+E*d+S*y,b=t[4],w=t[5],E=t[6],S=t[7],n[4]=b*r+w*u+E*c+S*v,n[5]=b*i+w*a+E*h+S*m,n[6]=b*s+w*f+E*p+S*g,n[7]=b*o+w*l+E*d+S*y,b=t[8],w=t[9],E=t[10],S=t[11],n[8]=b*r+w*u+E*c+S*v,n[9]=b*i+w*a+E*h+S*m,n[10]=b*s+w*f+E*p+S*g,n[11]=b*o+w*l+E*d+S*y,b=t[12],w=t[13],E=t[14],S=t[15],n[12]=b*r+w*u+E*c+S*v,n[13]=b*i+w*a+E*h+S*m,n[14]=b*s+w*f+E*p+S*g,n[15]=b*o+w*l+E*d+S*y,n},d.multiplyVec3=function(e,t,n){n||(n=t);var r=t[0],i=t[1],s=t[2];return n[0]=e[0]*r+e[4]*i+e[8]*s+e[12],n[1]=e[1]*r+e[5]*i+e[9]*s+e[13],n[2]=e[2]*r+e[6]*i+e[10]*s+e[14],n},d.multiplyVec4=function(e,t,n){n||(n=t);var r=t[0],i=t[1],s=t[2],o=t[3];return n[0]=e[0]*r+e[4]*i+e[8]*s+e[12]*o,n[1]=e[1]*r+e[5]*i+e[9]*s+e[13]*o,n[2]=e[2]*r+e[6]*i+e[10]*s+e[14]*o,n[3]=e[3]*r+e[7]*i+e[11]*s+e[15]*o,n},d.translate=function(e,t,n){var r=t[0],i=t[1],s=t[2],o,u,a,f,l,c,h,p,d,v,m,g;return!n||e===n?(e[12]=e[0]*r+e[4]*i+e[8]*s+e[12],e[13]=e[1]*r+e[5]*i+e[9]*s+e[13],e[14]=e[2]*r+e[6]*i+e[10]*s+e[14],e[15]=e[3]*r+e[7]*i+e[11]*s+e[15],e):(o=e[0],u=e[1],a=e[2],f=e[3],l=e[4],c=e[5],h=e[6],p=e[7],d=e[8],v=e[9],m=e[10],g=e[11],n[0]=o,n[1]=u,n[2]=a,n[3]=f,n[4]=l,n[5]=c,n[6]=h,n[7]=p,n[8]=d,n[9]=v,n[10]=m,n[11]=g,n[12]=o*r+l*i+d*s+e[12],n[13]=u*r+c*i+v*s+e[13],n[14]=a*r+h*i+m*s+e[14],n[15]=f*r+p*i+g*s+e[15],n)},d.scale=function(e,t,n){var r=t[0],i=t[1],s=t[2];return!n||e===n?(e[0]*=r,e[1]*=r,e[2]*=r,e[3]*=r,e[4]*=i,e[5]*=i,e[6]*=i,e[7]*=i,e[8]*=s,e[9]*=s,e[10]*=s,e[11]*=s,e):(n[0]=e[0]*r,n[1]=e[1]*r,n[2]=e[2]*r,n[3]=e[3]*r,n[4]=e[4]*i,n[5]=e[5]*i,n[6]=e[6]*i,n[7]=e[7]*i,n[8]=e[8]*s,n[9]=e[9]*s,n[10]=e[10]*s,n[11]=e[11]*s,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n)},d.rotate=function(e,t,n,r){var i=n[0],s=n[1],o=n[2],u=Math.sqrt(i*i+s*s+o*o),a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M;return u?(u!==1&&(u=1/u,i*=u,s*=u,o*=u),a=Math.sin(t),f=Math.cos(t),l=1-f,c=e[0],h=e[1],p=e[2],d=e[3],v=e[4],m=e[5],g=e[6],y=e[7],b=e[8],w=e[9],E=e[10],S=e[11],x=i*i*l+f,T=s*i*l+o*a,N=o*i*l-s*a,C=i*s*l-o*a,k=s*s*l+f,L=o*s*l+i*a,A=i*o*l+s*a,O=s*o*l-i*a,M=o*o*l+f,r?e!==r&&(r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]):r=e,r[0]=c*x+v*T+b*N,r[1]=h*x+m*T+w*N,r[2]=p*x+g*T+E*N,r[3]=d*x+y*T+S*N,r[4]=c*C+v*k+b*L,r[5]=h*C+m*k+w*L,r[6]=p*C+g*k+E*L,r[7]=d*C+y*k+S*L,r[8]=c*A+v*O+b*M,r[9]=h*A+m*O+w*M,r[10]=p*A+g*O+E*M,r[11]=d*A+y*O+S*M,r):null},d.rotateX=function(e,t,n){var r=Math.sin(t),i=Math.cos(t),s=e[4],o=e[5],u=e[6],a=e[7],f=e[8],l=e[9],c=e[10],h=e[11];return n?e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]):n=e,n[4]=s*i+f*r,n[5]=o*i+l*r,n[6]=u*i+c*r,n[7]=a*i+h*r,n[8]=s*-r+f*i,n[9]=o*-r+l*i,n[10]=u*-r+c*i,n[11]=a*-r+h*i,n},d.rotateY=function(e,t,n){var r=Math.sin(t),i=Math.cos(t),s=e[0],o=e[1],u=e[2],a=e[3],f=e[8],l=e[9],c=e[10],h=e[11];return n?e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]):n=e,n[0]=s*i+f*-r,n[1]=o*i+l*-r,n[2]=u*i+c*-r,n[3]=a*i+h*-r,n[8]=s*r+f*i,n[9]=o*r+l*i,n[10]=u*r+c*i,n[11]=a*r+h*i,n},d.rotateZ=function(e,t,n){var r=Math.sin(t),i=Math.cos(t),s=e[0],o=e[1],u=e[2],a=e[3],f=e[4],l=e[5],c=e[6],h=e[7];return n?e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]):n=e,n[0]=s*i+f*r,n[1]=o*i+l*r,n[2]=u*i+c*r,n[3]=a*i+h*r,n[4]=s*-r+f*i,n[5]=o*-r+l*i,n[6]=u*-r+c*i,n[7]=a*-r+h*i,n},d.frustum=function(e,t,n,r,i,s,o){o||(o=d.create());var u=t-e,a=r-n,f=s-i;return o[0]=i*2/u,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=i*2/a,o[6]=0,o[7]=0,o[8]=(t+e)/u,o[9]=(r+n)/a,o[10]=-(s+i)/f,o[11]=-1,o[12]=0,o[13]=0,o[14]=-(s*i*2)/f,o[15]=0,o},d.perspective=function(e,t,n,r,i){var s=n*Math.tan(e*Math.PI/360),o=s*t;return d.frustum(-o,o,-s,s,n,r,i)},d.ortho=function(e,t,n,r,i,s,o){o||(o=d.create());var u=t-e,a=r-n,f=s-i;return o[0]=2/u,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2/a,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=-2/f,o[11]=0,o[12]=-(e+t)/u,o[13]=-(r+n)/a,o[14]=-(s+i)/f,o[15]=1,o},d.lookAt=function(e,t,n,r){r||(r=d.create());var i,s,o,u,a,f,l,c,h,p,v=e[0],m=e[1],g=e[2],y=n[0],b=n[1],w=n[2],E=t[0],S=t[1],x=t[2];return v===E&&m===S&&g===x?d.identity(r):(l=v-E,c=m-S,h=g-x,p=1/Math.sqrt(l*l+c*c+h*h),l*=p,c*=p,h*=p,i=b*h-w*c,s=w*l-y*h,o=y*c-b*l,p=Math.sqrt(i*i+s*s+o*o),p?(p=1/p,i*=p,s*=p,o*=p):(i=0,s=0,o=0),u=c*o-h*s,a=h*i-l*o,f=l*s-c*i,p=Math.sqrt(u*u+a*a+f*f),p?(p=1/p,u*=p,a*=p,f*=p):(u=0,a=0,f=0),r[0]=i,r[1]=u,r[2]=l,r[3]=0,r[4]=s,r[5]=a,r[6]=c,r[7]=0,r[8]=o,r[9]=f,r[10]=h,r[11]=0,r[12]=-(i*v+s*m+o*g),r[13]=-(u*v+a*m+f*g),r[14]=-(l*v+c*m+h*g),r[15]=1,r)},d.fromRotationTranslation=function(e,t,n){n||(n=d.create());var r=e[0],i=e[1],s=e[2],o=e[3],u=r+r,a=i+i,f=s+s,l=r*u,c=r*a,h=r*f,p=i*a,v=i*f,m=s*f,g=o*u,y=o*a,b=o*f;return n[0]=1-(p+m),n[1]=c+b,n[2]=h-y,n[3]=0,n[4]=c-b,n[5]=1-(l+m),n[6]=v+g,n[7]=0,n[8]=h+y,n[9]=v-g,n[10]=1-(l+p),n[11]=0,n[12]=t[0],n[13]=t[1],n[14]=t[2],n[15]=1,n},d.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+"]"};var v={};v.create=function(e){var t=new r(4);return e?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]):t[0]=t[1]=t[2]=t[3]=0,t},v.createFrom=function(e,t,n,i){var s=new r(4);return s[0]=e,s[1]=t,s[2]=n,s[3]=i,s},v.set=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},v.equal=function(e,n){return e===n||Math.abs(e[0]-n[0])<t&&Math.abs(e[1]-n[1])<t&&Math.abs(e[2]-n[2])<t&&Math.abs(e[3]-n[3])<t},v.identity=function(e){return e||(e=v.create()),e[0]=0,e[1]=0,e[2]=0,e[3]=1,e};var m=v.identity();v.calculateW=function(e,t){var n=e[0],r=e[1],i=e[2];return!t||e===t?(e[3]=-Math.sqrt(Math.abs(1-n*n-r*r-i*i)),e):(t[0]=n,t[1]=r,t[2]=i,t[3]=-Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t)},v.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},v.inverse=function(e,t){var n=e[0],r=e[1],i=e[2],s=e[3],o=n*n+r*r+i*i+s*s,u=o?1/o:0;return!t||e===t?(e[0]*=-u,e[1]*=-u,e[2]*=-u,e[3]*=u,e):(t[0]=-e[0]*u,t[1]=-e[1]*u,t[2]=-e[2]*u,t[3]=e[3]*u,t)},v.conjugate=function(e,t){return!t||e===t?(e[0]*=-1,e[1]*=-1,e[2]*=-1,e):(t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t)},v.length=function(e){var t=e[0],n=e[1],r=e[2],i=e[3];return Math.sqrt(t*t+n*n+r*r+i*i)},v.normalize=function(e,t){t||(t=e);var n=e[0],r=e[1],i=e[2],s=e[3],o=Math.sqrt(n*n+r*r+i*i+s*s);return o===0?(t[0]=0,t[1]=0,t[2]=0,t[3]=0,t):(o=1/o,t[0]=n*o,t[1]=r*o,t[2]=i*o,t[3]=s*o,t)},v.add=function(e,t,n){return!n||e===n?(e[0]+=t[0],e[1]+=t[1],e[2]+=t[2],e[3]+=t[3],e):(n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n)},v.multiply=function(e,t,n){n||(n=e);var r=e[0],i=e[1],s=e[2],o=e[3],u=t[0],a=t[1],f=t[2],l=t[3];return n[0]=r*l+o*u+i*f-s*a,n[1]=i*l+o*a+s*u-r*f,n[2]=s*l+o*f+r*a-i*u,n[3]=o*l-r*u-i*a-s*f,n},v.multiplyVec3=function(e,t,n){n||(n=t);var r=t[0],i=t[1],s=t[2],o=e[0],u=e[1],a=e[2],f=e[3],l=f*r+u*s-a*i,c=f*i+a*r-o*s,h=f*s+o*i-u*r,p=-o*r-u*i-a*s;return n[0]=l*f+p*-o+c*-a-h*-u,n[1]=c*f+p*-u+h*-o-l*-a,n[2]=h*f+p*-a+l*-u-c*-o,n},v.scale=function(e,t,n){return!n||e===n?(e[0]*=t,e[1]*=t,e[2]*=t,e[3]*=t,e):(n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n)},v.toMat3=function(e,t){t||(t=p.create());var n=e[0],r=e[1],i=e[2],s=e[3],o=n+n,u=r+r,a=i+i,f=n*o,l=n*u,c=n*a,h=r*u,d=r*a,v=i*a,m=s*o,g=s*u,y=s*a;return t[0]=1-(h+v),t[1]=l+y,t[2]=c-g,t[3]=l-y,t[4]=1-(f+v),t[5]=d+m,t[6]=c+g,t[7]=d-m,t[8]=1-(f+h),t},v.toMat4=function(e,t){t||(t=d.create());var n=e[0],r=e[1],i=e[2],s=e[3],o=n+n,u=r+r,a=i+i,f=n*o,l=n*u,c=n*a,h=r*u,p=r*a,v=i*a,m=s*o,g=s*u,y=s*a;return t[0]=1-(h+v),t[1]=l+y,t[2]=c-g,t[3]=0,t[4]=l-y,t[5]=1-(f+v),t[6]=p+m,t[7]=0,t[8]=c+g,t[9]=p-m,t[10]=1-(f+h),t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},v.slerp=function(e,t,n,r){r||(r=e);var i=e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3],s,o,u,a;return Math.abs(i)>=1?(r!==e&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3]),r):(s=Math.acos(i),o=Math.sqrt(1-i*i),Math.abs(o)<.001?(r[0]=e[0]*.5+t[0]*.5,r[1]=e[1]*.5+t[1]*.5,r[2]=e[2]*.5+t[2]*.5,r[3]=e[3]*.5+t[3]*.5,r):(u=Math.sin((1-n)*s)/o,a=Math.sin(n*s)/o,r[0]=e[0]*u+t[0]*a,r[1]=e[1]*u+t[1]*a,r[2]=e[2]*u+t[2]*a,r[3]=e[3]*u+t[3]*a,r))},v.fromRotationMatrix=function(e,t){t||(t=v.create());var n=e[0]+e[4]+e[8],r;if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[7]-e[5])*r,t[1]=(e[2]-e[6])*r,t[2]=(e[3]-e[1])*r;else{var i=v.fromRotationMatrix.s_iNext=v.fromRotationMatrix.s_iNext||[1,2,0],s=0;e[4]>e[0]&&(s=1),e[8]>e[s*3+s]&&(s=2);var o=i[s],u=i[o];r=Math.sqrt(e[s*3+s]-e[o*3+o]-e[u*3+u]+1),t[s]=.5*r,r=.5/r,t[3]=(e[u*3+o]-e[o*3+u])*r,t[o]=(e[o*3+s]+e[s*3+o])*r,t[u]=(e[u*3+s]+e[s*3+u])*r}return t},p.toQuat4=v.fromRotationMatrix,function(){var e=p.create();v.fromAxes=function(t,n,r,i){return e[0]=n[0],e[3]=n[1],e[6]=n[2],e[1]=r[0],e[4]=r[1],e[7]=r[2],e[2]=t[0],e[5]=t[1],e[8]=t[2],v.fromRotationMatrix(e,i)}}(),v.identity=function(e){return e||(e=v.create()),e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},v.fromAngleAxis=function(e,t,n){n||(n=v.create());var r=e*.5,i=Math.sin(r);return n[3]=Math.cos(r),n[0]=i*t[0],n[1]=i*t[1],n[2]=i*t[2],n},v.toAngleAxis=function(e,t){t||(t=e);var r=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];if(r>0){t[3]=2*Math.acos(e[3]);var i=n.invsqrt(r);t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i}else t[3]=0,t[0]=1,t[1]=0,t[2]=0;return t},v.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+"]"};var g={};g.create=function(e){var t=new r(2);return e?(t[0]=e[0],t[1]=e[1]):(t[0]=0,t[1]=0),t},g.createFrom=function(e,t){var n=new r(2);return n[0]=e,n[1]=t,n},g.add=function(e,t,n){return n||(n=t),n[0]=e[0]+t[0],n[1]=e[1]+t[1],n},g.subtract=function(e,t,n){return n||(n=t),n[0]=e[0]-t[0],n[1]=e[1]-t[1],n},g.multiply=function(e,t,n){return n||(n=t),n[0]=e[0]*t[0],n[1]=e[1]*t[1],n},g.divide=function(e,t,n){return n||(n=t),n[0]=e[0]/t[0],n[1]=e[1]/t[1],n},g.scale=function(e,t,n){return n||(n=e),n[0]=e[0]*t,n[1]=e[1]*t,n},g.dist=function(e,t){var n=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(n*n+r*r)},g.set=function(e,t){return t[0]=e[0],t[1]=e[1],t},g.equal=function(e,n){return e===n||Math.abs(e[0]-n[0])<t&&Math.abs(e[1]-n[1])<t},g.negate=function(e,t){return t||(t=e),t[0]=-e[0],t[1]=-e[1],t},g.normalize=function(e,t){t||(t=e);var n=e[0]*e[0]+e[1]*e[1];return n>0?(n=Math.sqrt(n),t[0]=e[0]/n,t[1]=e[1]/n):t[0]=t[1]=0,t},g.cross=function(e,t,n){var r=e[0]*t[1]-e[1]*t[0];return n?(n[0]=n[1]=0,n[2]=r,n):r},g.length=function(e){var t=e[0],n=e[1];return Math.sqrt(t*t+n*n)},g.squaredLength=function(e){var t=e[0],n=e[1];return t*t+n*n},g.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},g.direction=function(e,t,n){n||(n=e);var r=e[0]-t[0],i=e[1]-t[1],s=r*r+i*i;return s?(s=1/Math.sqrt(s),n[0]=r*s,n[1]=i*s,n):(n[0]=0,n[1]=0,n[2]=0,n)},g.lerp=function(e,t,n,r){return r||(r=e),r[0]=e[0]+n*(t[0]-e[0]),r[1]=e[1]+n*(t[1]-e[1]),r},g.str=function(e){return"["+e[0]+", "+e[1]+"]"};var y={};y.create=function(e){var t=new r(4);return e?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]):t[0]=t[1]=t[2]=t[3]=0,t},y.createFrom=function(e,t,n,i){var s=new r(4);return s[0]=e,s[1]=t,s[2]=n,s[3]=i,s},y.set=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},y.equal=function(e,n){return e===n||Math.abs(e[0]-n[0])<t&&Math.abs(e[1]-n[1])<t&&Math.abs(e[2]-n[2])<t&&Math.abs(e[3]-n[3])<t},y.identity=function(e){return e||(e=y.create()),e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},y.transpose=function(e,t){if(!t||e===t){var n=e[1];return e[1]=e[2],e[2]=n,e}return t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3],t},y.determinant=function(e){return e[0]*e[3]-e[2]*e[1]},y.inverse=function(e,t){t||(t=e);var n=e[0],r=e[1],i=e[2],s=e[3],o=n*s-i*r;return o?(o=1/o,t[0]=s*o,t[1]=-r*o,t[2]=-i*o,t[3]=n*o,t):null},y.multiply=function(e,t,n){n||(n=e);var r=e[0],i=e[1],s=e[2],o=e[3];return n[0]=r*t[0]+i*t[2],n[1]=r*t[1]+i*t[3],n[2]=s*t[0]+o*t[2],n[3]=s*t[1]+o*t[3],n},y.rotate=function(e,t,n){n||(n=e);var r=e[0],i=e[1],s=e[2],o=e[3],u=Math.sin(t),a=Math.cos(t);return n[0]=r*a+i*u,n[1]=r*-u+i*a,n[2]=s*a+o*u,n[3]=s*-u+o*a,n},y.multiplyVec2=function(e,t,n){n||(n=t);var r=t[0],i=t[1];return n[0]=r*e[0]+i*e[1],n[1]=r*e[2]+i*e[3],n},y.scale=function(e,t,n){n||(n=e);var r=e[0],i=e[1],s=e[2],o=e[3],u=t[0],a=t[1];return n[0]=r*u,n[1]=i*a,n[2]=s*u,n[3]=o*a,n},y.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+"]"};var b={};return b.create=function(e){var t=new r(4);return e?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]):(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t},b.createFrom=function(e,t,n,i){var s=new r(4);return s[0]=e,s[1]=t,s[2]=n,s[3]=i,s},b.add=function(e,t,n){return n||(n=t),n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n},b.subtract=function(e,t,n){return n||(n=t),n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n},b.multiply=function(e,t,n){return n||(n=t),n[0]=e[0]*t[0],n[1]=e[1]*t[1],n[2]=e[2]*t[2],n[3]=e[3]*t[3],n},b.divide=function(e,t,n){return n||(n=t),n[0]=e[0]/t[0],n[1]=e[1]/t[1],n[2]=e[2]/t[2],n[3]=e[3]/t[3],n},b.scale=function(e,t,n){return n||(n=e),n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n},b.set=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},b.equal=function(e,n){return e===n||Math.abs(e[0]-n[0])<t&&Math.abs(e[1]-n[1])<t&&Math.abs(e[2]-n[2])<t&&Math.abs(e[3]-n[3])<t},b.negate=function(e,t){return t||(t=e),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},b.length=function(e){var t=e[0],n=e[1],r=e[2],i=e[3];return Math.sqrt(t*t+n*n+r*r+i*i)},b.squaredLength=function(e){var t=e[0],n=e[1],r=e[2],i=e[3];return t*t+n*n+r*r+i*i},b.lerp=function(e,t,n,r){return r||(r=e),r[0]=e[0]+n*(t[0]-e[0]),r[1]=e[1]+n*(t[1]-e[1]),r[2]=e[2]+n*(t[2]-e[2]),r[3]=e[3]+n*(t[3]-e[3]),r},b.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+"]"},e&&(e.glMatrixArrayType=r,e.MatrixArray=r,e.setMatrixArrayType=i,e.determineMatrixArrayType=s,e.glMath=n,e.vec2=g,e.vec3=o,e.vec4=b,e.mat2=y,e.mat3=p,e.mat4=d,e.quat4=v),{glMatrixArrayType:r,MatrixArray:r,setMatrixArrayType:i,determineMatrixArrayType:s,glMath:n,vec2:g,vec3:o,vec4:b,mat2:y,mat3:p,mat4:d,quat4:v}}),define("game/bg",["glmatrix"],function(e){function L(e,t,n){return t-e>180&&(t-=360),t-e<-180&&(t+=360),e+n*(t-e)}function A(e,t,n,r){var i,s,o,u,a,f,l;i=e[C]*(Math.PI*2/360),u=Math.sin(i),l=Math.cos(i),i=e[N]*(Math.PI*2/360),o=Math.sin(i),f=Math.cos(i),i=e[k]*(Math.PI*2/360),s=Math.sin(i),a=Math.cos(i),t&&(t[0]=f*l,t[1]=f*u,t[2]=-o),n&&(n[0]=-1*s*o*l+ -1*a*-u,n[1]=-1*s*o*u+ -1*a*l,n[2]=-1*s*f),r&&(r[0]=a*o*l+ -s*-u,r[1]=a*o*u+ -s*l,r[2]=a*f)}function O(e,t){var n=[0,0,0];A(e,t[0],n,t[2]),vec3.subtract([0,0,0],n,t[1])}function F(e){return e[0]==1?D:e[1]==1?P:e[2]==1?H:B}function I(e){var t=0;for(var n=0;n<3;n++)e.normal[n]<0&&(t|=1<<n);return t}function q(e,t,n){if(n.type<B)return n.dist<=e[n.type]?1:n.dist>=t[n.type]?2:3;var r=[0,0];if(n.signbits<8)for(var i=0;i<3;i++){var s=n.signbits>>i&1;r[s]+=n.normal[i]*t[i],r[s^1]+=n.normal[i]*e[i]}var o=0;return r[0]>=n.dist&&(o=1),r[1]<n.dist&&(o|=2),o}function U(e,t,n){var r=new Array(n),i=[].concat(R),s=[].concat(R),o=[].concat(R),u=[].concat(R),a=0,f,l=0,c,h=0,p,d=0,v,m;for(m=0;m<n;m++)f=e[m][t]&255,c=e[m][t]>>8&255,p=e[m][t]>>16&255,v=e[m][t]>>24&255^128,i[f]++,s[c]++,o[p]++,u[v]++;for(m=0;m<256;m++)f=a+i[m],c=l+s[m],p=h+o[m],v=d+u[m],i[m]=a,s[m]=l,o[m]=h,u[m]=d,a=f,l=c,h=p,d=v;for(m=0;m<n;m++)f=e[m][t]&255,r[i[f]]=e[m],i[f]++;for(m=0;m<n;m++)c=r[m][t]>>8&255,e[s[c]]=r[m],s[c]++;for(m=0;m<n;m++)p=e[m][t]>>16&255,r[o[p]]=e[m],o[p]++;for(m=0;m<n;m++)v=r[m][t]>>24&255^128,e[u[v]]=r[m],u[v]++;return e}function st(e){return e<-128?-128:e>127?127:e}function ut(e){var t=65536,n=e.length,r=e.slice||e.subarray,i;if(n<t)i=String.fromCharCode.apply(String,e);else{var s=[],o=0;while(o<n)s.push(String.fromCharCode.apply(String,r.call(e,o,o+t))),o+=t;i=s.join("")}return btoa(i)}function Nt(e,t){t.number=e.clientNum,t.eType=yt.PLAYER,t.pos.trType=S.INTERPOLATE,vec3.set(e.origin,t.pos.trBase),vec3.set(e.velocity,t.pos.trDelta),t.apos.trType=S.INTERPOLATE,vec3.set(e.viewangles,t.apos.trBase),t.angles2[C]=e.movementDir,t.clientNum=e.clientNum,t.eFlags=e.eFlags,t.groundEntityNum=e.groundEntityNum}function Ct(e,t,n){var r,i;switch(e.trType){case S.STATIONARY:case S.INTERPOLATE:vec3.set(e.trBase,n);break;case S.LINEAR:r=(t-e.trTime)*.001,vec3.add(e.trBase,vec3.scale(e.trDelta,r),n);break;case S.SINE:r=(t-e.trTime)/e.trDuration,i=Math.sin(r*Math.PI*2),vec3.add(e.trBase,i,e.trDelta,n);break;case S.LINEAR_STOP:t>e.trTime+e.trDuration&&(t=e.trTime+e.trDuration),r=(t-e.trTime)*.001,r<0&&(r=0),vec3.add(e.trBase,vec3.scale(e.trDelta,r),n);break;case S.GRAVITY:r=(t-e.trTime)*.001,vec3.add(e.trBase,vec3.scale(e.trDelta,r),n),n[2]-=.5*at*r*r;break;default:throw new Error("EvaluateTrajectory: unknown trType: "+e.trType)}}function kt(e,t){e.jumppad_ent=t.number,e.jumppad_frame=e.pmove_framecount,vec3.set(t.origin2,e.velocity)}function Wt(e,t){var n=Math.abs(e.forwardmove);Math.abs(e.rightmove)>n&&(n=Math.abs(e.rightmove)),Math.abs(e.upmove)>n&&(n=Math.abs(e.upmove));if(!n)return 0;var r=Math.sqrt(e.forwardmove*e.forwardmove+e.rightmove*e.rightmove+e.upmove*e.upmove),i=t*n/(127*r);return i}function Xt(e,t){var n=e.ps,r=vec3.create(n.velocity);Ut&&(r[2]=0);var i=vec3.length(r);if(i<1){n.velocity[0]=0,n.velocity[1]=0;return}var s=0;if(Ut&&!(qt.surfaceFlags&z.SLICK)&&!(n.pm_flags&xt.TIME_KNOCKBACK)){var o=i<Lt?Lt:i;s+=o*Pt*e.frameTime}t&&(s+=i*Ht*e.frameTime);var u=i-s;u<0&&(u=0),u/=i,vec3.scale(n.velocity,u)}function Vt(e,t,n){var r=vec3.dot(e,t);r<0?r*=n:r/=n;var i=vec3.scale(t,r,[0,0,0]);return vec3.subtract(e,i,[0,0,0])}function $t(e,t,n,r){var i=e.ps,s=vec3.dot(i.velocity,t),o=n-s;if(o<=0)return;var u=r*e.frameTime*n;u>o&&(u=o),vec3.add(i.velocity,vec3.scale(t,u,[0,0,0]))}function Jt(e){e.mins[0]=-15,e.mins[1]=-15,e.mins[2]=-24,e.maxs[0]=15,e.maxs[1]=15,e.maxs[2]=32,e.ps.viewheight=dt}function Kt(e){var t=e.ps;return e.cmd.upmove<10?!1:t.pm_flags&xt.JUMP_HELD?(e.cmd.upmove=0,!1):(Rt=!1,Ut=!1,t.pm_flags|=xt.JUMP_HELD,t.groundEntityNum=f,t.velocity[2]=ft,!0)}function Qt(e){var t=e.ps,n=[t.origin[0],t.origin[1],t.origin[2]-.25],r=qt=e.trace(t.origin,n,e.mins,e.maxs,e.tracemask);if(r.allSolid&&!Gt(e,r))return;if(r.fraction===1){Yt(e);return}if(t.velocity[2]>0&&vec3.dot(t.velocity,r.plane.normal)>10){t.groundEntityNum=f,Rt=!1,Ut=!1;return}if(r.plane.normal[2]<ct){t.groundEntityNum=f,Rt=!0,Ut=!1;return}Rt=!0,Ut=!0}function Gt(e,t){var n=e.ps,r=[0,0,0],t;for(var i=-1;i<=1;i++)for(var s=-1;s<=1;s++)for(var o=-1;o<=1;o++){vec3.set(n.origin,r),r[0]+=i,r[1]+=s,r[2]+=o,t=e.trace(r,r,e.mins,e.maxs,e.tracemask);if(!t.allSolid)return r[0]=n.origin[0],r[1]=n.origin[1],r[2]=n.origin[2]-.25,qt=e.trace(n.origin,r,e.mins,e.maxs,e.tracemask),!0}return n.groundEntityNum=f,Rt=!1,Ut=!1,!1}function Yt(e){e.ps.groundEntityNum=f,Rt=!1,Ut=!1}function Zt(e,t){var n=e.ps,r=[0,0,0],i=e.frameTime,s=[],o=4,u=[0,0,0];t&&(vec3.set(n.velocity,r),r[2]-=n.gravity*i,n.velocity[2]=(n.velocity[2]+r[2])*.5,Rt&&(n.velocity=Vt(n.velocity,qt.plane.normal,pt))),Rt&&s.push(vec3.set(qt.plane.normal,[0,0,0])),s.push(vec3.normalize(n.velocity,[0,0,0]));for(var a=0;a<o;a++){vec3.add(n.origin,vec3.scale(n.velocity,i,[0,0,0]),u);var f=e.trace(n.origin,u,e.mins,e.maxs,e.tracemask);if(f.allSolid)return n.velocity[2]=0,!1;f.fraction>0&&vec3.set(f.endPos,n.origin);if(f.fraction===1)break;i-=i*f.fraction;if(s.length>=lt)return n.velocity=[0,0,0],!1;for(var l=0;l<s.length;l++)if(vec3.dot(f.plane.normal,s[l])>.99){vec3.add(n.velocity,f.plane.normal);break}if(l<s.length)continue;s.push(vec3.set(f.plane.normal,[0,0,0]));for(var l=0;l<s.length;++l){var c=vec3.dot(n.velocity,s[l]);if(c>=.1)continue;var h=Vt(n.velocity,s[l],pt),p=Vt(r,s[l],pt);for(var d=0;d<s.length;d++){if(d==l)continue;if(vec3.dot(h,s[d])>=.1)continue;h=Vt(h,s[d],pt),p=Vt(p,s[d],pt);if(vec3.dot(h,s[l])>=0)continue;var v=vec3.cross(s[l],s[d],[0,0,0]);vec3.normalize(v);var m=vec3.dot(v,n.velocity);vec3.scale(v,m,h),vec3.cross(s[l],s[d],v),vec3.normalize(v),m=vec3.dot(v,r),vec3.scale(v,m,p);for(var g=0;g<s.length;g++){if(g==l||g==d)continue;if(vec3.dot(h,s[g])>=.1)continue;return n.velocity=[0,0,0],!1}}vec3.set(h,n.velocity),vec3.set(p,r);break}}return t&&vec3.set(r,n.velocity),a===0}function en(e,t){var n=e.ps,r=vec3.create(n.origin),i=vec3.create(n.velocity);if(Zt(e,t))return;var s=vec3.create(r);s[2]-=ht;var o=e.trace(r,s,e.mins,e.maxs,e.tracemask),u=[0,0,1];if(n.velocity[2]>0&&(o.fraction===1||vec3.dot(o.plane.normal,u)<.7))return;vec3.set(r,u),u[2]+=ht,o=e.trace(r,u,e.mins,e.maxs,e.tracemask);if(o.allSolid)return;var a=o.endPos[2]-r[2];vec3.set(o.endPos,n.origin),vec3.set(i,n.velocity),Zt(e,t),vec3.set(n.origin,s),s[2]-=a,o=e.trace(n.origin,s,e.mins,e.maxs,e.tracemask),o.allSolid||vec3.set(o.endPos,n.origin),o.fraction<1&&(n.velocity=Vt(n.velocity,o.plane.normal,pt))}function tn(e){var t=e.ps,n=e.cmd;Xt(e,!0);var r=Wt(n,t.speed),s=[0,0,0];for(i=0;i<3;i++)s[i]=r*jt[i]*n.forwardmove+r*Ft[i]*n.rightmove;s[2]+=n.upmove;var o=vec3.length(s),u=vec3.normalize(s,[0,0,0]);$t(e,u,o,Dt),en(e,!1)}function nn(e){var t=e.ps,n=e.cmd;Xt(e),jt[2]=0,Ft[2]=0,vec3.normalize(jt),vec3.normalize(Ft);var r=Wt(n,t.speed),i=[0,0,0];for(var s=0;s<2;s++)i[s]=jt[s]*n.forwardmove+Ft[s]*n.rightmove;i[2]=0;var o=vec3.length(i),u=vec3.normalize(i,[0,0,0]);o*=r,$t(e,u,o,_t),Rt&&Vt(t.velocity,qt.plane.normal,t.velocity,pt),en(e,!0)}function rn(e){var t=e.ps,n=e.cmd;if(Kt(e)){nn(e);return}Xt(e),jt[2]=0,Ft[2]=0,jt=Vt(jt,qt.plane.normal,pt),Ft=Vt(Ft,qt.plane.normal,pt),vec3.normalize(jt),vec3.normalize(Ft);var r=Wt(n,t.speed),i=[0,0,0];for(var s=0;s<3;s++)i[s]=jt[s]*n.forwardmove+Ft[s]*n.rightmove;var o=vec3.length(i),u=vec3.normalize(i,[0,0,0]);o*=r;var a=Mt;if(qt.surfaceFlags&z.SLICK||t.pm_flags&xt.TIME_KNOCKBACK)a=_t;$t(e,u,o,a);if(qt.surfaceFlags&z.SLICK||t.pm_flags&xt.TIME_KNOCKBACK)t.velocity[2]-=t.gravity*e.frameTime;var f=vec3.length(t.velocity);t.velocity=Vt(t.velocity,qt.plane.normal,pt),vec3.normalize(t.velocity),vec3.scale(t.velocity,f);if(!t.velocity[0]&&!t.velocity[1])return;en(e,!1)}function sn(e,t){for(var n=0;n<3;n++){var r=t.angles[n]+e.delta_angles[n]&65535;r>32767&&(r-=65535),n===N&&(r>16e3?(e.delta_angles[n]=16e3-t.angles[n],r=16e3):r<-16e3&&(e.delta_angles[n]=-16e3-t.angles[n],r=-16e3)),e.viewangles[n]=_(r)}}function on(e){var t=e.ps;t.pm_time&&(zt>=t.pm_time?(t.pm_flags&=~xt.ALL_TIMES,t.pm_time=0):t.pm_time-=zt)}function un(e){var t=e.ps,n=e.cmd;t.commandTime=n.serverTime,e.frameTime=zt*.001,sn(t,n),A(t.viewangles,jt,Ft,It),e.cmd.upmove<10&&(t.pm_flags&=~xt.JUMP_HELD),Jt(e),Qt(e),on(e),Ut?rn(e):nn(e),Qt(e)}function an(e){var t=e.ps,n=e.cmd;if(n.serverTime<t.commandTime)throw new Error("Pmove: cmd.serverTime < ps.commandTime");n.serverTime>t.commandTime+1e3&&(t.commandTime=n.serverTime-1e3),t.pmove_framecount=t.pmove_framecount+1&(1<<w)-1;while(t.commandTime!=n.serverTime)zt=n.serverTime-t.commandTime,zt<1?zt=1:zt>66&&(zt=66),un(e),e.ps.pm_flags&xt.JUMP_HELD&&(e.cmd.upmove=20)}var t="baseq3",n=1,r=2,s=4,o=64,u=64,a=1024,f=a-1,l=a-2,c=a-2,h=256,p=256,d={NAD:0,LOOPBACK:1,IP:2},v={CLIENT:0,SERVER:1},m=function(e,t,n){this.type=e,this.ip=t,this.port=n},g=function(e,t){var n=e,r=function(t){if(!arguments.length)return n;var r=n;typeof e=="string"?n=t.toString():e%1===0?n=parseInt(t):n=parseFloat(t)};return r.flags=t,r},y={ARCHIVE:1,USERINFO:2,SERVERINFO:4,SYSTEMINFO:8},b=function(){this.serverTime=0,this.angles=[0,0,0],this.forwardmove=0,this.rightmove=0,this.upmove=0};b.prototype.clone=function(e){return typeof e=="undefined"&&(e=new b),e.serverTime=this.serverTime,vec3.set(this.angles,e.angles),e.forwardmove=this.forwardmove,e.rightmove=this.rightmove,e.upmove=this.upmove,e};var w=6,E=function(){this.clientNum=0,this.commandTime=0,this.pm_type=0,this.pm_flags=0,this.origin=[0,0,0],this.velocity=[0,0,0],this.viewangles=[0,0,0],this.delta_angles=[0,0,0],this.speed=0,this.gravity=0,this.groundEntityNum=f,this.jumppad_ent=0,this.jumppad_frame=0,this.pmove_framecount=0};E.prototype.clone=function(e){return typeof e=="undefined"&&(e=new E),e.clientNum=this.clientNum,e.commandTime=this.commandTime,e.pm_type=this.pm_type,e.pm_flags=this.pm_flags,vec3.set(this.origin,e.origin),vec3.set(this.velocity,e.velocity),vec3.set(this.viewangles,e.viewangles),vec3.set(this.delta_angles,e.delta_angles),e.speed=this.speed,e.gravity=this.gravity,e.groundEntityNum=this.groundEntityNum,e.jumppad_ent=this.jumppad_ent,e.jumppad_frame=this.jumppad_frame,e.pmove_framecount=this.pmove_framecount,e};var S={STATIONARY:0,INTERPOLATE:1,LINEAR:2,LINEAR_STOP:3,SINE:4,GRAVITY:5},x=function(){this.trType=0,this.trTime=0,this.trDuration=0,this.trBase=[0,0,0],this.trDelta=[0,0,0]};x.prototype.clone=function(e){return typeof e=="undefined"&&(e=new x),e.trType=this.trType,e.trTime=this.trTime,e.trDuration=this.trDuration,vec3.set(this.trBase,e.trBase),vec3.set(this.trDelta,e.trDelta),e};var T=function(){this.number=0,this.eType=0,this.eFlags=0,this.pos=new x,this.apos=new x,this.time=0,this.time2=0,this.origin=[0,0,0],this.origin2=[0,0,0],this.angles=[0,0,0],this.angles2=[0,0,0],this.groundEntityNum=f,this.modelIndex=0,this.modelIndex2=0,this.clientNum=0,this.frame=0,this.solid=0,this.event=0,this.eventParm=0};T.prototype.clone=function(e){return typeof e=="undefined"&&(e=new T),e.number=this.number,e.eType=this.eType,e.eFlags=this.eFlags,this.pos.clone(e.pos),this.apos.clone(e.apos),e.time=this.time,e.time2=this.time2,vec3.set(this.origin,e.origin),vec3.set(this.origin2,e.origin2),vec3.set(this.angles,e.angles),vec3.set(this.angles2,e.angles2),e.groundEntityNum=this.groundEntityNum,e.modelIndex=this.modelIndex,e.modelindex2=this.modelIndex2,e.clientNum=this.clientNum,e.frame=this.frame,e.solid=this.solid,e.event=this.event,e.eventParm=this.eventParm,e};var N=0,C=1,k=2,M=function(e){return e*65536/360&65535},_=function(e){return e*(360/65536)},D=0,P=1,H=2,B=3,j=function(){this.normal=vec3.create(),this.dist=0,this.type=0,this.signbits=0},R=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],z={NODAMAGE:1,SLICK:2,SKY:4,LADDER:8,NOIMPACT:16,NOMARKS:32,FLESH:64,NODRAW:128,HINT:256,SKIP:512,NOLIGHTMAP:1024,POINTLIGHT:2048,METALSTEPS:4096,NOSTEPS:8192,NONSOLID:16384,LIGHTFILTER:32768,ALPHASHADOW:65536,NODLIGHT:131072,DUST:262144},W={ENTITIES:0,SHADERS:1,PLANES:2,NODES:3,LEAFS:4,LEAFSURFACES:5,LEAFBRUSHES:6,MODELS:7,BRUSHES:8,BRUSHSIDES:9,DRAWVERTS:10,DRAWINDEXES:11,FOGS:12,SURFACES:13,LIGHTMAPS:14,LIGHTGRID:15,VISIBILITY:16,NUM_LUMPS:17},X=64,V=function(){this.fileofs=0,this.filelen=0},$=function(){this.ident=null,this.version=0,this.lumps=new Array(W.NUM_LUMPS);for(var e=0;e<W.NUM_LUMPS;e++)this.lumps[e]=new V},J=function(){this.mins=[0,0,0],this.maxs=[0,0,0],this.firstSurface=0,this.numSurfaces=0,this.firstBrush=0,this.numBrushes=0};J.size=40;var K=function(){this.shaderName=null,this.flags=0,this.contents=0};K.size=72;var Q=function(){this.normal=[0,0,0],this.dist=0};Q.size=16;var G=function(){this.planeNum=0,this.childrenNum=[0,0],this.mins=[0,0,0],this.maxs=[0,0,0]};G.size=36;var Y=function(){this.cluster=0,this.area=0,this.mins=[0,0,0],this.maxs=[0,0,0],this.firstLeafSurface=0,this.numLeafSurfaces=0,this.firstLeafBrush=0,this.numLeafBrushes=0};Y.size=48;var Z=function(){this.planeNum=0,this.shader=0};Z.size=8;var et=function(){this.side=0,this.numsides=0,this.shader=0};et.size=12;var tt=function(){this.shader=null,this.brushNum=0,this.visibleSide=0};tt.size=72;var nt=function(){this.pos=[0,0,0],this.texCoord=[0,0],this.lmCoord=[0,0],this.normal=[0,0,0],this.color=[0,0,0,0]};nt.size=44;var rt={BAD:0,PLANAR:1,PATCH:2,TRIANGLE_SOUP:3,FLARE:4},it=function(){this.shaderNum=0,this.fogNum=0,this.surfaceType=0,this.vertex=0,this.vertCount=0,this.meshVert=0,this.meshVertCount=0,this.lightmapNum=0,this.lmStart=[0,0],this.lmSize=[0,0],this.lmOrigin=[0,0,0],this.lmVecs=[[0,0,0],[0,0,0],[0,0,0]],this.patchWidth=0,this.patchHeight=0};it.size=104;var ot=function(){this.gl=null,this.handle=null},at=800,ft=270,lt=5,ct=.7,ht=18,pt=1.001,dt=26,vt=15,mt={BAD:0,WEAPON:1,AMMO:2,ARMOR:3,HEALTH:4,POWERUP:5,HOLDABLE:6,PERSISTANT_POWERUP:7,TEAM:8},gt=function(e,t,n){this.classname=e,this.modelPaths=t,this.giType=n},yt={GENERAL:0,PLAYER:1,ITEM:2,MISSILE:3,MOVER:4,BEAM:5,PORTAL:6,SPEAKER:7,PUSH_TRIGGER:8,TELEPORT_TRIGGER:9,INVISIBLE:10,GRAPPLE:11,TEAM:12,EVENTS:13},bt={DEAD:1,TELEPORT_BIT:4,AWARD_EXCELLENT:8,PLAYER_EVENT:16,BOUNCE:16,BOUNCE_HALF:32,AWARD_GAUNTLET:64,NODRAW:128,FIRING:256,KAMIKAZE:512,MOVER_STOP:1024,AWARD_CAP:2048,TALK:4096,CONNECTION:8192,VOTED:16384,AWARD_IMPRESSIVE:32768,AWARD_DEFEND:65536,AWARD_ASSIST:131072,AWARD_DENIED:262144,TEAMVOTED:524288},wt={SOLID:1,LAVA:8,SLIME:16,WATER:32,FOG:64,NOTTEAM1:128,NOTTEAM2:256,NOBOTCLIP:512,AREAPORTAL:32768,PLAYERCLIP:65536,MONSTERCLIP:131072,TELEPORTER:262144,JUMPPAD:524288,CLUSTERPORTAL:1048576,DONOTENTER:2097152,BOTCLIP:4194304,MOVER:8388608,ORIGIN:16777216,BODY:33554432,CORPSE:67108864,DETAIL:134217728,STRUCTURAL:268435456,TRANSLUCENT:536870912,TRIGGER:1073741824,NODROP:2147483648},Et={ALL:-1,SOLID:wt.SOLID,PLAYERSOLID:wt.SOLID|wt.PLAYERCLIP|wt.BODY,DEADSOLID:wt.SOLID|wt.PLAYERCLIP,WATER:wt.WATER|wt.LAVA|wt.SLIME,OPAQUE:wt.SOLID|wt.SLIME|wt.LAVA,SHOT:wt.SOLID|wt.BODY|wt.CORPSE},St={NORMAL:0,NOCLIP:1,SPECTATOR:2,DEAD:3,FREEZE:4,INTERMISSION:5},xt={DUCKED:1,JUMP_HELD:2,BACKWARDS_JUMP:8,BACKWARDS_RUN:16,TIME_LAND:32,TIME_KNOCKBACK:64,TIME_WATERJUMP:256,RESPAWNED:512,USE_ITEM_HELD:1024,GRAPPLE_PULL:2048,FOLLOW:4096,SCOREBOARD:8192,INVULEXPAND:16384,ALL_TIMES:352},Tt=function(){this.ps=null,this.cmd=null,this.frameTime=0,this.mins=[0,0,0],this.maxs=[0,0,0],this.trace=null},Lt=100,At=.25,Ot=50,Mt=10,_t=1,Dt=8,Pt=6,Ht=3,Bt=10,jt=[0,0,0],Ft=[0,0,0],It=[0,0,0],qt,Rt,Ut,zt,fn=[new gt("item_armor_shard",["models/powerups/armor/shard.md3"],mt.ARMOR),new gt("item_armor_combat",["models/powerups/armor/armor_yel.md3"],mt.ARMOR),new gt("item_armor_body",["models/powerups/armor/armor_red.md3"],mt.ARMOR),new gt("item_health_small",["models/powerups/health/small_cross.md3","models/powerups/health/small_sphere.md3"],mt.HEALTH),new gt("item_health",["models/powerups/health/medium_cross.md3","models/powerups/health/medium_sphere.md3"],mt.HEALTH),new gt("item_health_large",["models/powerups/health/large_cross.md3","models/powerups/health/large_sphere.md3"],mt.HEALTH),new gt("item_health_mega",["models/powerups/health/mega_cross.md3","models/powerups/health/mega_sphere.md3"],mt.HEALTH),new gt("weapon_shotgun",["models/weapons2/shotgun/shotgun.md3"],mt.WEAPON),new gt("weapon_machinegun",["models/weapons2/machinegun/machinegun.md3"],mt.WEAPON),new gt("weapon_grenadelauncher"["models/weapons2/grenadel/grenadel.md3"],mt.WEAPON),new gt("weapon_rocketlauncher",["models/weapons2/rocketl/rocketl.md3"],mt.WEAPON),new gt("weapon_lightning",["models/weapons2/lightning/lightning.md3"],mt.WEAPON),new gt("weapon_railgun",["models/weapons2/railgun/railgun.md3"],mt.WEAPON),new gt("weapon_plasmagun",["models/weapons2/plasma/plasma.md3"],mt.WEAPON),new gt("item_quad",["models/powerups/instant/quad.md3","models/powerups/instant/quad_ring.md3"],mt.POWERUP)];return{ItemList:fn,Pmove:an,UpdateViewAngles:sn,PlayerStateToEntityState:Nt,EvaluateTrajectory:Ct,TouchJumpPad:kt}}),define("game/gm",["underscore","glmatrix","game/bg"],function(_,glmatrix,bg){function LerpAngle(e,t,n){return t-e>180&&(t-=360),t-e<-180&&(t+=360),e+n*(t-e)}function AnglesToVectors(e,t,n,r){var i,s,o,u,a,f,l;i=e[YAW]*(Math.PI*2/360),u=Math.sin(i),l=Math.cos(i),i=e[PITCH]*(Math.PI*2/360),o=Math.sin(i),f=Math.cos(i),i=e[ROLL]*(Math.PI*2/360),s=Math.sin(i),a=Math.cos(i),t&&(t[0]=f*l,t[1]=f*u,t[2]=-o),n&&(n[0]=-1*s*o*l+ -1*a*-u,n[1]=-1*s*o*u+ -1*a*l,n[2]=-1*s*f),r&&(r[0]=a*o*l+ -s*-u,r[1]=a*o*u+ -s*l,r[2]=a*f)}function AnglesToAxis(e,t){var n=[0,0,0];AnglesToVectors(e,t[0],n,t[2]),vec3.subtract([0,0,0],n,t[1])}function PlaneTypeForNormal(e){return e[0]==1?PLANE_X:e[1]==1?PLANE_Y:e[2]==1?PLANE_Z:PLANE_NON_AXIAL}function GetPlaneSignbits(e){var t=0;for(var n=0;n<3;n++)e.normal[n]<0&&(t|=1<<n);return t}function BoxOnPlaneSide(e,t,n){if(n.type<PLANE_NON_AXIAL)return n.dist<=e[n.type]?1:n.dist>=t[n.type]?2:3;var r=[0,0];if(n.signbits<8)for(var i=0;i<3;i++){var s=n.signbits>>i&1;r[s]+=n.normal[i]*t[i],r[s^1]+=n.normal[i]*e[i]}var o=0;return r[0]>=n.dist&&(o=1),r[1]<n.dist&&(o|=2),o}function RadixSort(e,t,n){var r=new Array(n),i=[].concat(_radixSort_0),s=[].concat(_radixSort_0),o=[].concat(_radixSort_0),u=[].concat(_radixSort_0),a=0,f,l=0,c,h=0,p,d=0,v,m;for(m=0;m<n;m++)f=e[m][t]&255,c=e[m][t]>>8&255,p=e[m][t]>>16&255,v=e[m][t]>>24&255^128,i[f]++,s[c]++,o[p]++,u[v]++;for(m=0;m<256;m++)f=a+i[m],c=l+s[m],p=h+o[m],v=d+u[m],i[m]=a,s[m]=l,o[m]=h,u[m]=d,a=f,l=c,h=p,d=v;for(m=0;m<n;m++)f=e[m][t]&255,r[i[f]]=e[m],i[f]++;for(m=0;m<n;m++)c=r[m][t]>>8&255,e[s[c]]=r[m],s[c]++;for(m=0;m<n;m++)p=e[m][t]>>16&255,r[o[p]]=e[m],o[p]++;for(m=0;m<n;m++)v=r[m][t]>>24&255^128,e[u[v]]=r[m],u[v]++;return e}function ClampChar(e){return e<-128?-128:e>127?127:e}function atob64(e){var t=65536,n=e.length,r=e.slice||e.subarray,i;if(n<t)i=String.fromCharCode.apply(String,e);else{var s=[],o=0;while(o<n)s.push(String.fromCharCode.apply(String,r.call(e,o,o+t))),o+=t;i=s.join("")}return btoa(i)}function Init(e,t){console.log("--------- GM Init ---------"),com=e,sv=t,level=new LevelLocals,g_gravity=com.AddCvar("g_gravity",800),sv.LocateGameData(level.gentities,level.clients),SpawnAllEntitiesFromDefs()}function Shutdown(){}function Frame(e){level.framenum++,level.previousTime=level.time,level.time=e;for(var t=0;t<level.gentities.length;t++){var n=level.gentities[t];if(!n)continue;EntityThink(n)}}function TouchTriggers(e){if(!e.client)return;var t=e.client.ps,n=[40,40,52],r=[0,0,0],i=[0,0,0];vec3.subtract(t.origin,n,r),vec3.add(t.origin,n,i);var s=sv.FindEntitiesInBox(r,i);for(var o=0;o<s.length;o++){var u=level.gentities[s[o]];if(!u.touch)continue;if(!(u.contents&ContentTypes.TRIGGER))continue;u.touch.call(this,u,e)}t.jumppad_frame!=t.pmove_framecount&&(t.jumppad_frame=0,t.jumppad_ent=0)}function ClientConnect(e,t){var n=level.clients[e]=new GameClient,r=level.gentities[e]=new GameEntity;return r.client=n,console.log("ClientConnect: "+e),ClientUserinfoChanged(e),null}function ClientUserinfoChanged(e){var t=level.gentities[e],n=t.client}function ClientBegin(e){var t=level.gentities[e];t.s.number=e,t.client.ps.clientNum=e,ClientSpawn(t)}function ClientThink(e){var t=level.clients[e],n=level.gentities[e];sv.GetUserCommand(e,n.client.pers.cmd);var r=n.client.pers.cmd;r.serverTime>level.time+200&&(r.serverTime=level.time+200),r.serverTime<level.time-1e3&&(r.serverTime=level.time-1e3),t.ps.gravity=g_gravity(),t.ps.speed=320;var i=new PmoveInfo;i.ps=t.ps,i.cmd=r,i.tracemask=ContentMasks.PLAYERSOLID,i.trace=sv.Trace,i.client=!1,bg.Pmove(i),bg.PlayerStateToEntityState(n.client.ps,n.s),vec3.set(t.ps.origin,n.currentOrigin),vec3.set(i.mins,n.mins),vec3.set(i.maxs,n.maxs),sv.LinkEntity(n),TouchTriggers(n),vec3.set(n.client.ps.origin,n.currentOrigin)}function GetClientPlayerstate(e){var t=level.clients[e];return t.ps}function ClientSpawn(e){var t=e.client,n=e.client.ps;e.classname="player",e.contents=ContentTypes.BODY,e.s.groundEntityNum=ENTITYNUM_NONE,vec3.set(playerMins,e.mins),vec3.set(playerMaxs,e.maxs);var r=SelectRandomDeathmatchSpawnPoint(),i=vec3.create(r.s.origin);i[2]+=70,SetOrigin(e,i),vec3.set(i,n.origin),vec3.set(n.velocity,[0,0,0]),sv.GetUserCommand(t.ps.clientNum,e.client.pers.cmd),SetClientViewAngle(e,r.s.angles)}function ClientDisconnect(e){var t=level.gentities[e];if(!t.client)return;console.log("ClientDisconnect: "+e),sv.UnlinkEntity(t),t.s.modelindex=0,t.classname="disconnected"}function SetClientViewAngle(e,t){for(var n=0;n<3;n++){var r=AngleToShort(t[n]);e.client.ps.delta_angles[n]=r-e.client.pers.cmd.angles[n]}vec3.set(t,e.s.angles),vec3.set(e.s.angles,e.client.ps.viewangles)}function SelectNearestDeathmatchSpawnPoint(e){var t=999999,n=null,r=FindEntity("classname","info_player_deathmatch");for(var i=0;i<r.length;i++){var s=r[i],o=vec3.length(vec3.subtract(s.origin,e,[0,0,0]));o<t&&(t=o,n=s)}return n}function SelectRandomDeathmatchSpawnPoint(){var e=FindEntity("classname","info_player_deathmatch");return e[Math.floor(Math.random()*e.length)]}function SpawnEntity(){for(var e=MAX_CLIENTS;e<MAX_GENTITIES;e++){if(level.gentities[e])continue;var t=level.gentities[e]=new GameEntity;return t.s.number=e,t}return null}function FreeEntity(e){sv.UnlinkEntity(e),delete level.gentities[e.s.number]}function FindEntity(e,t){var n=[];for(var r=0;r<level.gentities.length;r++){var i=level.gentities[r];if(!i)continue;i[e]===t&&n.push(i)}return n}function SetOrigin(e,t){vec3.set(t,e.s.pos.trBase),e.s.pos.trType=TrajectoryType.STATIONARY,e.s.pos.trTime=0,e.s.pos.trDuration=0,vec3.set([0,0,0],e.s.pos.trDelta),vec3.set(t,e.currentOrigin)}function EntityThink(e){var t=e.nextthink;if(t<=0)return;if(t>level.time)return;e.nextthink=0;if(!e.think)throw new Error("NULL ent->think");e.think.call(this,e)}function EntityPickTarget(e){if(!e)throw new Error("SV: EntityPickTarget called with NULL targetname");var t=FindEntity("targetname",e);if(!t.length)throw new Error("SV: EntityPickTarget: target "+e+" not found");return t[Math.floor(Math.random()*t.length)]}function SpawnEntityFromDef(def){var ent=SpawnEntity();for(var defKey in def){if(!def.hasOwnProperty(defKey))continue;var entKeys=keyMap[defKey]||[defKey];for(var i=0;i<entKeys.length;i++){var entKey=entKeys[i],val=eval("ent."+entKey);if(val===undefined)continue;eval("ent."+entKey+" = def[defKey]")}}entityEvents[ent.classname]&&_.extend(ent,entityEvents[ent.classname]);var spawn;for(var i=0;i<bg.ItemList.length;i++){var item=bg.ItemList[i];if(item.classname===ent.classname){SpawnItem(ent,item);return}}if(!ent.spawn){FreeEntity(ent);return}ent.spawn.call(this,ent)}function SpawnAllEntitiesFromDefs(){var e=sv.GetEntityDefs();for(var t=0;t<e.length;t++){var n=e[t];SpawnEntityFromDef(n)}}function SpawnItem(e,t){e.item=t,e.nextthink=level.time+FRAMETIME*2,e.think=FinishSpawningItem}function FinishSpawningItem(e){var t=bg.ItemList.indexOf(e.item);vec3.set([-ITEM_RADIUS,-ITEM_RADIUS,-ITEM_RADIUS],e.mins),vec3.set([ITEM_RADIUS,ITEM_RADIUS,ITEM_RADIUS],e.maxs),e.s.eType=EntityType.ITEM,e.s.modelIndex=t,e.contents=ContentTypes.TRIGGER,SetOrigin(e,e.s.origin),sv.LinkEntity(e)}function TeleportPlayer(e,t,n){var r=n[0]>999999;sv.UnlinkEntity(e),vec3.set(t,e.client.ps.origin),e.client.ps.origin[2]+=1,r||(AnglesToVectors(n,e.client.ps.velocity,null,null),vec3.scale(e.client.ps.velocity,400),e.client.ps.pm_time=160,e.client.ps.pm_flags|=PmoveFlags.TIME_KNOCKBACK,SetClientViewAngle(e,n)),e.client.ps.eFlags^=EntityFlags.TELEPORT_BIT,bg.PlayerStateToEntityState(e.client.ps,e.s),vec3.set(e.client.ps.origin,e.currentOrigin),sv.LinkEntity(e)}function AimAtTarget(e){var t=vec3.add(e.absmin,e.absmax,[0,0,0]);vec3.scale(t,.5);var n=EntityPickTarget(e.target);if(!n){FreeEntity(e);return}var r=n.s.origin[2]-t[2],i=g_gravity(),s=Math.sqrt(r/(.5*i));if(!s){FreeEntity(e);return}vec3.subtract(n.s.origin,t,e.s.origin2),e.s.origin2[2]=0;var o=vec3.length(e.s.origin2);vec3.normalize(e.s.origin2);var u=o/s;vec3.scale(e.s.origin2,u),e.s.origin2[2]=s*i}var Q3W_BASE_FOLDER="baseq3",SNAPFLAG_RATE_DELAYED=1,SNAPFLAG_NOT_ACTIVE=2,SNAPFLAG_SERVERCOUNT=4,MAX_CLIENTS=64,MAX_LOCATIONS=64,MAX_GENTITIES=1024,ENTITYNUM_NONE=MAX_GENTITIES-1,ENTITYNUM_WORLD=MAX_GENTITIES-2,ENTITYNUM_MAX_NORMAL=MAX_GENTITIES-2,MAX_MODELS=256,MAX_SOUNDS=256,NetAdrType={NAD:0,LOOPBACK:1,IP:2},NetSrc={CLIENT:0,SERVER:1},NetAdr=function(e,t,n){this.type=e,this.ip=t,this.port=n},Cvar=function(e,t){var n=e,r=function(t){if(!arguments.length)return n;var r=n;typeof e=="string"?n=t.toString():e%1===0?n=parseInt(t):n=parseFloat(t)};return r.flags=t,r},CvarFlags={ARCHIVE:1,USERINFO:2,SERVERINFO:4,SYSTEMINFO:8},UserCmd=function(){this.serverTime=0,this.angles=[0,0,0],this.forwardmove=0,this.rightmove=0,this.upmove=0};UserCmd.prototype.clone=function(e){return typeof e=="undefined"&&(e=new UserCmd),e.serverTime=this.serverTime,vec3.set(this.angles,e.angles),e.forwardmove=this.forwardmove,e.rightmove=this.rightmove,e.upmove=this.upmove,e};var PS_PMOVEFRAMECOUNTBITS=6,PlayerState=function(){this.clientNum=0,this.commandTime=0,this.pm_type=0,this.pm_flags=0,this.origin=[0,0,0],this.velocity=[0,0,0],this.viewangles=[0,0,0],this.delta_angles=[0,0,0],this.speed=0,this.gravity=0,this.groundEntityNum=ENTITYNUM_NONE,this.jumppad_ent=0,this.jumppad_frame=0,this.pmove_framecount=0};PlayerState.prototype.clone=function(e){return typeof e=="undefined"&&(e=new PlayerState),e.clientNum=this.clientNum,e.commandTime=this.commandTime,e.pm_type=this.pm_type,e.pm_flags=this.pm_flags,vec3.set(this.origin,e.origin),vec3.set(this.velocity,e.velocity),vec3.set(this.viewangles,e.viewangles),vec3.set(this.delta_angles,e.delta_angles),e.speed=this.speed,e.gravity=this.gravity,e.groundEntityNum=this.groundEntityNum,e.jumppad_ent=this.jumppad_ent,e.jumppad_frame=this.jumppad_frame,e.pmove_framecount=this.pmove_framecount,e};var TrajectoryType={STATIONARY:0,INTERPOLATE:1,LINEAR:2,LINEAR_STOP:3,SINE:4,GRAVITY:5},Trajectory=function(){this.trType=0,this.trTime=0,this.trDuration=0,this.trBase=[0,0,0],this.trDelta=[0,0,0]};Trajectory.prototype.clone=function(e){return typeof e=="undefined"&&(e=new Trajectory),e.trType=this.trType,e.trTime=this.trTime,e.trDuration=this.trDuration,vec3.set(this.trBase,e.trBase),vec3.set(this.trDelta,e.trDelta),e};var EntityState=function(){this.number=0,this.eType=0,this.eFlags=0,this.pos=new Trajectory,this.apos=new Trajectory,this.time=0,this.time2=0,this.origin=[0,0,0],this.origin2=[0,0,0],this.angles=[0,0,0],this.angles2=[0,0,0],this.groundEntityNum=ENTITYNUM_NONE,this.modelIndex=0,this.modelIndex2=0,this.clientNum=0,this.frame=0,this.solid=0,this.event=0,this.eventParm=0};EntityState.prototype.clone=function(e){return typeof e=="undefined"&&(e=new EntityState),e.number=this.number,e.eType=this.eType,e.eFlags=this.eFlags,this.pos.clone(e.pos),this.apos.clone(e.apos),e.time=this.time,e.time2=this.time2,vec3.set(this.origin,e.origin),vec3.set(this.origin2,e.origin2),vec3.set(this.angles,e.angles),vec3.set(this.angles2,e.angles2),e.groundEntityNum=this.groundEntityNum,e.modelIndex=this.modelIndex,e.modelindex2=this.modelIndex2,e.clientNum=this.clientNum,e.frame=this.frame,e.solid=this.solid,e.event=this.event,e.eventParm=this.eventParm,e};var PITCH=0,YAW=1,ROLL=2,AngleToShort=function(e){return e*65536/360&65535},ShortToAngle=function(e){return e*(360/65536)},PLANE_X=0,PLANE_Y=1,PLANE_Z=2,PLANE_NON_AXIAL=3,Plane=function(){this.normal=vec3.create(),this.dist=0,this.type=0,this.signbits=0},_radixSort_0=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],SurfaceFlags={NODAMAGE:1,SLICK:2,SKY:4,LADDER:8,NOIMPACT:16,NOMARKS:32,FLESH:64,NODRAW:128,HINT:256,SKIP:512,NOLIGHTMAP:1024,POINTLIGHT:2048,METALSTEPS:4096,NOSTEPS:8192,NONSOLID:16384,LIGHTFILTER:32768,ALPHASHADOW:65536,NODLIGHT:131072,DUST:262144},Lumps={ENTITIES:0,SHADERS:1,PLANES:2,NODES:3,LEAFS:4,LEAFSURFACES:5,LEAFBRUSHES:6,MODELS:7,BRUSHES:8,BRUSHSIDES:9,DRAWVERTS:10,DRAWINDEXES:11,FOGS:12,SURFACES:13,LIGHTMAPS:14,LIGHTGRID:15,VISIBILITY:16,NUM_LUMPS:17},MAX_QPATH=64,lumps_t=function(){this.fileofs=0,this.filelen=0},dheader_t=function(){this.ident=null,this.version=0,this.lumps=new Array(Lumps.NUM_LUMPS);for(var e=0;e<Lumps.NUM_LUMPS;e++)this.lumps[e]=new lumps_t},dmodel_t=function(){this.mins=[0,0,0],this.maxs=[0,0,0],this.firstSurface=0,this.numSurfaces=0,this.firstBrush=0,this.numBrushes=0};dmodel_t.size=40;var dshader_t=function(){this.shaderName=null,this.flags=0,this.contents=0};dshader_t.size=72;var dplane_t=function(){this.normal=[0,0,0],this.dist=0};dplane_t.size=16;var dnode_t=function(){this.planeNum=0,this.childrenNum=[0,0],this.mins=[0,0,0],this.maxs=[0,0,0]};dnode_t.size=36;var dleaf_t=function(){this.cluster=0,this.area=0,this.mins=[0,0,0],this.maxs=[0,0,0],this.firstLeafSurface=0,this.numLeafSurfaces=0,this.firstLeafBrush=0,this.numLeafBrushes=0};dleaf_t.size=48;var dbrushside_t=function(){this.planeNum=0,this.shader=0};dbrushside_t.size=8;var dbrush_t=function(){this.side=0,this.numsides=0,this.shader=0};dbrush_t.size=12;var dfog_t=function(){this.shader=null,this.brushNum=0,this.visibleSide=0};dfog_t.size=72;var drawVert_t=function(){this.pos=[0,0,0],this.texCoord=[0,0],this.lmCoord=[0,0],this.normal=[0,0,0],this.color=[0,0,0,0]};drawVert_t.size=44;var MapSurfaceType={BAD:0,PLANAR:1,PATCH:2,TRIANGLE_SOUP:3,FLARE:4},dsurface_t=function(){this.shaderNum=0,this.fogNum=0,this.surfaceType=0,this.vertex=0,this.vertCount=0,this.meshVert=0,this.meshVertCount=0,this.lightmapNum=0,this.lmStart=[0,0],this.lmSize=[0,0],this.lmOrigin=[0,0,0],this.lmVecs=[[0,0,0],[0,0,0],[0,0,0]],this.patchWidth=0,this.patchHeight=0};dsurface_t.size=104;var RenderContext=function(){this.gl=null,this.handle=null},DEFAULT_GRAVITY=800,JUMP_VELOCITY=270,MAX_CLIP_PLANES=5,MIN_WALK_NORMAL=.7,STEPSIZE=18,OVERCLIP=1.001,DEFAULT_VIEWHEIGHT=26,ITEM_RADIUS=15,ItemType={BAD:0,WEAPON:1,AMMO:2,ARMOR:3,HEALTH:4,POWERUP:5,HOLDABLE:6,PERSISTANT_POWERUP:7,TEAM:8},GameItemDesc=function(e,t,n){this.classname=e,this.modelPaths=t,this.giType=n},EntityType={GENERAL:0,PLAYER:1,ITEM:2,MISSILE:3,MOVER:4,BEAM:5,PORTAL:6,SPEAKER:7,PUSH_TRIGGER:8,TELEPORT_TRIGGER:9,INVISIBLE:10,GRAPPLE:11,TEAM:12,EVENTS:13},EntityFlags={DEAD:1,TELEPORT_BIT:4,AWARD_EXCELLENT:8,PLAYER_EVENT:16,BOUNCE:16,BOUNCE_HALF:32,AWARD_GAUNTLET:64,NODRAW:128,FIRING:256,KAMIKAZE:512,MOVER_STOP:1024,AWARD_CAP:2048,TALK:4096,CONNECTION:8192,VOTED:16384,AWARD_IMPRESSIVE:32768,AWARD_DEFEND:65536,AWARD_ASSIST:131072,AWARD_DENIED:262144,TEAMVOTED:524288},ContentTypes={SOLID:1,LAVA:8,SLIME:16,WATER:32,FOG:64,NOTTEAM1:128,NOTTEAM2:256,NOBOTCLIP:512,AREAPORTAL:32768,PLAYERCLIP:65536,MONSTERCLIP:131072,TELEPORTER:262144,JUMPPAD:524288,CLUSTERPORTAL:1048576,DONOTENTER:2097152,BOTCLIP:4194304,MOVER:8388608,ORIGIN:16777216,BODY:33554432,CORPSE:67108864,DETAIL:134217728,STRUCTURAL:268435456,TRANSLUCENT:536870912,TRIGGER:1073741824,NODROP:2147483648},ContentMasks={ALL:-1,SOLID:ContentTypes.SOLID,PLAYERSOLID:ContentTypes.SOLID|ContentTypes.PLAYERCLIP|ContentTypes.BODY,DEADSOLID:ContentTypes.SOLID|ContentTypes.PLAYERCLIP,WATER:ContentTypes.WATER|ContentTypes.LAVA|ContentTypes.SLIME,OPAQUE:ContentTypes.SOLID|ContentTypes.SLIME|ContentTypes.LAVA,SHOT:ContentTypes.SOLID|ContentTypes.BODY|ContentTypes.CORPSE},PmoveType={NORMAL:0,NOCLIP:1,SPECTATOR:2,DEAD:3,FREEZE:4,INTERMISSION:5},PmoveFlags={DUCKED:1,JUMP_HELD:2,BACKWARDS_JUMP:8,BACKWARDS_RUN:16,TIME_LAND:32,TIME_KNOCKBACK:64,TIME_WATERJUMP:256,RESPAWNED:512,USE_ITEM_HELD:1024,GRAPPLE_PULL:2048,FOLLOW:4096,SCOREBOARD:8192,INVULEXPAND:16384,ALL_TIMES:352},PmoveInfo=function(){this.ps=null,this.cmd=null,this.frameTime=0,this.mins=[0,0,0],this.maxs=[0,0,0],this.trace=null},FRAMETIME=100,LevelLocals=function(){this.framenum=0,this.previousTime=0,this.time=0,this.clients=new Array(MAX_CLIENTS),this.gentities=new Array(MAX_GENTITIES)},ServerFlags={NOCLIENT:1,BOT:2,BROADCAST:8,PORTAL:32,USE_CURRENT_ORIGIN:64,SINGLECLIENT:128,NOTSINGLECLIENT:256},GameEntity=function(){this.s=new EntityState,this.linked=!1,this.svFlags=0,this.singleClient=0,this.bmodel=!1,this.mins=[0,0,0],this.maxs=[0,0,0],this.contents=0,this.absmin=[0,0,0],this.absmax=[0,0,0],this.currentOrigin=[0,0,0],this.currentAngles=[0,0,0],this.client=null,this.classname="noclass",this.spawnflags=0,this.model=null,this.model2=null,this.target=null,this.targetname=null,this.nextthink=0},GameClient=function(){this.ps=new PlayerState,this.pers=new GameClientPersistant},GameClientPersistant=function(){this.cmd=new UserCmd,this.netname=null},com,sv,level,g_gravity,playerMins=[-15,-15,-24],playerMaxs=[15,15,32],entityEvents={},keyMap={origin:["s.origin","currentOrigin"],angles:["s.angles"]};return entityEvents.info_notnull={spawn:function(e){SetOrigin(e,e.s.origin)}},entityEvents.info_player_deathmatch={spawn:function(e){}},entityEvents.misc_teleporter_dest={spawn:function(e){SetOrigin(e,e.s.origin)}},entityEvents.target_position={spawn:function(e){SetOrigin(e,e.s.origin)}},entityEvents.target_push={spawn:function(e){e.speed||(e.speed=1e3)}},entityEvents.trigger_push={spawn:function(e){sv.SetBrushModel(e,e.model),e.s.eType=EntityType.PUSH_TRIGGER,e.contents=ContentTypes.TRIGGER,e.nextthink=level.time+FRAMETIME,sv.LinkEntity(e)},think:function(e){AimAtTarget(e)},touch:function(e,t){if(!t.client)return;bg.TouchJumpPad(t.client.ps,e.s)}},entityEvents.trigger_teleport={spawn:function(e){sv.SetBrushModel(e,e.model),e.s.eType=EntityType.TELEPORT_TRIGGER,e.contents=ContentTypes.TRIGGER,sv.LinkEntity(e)},touch:function(e,t){if(!t.client)return;if(t.client.ps.pm_type===PmoveType.DEAD)return;var n=EntityPickTarget(e.target);if(!n){console.log("Couldn't find teleporter destination"),FreeEntity(e);return}TeleportPlayer(t,n.s.origin,n.s.angles)}},{Init:Init,Shutdown:Shutdown,Frame:Frame,ClientConnect:ClientConnect,ClientBegin:ClientBegin,ClientThink:ClientThink,ClientDisconnect:ClientDisconnect,GetClientPlayerstate:GetClientPlayerstate}}),define("cgame/cg",["underscore","glmatrix","game/bg"],function(e,t,n){function A(e,t,n){return t-e>180&&(t-=360),t-e<-180&&(t+=360),e+n*(t-e)}function O(e,t,n,r){var i,s,o,u,a,f,l;i=e[k]*(Math.PI*2/360),u=Math.sin(i),l=Math.cos(i),i=e[C]*(Math.PI*2/360),o=Math.sin(i),f=Math.cos(i),i=e[L]*(Math.PI*2/360),s=Math.sin(i),a=Math.cos(i),t&&(t[0]=f*l,t[1]=f*u,t[2]=-o),n&&(n[0]=-1*s*o*l+ -1*a*-u,n[1]=-1*s*o*u+ -1*a*l,n[2]=-1*s*f),r&&(r[0]=a*o*l+ -s*-u,r[1]=a*o*u+ -s*l,r[2]=a*f)}function M(e,t){var n=[0,0,0];O(e,t[0],n,t[2]),vec3.subtract([0,0,0],n,t[1])}function I(e){return e[0]==1?P:e[1]==1?H:e[2]==1?B:j}function q(e){var t=0;for(var n=0;n<3;n++)e.normal[n]<0&&(t|=1<<n);return t}function R(e,t,n){if(n.type<j)return n.dist<=e[n.type]?1:n.dist>=t[n.type]?2:3;var r=[0,0];if(n.signbits<8)for(var i=0;i<3;i++){var s=n.signbits>>i&1;r[s]+=n.normal[i]*t[i],r[s^1]+=n.normal[i]*e[i]}var o=0;return r[0]>=n.dist&&(o=1),r[1]<n.dist&&(o|=2),o}function z(e,t,n){var r=new Array(n),i=[].concat(U),s=[].concat(U),o=[].concat(U),u=[].concat(U),a=0,f,l=0,c,h=0,p,d=0,v,m;for(m=0;m<n;m++)f=e[m][t]&255,c=e[m][t]>>8&255,p=e[m][t]>>16&255,v=e[m][t]>>24&255^128,i[f]++,s[c]++,o[p]++,u[v]++;for(m=0;m<256;m++)f=a+i[m],c=l+s[m],p=h+o[m],v=d+u[m],i[m]=a,s[m]=l,o[m]=h,u[m]=d,a=f,l=c,h=p,d=v;for(m=0;m<n;m++)f=e[m][t]&255,r[i[f]]=e[m],i[f]++;for(m=0;m<n;m++)c=r[m][t]>>8&255,e[s[c]]=r[m],s[c]++;for(m=0;m<n;m++)p=e[m][t]>>16&255,r[o[p]]=e[m],o[p]++;for(m=0;m<n;m++)v=r[m][t]>>24&255^128,e[u[v]]=r[m],u[v]++;return e}function ot(e){return e<-128?-128:e>127?127:e}function at(e){var t=65536,n=e.length,r=e.slice||e.subarray,i;if(n<t)i=String.fromCharCode.apply(String,e);else{var s=[],o=0;while(o<n)s.push(String.fromCharCode.apply(String,r.call(e,o,o+t))),o+=t;i=s.join("")}return btoa(i)}function Hn(e,t,r,i,a,f){function m(e,n,s){console.log("--------- CG Init ---------"),l=new On,c=new Mn,h=t.AddCvar("cg_errordecay",100,b.ARCHIVE),p=t.AddCvar("cg_predict",0,b.ARCHIVE),d=t.AddCvar("cg_showmiss",1,b.ARCHIVE),v=f.RegisterView("hud"),l.clientNum=s,c.processedSnapshotNum=e,c.serverCommandSequence=n,c.gameState=r.GetGameState(),L(),V(),i.LoadMap(c.mapname,function(){a.LoadMap(c.mapname,function(){w(),S(),l.initialized=!0})})}function g(){console.log("--------- CG Shutdown ---------")}function y(e){return c.gameState[e]}function w(){for(var e=0;e<n.ItemList.length;e++)E(e)}function E(e){var t=n.ItemList[e],r=l.itemInfo[e];if(r)return;r=l.itemInfo[e]=new Pn;for(var i=0;i<t.modelPaths.length;i++)r.modelHandles[i]=a.RegisterModel(t.modelPaths[i])}function S(){U(l.clientNum);for(var e=0;e<u;e++){if(l.clientNum===e)continue;var t=y("player"+e);if(!t)continue;U(e)}}function T(e){if(!l.initialized)return;l.time=e,$();if(!l.snap||l.snap.snapFlags&s)return;X(),N(),l.refdef.time=l.time,l.hyperspace||F(),a.RenderScene(l.refdef),j(),f.RenderView(v);if(l.showScores===!0){var t=[{name:"Player 1"}];f.RenderView("scoreboard")}}function N(){var e=l.predictedPlayerState;l.refdef.x=0,l.refdef.y=0,l.refdef.width=viewport.width,l.refdef.height=viewport.height,vec3.set(e.origin,l.refdef.vieworg),M(e.viewangles,l.refdef.viewaxis),C(),k()}function C(){l.refdef.vieworg[2]+=vt}function k(){var e=90,t=l.refdef.width/Math.tan(e/360*Math.PI),n=Math.atan2(l.refdef.height,t)*360/Math.PI;l.refdef.fovX=e,l.refdef.fovY=n}function L(){t.AddCmd("+scores",O),t.AddCmd("-scores",_)}function O(){l.showScores=!0}function _(){l.showScores=!1}function j(){var t=e.GetMilliseconds(),n=t-H;H=t,P[B%D]=n,B++;if(B>D){var r=0;for(var i=0;i<D;i++)r+=P[i];r||(r=1),v.setFPS(parseInt(1e3*D/r))}return 0}function F(){if(l.nextSnap){var e=l.nextSnap.serverTime-l.snap.serverTime;e===0?l.frameInterpolation=0:l.frameInterpolation=(l.time-l.snap.serverTime)/e}else l.frameInterpolation=0;l.autoAngles[0]=0,l.autoAngles[1]=(l.time&2047)*360/2048,l.autoAngles[2]=0,l.autoAnglesFast[0]=0,l.autoAnglesFast[1]=(l.time&1023)*360/1024,l.autoAnglesFast[2]=0;for(var t=0;t<l.snap.numEntities;t++){var n=l.entities[l.snap.entities[t].number];I(n)}}function I(e){if(e.currentState.eType>=bt.EVENTS)return;q(e);switch(e.currentState.eType){case bt.ITEM:var t=new Rt,r=n.ItemList[e.currentState.modelIndex],i=l.itemInfo[e.currentState.modelIndex];if(r.giType!==gt.HEALTH){r.giType===gt.HEALTH?vec3.set(l.autoAnglesFast,e.lerpAngles):vec3.set(l.autoAngles,e.lerpAngles);for(var s=0;s<i.modelHandles.length;s++)t.reType=qt.MODEL,vec3.set(e.lerpOrigin,t.origin),M(e.lerpAngles,t.axis),t.hModel=i.modelHandles[s],a.AddRefEntityToScene(t)}break;case bt.PLAYER:var t=new Rt;e.currentState.number!==l.predictedPlayerState.clientNum&&(t.reType=qt.BBOX,vec3.set(e.lerpOrigin,t.origin),M(e.lerpAngles,t.axis),vec3.set([-mt,-mt,-mt],t.mins),vec3.set([mt,mt,mt],t.maxs),a.AddRefEntityToScene(t))}}function q(e){e.currentState.number<u&&(e.currentState.pos.trType=x.INTERPOLATE,e.nextState.pos.trType=x.INTERPOLATE);if(e.interpolate&&e.currentState.pos.trType===x.INTERPOLATE){R(e);return}if(e.interpolate&&e.currentState.pos.trType===x.LINEAR_STOP&&e.currentState.number<u){R(e);return}n.EvaluateTrajectory(e.currentState.pos,l.time,e.lerpOrigin),n.EvaluateTrajectory(e.currentState.apos,l.time,e.lerpAngles)}function R(e){if(!l.nextSnap)throw new Error("InterpoateEntityPosition: !cg.nextSnap");var t=l.frameInterpolation,r=vec3.create(),i=vec3.create();n.EvaluateTrajectory(e.currentState.pos,l.snap.serverTime,r),n.EvaluateTrajectory(e.nextState.pos,l.nextSnap.serverTime,i),e.lerpOrigin[0]=r[0]+t*(i[0]-r[0]),e.lerpOrigin[1]=r[1]+t*(i[1]-r[1]),e.lerpOrigin[2]=r[2]+t*(i[2]-r[2]),n.EvaluateTrajectory(e.currentState.apos,l.snap.serverTime,r),n.EvaluateTrajectory(e.nextState.apos,l.nextSnap.serverTime,i),e.lerpAngles[0]=A(r[0],i[0],t),e.lerpAngles[1]=A(r[1],i[1],t),e.lerpAngles[2]=A(r[2],i[2],t)}function U(e){var t=c.clientInfo[e]=new Dn,n=y("player"+e);console.log("Loading client info for",e,t,n);if(!n)return}function z(e,t){}function W(e){var t=l.predictedPlayerState=l.snap.ps.clone(),i=l.snap,s=l.nextSnap;if(e){var o=r.GetCurrentUserCommandNumber(),u=r.GetUserCommand(o);n.UpdateViewAngles(t,u)}if(l.nextFrameTeleport)return;if(!s||s.serverTime<=i.serverTime)return;var a=(l.time-i.serverTime)/(s.serverTime-i.serverTime);for(var f=0;f<3;f++)t.origin[f]=i.ps.origin[f]+a*(s.ps.origin[f]-i.ps.origin[f]),e||(t.viewangles[f]=A(i.ps.viewangles[f],s.ps.viewangles[f],a)),t.velocity[f]=i.ps.velocity[f]+a*(s.ps.velocity[f]-i.ps.velocity[f])}function X(){l.hyperspace=!1,l.validPPS||(l.validPPS=!0,l.predictedPlayerState=l.snap.ps.clone());if(l.snap.ps.pm_flags&Tt.FOLLOW){W(!1);return}if(p()){W(!0);return}var e=l.predictedPlayerState.clone(),t=r.GetCurrentUserCommandNumber(),s=t-Ln+1,o=r.GetUserCommand(s);if(o.serverTime>l.snap.ps.commandTime&&o.serverTime<l.time){d()&&console.log("exceeded PACKET_BACKUP on commands");return}var u=r.GetUserCommand(t);l.nextSnap&&!l.nextFrameTeleport&&!l.thisFrameTeleport?(l.predictedPlayerState=l.nextSnap.ps.clone(),l.physicsTime=l.nextSnap.serverTime):(l.predictedPlayerState=l.snap.ps.clone(),l.physicsTime=l.snap.serverTime);var a=new Nt;a.ps=l.predictedPlayerState,a.trace=i.Trace,a.ps.pm_type===xt.DEAD?a.tracemask=St.PLAYERSOLID&~Et.BODY:a.tracemask=St.PLAYERSOLID;var f=!1;for(var c=s;c<=t;c++){a.cmd=r.GetUserCommand(c);if(a.cmd.serverTime<=l.predictedPlayerState.commandTime)continue;if(a.cmd.serverTime>u.serverTime)continue;n.Pmove(a),f=!0}d()>1&&console.log("["+a.cmd.serverTime+" : "+l.time+"]");if(!f){d()&&console.log("not moved");return}}function V(){var e=y("serverInfo");c.mapname=e.sv_mapname}function $(){var e,t=r.GetCurrentSnapshotNumber();l.latestSnapshotTime=t.serverTime;if(t.snapshotNumber!==l.latestSnapshotNum){if(t.snapshotNumber<l.latestSnapshotNum)throw new Error("ProcessSnapshots: info.snapshotNumber < cg.latestSnapshotNum");l.latestSnapshotNum=t.snapshotNumber}while(!l.snap){e=J();if(!e)return;e.snapFlags&s||K(e)}for(;;){if(!l.nextSnap){e=J();if(!e)break;Q(e);if(l.nextSnap.serverTime<l.snap.serverTime)throw new Error("ProcessSnapshots: Server time went backwards")}if(l.time>=l.snap.serverTime&&l.time<l.nextSnap.serverTime)break;G()}if(l.snap===null)throw new Error("ProcessSnapshots: cg.snap == NULL");l.time<l.snap.serverTime&&(l.time=l.snap.serverTime);if(l.nextSnap&&l.nextSnap.serverTime<=l.time)throw new Error("ProcessSnapshots: cg.nextSnap.serverTime <= cg.time")}function J(){l.latestSnapshotNum>c.processedSnapshotNum+1e3&&console.warn("ReadNextSnapshot: way out of range, "+l.latestSnapshotNum+" > "+c.processedSnapshotNum);while(c.processedSnapshotNum<l.latestSnapshotNum){c.processedSnapshotNum++;var e=r.GetSnapshot(c.processedSnapshotNum);if(e)return e}return null}function K(e){l.snap=e,console.log("Setting initial snapshot");for(var t=0;t<l.snap.numEntities;t++){var n=l.snap.entities[t],r=l.entities[n.number];n.clone(r.currentState),r.interpolate=!1,r.currentValid=!0,Y(r)}}function Q(e){l.nextSnap=e,n.PlayerStateToEntityState(e.ps,l.entities[e.ps.clientNum].nextState),l.entities[l.snap.ps.clientNum].interpolate=!0;for(var t=0;t<e.numEntities;t++){var r=e.entities[t],i=l.entities[r.number];r.clone(i.nextState),!i.currentValid||(i.currentState.eFlags^r.eFlags)&wt.TELEPORT_BIT?i.interpolate=!1:i.interpolate=!0}l.snap&&(e.ps.eFlags^l.snap.ps.eFlags)&wt.TELEPORT_BIT?l.nextFrameTeleport=!0:l.nextFrameTeleport=!1,(l.nextSnap.snapFlags^l.snap.snapFlags)&o&&(l.nextFrameTeleport=!0)}function G(){if(!l.snap)throw new Error("TransitionSnapshot: NULL cg.snap");if(!l.nextSnap)throw new Error("TransitionSnapshot: NULL cg.nextSnap");var e=l.snap;l.snap=l.nextSnap,n.PlayerStateToEntityState(l.snap.ps,l.entities[l.snap.ps.clientNum].currentState),l.entities[l.snap.ps.clientNum].interpolate=!1;for(var t=0;t<l.snap.numEntities;t++){var r=l.entities[l.snap.entities[t].number];Z(r),r.snapShotTime=l.snap.serverTime}l.nextSnap=null}function Y(e){vec3.set(e.currentState.origin,e.lerpOrigin),vec3.set(e.currentState.angles,e.lerpAngles)}function Z(e){e.currentState=e.nextState,e.currentValid=!0,e.interpolate||Y(e),e.interpolate=!1}var l,c,h,p,d,v,D=4,P=new Array(D),H=0,B=0;return{Init:m,Shutdown:g,Frame:T}}var r="baseq3",i=1,s=2,o=4,u=64,a=64,f=1024,l=f-1,c=f-2,h=f-2,p=256,d=256,v={NAD:0,LOOPBACK:1,IP:2},m={CLIENT:0,SERVER:1},g=function(e,t,n){this.type=e,this.ip=t,this.port=n},y=function(e,t){var n=e,r=function(t){if(!arguments.length)return n;var r=n;typeof e=="string"?n=t.toString():e%1===0?n=parseInt(t):n=parseFloat(t)};return r.flags=t,r},b={ARCHIVE:1,USERINFO:2,SERVERINFO:4,SYSTEMINFO:8},w=function(){this.serverTime=0,this.angles=[0,0,0],this.forwardmove=0,this.rightmove=0,this.upmove=0};w.prototype.clone=function(e){return typeof e=="undefined"&&(e=new w),e.serverTime=this.serverTime,vec3.set(this.angles,e.angles),e.forwardmove=this.forwardmove,e.rightmove=this.rightmove,e.upmove=this.upmove,e};var E=6,S=function(){this.clientNum=0,this.commandTime=0,this.pm_type=0,this.pm_flags=0,this.origin=[0,0,0],this.velocity=[0,0,0],this.viewangles=[0,0,0],this.delta_angles=[0,0,0],this.speed=0,this.gravity=0,this.groundEntityNum=l,this.jumppad_ent=0,this.jumppad_frame=0,this.pmove_framecount=0};S.prototype.clone=function(e){return typeof e=="undefined"&&(e=new S),e.clientNum=this.clientNum,e.commandTime=this.commandTime,e.pm_type=this.pm_type,e.pm_flags=this.pm_flags,vec3.set(this.origin,e.origin),vec3.set(this.velocity,e.velocity),vec3.set(this.viewangles,e.viewangles),vec3.set(this.delta_angles,e.delta_angles),e.speed=this.speed,e.gravity=this.gravity,e.groundEntityNum=this.groundEntityNum,e.jumppad_ent=this.jumppad_ent,e.jumppad_frame=this.jumppad_frame,e.pmove_framecount=this.pmove_framecount,e};var x={STATIONARY:0,INTERPOLATE:1,LINEAR:2,LINEAR_STOP:3,SINE:4,GRAVITY:5},T=function(){this.trType=0,this.trTime=0,this.trDuration=0,this.trBase=[0,0,0],this.trDelta=[0,0,0]};T.prototype.clone=function(e){return typeof e=="undefined"&&(e=new T),e.trType=this.trType,e.trTime=this.trTime,e.trDuration=this.trDuration,vec3.set(this.trBase,e.trBase),vec3.set(this.trDelta,e.trDelta),e};var N=function(){this.number=0,this.eType=0,this.eFlags=0,this.pos=new T,this.apos=new T,this.time=0,this.time2=0,this.origin=[0,0,0],this.origin2=[0,0,0],this.angles=[0,0,0],this.angles2=[0,0,0],this.groundEntityNum=l,this.modelIndex=0,this.modelIndex2=0,this.clientNum=0,this.frame=0,this.solid=0,this.event=0,this.eventParm=0};N.prototype.clone=function(e){return typeof e=="undefined"&&(e=new N),e.number=this.number,e.eType=this.eType,e.eFlags=this.eFlags,this.pos.clone(e.pos),this.apos.clone(e.apos),e.time=this.time,e.time2=this.time2,vec3.set(this.origin,e.origin),vec3.set(this.origin2,e.origin2),vec3.set(this.angles,e.angles),vec3.set(this.angles2,e.angles2),e.groundEntityNum=this.groundEntityNum,e.modelIndex=this.modelIndex,e.modelindex2=this.modelIndex2,e.clientNum=this.clientNum,e.frame=this.frame,e.solid=this.solid,e.event=this.event,e.eventParm=this.eventParm,e};var C=0,k=1,L=2,_=function(e){return e*65536/360&65535},D=function(e){return e*(360/65536)},P=0,H=1,B=2,j=3,F=function(){this.normal=vec3.create(),this.dist=0,this.type=0,this.signbits=0},U=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],W={NODAMAGE:1,SLICK:2,SKY:4,LADDER:8,NOIMPACT:16,NOMARKS:32,FLESH:64,NODRAW:128,HINT:256,SKIP:512,NOLIGHTMAP:1024,POINTLIGHT:2048,METALSTEPS:4096,NOSTEPS:8192,NONSOLID:16384,LIGHTFILTER:32768,ALPHASHADOW:65536,NODLIGHT:131072,DUST:262144},X={ENTITIES:0,SHADERS:1,PLANES:2,NODES:3,LEAFS:4,LEAFSURFACES:5,LEAFBRUSHES:6,MODELS:7,BRUSHES:8,BRUSHSIDES:9,DRAWVERTS:10,DRAWINDEXES:11,FOGS:12,SURFACES:13,LIGHTMAPS:14,LIGHTGRID:15,VISIBILITY:16,NUM_LUMPS:17},V=64,$=function(){this.fileofs=0,this.filelen=0},J=function(){this.ident=null,this.version=0,this.lumps=new Array(X.NUM_LUMPS);for(var e=0;e<X.NUM_LUMPS;e++)this.lumps[e]=new $},K=function(){this.mins=[0,0,0],this.maxs=[0,0,0],this.firstSurface=0,this.numSurfaces=0,this.firstBrush=0,this.numBrushes=0};K.size=40;var Q=function(){this.shaderName=null,this.flags=0,this.contents=0};Q.size=72;var G=function(){this.normal=[0,0,0],this.dist=0};G.size=16;var Y=function(){this.planeNum=0,this.childrenNum=[0,0],this.mins=[0,0,0],this.maxs=[0,0,0]};Y.size=36;var Z=function(){this.cluster=0,this.area=0,this.mins=[0,0,0],this.maxs=[0,0,0],this.firstLeafSurface=0,this.numLeafSurfaces=0,this.firstLeafBrush=0,this.numLeafBrushes=0};Z.size=48;var et=function(){this.planeNum=0,this.shader=0};et.size=8;var tt=function(){this.side=0,this.numsides=0,this.shader=0};tt.size=12;var nt=function(){this.shader=null,this.brushNum=0,this.visibleSide=0};nt.size=72;var rt=function(){this.pos=[0,0,0],this.texCoord=[0,0],this.lmCoord=[0,0],this.normal=[0,0,0],this.color=[0,0,0,0]};rt.size=44;var it={BAD:0,PLANAR:1,PATCH:2,TRIANGLE_SOUP:3,FLARE:4},st=function(){this.shaderNum=0,this.fogNum=0,this.surfaceType=0,this.vertex=0,this.vertCount=0,this.meshVert=0,this.meshVertCount=0,this.lightmapNum=0,this.lmStart=[0,0],this.lmSize=[0,0],this.lmOrigin=[0,0,0],this.lmVecs=[[0,0,0],[0,0,0],[0,0,0]],this.patchWidth=0,this.patchHeight=0};st.size=104;var ut=function(){this.gl=null,this.handle=null},ft=800,lt=270,ct=5,ht=.7,pt=18,dt=1.001,vt=26,mt=15,gt={BAD:0,WEAPON:1,AMMO:2,ARMOR:3,HEALTH:4,POWERUP:5,HOLDABLE:6,PERSISTANT_POWERUP:7,TEAM:8},yt=function(e,t,n){this.classname=e,this.modelPaths=t,this.giType=n},bt={GENERAL:0,PLAYER:1,ITEM:2,MISSILE:3,MOVER:4,BEAM:5,PORTAL:6,SPEAKER:7,PUSH_TRIGGER:8,TELEPORT_TRIGGER:9,INVISIBLE:10,GRAPPLE:11,TEAM:12,EVENTS:13},wt={DEAD:1,TELEPORT_BIT:4,AWARD_EXCELLENT:8,PLAYER_EVENT:16,BOUNCE:16,BOUNCE_HALF:32,AWARD_GAUNTLET:64,NODRAW:128,FIRING:256,KAMIKAZE:512,MOVER_STOP:1024,AWARD_CAP:2048,TALK:4096,CONNECTION:8192,VOTED:16384,AWARD_IMPRESSIVE:32768,AWARD_DEFEND:65536,AWARD_ASSIST:131072,AWARD_DENIED:262144,TEAMVOTED:524288},Et={SOLID:1,LAVA:8,SLIME:16,WATER:32,FOG:64,NOTTEAM1:128,NOTTEAM2:256,NOBOTCLIP:512,AREAPORTAL:32768,PLAYERCLIP:65536,MONSTERCLIP:131072,TELEPORTER:262144,JUMPPAD:524288,CLUSTERPORTAL:1048576,DONOTENTER:2097152,BOTCLIP:4194304,MOVER:8388608,ORIGIN:16777216,BODY:33554432,CORPSE:67108864,DETAIL:134217728,STRUCTURAL:268435456,TRANSLUCENT:536870912,TRIGGER:1073741824,NODROP:2147483648},St={ALL:-1,SOLID:Et.SOLID,PLAYERSOLID:Et.SOLID|Et.PLAYERCLIP|Et.BODY,DEADSOLID:Et.SOLID|Et.PLAYERCLIP,WATER:Et.WATER|Et.LAVA|Et.SLIME,OPAQUE:Et.SOLID|Et.SLIME|Et.LAVA,SHOT:Et.SOLID|Et.BODY|Et.CORPSE},xt={NORMAL:0,NOCLIP:1,SPECTATOR:2,DEAD:3,FREEZE:4,INTERMISSION:5},Tt={DUCKED:1,JUMP_HELD:2,BACKWARDS_JUMP:8,BACKWARDS_RUN:16,TIME_LAND:32,TIME_KNOCKBACK:64,TIME_WATERJUMP:256,RESPAWNED:512,USE_ITEM_HELD:1024,GRAPPLE_PULL:2048,FOLLOW:4096,SCOREBOARD:8192,INVULEXPAND:16384,ALL_TIMES:352},Nt=function(){this.ps=null,this.cmd=null,this.frameTime=0,this.mins=[0,0,0],this.maxs=[0,0,0],this.trace=null},Ct=65536,kt=5e3,Lt=6*kt,At=10,Ot=1<<At,Mt=2,_t=7,Dt=_t+At,Pt=14,Ht=1<<Pt,Bt=32,jt=function(){this.world=null,this.refdef=new It,this.viewParms=null,this.visCount=0,this.frameCount=0,this.sceneCount=0,this.viewCount=0,this.frameSceneNum=0,this.models=[],this.shaderBodies={},this.programBodies={},this.compiledShaders={},this.sortedShaders=[],this.defaultModelProgram=null,this.modelProgram=null,this.bboxSurfaces=new Array(Bt),this.bboxSurfaceNum=0;for(var e=0;e<Bt;e++)this.bboxSurfaces[e]=new $t},Ft=function(){this.name=null,this.path=null,this.lightmaps=null,this.shaders=[],this.verts=[],this.meshVerts=[],this.faces=[],this.planes=[],this.leafSurfaces=[],this.nodes=[],this.leafs=[],this.entities={},this.numClusters=0},It=function(){this.x=0,this.y=0,this.width=0,this.height=0,this.fovX=0,this.fovY=0,this.vieworg=[0,0,0],this.viewaxis=[[0,0,0],[0,0,0],[0,0,0]],this.time=0,this.drawSurfs=new Array(Ct),this.numDrawSurfs=0,this.refEntities=new Array(Ot),this.numRefEntities=0;for(var e=0;e<Ct;e++)this.drawSurfs[e]=new Kt;for(var e=0;e<Ot;e++)this.refEntities[e]=new Rt},qt={BBOX:0,MODEL:1,POLY:2,SPRITE:3,BEAM:4,RAIL_CORE:5,RAIL_RINGS:6,LIGHTNING:7,PORTALSURFACE:8,MAX_REF_ENTITY_TYPE:9},Rt=function(){this.index=0,this.reType=0,this.origin=[0,0,0],this.axis=[[0,0,0],[0,0,0],[0,0,0]],this.hModel=-1,this.mins=[0,0,0],this.maxs=[0,0,0]};Rt.prototype.clone=function(e){return typeof e=="undefined"&&(e=new Rt),e.reType=this.reType,vec3.set(this.origin,e.origin),mat3.set(this.axis,e.axis),e.hModel=this.hModel,vec3.set(this.mins,e.mins),vec3.set(this.maxs,e.maxs),e.index=this.index,e};var Ut=function(){this.origin=vec3.create(),this.axis=[[0,0,0],[0,0,0],[0,0,0]],this.viewOrigin=vec3.create(),this.modelMatrix=mat4.create()},zt=function(){this.or=new Ut,this.world=new Ut,this.pvsOrigin=vec3.create(),this.x=0,this.y=0,this.width=0,this.height=0,this.fovX=0,this.fovY=0,this.frustum=[new F,new F,new F,new F],this.visBounds=[vec3.create(),vec3.create()],this.zFar=0,this.projectionMatrix=mat4.create(),this.frameSceneNum=0,this.frameCount=0},Wt=function(){this.shader=null,this.shaderTime=0,this.modelMatrix=mat4.create(),this.numVertexes=0,this.numIndexes=0,this.abindexes=new ArrayBuffer(Lt*2),this.abvertexes=new ArrayBuffer(kt*4*14),this.indexes=new Uint16Array(this.abindexes),this.vertexes=new Float32Array(this.abvertexes),this.indexBuffer=gl.createBuffer(),this.vertexBuffer=gl.createBuffer()},Xt={BAD:0,BBOX:1,SKIP:2,FACE:3,GRID:4,TRIANGLES:5,POLY:6,MD3:7,FLARE:8,ENTITY:9,DISPLAY_LIST:10},Vt=function(){this.surfaceType=Xt.BAD,this.viewCount=0,this.shader=null,this.fogIndex=0,this.vertex=0,this.vertCount=0,this.meshVert=0,this.meshVertCount=0,this.lightmapNum=0,this.normal=[0,0,0],this.patchWidth=0,this.patchHeight=0,this.plane=new F},$t=function(){this.surfaceType=Xt.BBOX,this.shader=null,this.refent=null},Jt=function(){this.surfaceType=Xt.MD3,this.header=null,this.name=null,this.shaders=null,this.st=null,this.triangles=null,this.xyzNormals=null},Kt=function(){this.sort=0,this.surface=-1},Qt={BAD:0,PORTAL:1,ENVIRONMENT:2,OPAQUE:3,DECAL:4,SEE_THROUGH:5,BANNER:6,FOG:7,UNDERWATER:8,BLEND0:9,BLEND1:10,BLEND2:11,BLEND3:12,BLEND6:13,STENCIL_SHADOW:14,ALMOST_NEAREST:15,NEAREST:16},Gt={UV:-4,VERTEX:-3,WHITEIMAGE:-2,NONE:-1},Yt=function(){this.name=null,this.texnum=null},Zt=function(){this.name=null,this.sort=Qt.OPAQUE,this.cull=gl.FRONT,this.mode=gl.TRIANGLES,this.stages=[],this.sortedIndex=0},en=function(){this.texture=null,this.animFreq=0,this.animTextures=null,this.blendSrc=gl.ONE,this.blendDest=gl.ZERO,this.depthWrite=!0,this.depthFunc=gl.LEQUAL,this.program=null},tn=function(){this.name=null,this.sort=0,this.cull="front",this.sky=!1,this.blend=!1,this.opaque=!1,this.lightmapIndex=0,this.stages=[],this.vertexDeforms=[]},nn=function(){this.map=null,this.animFreq=0,this.animMaps=[],this.clamp=!1,this.tcGen="base",this.rgbGen="identity",this.rgbWaveform=null,this.alphaGen="1.0",this.alphaFunc=null,this.alphaWaveform=null,this.blendSrc="GL_ONE",this.blendDest="GL_ZERO",this.hasBlendFunc=!1,this.tcMods=[],this.depthFunc="lequal",this.depthWrite=!0,this.isLightmap=!1},rn={BAD:0,BRUSH:1,Md3:2},sn=function(){this.type=rn.BAD,this.name=null,this.index=0,this.bmodel=null,this.md3=new Array(cn),this.numLods=0},on=function(){this.parent=null,this.plane=null,this.children=[null,null],this.mins=[0,0,0],this.maxs=[0,0,0]},un=function(){this.parent=null,this.cluster=0,this.area=0,this.mins=[0,0,0],this.maxs=[0,0,0],this.firstLeafSurface=0,this.numLeafSurfaces=0,this.firstLeafBrush=0,this.numLeafBrushes=0},an=function(){this.bounds=[[0,0,0],[0,0,0]],this.firstSurface=0,this.numSurfaces=0},fn=("3".charCodeAt()<<24)+("P".charCodeAt()<<16)+("D".charCodeAt()<<8)+"I".charCodeAt(),ln=15,cn=3,hn=8192,pn=4096,dn=256,vn=1024,mn=32,gn=16,yn=1/64,bn=function(){this.name=null,this.flags=0,this.frames=null,this.tags=null,this.surfaces=null,this.skins=null},wn=function(){this.ident=0,this.version=0,this.name=null,this.flags=0,this.numFrames=0,this.numTags=0,this.numSurfaces=0,this.numSkins=0,this.ofsFrames=0,this.ofsTags=0,this.ofsSurfaces=0,this.ofsEnd=0},En=function(){this.ident=0,this.name=null,this.flags=0,this.numFrames=0,this.numShaders=0,this.numVerts=0,this.numTriangles=0,this.ofsTriangles=0,this.ofsShaders=0,this.ofsSt=0,this.ofsXyzNormals=0,this.ofsEnd=0},Sn=function(){this.name=null,this.shader=0},xn=function(){this.indexes=[0,0,0]},Tn=function(){this.st=[0,0]},Nn=function(){this.xyz=[0,0,0],this.normal=[0,0,0]},Cn=function(){this.bounds=[[0,0,0],[0,0,0]],this.localOrigin=[0,0,0],this.radius=0,this.name=null},kn=function(){this.name=null,this.origin=[0,0,0],this.axis=[[0,0,0],[0,0,0],[0,0,0]]},Ln=64,An=Ln-1,On=function(){this.initialized=!1,this.frameInterpolation=0,this.thisFrameTeleport=!1,this.nextFrameTeleport=!1,this.time=0,this.physicsTime=0,this.latestSnapshotNum=0,this.latestSnapshotTime=0,this.snap=null,this.nextSnap=null,this.entities=new Array(f),this.hyperspace=!1,this.validPPS=!1,this.predictedErrorTime=0,this.predictedError=[0,0,0],this.predictedPlayerState=null,this.itemInfo=new Array,this.autoAngles=[0,0,0],this.autoAnglesFast=[0,0,0],this.refdef=new It,this.showScores=!1;for(var e=0;e<f;e++)this.entities[e]=new _n},Mn=function(){this.gameState=null,this.mapname=null,this.processedSnapshotNum=0,this.clientInfo=new Array(u)},_n=function(){this.currentState=new N,this.nextState=new N,this.interpolate=!1,this.currentValid=!1,this.snapShotTime=0,this.extrapolated=!1,this.rawOrigin=[0,0,0],this.rawAngles=[0,0,0],this.lerpOrigin=[0,0,0],this.lerpAngles=[0,0,0]},Dn=function(){this.infoValid=!1,this.name=null,this.modelName=null,this.skinName=null,this.headModelName=null,this.headSkinName=null,this.legsModel=-1,this.legsSkin=-1,this.torsoModel=-1,this.torsoSkin=-1,this.headModel=-1,this.headSkin=-1},Pn=function(){this.modelHandles=[],this.icon=-1};return{CreateInstance:function(e,t,n,r,i,s){return new Hn(e,t,n,r,i,s)}}}),define("clipmap/cm",["underscore","glmatrix","ByteBuffer"],function(e,t,n){function A(e,t,n){return t-e>180&&(t-=360),t-e<-180&&(t+=360),e+n*(t-e)}function O(e,t,n,r){var i,s,o,u,a,f,l;i=e[k]*(Math.PI*2/360),u=Math.sin(i),l=Math.cos(i),i=e[C]*(Math.PI*2/360),o=Math.sin(i),f=Math.cos(i),i=e[L]*(Math.PI*2/360),s=Math.sin(i),a=Math.cos(i),t&&(t[0]=f*l,t[1]=f*u,t[2]=-o),n&&(n[0]=-1*s*o*l+ -1*a*-u,n[1]=-1*s*o*u+ -1*a*l,n[2]=-1*s*f),r&&(r[0]=a*o*l+ -s*-u,r[1]=a*o*u+ -s*l,r[2]=a*f)}function M(e,t){var n=[0,0,0];O(e,t[0],n,t[2]),vec3.subtract([0,0,0],n,t[1])}function I(e){return e[0]==1?P:e[1]==1?H:e[2]==1?B:j}function q(e){var t=0;for(var n=0;n<3;n++)e.normal[n]<0&&(t|=1<<n);return t}function R(e,t,n){if(n.type<j)return n.dist<=e[n.type]?1:n.dist>=t[n.type]?2:3;var r=[0,0];if(n.signbits<8)for(var i=0;i<3;i++){var s=n.signbits>>i&1;r[s]+=n.normal[i]*t[i],r[s^1]+=n.normal[i]*e[i]}var o=0;return r[0]>=n.dist&&(o=1),r[1]<n.dist&&(o|=2),o}function z(e,t,n){var r=new Array(n),i=[].concat(U),s=[].concat(U),o=[].concat(U),u=[].concat(U),a=0,f,l=0,c,h=0,p,d=0,v,m;for(m=0;m<n;m++)f=e[m][t]&255,c=e[m][t]>>8&255,p=e[m][t]>>16&255,v=e[m][t]>>24&255^128,i[f]++,s[c]++,o[p]++,u[v]++;for(m=0;m<256;m++)f=a+i[m],c=l+s[m],p=h+o[m],v=d+u[m],i[m]=a,s[m]=l,o[m]=h,u[m]=d,a=f,l=c,h=p,d=v;for(m=0;m<n;m++)f=e[m][t]&255,r[i[f]]=e[m],i[f]++;for(m=0;m<n;m++)c=r[m][t]>>8&255,e[s[c]]=r[m],s[c]++;for(m=0;m<n;m++)p=e[m][t]>>16&255,r[o[p]]=e[m],o[p]++;for(m=0;m<n;m++)v=r[m][t]>>24&255^128,e[u[v]]=r[m],u[v]++;return e}function ot(e){return e<-128?-128:e>127?127:e}function at(e){var t=65536,n=e.length,r=e.slice||e.subarray,i;if(n<t)i=String.fromCharCode.apply(String,e);else{var s=[],o=0;while(o<n)s.push(String.fromCharCode.apply(String,r.call(e,o,o+t))),o+=t;i=s.join("")}return btoa(i)}function wt(e){function i(e,i){console.log("--------- CM Init ---------"),console.log("Loading clipmap for "+e),r=new lt,t.ReadFile("maps/"+e+".bsp","binary",function(e,t){if(e)throw e;var r=new n(t,n.LITTLE_ENDIAN),d=new J;d.ident=r.readASCIIString(4),d.version=r.readInt();for(var v=0;v<X.NUM_LUMPS;v++)d.lumps[v].fileofs=r.readInt(),d.lumps[v].filelen=r.readInt();if(d.ident!=="IBSP"&&d.version!==46)return;s(t,d.lumps[X.SHADERS]),o(t,d.lumps[X.LEAFS]),u(t,d.lumps[X.LEAFBRUSHES]),a(t,d.lumps[X.PLANES]),f(t,d.lumps[X.BRUSHSIDES]),l(t,d.lumps[X.BRUSHES]),c(t,d.lumps[X.MODELS]),h(t,d.lumps[X.NODES]),p(t,d.lumps[X.ENTITIES]),i&&i()})}function s(e,t){var i=new n(e,n.LITTLE_ENDIAN);i.index=t.fileofs;var s=r.shaders=new Array(t.filelen/Q.size);for(var o=0;o<s.length;o++){var u=s[o]=new Q;u.shaderName=i.readASCIIString(V),u.flags=i.readInt(),u.contents=i.readInt()}}function o(e,t){var i=new n(e,n.LITTLE_ENDIAN);i.index=t.fileofs;var s=r.leafs=new Array(t.filelen/Z.size);for(var o=0;o<s.length;o++){var u=s[o]=new pt;u.cluster=i.readInt(),u.area=i.readInt(),i.index+=24,u.firstLeafSurface=i.readInt(),u.numLeafSurfaces=i.readInt(),u.firstLeafBrush=i.readInt(),u.numLeafBrushes=i.readInt()}}function u(e,t){var i=new n(e,n.LITTLE_ENDIAN);i.index=t.fileofs;var s=r.leafBrushes=new Array(t.filelen/4);for(var o=0;o<s.length;o++)s[o]=i.readInt()}function a(e,t){var i=new n(e,n.LITTLE_ENDIAN);i.index=t.fileofs;var s=r.planes=new Array(t.filelen/G.size);for(var o=0;o<s.length;o++){var u=s[o]=new F;u.normal=[i.readFloat(),i.readFloat(),i.readFloat()],u.dist=i.readFloat(),u.signbits=q(u),u.type=I(u.normal)}}function f(e,t){var i=r.planes,s=new n(e,n.LITTLE_ENDIAN);s.index=t.fileofs;var o=r.brushSides=new Array(t.filelen/et.size);for(var u=0;u<o.length;u++){var a=o[u]=new dt,f=s.readInt(),l=s.readInt();a.plane=i[f],a.shaderNum=l,a.surfaceFlags=r.shaders[l].surfaceFlags}}function l(e,t){var i=r.shaders,s=r.brushSides,o=new n(e,n.LITTLE_ENDIAN);o.index=t.fileofs;var u=r.brushes=new Array(t.filelen/tt.size);for(var a=0;a<u.length;a++){var f=u[a]=new vt;f.side=o.readInt(),f.numsides=o.readInt(),f.shaderNum=o.readInt(),f.sides=s.slice(f.side,f.side+f.numsides),f.bounds=[[-f.sides[0].plane.dist,-f.sides[2].plane.dist,-f.sides[4].plane.dist],[f.sides[1].plane.dist,f.sides[3].plane.dist,f.sides[5].plane.dist]],f.contents=i[f.shaderNum].contents}}function c(e,t){var i=new n(e,n.LITTLE_ENDIAN);i.index=t.fileofs;var s=r.models=new Array(t.filelen/K.size);for(var o=0;o<s.length;o++){var u=s[o]=new ht;u.mins=[i.readFloat()-1,i.readFloat()-1,i.readFloat()-1],u.maxs=[i.readFloat()+1,i.readFloat()+1,i.readFloat()+1];var a=i.readInt(),f=i.readInt(),l=i.readInt(),c=i.readInt();if(o===0)continue}}function h(e,t){var i=r.planes,s=new n(e,n.LITTLE_ENDIAN);s.index=t.fileofs;var o=r.nodes=new Array(t.filelen/Y.size);for(var u=0;u<o.length;u++){var a=o[u]=new ct;a.planeNum=s.readInt(),a.childrenNum=[s.readInt(),s.readInt()],s.index+=24}}function p(e,t){var i=new n(e,n.LITTLE_ENDIAN);i.index=t.fileofs;var s=i.readASCIIString(t.filelen),o=r.entities=[];s.replace(/\{([^}]*)\}/mg,function(e,t){var n={classname:"unknown"};t.replace(/"(.+)" "(.+)"$/mg,function(e,t,r){switch(t){case"origin":r.replace(/(.+) (.+) (.+)/,function(e,r,i,s){n[t]=[parseFloat(r),parseFloat(i),parseFloat(s)]});break;case"angles":r.replace(/(.+) (.+) (.+)/,function(e,r,i,s){n[t]=[parseFloat(r),parseFloat(i),parseFloat(s)]});break;case"angle":n.angles=[0,parseFloat(r),0];break;default:n[t]=r}}),o.push(n)})}function d(e){if(e<0)throw new Error("ClipHandleToModel: bad handle "+e);if(e<r.models.length)return r.models[e];throw new Error("ClipHandleToModel: bad handle "+r.models.length+" < "+e)}function v(e){if(e<0||e>=r.models.length)throw new Error("GetInlineModel: bad number");return e}function m(e,t,n){var r=d(e);vec3.set(r.mins,t),vec3.set(r.maxs,n)}function g(e,t,n,i){for(;;){if(i<0){if(e.count>=gt)return;e.list[e.count++]=-1-i;return}var s=r.nodes[i],o=R(t,n,r.planes[s.planeNum]);o===1?i=s.childrenNum[0]:o===2?i=s.childrenNum[1]:(g(e,t,n,s.childrenNum[0]),i=s.childrenNum[1])}}function y(e,t,n,r){return t[0]<n[0]-ft||t[1]<n[1]-ft||t[2]<n[2]-ft||e[0]>r[0]+ft||e[1]>r[1]+ft||e[2]>r[2]+ft?!1:!0}function b(e,t){if(!t.numsides)return;if(e.bounds[0][0]>t.bounds[1][0]||e.bounds[0][1]>t.bounds[1][1]||e.bounds[0][2]>t.bounds[1][2]||e.bounds[1][0]<t.bounds[0][0]||e.bounds[1][1]<t.bounds[0][1]||e.bounds[1][2]<t.bounds[0][2])return;for(var n=6;n<t.numsides;n++){var r=t.sides[n],i=r.plane,s=i.dist-vec3.dot(e.offsets[i.signbits],i.normal),o=vec3.dot(e.start,i.normal)-s;if(o>0)return}e.trace.startSolid=e.trace.allSolid=!0,e.trace.fraction=0,e.trace.contents=t.contents}function w(e,t){var n=r.brushes,i=r.leafBrushes;for(var s=0;s<t.numLeafBrushes;s++){var o=i[t.firstLeafBrush+s],u=n[o];if(u.checkcount===r.checkcount)continue;u.checkcount=r.checkcount;if(!(u.contents&e.contents))continue;b(e,u);if(e.trace.allSolid)return}}function S(e){var t=r.leafs,n=vec3.add(e.start,e.size[0],[0,0,0]),i=vec3.add(e.start,e.size[1],[0,0,0]);vec3.add(n,[-1,-1,-1]),vec3.add(i,[1,1,1]),r.checkcount++,E.count=0,g(E,n,i,0),r.checkcount++;for(var s=0;s<E.count;s++){w(e,t[E.list[s]]);if(e.trace.allSolid)break}}function x(e,t,n,i,s,o){var u=r.brushes,a=r.leafs,f=r.leafBrushes,l=r.nodes,c=r.planes,h=r.shaders;if(e.trace.fraction<=n)return;if(t<0){T(e,a[-(t+1)]);return}var p=l[t],d=c[p.planeNum],v,m,g;d.type<3?(v=s[d.type]-d.dist,m=o[d.type]-d.dist,g=e.extents[d.type]):(v=vec3.dot(d.normal,s)-d.dist,m=vec3.dot(d.normal,o)-d.dist,e.isPoint?g=0:g=2048);if(v>=g+1&&m>=g+1){x(e,p.childrenNum[0],n,i,s,o);return}if(v<-g-1&&m<-g-1){x(e,p.childrenNum[1],n,i,s,o);return}var y,b,w,E;v<m?(y=1/(v-m),b=1,E=(v+g+ft)*y,w=(v-g+ft)*y):v>m?(y=1/(v-m),b=0,E=(v-g-ft)*y,w=(v+g+ft)*y):(b=0,w=1,E=0);var S=[0,0,0],N;w<0?w=0:w>1&&(w=1),N=n+(i-n)*w,S[0]=s[0]+w*(o[0]-s[0]),S[1]=s[1]+w*(o[1]-s[1]),S[2]=s[2]+w*(o[2]-s[2]),x(e,p.childrenNum[b],n,N,s,S),E<0&&(E=0),E>1&&(E=1),N=n+(i-n)*E,S[0]=s[0]+E*(o[0]-s[0]),S[1]=s[1]+E*(o[1]-s[1]),S[2]=s[2]+E*(o[2]-s[2]),x(e,p.childrenNum[b^1],N,i,S,o)}function T(e,t){var n=r.brushes,i=r.leafBrushes,s=r.shaders;for(var o=0;o<t.numLeafBrushes;o++){var u=i[t.firstLeafBrush+o],a=n[u];if(a.checkcount===r.checkcount)continue;a.checkcount=r.checkcount;if(!(a.contents&e.contents))continue;if(!y(e.bounds[0],e.bounds[1],a.bounds[0],a.bounds[1]))continue;N(e,a);if(!e.trace.fraction)return}}function N(e,t){var n=r.brushSides,i=e.trace,s,o,u=!1,a=!1,f=-1,l=1;if(!t.numsides)return;for(var c=0;c<t.numsides;c++){var h=t.sides[c],p=h.plane,d=p.dist-vec3.dot(e.offsets[p.signbits],p.normal),v=vec3.dot(e.start,p.normal)-d,m=vec3.dot(e.end,p.normal)-d;m>0&&(u=!0),v>0&&(a=!0);if(v>0&&(m>=ft||m>=v))return;if(v<=0&&m<=0)continue;if(v>m){var g=(v-ft)/(v-m);g<0&&(g=0),g>f&&(f=g,o=p,s=h)}else{var g=(v+ft)/(v-m);g>1&&(g=1),g<l&&(l=g)}}if(!a){e.trace.startSolid=!0,u||(e.trace.allSolid=!0,e.trace.fraction=0,e.trace.contents=t.contents);return}f<l&&f>-1&&f<e.trace.fraction&&(f<0&&(f=0),e.trace.fraction=f,e.trace.plane=o,e.trace.contents=t.contents)}function C(e,t,n,i,s,o){o=o||new bt;var u=o.trace;r.checkcount||(r.checkcount=0),r.checkcount++,o.contents=s;var a=[0,0,0];for(var f=0;f<3;f++)a[f]=(n[f]+i[f])*.5,o.size[0][f]=n[f]-a[f],o.size[1][f]=i[f]-a[f],o.start[f]=e[f]+a[f],o.end[f]=t[f]+a[f];o.maxOffset=o.size[1][0]+o.size[1][1]+o.size[1][2],o.offsets[0][0]=o.size[0][0],o.offsets[0][1]=o.size[0][1],o.offsets[0][2]=o.size[0][2],o.offsets[1][0]=o.size[1][0],o.offsets[1][1]=o.size[0][1],o.offsets[1][2]=o.size[0][2],o.offsets[2][0]=o.size[0][0],o.offsets[2][1]=o.size[1][1],o.offsets[2][2]=o.size[0][2],o.offsets[3][0]=o.size[1][0],o.offsets[3][1]=o.size[1][1],o.offsets[3][2]=o.size[0][2],o.offsets[4][0]=o.size[0][0],o.offsets[4][1]=o.size[0][1],o.offsets[4][2]=o.size[1][2],o.offsets[5][0]=o.size[1][0],o.offsets[5][1]=o.size[0][1],o.offsets[5][2]=o.size[1][2],o.offsets[6][0]=o.size[0][0],o.offsets[6][1]=o.size[1][1],o.offsets[6][2]=o.size[1][2],o.offsets[7][0]=o.size[1][0],o.offsets[7][1]=o.size[1][1],o.offsets[7][2]=o.size[1][2];for(var f=0;f<3;f++)o.start[f]<o.end[f]?(o.bounds[0][f]=o.start[f]+o.size[0][f],o.bounds[1][f]=o.end[f]+o.size[1][f]):(o.bounds[0][f]=o.end[f]+o.size[0][f],o.bounds[1][f]=o.start[f]+o.size[1][f]);e[0]==t[0]&&e[1]==t[1]&&e[2]==t[2]?S(o):(o.size[0][0]==0&&o.size[0][1]==0&&o.size[0][2]==0?(o.isPoint=!0,o.extents=[0,0,0]):(o.isPoint=!1,o.extents[0]=o.size[1][0],o.extents[1]=o.size[1][1],o.extents[2]=o.size[1][2]),x(o,0,0,1,o.start,o.end));for(var f=0;f<3;f++)o.trace.endPos[f]=e[f]+o.trace.fraction*(t[f]-e[f]);return u}var t=e,r,E=new yt;return{LoadMap:i,EntityDefs:function(){return r.entities},InlineModel:v,ModelBounds:m,Trace:C}}var r="baseq3",i=1,s=2,o=4,u=64,a=64,f=1024,l=f-1,c=f-2,h=f-2,p=256,d=256,v={NAD:0,LOOPBACK:1,IP:2},m={CLIENT:0,SERVER:1},g=function(e,t,n){this.type=e,this.ip=t,this.port=n},y=function(e,t){var n=e,r=function(t){if(!arguments.length)return n;var r=n;typeof e=="string"?n=t.toString():e%1===0?n=parseInt(t):n=parseFloat(t)};return r.flags=t,r},b={ARCHIVE:1,USERINFO:2,SERVERINFO:4,SYSTEMINFO:8},w=function(){this.serverTime=0,this.angles=[0,0,0],this.forwardmove=0,this.rightmove=0,this.upmove=0};w.prototype.clone=function(e){return typeof e=="undefined"&&(e=new w),e.serverTime=this.serverTime,vec3.set(this.angles,e.angles),e.forwardmove=this.forwardmove,e.rightmove=this.rightmove,e.upmove=this.upmove,e};var E=6,S=function(){this.clientNum=0,this.commandTime=0,this.pm_type=0,this.pm_flags=0,this.origin=[0,0,0],this.velocity=[0,0,0],this.viewangles=[0,0,0],this.delta_angles=[0,0,0],this.speed=0,this.gravity=0,this.groundEntityNum=l,this.jumppad_ent=0,this.jumppad_frame=0,this.pmove_framecount=0};S.prototype.clone=function(e){return typeof e=="undefined"&&(e=new S),e.clientNum=this.clientNum,e.commandTime=this.commandTime,e.pm_type=this.pm_type,e.pm_flags=this.pm_flags,vec3.set(this.origin,e.origin),vec3.set(this.velocity,e.velocity),vec3.set(this.viewangles,e.viewangles),vec3.set(this.delta_angles,e.delta_angles),e.speed=this.speed,e.gravity=this.gravity,e.groundEntityNum=this.groundEntityNum,e.jumppad_ent=this.jumppad_ent,e.jumppad_frame=this.jumppad_frame,e.pmove_framecount=this.pmove_framecount,e};var x={STATIONARY:0,INTERPOLATE:1,LINEAR:2,LINEAR_STOP:3,SINE:4,GRAVITY:5},T=function(){this.trType=0,this.trTime=0,this.trDuration=0,this.trBase=[0,0,0],this.trDelta=[0,0,0]};T.prototype.clone=function(e){return typeof e=="undefined"&&(e=new T),e.trType=this.trType,e.trTime=this.trTime,e.trDuration=this.trDuration,vec3.set(this.trBase,e.trBase),vec3.set(this.trDelta,e.trDelta),e};var N=function(){this.number=0,this.eType=0,this.eFlags=0,this.pos=new T,this.apos=new T,this.time=0,this.time2=0,this.origin=[0,0,0],this.origin2=[0,0,0],this.angles=[0,0,0],this.angles2=[0,0,0],this.groundEntityNum=l,this.modelIndex=0,this.modelIndex2=0,this.clientNum=0,this.frame=0,this.solid=0,this.event=0,this.eventParm=0};N.prototype.clone=function(e){return typeof e=="undefined"&&(e=new N),e.number=this.number,e.eType=this.eType,e.eFlags=this.eFlags,this.pos.clone(e.pos),this.apos.clone(e.apos),e.time=this.time,e.time2=this.time2,vec3.set(this.origin,e.origin),vec3.set(this.origin2,e.origin2),vec3.set(this.angles,e.angles),vec3.set(this.angles2,e.angles2),e.groundEntityNum=this.groundEntityNum,e.modelIndex=this.modelIndex,e.modelindex2=this.modelIndex2,e.clientNum=this.clientNum,e.frame=this.frame,e.solid=this.solid,e.event=this.event,e.eventParm=this.eventParm,e};var C=0,k=1,L=2,_=function(e){return e*65536/360&65535},D=function(e){return e*(360/65536)},P=0,H=1,B=2,j=3,F=function(){this.normal=vec3.create(),this.dist=0,this.type=0,this.signbits=0},U=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],W={NODAMAGE:1,SLICK:2,SKY:4,LADDER:8,NOIMPACT:16,NOMARKS:32,FLESH:64,NODRAW:128,HINT:256,SKIP:512,NOLIGHTMAP:1024,POINTLIGHT:2048,METALSTEPS:4096,NOSTEPS:8192,NONSOLID:16384,LIGHTFILTER:32768,ALPHASHADOW:65536,NODLIGHT:131072,DUST:262144},X={ENTITIES:0,SHADERS:1,PLANES:2,NODES:3,LEAFS:4,LEAFSURFACES:5,LEAFBRUSHES:6,MODELS:7,BRUSHES:8,BRUSHSIDES:9,DRAWVERTS:10,DRAWINDEXES:11,FOGS:12,SURFACES:13,LIGHTMAPS:14,LIGHTGRID:15,VISIBILITY:16,NUM_LUMPS:17},V=64,$=function(){this.fileofs=0,this.filelen=0},J=function(){this.ident=null,this.version=0,this.lumps=new Array(X.NUM_LUMPS);for(var e=0;e<X.NUM_LUMPS;e++)this.lumps[e]=new $},K=function(){this.mins=[0,0,0],this.maxs=[0,0,0],this.firstSurface=0,this.numSurfaces=0,this.firstBrush=0,this.numBrushes=0};K.size=40;var Q=function(){this.shaderName=null,this.flags=0,this.contents=0};Q.size=72;var G=function(){this.normal=[0,0,0],this.dist=0};G.size=16;var Y=function(){this.planeNum=0,this.childrenNum=[0,0],this.mins=[0,0,0],this.maxs=[0,0,0]};Y.size=36;var Z=function(){this.cluster=0,this.area=0,this.mins=[0,0,0],this.maxs=[0,0,0],this.firstLeafSurface=0,this.numLeafSurfaces=0,this.firstLeafBrush=0,this.numLeafBrushes=0};Z.size=48;var et=function(){this.planeNum=0,this.shader=0};et.size=8;var tt=function(){this.side=0,this.numsides=0,this.shader=0};tt.size=12;var nt=function(){this.shader=null,this.brushNum=0,this.visibleSide=0};nt.size=72;var rt=function(){this.pos=[0,0,0],this.texCoord=[0,0],this.lmCoord=[0,0],this.normal=[0,0,0],this.color=[0,0,0,0]};rt.size=44;var it={BAD:0,PLANAR:1,PATCH:2,TRIANGLE_SOUP:3,FLARE:4},st=function(){this.shaderNum=0,this.fogNum=0,this.surfaceType=0,this.vertex=0,this.vertCount=0,this.meshVert=0,this.meshVertCount=0,this.lightmapNum=0,this.lmStart=[0,0],this.lmSize=[0,0],this.lmOrigin=[0,0,0],this.lmVecs=[[0,0,0],[0,0,0],[0,0,0]],this.patchWidth=0,this.patchHeight=0};st.size=104;var ut=function(){this.gl=null,this.handle=null},ft=.125,lt=function(){this.shaders=null,this.brushes=null,this.models=null,this.leafs=null,this.leafBrushes=null,this.nodes=null,this.planes=null,this.shaders=null,this.entities=null},ct=function(){this.planeNum=0,this.childrenNum=[0,0]},ht=function(){this.mins=[0,0,0],this.maxs=[0,0,0],this.leaf=null},pt=function(){this.cluster=0,this.area=0,this.firstLeafSurface=0,this.numLeafSurfaces=0,this.firstLeafBrush=0,this.numLeafBrushes=0},dt=function(){this.plane=null,this.surfaceFlags=0,this.shaderNum=0},vt=function(){this.shaderNum=0,this.contents=0,this.bounds=[[0,0,0],[0,0,0]],this.numsides=0,this.sides=null,this.checkcount=0},mt=function(){this.allSolid=!1,this.startSolid=!1,this.fraction=1,this.endPos=vec3.create(),this.plane=null},gt=1024,yt=function(){this.list=new Uint32Array(gt),this.count=0},bt=function(){this.trace=new mt,this.start=vec3.create(),this.end=vec3.create(),this.size=[vec3.create(),vec3.create()],this.offsets=[vec3.create(),vec3.create(),vec3.create(),vec3.create(),vec3.create(),vec3.create(),vec3.create(),vec3.create()],this.maxOffset=0,this.extents=vec3.create(),this.bounds=[vec3.create(),vec3.create()],this.contents=0,this.isPoint=!1};return{CreateInstance:function(e){return new wt(e)}}}),define("renderer/re",["underscore","glmatrix","ByteBuffer"],function(e,t,n){function A(e,t,n){return t-e>180&&(t-=360),t-e<-180&&(t+=360),e+n*(t-e)}function O(e,t,n,r){var i,s,o,u,a,f,l;i=e[k]*(Math.PI*2/360),u=Math.sin(i),l=Math.cos(i),i=e[C]*(Math.PI*2/360),o=Math.sin(i),f=Math.cos(i),i=e[L]*(Math.PI*2/360),s=Math.sin(i),a=Math.cos(i),t&&(t[0]=f*l,t[1]=f*u,t[2]=-o),n&&(n[0]=-1*s*o*l+ -1*a*-u,n[1]=-1*s*o*u+ -1*a*l,n[2]=-1*s*f),r&&(r[0]=a*o*l+ -s*-u,r[1]=a*o*u+ -s*l,r[2]=a*f)}function M(e,t){var n=[0,0,0];O(e,t[0],n,t[2]),vec3.subtract([0,0,0],n,t[1])}function I(e){return e[0]==1?P:e[1]==1?H:e[2]==1?B:j}function q(e){var t=0;for(var n=0;n<3;n++)e.normal[n]<0&&(t|=1<<n);return t}function R(e,t,n){if(n.type<j)return n.dist<=e[n.type]?1:n.dist>=t[n.type]?2:3;var r=[0,0];if(n.signbits<8)for(var i=0;i<3;i++){var s=n.signbits>>i&1;r[s]+=n.normal[i]*t[i],r[s^1]+=n.normal[i]*e[i]}var o=0;return r[0]>=n.dist&&(o=1),r[1]<n.dist&&(o|=2),o}function z(e,t,n){var r=new Array(n),i=[].concat(U),s=[].concat(U),o=[].concat(U),u=[].concat(U),a=0,f,l=0,c,h=0,p,d=0,v,m;for(m=0;m<n;m++)f=e[m][t]&255,c=e[m][t]>>8&255,p=e[m][t]>>16&255,v=e[m][t]>>24&255^128,i[f]++,s[c]++,o[p]++,u[v]++;for(m=0;m<256;m++)f=a+i[m],c=l+s[m],p=h+o[m],v=d+u[m],i[m]=a,s[m]=l,o[m]=h,u[m]=d,a=f,l=c,h=p,d=v;for(m=0;m<n;m++)f=e[m][t]&255,r[i[f]]=e[m],i[f]++;for(m=0;m<n;m++)c=r[m][t]>>8&255,e[s[c]]=r[m],s[c]++;for(m=0;m<n;m++)p=e[m][t]>>16&255,r[o[p]]=e[m],o[p]++;for(m=0;m<n;m++)v=r[m][t]>>24&255^128,e[u[v]]=r[m],u[v]++;return e}function ot(e){return e<-128?-128:e>127?127:e}function at(e){var t=65536,n=e.length,r=e.slice||e.subarray,i;if(n<t)i=String.fromCharCode.apply(String,e);else{var s=[],o=0;while(o<n)s.push(String.fromCharCode.apply(String,r.call(e,o,o+t))),o+=t;i=s.join("")}return btoa(i)}function Sn(e,t){console.log("--------- RE Init ---------"),cn=e,hn=t,pn=new wt,mn=hn.AddCvar("r_cull",1),gn=hn.AddCvar("r_subdivisions",4),yn=hn.AddCvar("r_znear",4),bn=hn.AddCvar("r_zproj",64);var n=cn.GetGameRenderContext();dn=n.gl,rr(),mr()}function xn(){console.log("--------- RE Shutdown ---------"),ir()}function Tn(){var e=pn.viewParms.or,t=mat4.create();t[0]=e.axis[0][0],t[4]=e.axis[0][1],t[8]=e.axis[0][2],t[12]=-e.origin[0]*t[0]+ -e.origin[1]*t[4]+ -e.origin[2]*t[8],t[1]=e.axis[1][0],t[5]=e.axis[1][1],t[9]=e.axis[1][2],t[13]=-e.origin[0]*t[1]+ -e.origin[1]*t[5]+ -e.origin[2]*t[9],t[2]=e.axis[2][0],t[6]=e.axis[2][1],t[10]=e.axis[2][2],t[14]=-e.origin[0]*t[2]+ -e.origin[1]*t[6]+ -e.origin[2]*t[10],t[3]=0,t[7]=0,t[11]=0,t[15]=1,mat4.multiply(En,t,e.modelMatrix)}function Nn(e,t){vec3.set(e.origin,t.origin),vec3.set(e.axis[0],t.axis[0]),vec3.set(e.axis[1],t.axis[1]),vec3.set(e.axis[2],t.axis[2]);var n=mat4.create();n[0]=t.axis[0][0],n[4]=t.axis[1][0],n[8]=t.axis[2][0],n[12]=t.origin[0],n[1]=t.axis[0][1],n[5]=t.axis[1][1],n[9]=t.axis[2][1],n[13]=t.origin[1],n[2]=t.axis[0][2],n[6]=t.axis[1][2],n[10]=t.axis[2][2],n[14]=t.origin[2],n[3]=0,n[7]=0,n[11]=0,n[15]=1,mat4.multiply(pn.viewParms.or.modelMatrix,n,t.modelMatrix)}function Cn(e){var t=pn.viewParms,n=e*Math.tan(t.fovY*Math.PI/360),r=-n,i=e*Math.tan(t.fovX*Math.PI/360),s=-i,o=i-s,u=n-r;t.projectionMatrix[0]=2*e/o,t.projectionMatrix[4]=0,t.projectionMatrix[8]=(i+s)/o,t.projectionMatrix[12]=0,t.projectionMatrix[1]=0,t.projectionMatrix[5]=2*e/u,t.projectionMatrix[9]=(n+r)/u,t.projectionMatrix[13]=0,t.projectionMatrix[3]=0,t.projectionMatrix[7]=0,t.projectionMatrix[11]=-1,t.projectionMatrix[15]=0,kn(t,s,i,n,e)}function kn(e,t,n,r,i){var s=vec3.create(e.or.origin),o=Math.sqrt(n*n+i*i),u=n/o,a=i/o;vec3.scale(e.or.axis[0],u,e.frustum[0].normal),vec3.add(e.frustum[0].normal,vec3.scale(e.or.axis[1],a,[0,0,0])),vec3.scale(e.or.axis[0],u,e.frustum[1].normal),vec3.add(e.frustum[1].normal,vec3.scale(e.or.axis[1],-a,[0,0,0])),o=Math.sqrt(r*r+i*i),u=r/o,a=i/o,vec3.scale(e.or.axis[0],u,e.frustum[2].normal),vec3.add(e.frustum[2].normal,vec3.scale(e.or.axis[2],a,[0,0,0])),vec3.scale(e.or.axis[0],u,e.frustum[3].normal),vec3.add(e.frustum[3].normal,vec3.scale(e.or.axis[2],-a,[0,0,0]));for(var f=0;f<4;f++)e.frustum[f].type=j,e.frustum[f].dist=vec3.dot(s,e.frustum[f].normal),e.frustum[f].signbits=q(e.frustum[f])}function Ln(){var e=pn.viewParms,t=0;for(var n=0;n<8;n++){var r=[0,0,0];n&1?r[0]=e.visBounds[0][0]:r[0]=e.visBounds[1][0],n&2?r[1]=e.visBounds[0][1]:r[1]=e.visBounds[1][1],n&4?r[2]=e.visBounds[0][2]:r[2]=e.visBounds[1][2];var i=vec3.subtract(r,pn.viewParms.or.origin,[0,0,0]),s=i[0]*i[0]+i[1]*i[1]+i[2]*i[2];s>t&&(t=s)}pn.viewParms.zFar=Math.sqrt(t)}function An(){var e=pn.viewParms,t=yn(),n=e.zFar,r=n-t;e.projectionMatrix[2]=0,e.projectionMatrix[6]=0,e.projectionMatrix[10]=-(n+t)/r,e.projectionMatrix[14]=-2*n*t/r}function On(e){pn.viewCount++,pn.viewParms=e,pn.viewParms.frameSceneNum=pn.frameSceneNum,pn.viewParms.frameCount=pn.frameCount,pn.viewCount++,Tn(),Cn(bn()),Mn(),Dn(),Bn()}function Mn(){oi(),Ir(),Ln(),An()}function _n(e,t,n){var r=pn.refdef,i=r.numDrawSurfs%ft;r.drawSurfs[i].sort=t.sortedIndex<<mt|n<<vt,r.drawSurfs[i].surface=e,r.numDrawSurfs++}function Dn(){z(pn.refdef.drawSurfs,"sort",pn.refdef.numDrawSurfs)}function Bn(){var e=pn.world,t=pn.viewParms,n=pn.refdef,r=n.drawSurfs,i=e.shaders;Pn||(Pn=new kt),dn.viewport(0,0,pn.viewParms.width,pn.viewParms.height),dn.clearColor(0,0,0,1),dn.clearDepth(1),dn.clear(dn.COLOR_BUFFER_BIT|dn.DEPTH_BUFFER_BIT),dn.enable(dn.DEPTH_TEST),dn.enable(dn.BLEND),dn.enable(dn.CULL_FACE),dn.depthMask(!0);var s=-1,o=null,u=-1,a;for(var f=0;f<n.numDrawSurfs;f++){var l=r[f],h=l.surface,p=pn.sortedShaders[(l.sort>>mt)%yt],d=(l.sort>>vt)%pt;if(r.sort===s){Hn[h.surfaceType](Pn,h);continue}s=l.sort;if(p!=o||d!=u)o&&Fn(),jn(p),o=p;if(u!==d){if(d!==c){var v=new Nt;Nn(n.refEntities[d],v),mat4.set(v.modelMatrix,Pn.modelMatrix)}else mat4.set(t.or.modelMatrix,Pn.modelMatrix);u=d}Hn[h.surfaceType](Pn,h)}o&&Fn()}function jn(e){Pn.numIndexes=0,Pn.numVertexes=0,Pn.shader=e,Pn.shaderTime=pn.refdef.time/1e3}function Fn(){var e=Pn.shader,t=new Float32Array(Pn.abvertexes,0,Pn.numVertexes*14),n=new Uint16Array(Pn.abindexes,0,Pn.numIndexes);dn.bindBuffer(dn.ARRAY_BUFFER,Pn.vertexBuffer),dn.bufferData(dn.ARRAY_BUFFER,t,dn.DYNAMIC_DRAW),dn.bindBuffer(dn.ELEMENT_ARRAY_BUFFER,Pn.indexBuffer),dn.bufferData(dn.ELEMENT_ARRAY_BUFFER,n,dn.DYNAMIC_DRAW),Cr(e);for(var r=0;r<e.stages.length;r++){var i=e.stages[r],s=i.program;kr(e,i,Pn.shaderTime),dn.uniformMatrix4fv(s.uniform.modelViewMat,!1,Pn.modelMatrix),dn.uniformMatrix4fv(s.uniform.projectionMat,!1,pn.viewParms.projectionMatrix),dn.enableVertexAttribArray(s.attrib.position),dn.vertexAttribPointer(s.attrib.position,3,dn.FLOAT,!1,56,0),s.attrib.texCoord!==undefined&&(dn.enableVertexAttribArray(s.attrib.texCoord),dn.vertexAttribPointer(s.attrib.texCoord,2,dn.FLOAT,!1,56,12)),s.attrib.lightCoord!==undefined&&(dn.enableVertexAttribArray(s.attrib.lightCoord),dn.vertexAttribPointer(s.attrib.lightCoord,2,dn.FLOAT,!1,56,20)),s.attrib.normal!==undefined&&(dn.enableVertexAttribArray(s.attrib.normal),dn.vertexAttribPointer(s.attrib.normal,3,dn.FLOAT,!1,56,28)),s.attrib.color!==undefined&&(dn.enableVertexAttribArray(s.attrib.color),dn.vertexAttribPointer(s.attrib.color,4,dn.FLOAT,!1,56,40)),dn.drawElements(e.mode,Pn.numIndexes,dn.UNSIGNED_SHORT,0)}}function In(e,t){pn.world=new Et,console.log("Loading render map for "+e),cn.ReadFile("maps/"+e+".bsp","binary",function(e,r){if(e)throw e;var i=new n(r,n.LITTLE_ENDIAN),s=new J;s.ident=i.readASCIIString(4),s.version=i.readInt();for(var o=0;o<X.NUM_LUMPS;o++)s.lumps[o].fileofs=i.readInt(),s.lumps[o].filelen=i.readInt();if(s.ident!=="IBSP"&&s.version!==46)return;zn(r,s.lumps[X.SHADERS]),Wn(r,s.lumps[X.LIGHTMAPS]),Xn(r,s.lumps[X.SURFACES],s.lumps[X.DRAWVERTS],s.lumps[X.DRAWINDEXES]),Jn(r,s.lumps[X.PLANES]),Kn(r,s.lumps[X.NODES],s.lumps[X.LEAFS],s.lumps[X.LEAFSURFACES]),Qn(r,s.lumps[X.VISIBILITY]),t&&t()})}function qn(e,t){var n=1,r=0;return e[0]*=t,e[1]*=t,e[2]*=t,e[0]>255&&(r=255/e[0])<n&&(n=r),e[1]>255&&(r=255/e[1])<n&&(n=r),e[2]>255&&(r=255/e[2])<n&&(n=r),e[0]*=n,e[1]*=n,e[2]*=n,e}function Rn(e){var t,n,r;t=e[0]/255,n=e[1]/255,r=e[2]/255;if((t|n|r)>1){var i=t>n?t:n;i=i>r?i:r,t/=i,n/=i,r/=i}return[t,n,r,e[3]/255]}function Un(e,t){var n=pn.world.shaders;if(e<0||e>=n.length)throw new Error("ShaderForShaderNum: bad num "+e);var r=n[e],i=yr(r.shaderName,t);return i}function zn(e,t){var r=new n(e,n.LITTLE_ENDIAN);r.index=t.fileofs;var i=pn.world.shaders=new Array(t.filelen/Q.size);for(var s=0;s<i.length;s++){var o=i[s]=new Q;o.shaderName=r.readASCIIString(V),o.flags=r.readInt(),o.contents=r.readInt()}}function Wn(e,t){var r=new n(e,n.LITTLE_ENDIAN);r.index=t.fileofs;var i=128,s=128,o=i*s,u=t.filelen/(o*3),a=2;while(a*a<u)a*=2;var f=a*i,l=0,c=0;pn.world.lightmaps=[];for(var h=0;h<u;++h){var p=new Array(o*4);for(var d=0;d<o*4;d+=4){var v=[r.readUnsignedByte(),r.readUnsignedByte(),r.readUnsignedByte()];qn(v,4),p[d]=v[0],p[d+1]=v[1],p[d+2]=v[2],p[d+3]=255}pn.world.lightmaps.push({x:l,y:c,width:i,height:s,buffer:new Uint8Array(p),texCoords:{x:l/f,y:c/f,xScale:i/f,yScale:s/f}}),l+=i,l>=f&&(c+=s,l=0)}fr("*lightmap",pn.world.lightmaps,f,f)}function Xn(e,t,r,i){var s=new n(e,n.LITTLE_ENDIAN);s.index=r.fileofs;var o=pn.world.verts=new Array(r.filelen/rt.size);for(var u=0;u<o.length;u++){var a=o[u]=new rt;a.pos=[s.readFloat(),s.readFloat(),s.readFloat()],a.texCoord=[s.readFloat(),s.readFloat()],a.lmCoord=[s.readFloat(),s.readFloat()],a.normal=[s.readFloat(),s.readFloat(),s.readFloat()],a.color=[s.readUnsignedByte(),s.readUnsignedByte(),s.readUnsignedByte(),s.readUnsignedByte()],a.color=Rn(qn(a.color,4))}s.index=i.fileofs;var f=pn.world.meshVerts=new Array(i.filelen/4);for(var u=0;u<f.length;u++)f[u]=s.readInt();s.index=t.fileofs;var l=pn.world.faces=new Array(t.filelen/st.size);for(var u=0;u<l.length;u++){var c=l[u]=new At,h=new st;h.shaderNum=s.readInt(),h.fogNum=s.readInt(),h.surfaceType=s.readInt(),h.vertex=s.readInt(),h.vertCount=s.readInt(),h.meshVert=s.readInt(),h.meshVertCount=s.readInt(),h.lightmapNum=s.readInt(),h.lmStart=[s.readInt(),s.readInt()],h.lmSize=[s.readInt(),s.readInt()],h.lmOrigin=[s.readFloat(),s.readFloat(),s.readFloat()],h.lmVecs=[[s.readFloat(),s.readFloat(),s.readFloat()],[s.readFloat(),s.readFloat(),s.readFloat()],[s.readFloat(),s.readFloat(),s.readFloat()]],h.patchWidth=s.readInt(),h.patchHeight=s.readInt(),c.surfaceType=Lt.FACE,c.shader=Un(h.shaderNum,h.lightmapNum),c.fogIndex=h.fogNum+1,c.vertex=h.vertex,c.vertCount=h.vertCount,c.meshVert=h.meshVert,c.meshVertCount=h.meshVertCount,c.lightmapNum=h.lightmapNum,c.patchWidth=h.patchWidth,c.patchHeight=h.patchHeight,h.surfaceType===it.PATCH?Vn(h,c,gn()):h.surfaceType===it.PLANAR&&$n(h,c)}var p=pn.world.lightmaps,d=new Array(o.length);for(var u=0;u<l.length;u++){var c=l[u],v=p[c.lightmapNum];v||(v=p[0]);for(var m=0;m<c.vertCount;m++){var g=c.vertex+m;if(!d[g]){var a=o[g];a.lmCoord[0]=a.lmCoord[0]*v.texCoords.xScale+v.texCoords.x,a.lmCoord[1]=a.lmCoord[1]*v.texCoords.yScale+v.texCoords.y,d[g]=!0}}for(var m=0;m<c.meshVertCount;m++){var g=c.vertex+f[c.meshVert+m];if(!d[g]){var a=o[g];a.lmCoord[0]=a.lmCoord[0]*v.texCoords.xScale+v.texCoords.x,a.lmCoord[1]=a.lmCoord[1]*v.texCoords.yScale+v.texCoords.y,d[g]=!0}}}}function Vn(e,t,n){var r=pn.world.verts,i=pn.world.meshVerts,s=r.slice(t.vertex,t.vertex+t.vertCount),o=tr(s,t.patchWidth,t.patchHeight,n);t.surfaceType=Lt.GRID,t.vertex=r.length,t.vertCount=o.verts.length,t.meshVert=i.length,t.meshVertCount=(o.width-1)*(o.height-1)*6,r.push.apply(r,o.verts);for(var u=0;u<o.height-1;u++)for(var a=0;a<o.width-1;a++){var f=u*o.width+a+1,l=f-1,c=l+o.width,h=c+1;i.push(l),i.push(c),i.push(f),i.push(f),i.push(c),i.push(h)}}function $n(e,t){var n=pn.world.verts;t.surfaceType=Lt.FACE,t.plane.normal=vec3.create(e.lmVecs[2]),t.plane.dist=vec3.dot(n[t.vertex].pos,t.plane.normal),t.plane.signbits=q(t.plane),t.plane.type=I(t.plane.normal)}function Jn(e,t){var r=new n(e,n.LITTLE_ENDIAN);r.index=t.fileofs;var i=pn.world.planes=new Array(t.filelen/G.size);for(var s=0;s<i.length;s++){var o=i[s]=new F;o.normal=[r.readFloat(),r.readFloat(),r.readFloat()],o.dist=r.readFloat(),o.signbits=q(o),o.type=I(o.normal)}}function Kn(e,t,r,i){var s=pn.world,o=s.planes,u=new n(e,n.LITTLE_ENDIAN),a=function(e,t){e.parent=t;if(!e.children)return;a(e.children[0],e),a(e.children[1],e)},f=t.filelen/Y.size,l=r.filelen/Z.size,c=s.nodes=new Array(f+l);for(var h=0;h<f;h++)c[h]=new Ut;for(var h=f;h<f+l;h++)c[h]=new zt;u.index=i.fileofs;var p=pn.world.leafSurfaces=new Array(i.filelen/4);for(var h=0;h<p.length;h++)p[h]=u.readInt();u.index=t.fileofs;for(var h=0;h<f;h++){var d=c[h],v=u.readInt(),m=[u.readInt(),u.readInt()],g=[u.readInt(),u.readInt(),u.readInt()],y=[u.readInt(),u.readInt(),u.readInt()];d.plane=o[v],d.children=new Array(2);for(var b=0;b<2;b++){var w=m[b];w>=0?d.children[b]=c[w]:d.children[b]=c[f+(-1-w)]}vec3.set(g,d.mins),vec3.set(y,d.maxs)}u.index=r.fileofs;for(var h=f;h<f+l;h++){var E=c[h];E.cluster=u.readInt(),E.area=u.readInt(),E.mins=[u.readInt(),u.readInt(),u.readInt()],E.maxs=[u.readInt(),u.readInt(),u.readInt()],E.firstLeafSurface=u.readInt(),E.numLeafSurfaces=u.readInt(),E.firstLeafBrush=u.readInt(),E.numLeafBrushes=u.readInt(),E.cluster>=s.numClusters&&(s.numClusters=E.cluster+1)}a(c[0],null)}function Qn(e,t){var r=pn.world,i=new n(e,n.LITTLE_ENDIAN);i.index=t.fileofs,r.numClusters=i.readInt(),r.clusterBytes=i.readInt();var s=r.numClusters*r.clusterBytes;r.vis=new Uint8Array(s);for(var o=0;o<s;o++)r.vis[o]=i.readUnsignedByte()}function Yn(e,t,n){n.pos[0]=.5*(e.pos[0]+t.pos[0]),n.pos[1]=.5*(e.pos[1]+t.pos[1]),n.pos[2]=.5*(e.pos[2]+t.pos[2]),n.lmCoord[0]=.5*(e.lmCoord[0]+t.lmCoord[0]),n.lmCoord[1]=.5*(e.lmCoord[1]+t.lmCoord[1]),n.texCoord[0]=.5*(e.texCoord[0]+t.texCoord[0]),n.texCoord[1]=.5*(e.texCoord[1]+t.texCoord[1]),n.color[0]=e.color[0]+t.color[0]>>1,n.color[1]=e.color[1]+t.color[1]>>1,n.color[2]=e.color[2]+t.color[2]>>1,n.color[3]=e.color[3]+t.color[3]>>1}function Zn(e,t,n){var r;if(t>n)for(var i=0;i<n;i++)for(var s=i+1;s<t;s++)s<n?(r=e[s][i],e[s][i]=e[i][s],e[i][s]=r):e[s][i]=e[i][s];else for(var i=0;i<t;i++)for(var s=i+1;s<n;s++)s<t?(r=e[i][s],e[i][s]=e[s][i],e[s][i]=r):e[i][s]=e[s][i]}function er(e,t,n){var r={pos:[0,0,0],lmCoord:[0,0],texCoord:[0,0],color:[0,0,0,0],normal:[0,0,1]},i={pos:[0,0,0],lmCoord:[0,0],texCoord:[0,0],color:[0,0,0,0],normal:[0,0,1]};for(var s=0;s<t;s++)for(var o=1;o<n;o+=2)Yn(e[o][s],e[o-1][s],r),Yn(e[o][s],e[o+1][s],i),Yn(r,i,e[o][s]);for(var o=0;o<n;o++)for(var s=1;s<t;s+=2)Yn(e[o][s],e[o][s-1],r),Yn(e[o][s],e[o][s+1],i),Yn(r,i,e[o][s])}function tr(e,t,n,r){var i=new Array(Gn);for(var s=0;s<Gn;s++)i[s]=new Array(Gn);for(var o=0;o<t;o++)for(var s=0;s<n;s++)i[s][o]=e[s*t+o];for(var u=0;u<2;u++){for(var o=0;o+2<t;o+=2){var a=0;for(var s=0;s<n;s++){var f=[0,0,0];for(var l=0;l<3;l++)f[l]=(i[s][o].pos[l]+i[s][o+1].pos[l]*2+i[s][o+2].pos[l])*.25;vec3.subtract(f,i[s][o].pos);var c=vec3.subtract(i[s][o+2].pos,i[s][o].pos,[0,0,0]);vec3.normalize(c);var h=vec3.dot(f,c),p=vec3.scale(c,h,[0,0,0]),d=vec3.subtract(f,p),v=vec3.length(d);v>a&&(a=v)}if(a<.1)continue;if(t+2>Gn)continue;if(a<=r)continue;t+=2;for(var s=0;s<n;s++){var m={pos:[0,0,0],lmCoord:[0,0],texCoord:[0,0],color:[0,0,0,0],normal:[0,0,1]},g={pos:[0,0,0],lmCoord:[0,0],texCoord:[0,0],color:[0,0,0,0],normal:[0,0,1]},y={pos:[0,0,0],lmCoord:[0,0],texCoord:[0,0],color:[0,0,0,0],normal:[0,0,1]};Yn(i[s][o],i[s][o+1],m),Yn(i[s][o+1],i[s][o+2],g),Yn(m,g,y);for(var b=t-1;b>o+3;b--)i[s][b]=i[s][b-2];i[s][o+1]=m,i[s][o+2]=y,i[s][o+3]=g}o-=2}Zn(i,t,n);var w=t;t=n,n=w}er(i,t,n);var E=new Array(t*n);for(var s=0;s<n;s++)for(var o=0;o<t;o++)E[s*t+o]=i[s][o];return{verts:E,width:t,height:n}}function rr(){or(),ur()}function ir(){}function sr(e,t){e=e.replace(/\.[^\.]+$/,".png");var n;if(n=nr[e])return n;var n=nr[e]=new Ht;n.name=e,n.texnum=sr("*default").texnum;var i=new Image;return i.onload=function(){n.texnum=ar(i,null,null,t)},i.src=r+"/"+e,n}function or(){fr("*white",new Uint8Array([255,255,255,255]),1,1)}function ur(){var e=nr["*default"]=new Ht;e.name=name;var t=new Image;t.onload=function(){e.texnum=ar(t)},t.src="data:image/png;base64,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"}function ar(e,t,n,r){var i=dn.createTexture();dn.bindTexture(dn.TEXTURE_2D,i);if(e instanceof Image)dn.texImage2D(dn.TEXTURE_2D,0,dn.RGBA,dn.RGBA,dn.UNSIGNED_BYTE,e);else if(e instanceof Uint8Array)dn.texImage2D(dn.TEXTURE_2D,0,dn.RGBA,t,n,0,dn.RGBA,dn.UNSIGNED_BYTE,e);else{dn.texImage2D(dn.TEXTURE_2D,0,dn.RGBA,t,n,0,dn.RGBA,dn.UNSIGNED_BYTE,null);for(var s=0;s<e.length;s++){var o=e[s];dn.texSubImage2D(dn.TEXTURE_2D,0,o.x,o.y,o.width,o.height,dn.RGBA,dn.UNSIGNED_BYTE,o.buffer)}}return dn.texParameteri(dn.TEXTURE_2D,dn.TEXTURE_MAG_FILTER,dn.LINEAR),dn.texParameteri(dn.TEXTURE_2D,dn.TEXTURE_MIN_FILTER,dn.LINEAR_MIPMAP_NEAREST),r&&(dn.texParameterf(dn.TEXTURE_2D,dn.TEXTURE_WRAP_S,dn.CLAMP_TO_EDGE),dn.texParameterf(dn.TEXTURE_2D,dn.TEXTURE_WRAP_T,dn.CLAMP_TO_EDGE)),dn.generateMipmap(dn.TEXTURE_2D),i}function fr(e,t,n,r,i){var s;return(s=nr[e])||(s=nr[e]=new Ht,s.name=e),s.texnum=ar(t,n,r,i),s}function lr(e){return e<1||e>=pn.models.length?pn.models[0]:pn.models[e]}function cr(e){if(!e)return console.log("RegisterModel: null name"),0;for(var t=0;t<pn.models.length;t++){mod=pn.models[t];if(mod.name===e)return t}return t=pn.models.length,mod=pn.models[t]=new Rt,mod.type=qt.BAD,mod.name=e,hr(mod,e),t}function hr(e,t){var n=0,r=t.substr(0,t.lastIndexOf("."))||t;for(var i=0;i>=0;i--){var s;i?s=r+"_"+i+".md3":s=r+".md3",function(t){pr(s,function(r,i){r||(e.type=qt.MD3,e.md3[t]=i,e.numLods++);if(++n===$t){var s;for(var o=$t-1;o>=0;o--)e.md3[o]?s=e.md3[o]:s&&(e.md3[o]=s,e.numLods++)}})}(i)}}function pr(e,t){cn.ReadFile(e,"binary",function(r,i){if(r)return t(r);var s=new n(i,n.LITTLE_ENDIAN),o=new nn;o.ident=s.readInt(),o.version=s.readInt();if(o.version!=Vt)return console.warn("LoadMd3: "+e+" has wrong version ("+version+" should be "+Vt+")"),null;o.name=s.readASCIIString(V),o.flags=s.readInt(),o.numFrames=s.readInt(),o.numTags=s.readInt(),o.numSurfaces=s.readInt(),o.numSkins=s.readInt(),o.ofsFrames=s.readInt(),o.ofsTags=s.readInt(),o.ofsSurfaces=s.readInt(),o.ofsEnd=s.readInt();if(o.numFrames<1)return console.warn("LoadMd3: "+e+" has no frames"),null;var u=new tn;u.name=o.name,u.frames=new Array(o.numFrames),u.tags=new Array(o.numTags),u.surfaces=new Array(o.numSurfaces),u.skins=new Array(o.numSkins),s.index=o.ofsFrames;for(var a=0;a<o.numFrames;a++){var f=u.frames[a]=new fn;for(var l=0;l<6;l++)f.bounds[Math.floor(l/3)][l%3]=s.readFloat();for(var l=0;l<3;l++)f.localOrigin[l]=s.readFloat();f.radius=s.readFloat(),f.name=s.readASCIIString(16)}s.index=o.ofsTags;for(var a=0;a<o.numTags;a++){var c=u.tags[a]=new ln;c.name=s.readASCIIString(V);for(var l=0;l<3;l++)c.origin[l]=s.readFloat();for(var l=0;l<9;l++)c.axis[Math.floor(l/3)][l%3]=s.readFloat()}var h=s.index=o.ofsSurfaces;for(var a=0;a<o.numSurfaces;a++){var p=new rn;p.ident=s.readInt(),p.name=s.readASCIIString(V),p.flags=s.readInt(),p.numFrames=s.readInt(),p.numShaders=s.readInt(),p.numVerts=s.readInt(),p.numTriangles=s.readInt(),p.ofsTriangles=s.readInt(),p.ofsShaders=s.readInt(),p.ofsSt=s.readInt(),p.ofsXyzNormals=s.readInt(),p.ofsEnd=s.readInt();if(p.numVerts>lt)return console.warn("LoadMd3: "+e+" has more than "+lt+" verts on a surface ("+p.numVerts+")"),null;if(p.numTriangles*3>ct)return console.warn("LoadMd3: "+e+" has more than "+ct/3+" triangles on a surface ("+shead.numTriangles+")"),null;var d=u.surfaces[a]=new Mt;d.header=p,d.name=p.name.toLowerCase(),d.shaders=new Array(p.numShaders),d.triangles=new Array(p.numTriangles),d.st=new Array(p.numVerts),d.xyzNormals=new Array(p.numFrames*p.numVerts),s.index=h+p.ofsShaders;for(var l=0;l<p.numShaders;l++){var v=d.shaders[l]=new sn;v.name=s.readASCIIString(V).replace(/\.[^/.]+$/,""),v.shader=yr(v.name,Pt.NONE)}s.index=h+p.ofsTriangles;for(var l=0;l<p.numTriangles;l++){var m=d.triangles[l]=new on;for(var g=0;g<3;g++)m.indexes[g]=s.readInt()}s.index=h+p.ofsSt;for(var l=0;l<p.numVerts;l++){var y=d.st[l]=new un;for(var g=0;g<2;g++)y.st[g]=s.readFloat()}s.index=h+p.ofsXyzNormals;for(var l=0;l<p.numFrames*p.numVerts;l++){var b=d.xyzNormals[l]=new an;for(var g=0;g<3;g++)b.xyz[g]=s.readShort();var w=s.readByte(),E=s.readByte(),S=w*2*Math.PI/255,x=E*2*Math.PI/255;b.normal[0]=Math.cos(x)*Math.sin(S),b.normal[1]=Math.sin(x)*Math.sin(S),b.normal[2]=Math.cos(S)}h+=p.ofsEnd}t(null,u)})}function dr(e){if(!pn.world)return;pn.refdef.x=e.x,pn.refdef.y=e.y,pn.refdef.width=e.width,pn.refdef.height=e.height,pn.refdef.fovX=e.fovX,pn.refdef.fovY=e.fovY,pn.refdef.origin=e.vieworg,pn.refdef.viewaxis=e.viewaxis,pn.refdef.time=e.time,pn.refdef.numDrawSurfs=0;var t=new Ct;t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height,t.fovX=e.fovX,t.fovY=e.fovY,vec3.set(e.vieworg,t.or.origin),vec3.set(e.viewaxis[0],t.or.axis[0]),vec3.set(e.viewaxis[1],t.or.axis[1]),vec3.set(e.viewaxis[2],t.or.axis[2]),vec3.set(e.vieworg,t.pvsOrigin),On(t),pn.refdef.numRefEntities=0}function vr(e){if(e.reType<0||e.reType>=xt.MAX_REF_ENTITY_TYPE)throw new Error("AddRefEntityToScene: bad reType "+ent.reType);e.index=pn.refdef.numRefEntities,e.clone(pn.refdef.refEntities[pn.refdef.numRefEntities]),pn.refdef.numRefEntities++}function mr(e){xr(function(){gr(),Er(function(){e&&e()})})}function gr(){pn.defaultProgram=Nr(pn.programBodies["default.vp"],pn.programBodies["default.fp"]),pn.defaultModelProgram=Nr(pn.programBodies["default.vp"],pn.programBodies["defaultModel.fp"]);var e=new Bt,t=new jt;e.mode=dn.LINE_LOOP,e.name="debugGreenShader",t.program=Nr(pn.programBodies["world.vp"],pn.programBodies["green.fp"]),e.stages.push(t),br("debugGreenShader",e)}function yr(e,t){var n;if(n=pn.compiledShaders[e])return n;if(pn.shaderBodies[e]){var r=pn.shaderBodies[e],i=Lr(r,t);n=Mr(i)}else{n=new Bt,n.name=e!=="*default"?e+".png":e;var s=new jt;s.texture=sr(n.name),s.program=t===Pt.VERTEX||t===Pt.NONE?pn.defaultModelProgram:pn.defaultProgram,n.stages.push(s)}return br(e,n)}function br(e,t){return pn.sortedShaders.length===yt?(console.warn("RegisterShader - MAX_SHADERS hit"),yr("*default")):(wr(t),pn.compiledShaders[e]=t)}function wr(e){var t=pn.sortedShaders,n=e.sort;for(var r=t.length-1;r>=0;r--){if(t[r].sort<=n)break;t[r+1]=t[r],t[r+1].sortedIndex++}e.sortedIndex=r+1,t[r+1]=e}function Er(e){var t=["scripts/base.shader","scripts/base_button.shader","scripts/base_floor.shader","scripts/base_light.shader","scripts/base_object.shader","scripts/base_support.shader","scripts/base_trim.shader","scripts/base_wall.shader","scripts/common.shader","scripts/ctf.shader","scripts/eerie.shader","scripts/gfx.shader","scripts/gothic_block.shader","scripts/gothic_floor.shader","scripts/gothic_light.shader","scripts/gothic_trim.shader","scripts/gothic_wall.shader","scripts/hell.shader","scripts/liquid.shader","scripts/menu.shader","scripts/models.shader","scripts/organics.shader","scripts/sfx.shader","scripts/shrine.shader","scripts/skin.shader","scripts/sky.shader","scripts/test.shader"],n=0;for(var r=0;r<t.length;++r)Sr(t[r],function(){++n===t.length&&e&&e()})}function Sr(e,t){cn.ReadFile(e,"utf8",function(e,n){if(e)throw e;var r=new Fr(n);while(!r.EOF()){var i=r.next(),s=0,o=i+" ";do{var u=r.next();u==="{"?s++:u==="}"&&s--,o+=u+" "}while(s&&!r.EOF());pn.shaderBodies[i]=o}t&&t()})}function xr(e){var t=["programs/default.vp","programs/world.vp","programs/default.fp","programs/defaultModel.fp","programs/green.fp"],n=0;for(var r=0;r<t.length;++r)Tr(t[r],function(){++n===t.length&&e&&e()})}function Tr(e,t){cn.ReadFile(e,"utf8",function(n,r){if(n)throw n;var i=e.replace(/.*\//,"");pn.programBodies[i]=r,t&&t()})}function Nr(e,t){var n=dn.createShader(dn.FRAGMENT_SHADER);dn.shaderSource(n,t),dn.compileShader(n);if(!dn.getShaderParameter(n,dn.COMPILE_STATUS))return dn.deleteShader(n),null;var r=dn.createShader(dn.VERTEX_SHADER);dn.shaderSource(r,e),dn.compileShader(r);if(!dn.getShaderParameter(r,dn.COMPILE_STATUS))return dn.deleteShader(r),null;var i=dn.createProgram();dn.attachShader(i,r),dn.attachShader(i,n),dn.linkProgram(i);if(!dn.getProgramParameter(i,dn.LINK_STATUS))return dn.deleteProgram(i),dn.deleteShader(r),dn.deleteShader(n),null;var s,o,u,a=dn.getProgramParameter(i,dn.ACTIVE_ATTRIBUTES);i.attrib={};for(s=0;s<a;s++)o=dn.getActiveAttrib(i,s),i.attrib[o.name]=dn.getAttribLocation(i,o.name);var f=dn.getProgramParameter(i,dn.ACTIVE_UNIFORMS);i.uniform={};for(s=0;s<f;s++)u=dn.getActiveUniform(i,s),i.uniform[u.name]=dn.getUniformLocation(i,u.name);return i}function Cr(e){e.cull?(dn.enable(dn.CULL_FACE),dn.cullFace(e.cull)):dn.disable(dn.CULL_FACE)}function kr(e,t,n){if(!n||isNaN(n))throw new Error("Invalid time for shader");dn.blendFunc(t.blendSrc,t.blendDest),t.depthWrite?dn.depthMask(!0):dn.depthMask(!1),dn.depthFunc(t.depthFunc),dn.useProgram(t.program);var r;if(t.animFreq){var i=Math.floor(n*t.animFreq)%t.animTextures.length;r=t.animTextures[i]}else r=t.texture;r&&(dn.activeTexture(dn.TEXTURE0),dn.uniform1i(t.program.uniform.texture,0),dn.bindTexture(dn.TEXTURE_2D,r.texnum));if(t.program.uniform.lightmap){var s=sr("*lightmap");dn.activeTexture(dn.TEXTURE1),dn.uniform1i(t.program.uniform.lightmap,1),dn.bindTexture(dn.TEXTURE_2D,s.texnum)}t.program.uniform.time&&dn.uniform1f(t.program.uniform.time,n)}function Lr(e,t){var n=new Fr(e),r=new Ft;r.name=n.next(),r.lightmapIndex=t;if(n.next()!=="{")return null;while(!n.EOF()){var i=n.next().toLowerCase();if(i=="}")break;switch(i){case"{":var s=Ar(r,n);s.isLightmap&&s.hasBlendFunc&&(s.blendSrc="GL_DST_COLOR",s.blendDest="GL_ZERO"),s.alphaGen=="lightingspecular"&&(s.blendSrc="GL_ONE",s.blendDest="GL_ZERO",s.hasBlendFunc=!1,s.depthWrite=!0,r.stages=[]),s.hasBlendFunc?r.blend=!0:r.opaque=!0,r.stages.push(s);break;case"cull":r.cull=n.next();break;case"deformvertexes":var o={type:n.next().toLowerCase()};switch(o.type){case"wave":o.spread=1/parseFloat(n.next()),o.waveform=Or(n);break;default:o=null}o&&r.vertexDeforms.push(o);break;case"sort":var u=n.next().toLowerCase();switch(u){case"portal":r.sort=Dt.PORTAL;break;case"sky":r.sort=Dt.ENVIRONMENT;break;case"opaque":r.sort=Dt.OPAQUE;break;case"decal":r.sort=Dt.DECAL;break;case"seeThrough":r.sort=Dt.SEE_THROUGH;break;case"banner":r.sort=Dt.BANNER;break;case"additive":r.sort=Dt.BLEND1;break;case"nearest":r.sort=Dt.NEAREST;break;case"underwater":r.sort=Dt.UNDERWATER;break;default:r.sort=parseInt(u)}break;case"surfaceparm":var a=n.next().toLowerCase();switch(a){case"sky":r.sky=!0;break;default:}break;default:}}return r.sort||(r.opaque?r.sort=Dt.OPAQUE:r.sort=Dt.BLEND0),r}function Ar(e,t){var n=new It;while(!t.EOF()){var r=t.next();if(r=="}")break;switch(r.toLowerCase()){case"clampmap":n.clamp=!0;case"map":n.map=t.next().replace(/(\.jpg|\.tga)/,".png");if(!n.map)throw new Error("WARNING: missing parameter for 'map' keyword in shader '"+e.name+"'");n.map==="$whiteimage"?n.texture=sr("*white"):n.map=="$lightmap"?(n.isLightmap=!0,e.lightmapIndex<0?n.texture=sr("*white"):n.texture=sr("*lightmap")):n.texture=sr(n.map,n.clamp);break;case"animmap":n.animFrame=0,n.animFreq=parseFloat(t.next());var i=t.next();n.animTextures=[];while(i.match(/(\.jpg|\.tga)/)){var s=i.replace(/(\.jpg|\.tga)/,".png");n.animMaps.push(s),n.animTextures.push(sr(s,n.clamp)),i=t.next()}t.prev();break;case"rgbgen":n.rgbGen=t.next().toLowerCase();switch(n.rgbGen){case"wave":n.rgbWaveform=Or(t),n.rgbWaveform||n.rgbGen=="identity"}break;case"alphagen":n.alphaGen=t.next().toLowerCase();switch(n.alphaGen){case"wave":n.alphaWaveform=Or(t),n.alphaWaveform||n.alphaGen=="1.0";break;default:}break;case"alphafunc":n.alphaFunc=t.next().toUpperCase();break;case"blendfunc":n.blendSrc=t.next(),n.hasBlendFunc=!0,n.depthWriteOverride||(n.depthWrite=!1);switch(n.blendSrc){case"add":n.blendSrc="GL_ONE",n.blendDest="GL_ONE";break;case"blend":n.blendSrc="GL_SRC_ALPHA",n.blendDest="GL_ONE_MINUS_SRC_ALPHA";break;case"filter":n.blendSrc="GL_DST_COLOR",n.blendDest="GL_ZERO";break;default:n.blendDest=t.next()}break;case"depthfunc":n.depthFunc=t.next().toLowerCase();break;case"depthwrite":n.depthWrite=!0,n.depthWriteOverride=!0;break;case"tcmod":var o={type:t.next().toLowerCase()};switch(o.type){case"rotate":o.angle=parseFloat(t.next())*(3.1415/180);break;case"scale":o.scaleX=parseFloat(t.next()),o.scaleY=parseFloat(t.next());break;case"scroll":o.sSpeed=parseFloat(t.next()),o.tSpeed=parseFloat(t.next());break;case"stretch":o.waveform=Or(t),o.waveform||o.type==null;break;case"turb":o.turbulance={base:parseFloat(t.next()),amp:parseFloat(t.next()),phase:parseFloat(t.next()),freq:parseFloat(t.next())};break;default:o.type==null}o.type&&n.tcMods.push(o);break;case"tcgen":n.tcGen=t.next();break;default:}}return n.blendSrc=="GL_ONE"&&n.blendDest=="GL_ZERO"&&(n.hasBlendFunc=!1,n.depthWrite=!0),n}function Or(e){return{funcName:e.next().toLowerCase(),base:parseFloat(e.next()),amp:parseFloat(e.next()),phase:parseFloat(e.next()),freq:parseFloat(e.next())}}function Mr(e){var t=new Bt;t.name=e.name,t.sort=e.sort,t.cull=Dr(e.cull),t.blend=e.blend,t.sky=e.sky;for(var n=0;n<e.stages.length;n++){var r=e.stages[n],i=new jt;i.texture=r.texture,i.animFreq=r.animFreq,i.animTextures=r.animTextures,i.blendSrc=Pr(r.blendSrc),i.blendDest=Pr(r.blendDest),i.depthFunc=_r(r.depthFunc),i.depthWrite=r.depthWrite;var s=Hr(e,r),o=Br(e,r);i.program=Nr(s,o),i.vertexSrc=s,i.fragmentSrc=o,t.stages.push(i)}return t}function _r(e){if(!e)return dn.LEQUAL;switch(e.toLowerCase()){case"gequal":return dn.GEQUAL;case"lequal":return dn.LEQUAL;case"equal":return dn.EQUAL;case"greater":return dn.GREATER;case"less":return dn.LESS;default:return dn.LEQUAL}}function Dr(e){if(!e)return dn.FRONT;e=e.toLowerCase();if(e=="none"||e=="twosided"||e=="disable")return null;if(e=="back"||e=="backside"||e=="backsided")return dn.BACK}function Pr(e){if(!e)return dn.ONE;switch(e.toUpperCase()){case"GL_ONE":return dn.ONE;case"GL_ZERO":return dn.ZERO;case"GL_DST_COLOR":return dn.DST_COLOR;case"GL_ONE_MINUS_DST_COLOR":return dn.ONE_MINUS_DST_COLOR;case"GL_SRC_ALPHA ":return dn.SRC_ALPHA;case"GL_ONE_MINUS_SRC_ALPHA":return dn.ONE_MINUS_SRC_ALPHA;case"GL_SRC_COLOR":return dn.SRC_COLOR;case"GL_ONE_MINUS_SRC_COLOR":return dn.ONE_MINUS_SRC_COLOR;default:return dn.ONE}}function Hr(e,t){var n=new jr;n.addAttribs({position:"vec3",normal:"vec3",color:"vec4"}),n.addVaryings({vTexCoord:"vec2",vColor:"vec4"}),n.addUniforms({modelViewMat:"mat4",projectionMat:"mat4",time:"float"}),t.isLightmap?n.addAttribs({lightCoord:"vec2"}):n.addAttribs({texCoord:"vec2"}),n.addLines(["vec3 defPosition = position;"]);for(var r=0;r<e.vertexDeforms.length;++r){var i=e.vertexDeforms[r];switch(i.type){case"wave":var s="deform"+r,o="deformOff"+r;n.addLines(["float "+o+" = (position.x + position.y + position.z) * "+i.spread.toFixed(4)+";"]);var u=i.waveform.phase;i.waveform.phase=u.toFixed(4)+" + "+o,n.addWaveform(s,i.waveform),i.waveform.phase=u,n.addLines(["defPosition += normal * "+s+";"]);break;default:}}n.addLines(["vec4 worldPosition = modelViewMat * vec4(defPosition, 1.0);"]),n.addLines(["vColor = color;"]),t.tcGen=="environment"?n.addLines(["vec3 viewer = normalize(-worldPosition.xyz);","float d = dot(normal, viewer);","vec3 reflected = normal*2.0*d - viewer;","vTexCoord = vec2(0.5, 0.5) + reflected.xy * 0.5;"]):t.isLightmap?n.addLines(["vTexCoord = lightCoord;"]):n.addLines(["vTexCoord = texCoord;"]);for(var r=0;r<t.tcMods.length;r++){var a=t.tcMods[r];switch(a.type){case"rotate":n.addLines(["float r = "+a.angle.toFixed(4)+" * time;","vTexCoord -= vec2(0.5, 0.5);","vTexCoord = vec2(vTexCoord.s * cos(r) - vTexCoord.t * sin(r), vTexCoord.t * cos(r) + vTexCoord.s * sin(r));","vTexCoord += vec2(0.5, 0.5);"]);break;case"scroll":n.addLines(["vTexCoord += vec2("+a.sSpeed.toFixed(4)+" * time, "+a.tSpeed.toFixed(4)+" * time);"]);break;case"scale":n.addLines(["vTexCoord *= vec2("+a.scaleX.toFixed(4)+", "+a.scaleY.toFixed(4)+");"]);break;case"stretch":n.addWaveform("stretchWave",a.waveform),n.addLines(["stretchWave = 1.0 / stretchWave;","vTexCoord *= stretchWave;","vTexCoord += vec2(0.5 - (0.5 * stretchWave), 0.5 - (0.5 * stretchWave));"]);break;case"turb":var f="turbTime"+r;n.addLines(["float "+f+" = "+a.turbulance.phase.toFixed(4)+" + time * "+a.turbulance.freq.toFixed(4)+";","vTexCoord.s += sin( ( ( position.x + position.z )* 1.0/128.0 * 0.125 + "+f+" ) * 6.283) * "+a.turbulance.amp.toFixed(4)+";","vTexCoord.t += sin( ( position.y * 1.0/128.0 * 0.125 + "+f+" ) * 6.283) * "+a.turbulance.amp.toFixed(4)+";"]);break;default:}}switch(t.alphaGen){case"lightingspecular":n.addAttribs({lightCoord:"vec2"}),n.addVaryings({vLightCoord:"vec2"}),n.addLines(["vLightCoord = lightCoord;"]);break;default:}return n.addLines(["gl_Position = projectionMat * worldPosition;"]),n.getSource()}function Br(e,t){var n=new jr;n.addVaryings({vTexCoord:"vec2",vColor:"vec4"}),n.addUniforms({texture:"sampler2D",time:"float"}),n.addLines(["vec4 texColor = texture2D(texture, vTexCoord.st);"]);switch(t.rgbGen){case"vertex":n.addLines(["vec3 rgb = texColor.rgb * vColor.rgb;"]);break;case"wave":n.addWaveform("rgbWave",t.rgbWaveform),n.addLines(["vec3 rgb = texColor.rgb * rgbWave;"]);break;default:n.addLines(["vec3 rgb = texColor.rgb;"])}switch(t.alphaGen){case"wave":n.addWaveform("alpha",t.alphaWaveform);break;case"lightingspecular":n.addUniforms({lightmap:"sampler2D"}),n.addVaryings({vLightCoord:"vec2",vLight:"float"}),n.addLines(["vec4 light = texture2D(lightmap, vLightCoord.st);","rgb *= light.rgb;","rgb += light.rgb * texColor.a * 0.6;","float alpha = 1.0;"]);break;default:n.addLines(["float alpha = texColor.a;"])}if(t.alphaFunc)switch(t.alphaFunc){case"GT0":n.addLines(["if(alpha == 0.0) { discard; }"]);break;case"LT128":n.addLines(["if(alpha >= 0.5) { discard; }"]);break;case"GE128":n.addLines(["if(alpha < 0.5) { discard; }"]);break;default:}return n.addLines(["gl_FragColor = vec4(rgb, alpha);"]),n.getSource()}function Ir(){for(var e=0;e<pn.refdef.numRefEntities;e++){var t=pn.refdef.refEntities[e];switch(t.reType){case xt.BBOX:qr(t);break;case xt.MODEL:Rr(t);break;default:throw new Error("AddEntitySurfaces: Bad reType")}}}function qr(e){var t=pn.bboxSurfaces[pn.bboxSurfaceNum++%bt];t.shader=yr("debugGreenShader"),t.refent=e,_n(t,t.shader,e.index)}function Rr(e){var t=lr(e.hModel),n=t.md3[0];if(!n)return;for(var r=0;r<n.surfaces.length;r++){var i=n.surfaces[r];_n(i,i.shaders[0].shader,e.index)}}function Ur(e,t){var n=pn.world.verts,r=pn.world.meshVerts,i=e.numVertexes*14,s=e.numVertexes;for(var o=0;o<t.vertCount;o++){var u=n[t.vertex+o];e.vertexes[i++]=u.pos[0],e.vertexes[i++]=u.pos[1],e.vertexes[i++]=u.pos[2],e.vertexes[i++]=u.texCoord[0],e.vertexes[i++]=u.texCoord[1],e.vertexes[i++]=u.lmCoord[0],e.vertexes[i++]=u.lmCoord[1],e.vertexes[i++]=u.normal[0],e.vertexes[i++]=u.normal[1],e.vertexes[i++]=u.normal[2],e.vertexes[i++]=u.color[0],e.vertexes[i++]=u.color[1],e.vertexes[i++]=u.color[2],e.vertexes[i++]=u.color[3],e.numVertexes++}for(var o=0;o<t.meshVertCount;o++){var a=r[t.meshVert+o];e.indexes[e.numIndexes++]=s+a}}function zr(e,t){var n=e.numVertexes*14,r=e.numVertexes;for(var i=0;i<t.header.numVerts;i++)e.vertexes[n++]=t.xyzNormals[i].xyz[0]*en,e.vertexes[n++]=t.xyzNormals[i].xyz[1]*en,e.vertexes[n++]=t.xyzNormals[i].xyz[2]*en,e.vertexes[n++]=t.st[i].st[0],e.vertexes[n++]=t.st[i].st[1],e.vertexes[n++]=0,e.vertexes[n++]=0,e.vertexes[n++]=t.xyzNormals[i].normal[0],e.vertexes[n++]=t.xyzNormals[i].normal[1],e.vertexes[n++]=t.xyzNormals[i].normal[2],e.vertexes[n++]=0,e.vertexes[n++]=0,e.vertexes[n++]=0,e.vertexes[n++]=0,e.numVertexes++;for(var i=0;i<t.triangles.length;i++){var s=t.triangles[i];e.indexes[e.numIndexes++]=r+s.indexes[0],e.indexes[e.numIndexes++]=r+s.indexes[1],e.indexes[e.numIndexes++]=r+s.indexes[2]}}function Vr(e){var t=Pn.numVertexes*14,n=Pn.numVertexes;for(var r=0;r<Wr.length;r+=3)Pn.vertexes[t++]=Wr[r+0],Pn.vertexes[t++]=Wr[r+1],Pn.vertexes[t++]=Wr[r+2],Pn.vertexes[t++]=0,Pn.vertexes[t++]=0,Pn.vertexes[t++]=0,Pn.vertexes[t++]=0,Pn.vertexes[t++]=0,Pn.vertexes[t++]=0,Pn.vertexes[t++]=0,Pn.vertexes[t++]=0,Pn.vertexes[t++]=0,Pn.vertexes[t++]=0,Pn.vertexes[t++]=0,Pn.numVertexes++;for(var r=0;r<Xr.length;r++)Pn.indexes[Pn.numIndexes++]=n+Xr[r]}function Zr(){var e=[-128,128,128,0,0,128,128,128,1,0,-128,-128,128,0,1,128,-128,128,1,1,-128,128,128,0,1,128,128,128,1,1,-128,128,-128,0,0,128,128,-128,1,0,-128,-128,128,0,0,128,-128,128,1,0,-128,-128,-128,0,1,128,-128,-128,1,1,128,128,128,0,0,128,-128,128,0,1,128,128,-128,1,0,128,-128,-128,1,1,-128,128,128,1,0,-128,-128,128,1,1,-128,128,-128,0,0,-128,-128,-128,0,1],t=[0,1,2,1,2,3,4,5,6,5,6,7,8,9,10,9,10,11,12,13,14,13,14,15,16,17,18,17,18,19];Kr=dn.createBuffer(),dn.bindBuffer(dn.ARRAY_BUFFER,Kr),dn.bufferData(dn.ARRAY_BUFFER,new Float32Array(e),dn.STATIC_DRAW),Qr=dn.createBuffer(),dn.bindBuffer(dn.ELEMENT_ARRAY_BUFFER,Qr),dn.bufferData(dn.ELEMENT_ARRAY_BUFFER,new Uint16Array(t),dn.STATIC_DRAW),Gr=t.length}function ei(e){if(!pn.world)throw new Error("PointInLeaf: bad model");var t=pn.world.nodes[0];for(;;){if(!t.children)break;var n=t.plane,r=vec3.dot(e,n.normal)-n.dist;r>0?t=t.children[0]:t=t.children[1]}return t}function ti(e,t){var n=pn.world;if(!n||!n.vis||e===t||e==-1)return!0;var r=e*n.clusterBytes;return(n.vis[r+(t>>3)]&1<<(t&7))!==0}function ni(){var e=pn.world,t=e.nodes,n=ei(pn.viewParms.pvsOrigin),r=n.cluster;if(pn.viewCluster===r)return;pn.viewCluster=r,pn.visCount++;for(var i=0,s=t.length;i<s;i++){var o=t[i],r=o.cluster;if(r<0||r>=e.numClusters)continue;if(!ti(pn.viewCluster,r))continue;var u=o;while(u){if(u.visframe===pn.visCount)break;u.visframe=pn.visCount,u=u.parent}}}function ri(e){if(e.viewCount===pn.viewCount)return;e.viewCount=pn.viewCount;if(ii(e,e.shader))return;_n(e,e.shader,c)}function ii(e,t){if(!mn())return!1;if(e.type===Lt.GRID)return!1;if(e.type!==Lt.FACE)return!1;if(!t.cull)return!1;var n=vec3.dot(pn.viewParms.or.origin,e.plane.normal);if(t.cull==="front"){if(n<e.plane.dist-8)return!0}else if(n>e.plane.dist+8)return!0;return!1}function si(e,t){for(;;){if(e.visframe!=pn.visCount)return;var n;if(t&1){n=R(e.mins,e.maxs,pn.viewParms.frustum[0]);if(n===2)return;n===1&&(t&=-2)}if(t&2){n=R(e.mins,e.maxs,pn.viewParms.frustum[1]);if(n===2)return;n===1&&(t&=-3)}if(t&4){n=R(e.mins,e.maxs,pn.viewParms.frustum[2]);if(n===2)return;n==1&&(t&=-5)}if(t&8){n=R(e.mins,e.maxs,pn.viewParms.frustum[3]);if(n===2)return;n===1&&(t&=-9)}if(!e.children)break;si(e.children[0],t),e=e.children[1]}var r=pn.viewParms;e.mins[0]<r.visBounds[0][0]&&(r.visBounds[0][0]=e.mins[0]),e.mins[1]<r.visBounds[0][1]&&(r.visBounds[0][1]=e.mins[1]),e.mins[2]<r.visBounds[0][2]&&(r.visBounds[0][2]=e.mins[2]),e.maxs[0]>r.visBounds[1][0]&&(r.visBounds[1][0]=e.maxs[0]),e.maxs[1]>r.visBounds[1][1]&&(r.visBounds[1][1]=e.maxs[1]),e.maxs[2]>r.visBounds[1][2]&&(r.visBounds[1][2]=e.maxs[2]);var i=pn.world.faces,s=pn.world.leafSurfaces;for(var o=0;o<e.numLeafSurfaces;o++){var u=i[s[e.firstLeafSurface+o]];ri(u)}}function oi(e){ni(),si(pn.world.nodes[0],15)}var r="baseq3",i=1,s=2,o=4,u=64,a=64,f=1024,l=f-1,c=f-2,h=f-2,p=256,d=256,v={NAD:0,LOOPBACK:1,IP:2},m={CLIENT:0,SERVER:1},g=function(e,t,n){this.type=e,this.ip=t,this.port=n},y=function(e,t){var n=e,r=function(t){if(!arguments.length)return n;var r=n;typeof e=="string"?n=t.toString():e%1===0?n=parseInt(t):n=parseFloat(t)};return r.flags=t,r},b={ARCHIVE:1,USERINFO:2,SERVERINFO:4,SYSTEMINFO:8},w=function(){this.serverTime=0,this.angles=[0,0,0],this.forwardmove=0,this.rightmove=0,this.upmove=0};w.prototype.clone=function(e){return typeof e=="undefined"&&(e=new w),e.serverTime=this.serverTime,vec3.set(this.angles,e.angles),e.forwardmove=this.forwardmove,e.rightmove=this.rightmove,e.upmove=this.upmove,e};var E=6,S=function(){this.clientNum=0,this.commandTime=0,this.pm_type=0,this.pm_flags=0,this.origin=[0,0,0],this.velocity=[0,0,0],this.viewangles=[0,0,0],this.delta_angles=[0,0,0],this.speed=0,this.gravity=0,this.groundEntityNum=l,this.jumppad_ent=0,this.jumppad_frame=0,this.pmove_framecount=0};S.prototype.clone=function(e){return typeof e=="undefined"&&(e=new S),e.clientNum=this.clientNum,e.commandTime=this.commandTime,e.pm_type=this.pm_type,e.pm_flags=this.pm_flags,vec3.set(this.origin,e.origin),vec3.set(this.velocity,e.velocity),vec3.set(this.viewangles,e.viewangles),vec3.set(this.delta_angles,e.delta_angles),e.speed=this.speed,e.gravity=this.gravity,e.groundEntityNum=this.groundEntityNum,e.jumppad_ent=this.jumppad_ent,e.jumppad_frame=this.jumppad_frame,e.pmove_framecount=this.pmove_framecount,e};var x={STATIONARY:0,INTERPOLATE:1,LINEAR:2,LINEAR_STOP:3,SINE:4,GRAVITY:5},T=function(){this.trType=0,this.trTime=0,this.trDuration=0,this.trBase=[0,0,0],this.trDelta=[0,0,0]};T.prototype.clone=function(e){return typeof e=="undefined"&&(e=new T),e.trType=this.trType,e.trTime=this.trTime,e.trDuration=this.trDuration,vec3.set(this.trBase,e.trBase),vec3.set(this.trDelta,e.trDelta),e};var N=function(){this.number=0,this.eType=0,this.eFlags=0,this.pos=new T,this.apos=new T,this.time=0,this.time2=0,this.origin=[0,0,0],this.origin2=[0,0,0],this.angles=[0,0,0],this.angles2=[0,0,0],this.groundEntityNum=l,this.modelIndex=0,this.modelIndex2=0,this.clientNum=0,this.frame=0,this.solid=0,this.event=0,this.eventParm=0};N.prototype.clone=function(e){return typeof e=="undefined"&&(e=new N),e.number=this.number,e.eType=this.eType,e.eFlags=this.eFlags,this.pos.clone(e.pos),this.apos.clone(e.apos),e.time=this.time,e.time2=this.time2,vec3.set(this.origin,e.origin),vec3.set(this.origin2,e.origin2),vec3.set(this.angles,e.angles),vec3.set(this.angles2,e.angles2),e.groundEntityNum=this.groundEntityNum,e.modelIndex=this.modelIndex,e.modelindex2=this.modelIndex2,e.clientNum=this.clientNum,e.frame=this.frame,e.solid=this.solid,e.event=this.event,e.eventParm=this.eventParm,e};var C=0,k=1,L=2,_=function(e){return e*65536/360&65535},D=function(e){return e*(360/65536)},P=0,H=1,B=2,j=3,F=function(){this.normal=vec3.create(),this.dist=0,this.type=0,this.signbits=0},U=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],W={NODAMAGE:1,SLICK:2,SKY:4,LADDER:8,NOIMPACT:16,NOMARKS:32,FLESH:64,NODRAW:128,HINT:256,SKIP:512,NOLIGHTMAP:1024,POINTLIGHT:2048,METALSTEPS:4096,NOSTEPS:8192,NONSOLID:16384,LIGHTFILTER:32768,ALPHASHADOW:65536,NODLIGHT:131072,DUST:262144},X={ENTITIES:0,SHADERS:1,PLANES:2,NODES:3,LEAFS:4,LEAFSURFACES:5,LEAFBRUSHES:6,MODELS:7,BRUSHES:8,BRUSHSIDES:9,DRAWVERTS:10,DRAWINDEXES:11,FOGS:12,SURFACES:13,LIGHTMAPS:14,LIGHTGRID:15,VISIBILITY:16,NUM_LUMPS:17},V=64,$=function(){this.fileofs=0,this.filelen=0},J=function(){this.ident=null,this.version=0,this.lumps=new Array(X.NUM_LUMPS);for(var e=0;e<X.NUM_LUMPS;e++)this.lumps[e]=new $},K=function(){this.mins=[0,0,0],this.maxs=[0,0,0],this.firstSurface=0,this.numSurfaces=0,this.firstBrush=0,this.numBrushes=0};K.size=40;var Q=function(){this.shaderName=null,this.flags=0,this.contents=0};Q.size=72;var G=function(){this.normal=[0,0,0],this.dist=0};G.size=16;var Y=function(){this.planeNum=0,this.childrenNum=[0,0],this.mins=[0,0,0],this.maxs=[0,0,0]};Y.size=36;var Z=function(){this.cluster=0,this.area=0,this.mins=[0,0,0],this.maxs=[0,0,0],this.firstLeafSurface=0,this.numLeafSurfaces=0,this.firstLeafBrush=0,this.numLeafBrushes=0};Z.size=48;var et=function(){this.planeNum=0,this.shader=0};et.size=8;var tt=function(){this.side=0,this.numsides=0,this.shader=0};tt.size=12;var nt=function(){this.shader=null,this.brushNum=0,this.visibleSide=0};nt.size=72;var rt=function(){this.pos=[0,0,0],this.texCoord=[0,0],this.lmCoord=[0,0],this.normal=[0,0,0],this.color=[0,0,0,0]};rt.size=44;var it={BAD:0,PLANAR:1,PATCH:2,TRIANGLE_SOUP:3,FLARE:4},st=function(){this.shaderNum=0,this.fogNum=0,this.surfaceType=0,this.vertex=0,this.vertCount=0,this.meshVert=0,this.meshVertCount=0,this.lightmapNum=0,this.lmStart=[0,0],this.lmSize=[0,0],this.lmOrigin=[0,0,0],this.lmVecs=[[0,0,0],[0,0,0],[0,0,0]],this.patchWidth=0,this.patchHeight=0};st.size=104;var ut=function(){this.gl=null,this.handle=null},ft=65536,lt=5e3,ct=6*lt,ht=10,pt=1<<ht,dt=2,vt=7,mt=vt+ht,gt=14,yt=1<<gt,bt=32,wt=function(){this.world=null,this.refdef=new St,this.viewParms=null,this.visCount=0,this.frameCount=0,this.sceneCount=0,this.viewCount=0,this.frameSceneNum=0,this.models=[],this.shaderBodies={},this.programBodies={},this.compiledShaders={},this.sortedShaders=[],this.defaultModelProgram=null,this.modelProgram=null,this.bboxSurfaces=new Array(bt),this.bboxSurfaceNum=0;for(var e=0;e<bt;e++)this.bboxSurfaces[e]=new Ot},Et=function(){this.name=null,this.path=null,this.lightmaps=null,this.shaders=[],this.verts=[],this.meshVerts=[],this.faces=[],this.planes=[],this.leafSurfaces=[],this.nodes=[],this.leafs=[],this.entities={},this.numClusters=0},St=function(){this.x=0,this.y=0,this.width=0,this.height=0,this.fovX=0,this.fovY=0,this.vieworg=[0,0,0],this.viewaxis=[[0,0,0],[0,0,0],[0,0,0]],this.time=0,this.drawSurfs=new Array(ft),this.numDrawSurfs=0,this.refEntities=new Array(pt),this.numRefEntities=0;for(var e=0;e<ft;e++)this.drawSurfs[e]=new _t;for(var e=0;e<pt;e++)this.refEntities[e]=new Tt},xt={BBOX:0,MODEL:1,POLY:2,SPRITE:3,BEAM:4,RAIL_CORE:5,RAIL_RINGS:6,LIGHTNING:7,PORTALSURFACE:8,MAX_REF_ENTITY_TYPE:9},Tt=function(){this.index=0,this.reType=0,this.origin=[0,0,0],this.axis=[[0,0,0],[0,0,0],[0,0,0]],this.hModel=-1,this.mins=[0,0,0],this.maxs=[0,0,0]};Tt.prototype.clone=function(e){return typeof e=="undefined"&&(e=new Tt),e.reType=this.reType,vec3.set(this.origin,e.origin),mat3.set(this.axis,e.axis),e.hModel=this.hModel,vec3.set(this.mins,e.mins),vec3.set(this.maxs,e.maxs),e.index=this.index,e};var Nt=function(){this.origin=vec3.create(),this.axis=[[0,0,0],[0,0,0],[0,0,0]],this.viewOrigin=vec3.create(),this.modelMatrix=mat4.create()},Ct=function(){this.or=new Nt,this.world=new Nt,this.pvsOrigin=vec3.create(),this.x=0,this.y=0,this.width=0,this.height=0,this.fovX=0,this.fovY=0,this.frustum=[new F,new F,new F,new F],this.visBounds=[vec3.create(),vec3.create()],this.zFar=0,this.projectionMatrix=mat4.create(),this.frameSceneNum=0,this.frameCount=0},kt=function(){this.shader=null,this.shaderTime=0,this.modelMatrix=mat4.create(),this.numVertexes=0,this.numIndexes=0,this.abindexes=new ArrayBuffer(ct*2),this.abvertexes=new ArrayBuffer(lt*4*14),this.indexes=new Uint16Array(this.abindexes),this.vertexes=new Float32Array(this.abvertexes),this.indexBuffer=dn.createBuffer(),this.vertexBuffer=dn.createBuffer()},Lt={BAD:0,BBOX:1,SKIP:2,FACE:3,GRID:4,TRIANGLES:5,POLY:6,MD3:7,FLARE:8,ENTITY:9,DISPLAY_LIST:10},At=function(){this.surfaceType=Lt.BAD,this.viewCount=0,this.shader=null,this.fogIndex=0,this.vertex=0,this.vertCount=0,this.meshVert=0,this.meshVertCount=0,this.lightmapNum=0,this.normal=[0,0,0],this.patchWidth=0,this.patchHeight=0,this.plane=new F},Ot=function(){this.surfaceType=Lt.BBOX,this.shader=null,this.refent=null},Mt=function(){this.surfaceType=Lt.MD3,this.header=null,this.name=null,this.shaders=null,this.st=null,this.triangles=null,this.xyzNormals=null},_t=function(){this.sort=0,this.surface=-1},Dt={BAD:0,PORTAL:1,ENVIRONMENT:2,OPAQUE:3,DECAL:4,SEE_THROUGH:5,BANNER:6,FOG:7,UNDERWATER:8,BLEND0:9,BLEND1:10,BLEND2:11,BLEND3:12,BLEND6:13,STENCIL_SHADOW:14,ALMOST_NEAREST:15,NEAREST:16},Pt={UV:-4,VERTEX:-3,WHITEIMAGE:-2,NONE:-1},Ht=function(){this.name=null,this.texnum=null},Bt=function(){this.name=null,this.sort=Dt.OPAQUE,this.cull=dn.FRONT,this.mode=dn.TRIANGLES,this.stages=[],this.sortedIndex=0},jt=function(){this.texture=null,this.animFreq=0,this.animTextures=null,this.blendSrc=dn.ONE,this.blendDest=dn.ZERO,this.depthWrite=!0,this.depthFunc=dn.LEQUAL,this.program=null},Ft=function(){this.name=null,this.sort=0,this.cull="front",this.sky=!1,this.blend=!1,this.opaque=!1,this.lightmapIndex=0,this.stages=[],this.vertexDeforms=[]},It=function(){this.map=null,this.animFreq=0,this.animMaps=[],this.clamp=!1,this.tcGen="base",this.rgbGen="identity",this.rgbWaveform=null,this.alphaGen="1.0",this.alphaFunc=null,this.alphaWaveform=null,this.blendSrc="GL_ONE",this.blendDest="GL_ZERO",this.hasBlendFunc=!1,this.tcMods=[],this.depthFunc="lequal",this.depthWrite=!0,this.isLightmap=!1},qt={BAD:0,BRUSH:1,Md3:2},Rt=function(){this.type=qt.BAD,this.name=null,this.index=0,this.bmodel=null,this.md3=new Array($t),this.numLods=0},Ut=function(){this.parent=null,this.plane=null,this.children=[null,null],this.mins=[0,0,0],this.maxs=[0,0,0]},zt=function(){this.parent=null,this.cluster=0,this.area=0,this.mins=[0,0,0],this.maxs=[0,0,0],this.firstLeafSurface=0,this.numLeafSurfaces=0,this.firstLeafBrush=0,this.numLeafBrushes=0},Wt=function(){this.bounds=[[0,0,0],[0,0,0]],this.firstSurface=0,this.numSurfaces=0},Xt=("3".charCodeAt()<<24)+("P".charCodeAt()<<16)+("D".charCodeAt()<<8)+"I".charCodeAt(),Vt=15,$t=3,Jt=8192,Kt=4096,Qt=256,Gt=1024,Yt=32,Zt=16,en=1/64,tn=function(){this.name=null,this.flags=0,this.frames=null,this.tags=null,this.surfaces=null,this.skins=null},nn=function(){this.ident=0,this.version=0,this.name=null,this.flags=0,this.numFrames=0,this.numTags=0,this.numSurfaces=0,this.numSkins=0,this.ofsFrames=0,this.ofsTags=0,this.ofsSurfaces=0,this.ofsEnd=0},rn=function(){this.ident=0,this.name=null,this.flags=0,this.numFrames=0,this.numShaders=0,this.numVerts=0,this.numTriangles=0,this.ofsTriangles=0,this.ofsShaders=0,this.ofsSt=0,this.ofsXyzNormals=0,this.ofsEnd=0},sn=function(){this.name=null,this.shader=0},on=function(){this.indexes=[0,0,0]},un=function(){this.st=[0,0]},an=function(){this.xyz=[0,0,0],this.normal=[0,0,0]},fn=function(){this.bounds=[[0,0,0],[0,0,0]],this.localOrigin=[0,0,0],this.radius=0,this.name=null},ln=function(){this.name=null,this.origin=[0,0,0],this.axis=[[0,0,0],[0,0,0],[0,0,0]]},cn,hn,pn,dn,vn,mn,gn,yn,bn,wn,En=mat4.create([0,0,-1,0,-1,0,0,0,0,1,0,0,0,0,0,1]),Pn,Hn={};Hn[Lt.BAD]=Ur,Hn[Lt.FACE]=Ur,Hn[Lt.GRID]=Ur,Hn[Lt.BBOX]=Vr,Hn[Lt.MD3]=zr;var Gn=129,nr={},jr=function(){this.attrib={},this.varying={},this.uniform={},this.functions={},this.statements=[]};jr.prototype.addAttribs=function(e){for(var t in e)this.attrib[t]="attribute "+e[t]+" "+t+";"},jr.prototype.addVaryings=function(e){for(var t in e)this.varying[t]="varying "+e[t]+" "+t+";"},jr.prototype.addUniforms=function(e){for(var t in e)this.uniform[t]="uniform "+e[t]+" "+t+";"},jr.prototype.addFunction=function(e,t){this.functions[e]=t.join("\n")},jr.prototype.addLines=function(e){for(var t=0;t<e.length;++t)this.statements.push(e[t])},jr.prototype.getSource=function(){var e="	#ifdef GL_ES \n	precision highp float; \n	#endif \n";for(var t in this.attrib)e+=this.attrib[t]+"\n";for(var t in this.varying)e+=this.varying[t]+"\n";for(var t in this.uniform)e+=this.uniform[t]+"\n";for(var t in this.functions)e+=this.functions[t]+"\n";return e+="void main(void) {\n	",e+=this.statements.join("\n	"),e+="\n}\n",e},jr.prototype.addWaveform=function(e,t,n){if(!t){this.statements.push("float "+e+" = 0.0;");return}n||(n="time"),typeof t.phase=="number"&&(t.phase=t.phase.toFixed(4));switch(t.funcName){case"sin":this.statements.push("float "+e+" = "+t.base.toFixed(4)+" + sin(("+t.phase+" + "+n+" * "+t.freq.toFixed(4)+") * 6.283) * "+t.amp.toFixed(4)+";");return;case"square":funcName="square",this.addSquareFunc();break;case"triangle":funcName="triangle",this.addTriangleFunc();break;case"sawtooth":funcName="fract";break;case"inversesawtooth":funcName="1.0 - fract";break;default:this.statements.push("float "+e+" = 0.0;");return}this.statements.push("float "+e+" = "+t.base.toFixed(4)+" + "+funcName+"("+t.phase+" + "+n+" * "+t.freq.toFixed(4)+") * "+t.amp.toFixed(4)+";")},jr.prototype.addSquareFunc=function(){this.addFunction("square",["float square(float val) {","   return (mod(floor(val*2.0)+1.0, 2.0) * 2.0) - 1.0;","}"])},jr.prototype.addTriangleFunc=function(){this.addFunction("triangle",["float triangle(float val) {","   return abs(2.0 * fract(val) - 1.0);","}"])};var Fr=function(e){e=e.replace(/\/\/.*$/mg,""),e=e.replace(/\/\*[^*\/]*\*\//mg,""),this.tokens=e.match(/[^\s\n\r\"]+/mg),this.offset=0};Fr.prototype.EOF=function(){if(this.tokens===null)return!0;var e=this.tokens[this.offset];while(e===""&&this.offset<this.tokens.length)this.offset++,e=this.tokens[this.offset];return this.offset>=this.tokens.length},Fr.prototype.next=function(){if(this.tokens===null)return;var e="";while(e===""&&this.offset<this.tokens.length)e=this.tokens[this.offset++];return e},Fr.prototype.prev=function(){if(this.tokens===null)return;var e="";while(e===""&&this.offset>=0)e=this.tokens[this.offset--];return e};var Wr=[-15,-15,15,15,-15,15,15,15,15,-15,15,15,-15,-15,-15,-15,15,-15,15,15,-15,15,-15,-15,-15,15,-15,-15,15,15,15,15,15,15,15,-15,-15,-15,-15,15,-15,-15,15,-15,15,-15,-15,15,15,-15,-15,15,15,-15,15,15,15,15,-15,15,-15,-15,-15,-15,-15,15,-15,15,15,-15,15,-15],Xr=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23],$r=20,Jr=mat4.create(),Kr=null,Qr=null,Gr,Yr=null;return{Init:Sn,Shutdown:xn,LoadMap:In,RenderScene:dr,AddRefEntityToScene:vr,RegisterModel:cr}}),function(e,t){function _(e){var t=M[e]={};return v.each(e.split(y),function(e,n){t[n]=!0}),t}function H(e,n,r){if(r===t&&e.nodeType===1){var i="data-"+n.replace(P,"-$1").toLowerCase();r=e.getAttribute(i);if(typeof r=="string"){try{r=r==="true"?!0:r==="false"?!1:r==="null"?null:+r+""===r?+r:D.test(r)?v.parseJSON(r):r}catch(s){}v.data(e,n,r)}else r=t}return r}function B(e){var t;for(t in e){if(t==="data"&&v.isEmptyObject(e[t]))continue;if(t!=="toJSON")return!1}return!0}function et(){return!1}function tt(){return!0}function ut(e){return!e||!e.parentNode||e.parentNode.nodeType===11}function at(e,t){do e=e[t];while(e&&e.nodeType!==1);return e}function ft(e,t,n){t=t||0;if(v.isFunction(t))return v.grep(e,function(e,r){var i=!!t.call(e,r,e);return i===n});if(t.nodeType)return v.grep(e,function(e,r){return e===t===n});if(typeof t=="string"){var r=v.grep(e,function(e){return e.nodeType===1});if(it.test(t))return v.filter(t,r,!n);t=v.filter(t,r)}return v.grep(e,function(e,r){return v.inArray(e,t)>=0===n})}function lt(e){var t=ct.split("|"),n=e.createDocumentFragment();if(n.createElement)while(t.length)n.createElement(t.pop());return n}function Lt(e,t){return e.getElementsByTagName(t)[0]||e.appendChild(e.ownerDocument.createElement(t))}function At(e,t){if(t.nodeType!==1||!v.hasData(e))return;var n,r,i,s=v._data(e),o=v._data(t,s),u=s.events;if(u){delete o.handle,o.events={};for(n in u)for(r=0,i=u[n].length;r<i;r++)v.event.add(t,n,u[n][r])}o.data&&(o.data=v.extend({},o.data))}function Ot(e,t){var n;if(t.nodeType!==1)return;t.clearAttributes&&t.clearAttributes(),t.mergeAttributes&&t.mergeAttributes(e),n=t.nodeName.toLowerCase(),n==="object"?(t.parentNode&&(t.outerHTML=e.outerHTML),v.support.html5Clone&&e.innerHTML&&!v.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):n==="input"&&Et.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):n==="option"?t.selected=e.defaultSelected:n==="input"||n==="textarea"?t.defaultValue=e.defaultValue:n==="script"&&t.text!==e.text&&(t.text=e.text),t.removeAttribute(v.expando)}function Mt(e){return typeof e.getElementsByTagName!="undefined"?e.getElementsByTagName("*"):typeof e.querySelectorAll!="undefined"?e.querySelectorAll("*"):[]}function _t(e){Et.test(e.type)&&(e.defaultChecked=e.checked)}function Qt(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=Jt.length;while(i--){t=Jt[i]+n;if(t in e)return t}return r}function Gt(e,t){return e=t||e,v.css(e,"display")==="none"||!v.contains(e.ownerDocument,e)}function Yt(e,t){var n,r,i=[],s=0,o=e.length;for(;s<o;s++){n=e[s];if(!n.style)continue;i[s]=v._data(n,"olddisplay"),t?(!i[s]&&n.style.display==="none"&&(n.style.display=""),n.style.display===""&&Gt(n)&&(i[s]=v._data(n,"olddisplay",nn(n.nodeName)))):(r=Dt(n,"display"),!i[s]&&r!=="none"&&v._data(n,"olddisplay",r))}for(s=0;s<o;s++){n=e[s];if(!n.style)continue;if(!t||n.style.display==="none"||n.style.display==="")n.style.display=t?i[s]||"":"none"}return e}function Zt(e,t,n){var r=Rt.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function en(e,t,n,r){var i=n===(r?"border":"content")?4:t==="width"?1:0,s=0;for(;i<4;i+=2)n==="margin"&&(s+=v.css(e,n+$t[i],!0)),r?(n==="content"&&(s-=parseFloat(Dt(e,"padding"+$t[i]))||0),n!=="margin"&&(s-=parseFloat(Dt(e,"border"+$t[i]+"Width"))||0)):(s+=parseFloat(Dt(e,"padding"+$t[i]))||0,n!=="padding"&&(s+=parseFloat(Dt(e,"border"+$t[i]+"Width"))||0));return s}function tn(e,t,n){var r=t==="width"?e.offsetWidth:e.offsetHeight,i=!0,s=v.support.boxSizing&&v.css(e,"boxSizing")==="border-box";if(r<=0||r==null){r=Dt(e,t);if(r<0||r==null)r=e.style[t];if(Ut.test(r))return r;i=s&&(v.support.boxSizingReliable||r===e.style[t]),r=parseFloat(r)||0}return r+en(e,t,n||(s?"border":"content"),i)+"px"}function nn(e){if(Wt[e])return Wt[e];var t=v("<"+e+">").appendTo(i.body),n=t.css("display");t.remove();if(n==="none"||n===""){Pt=i.body.appendChild(Pt||v.extend(i.createElement("iframe"),{frameBorder:0,width:0,height:0}));if(!Ht||!Pt.createElement)Ht=(Pt.contentWindow||Pt.contentDocument).document,Ht.write("<!doctype html><html><body>"),Ht.close();t=Ht.body.appendChild(Ht.createElement(e)),n=Dt(t,"display"),i.body.removeChild(Pt)}return Wt[e]=n,n}function fn(e,t,n,r){var i;if(v.isArray(t))v.each(t,function(t,i){n||sn.test(e)?r(e,i):fn(e+"["+(typeof i=="object"?t:"")+"]",i,n,r)});else if(!n&&v.type(t)==="object")for(i in t)fn(e+"["+i+"]",t[i],n,r);else r(e,t)}function Cn(e){return function(t,n){typeof t!="string"&&(n=t,t="*");var r,i,s,o=t.toLowerCase().split(y),u=0,a=o.length;if(v.isFunction(n))for(;u<a;u++)r=o[u],s=/^\+/.test(r),s&&(r=r.substr(1)||"*"),i=e[r]=e[r]||[],i[s?"unshift":"push"](n)}}function kn(e,n,r,i,s,o){s=s||n.dataTypes[0],o=o||{},o[s]=!0;var u,a=e[s],f=0,l=a?a.length:0,c=e===Sn;for(;f<l&&(c||!u);f++)u=a[f](n,r,i),typeof u=="string"&&(!c||o[u]?u=t:(n.dataTypes.unshift(u),u=kn(e,n,r,i,u,o)));return(c||!u)&&!o["*"]&&(u=kn(e,n,r,i,"*",o)),u}function Ln(e,n){var r,i,s=v.ajaxSettings.flatOptions||{};for(r in n)n[r]!==t&&((s[r]?e:i||(i={}))[r]=n[r]);i&&v.extend(!0,e,i)}function An(e,n,r){var i,s,o,u,a=e.contents,f=e.dataTypes,l=e.responseFields;for(s in l)s in r&&(n[l[s]]=r[s]);while(f[0]==="*")f.shift(),i===t&&(i=e.mimeType||n.getResponseHeader("content-type"));if(i)for(s in a)if(a[s]&&a[s].test(i)){f.unshift(s);break}if(f[0]in r)o=f[0];else{for(s in r){if(!f[0]||e.converters[s+" "+f[0]]){o=s;break}u||(u=s)}o=o||u}if(o)return o!==f[0]&&f.unshift(o),r[o]}function On(e,t){var n,r,i,s,o=e.dataTypes.slice(),u=o[0],a={},f=0;e.dataFilter&&(t=e.dataFilter(t,e.dataType));if(o[1])for(n in e.converters)a[n.toLowerCase()]=e.converters[n];for(;i=o[++f];)if(i!=="*"){if(u!=="*"&&u!==i){n=a[u+" "+i]||a["* "+i];if(!n)for(r in a){s=r.split(" ");if(s[1]===i){n=a[u+" "+s[0]]||a["* "+s[0]];if(n){n===!0?n=a[r]:a[r]!==!0&&(i=s[0],o.splice(f--,0,i));break}}}if(n!==!0)if(n&&e["throws"])t=n(t);else try{t=n(t)}catch(l){return{state:"parsererror",error:n?l:"No conversion from "+u+" to "+i}}}u=i}return{state:"success",data:t}}function Fn(){try{return new e.XMLHttpRequest}catch(t){}}function In(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function $n(){return setTimeout(function(){qn=t},0),qn=v.now()}function Jn(e,t){v.each(t,function(t,n){var r=(Vn[t]||[]).concat(Vn["*"]),i=0,s=r.length;for(;i<s;i++)if(r[i].call(e,t,n))return})}function Kn(e,t,n){var r,i=0,s=0,o=Xn.length,u=v.Deferred().always(function(){delete a.elem}),a=function(){var t=qn||$n(),n=Math.max(0,f.startTime+f.duration-t),r=1-(n/f.duration||0),i=0,s=f.tweens.length;for(;i<s;i++)f.tweens[i].run(r);return u.notifyWith(e,[f,r,n]),r<1&&s?n:(u.resolveWith(e,[f]),!1)},f=u.promise({elem:e,props:v.extend({},t),opts:v.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:qn||$n(),duration:n.duration,tweens:[],createTween:function(t,n,r){var i=v.Tween(e,f.opts,t,n,f.opts.specialEasing[t]||f.opts.easing);return f.tweens.push(i),i},stop:function(t){var n=0,r=t?f.tweens.length:0;for(;n<r;n++)f.tweens[n].run(1);return t?u.resolveWith(e,[f,t]):u.rejectWith(e,[f,t]),this}}),l=f.props;Qn(l,f.opts.specialEasing);for(;i<o;i++){r=Xn[i].call(f,e,l,f.opts);if(r)return r}return Jn(f,l),v.isFunction(f.opts.start)&&f.opts.start.call(e,f),v.fx.timer(v.extend(a,{anim:f,queue:f.opts.queue,elem:e})),f.progress(f.opts.progress).done(f.opts.done,f.opts.complete).fail(f.opts.fail).always(f.opts.always)}function Qn(e,t){var n,r,i,s,o;for(n in e){r=v.camelCase(n),i=t[r],s=e[n],v.isArray(s)&&(i=s[1],s=e[n]=s[0]),n!==r&&(e[r]=s,delete e[n]),o=v.cssHooks[r];if(o&&"expand"in o){s=o.expand(s),delete e[r];for(n in s)n in e||(e[n]=s[n],t[n]=i)}else t[r]=i}}function Gn(e,t,n){var r,i,s,o,u,a,f,l,c=this,h=e.style,p={},d=[],m=e.nodeType&&Gt(e);n.queue||(f=v._queueHooks(e,"fx"),f.unqueued==null&&(f.unqueued=0,l=f.empty.fire,f.empty.fire=function(){f.unqueued||l()}),f.unqueued++,c.always(function(){c.always(function(){f.unqueued--,v.queue(e,"fx").length||f.empty.fire()})})),e.nodeType===1&&("height"in t||"width"in t)&&(n.overflow=[h.overflow,h.overflowX,h.overflowY],v.css(e,"display")==="inline"&&v.css(e,"float")==="none"&&(!v.support.inlineBlockNeedsLayout||nn(e.nodeName)==="inline"?h.display="inline-block":h.zoom=1)),n.overflow&&(h.overflow="hidden",v.support.shrinkWrapBlocks||c.done(function(){h.overflow=n.overflow[0],h.overflowX=n.overflow[1],h.overflowY=n.overflow[2]}));for(r in t){s=t[r];if(Un.exec(s)){delete t[r];if(s===(m?"hide":"show"))continue;d.push(r)}}o=d.length;if(o){u=v._data(e,"fxshow")||v._data(e,"fxshow",{}),m?v(e).show():c.done(function(){v(e).hide()}),c.done(function(){var t;v.removeData(e,"fxshow",!0);for(t in p)v.style(e,t,p[t])});for(r=0;r<o;r++)i=d[r],a=c.createTween(i,m?u[i]:0),p[i]=u[i]||v.style(e,i),i in u||(u[i]=a.start,m&&(a.end=a.start,a.start=i==="width"||i==="height"?1:0))}}function Yn(e,t,n,r,i){return new Yn.prototype.init(e,t,n,r,i)}function Zn(e,t){var n,r={height:e},i=0;t=t?1:0;for(;i<4;i+=2-t)n=$t[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function tr(e){return v.isWindow(e)?e:e.nodeType===9?e.defaultView||e.parentWindow:!1}var n,r,i=e.document,s=e.location,o=e.navigator,u=e.jQuery,a=e.$,f=Array.prototype.push,l=Array.prototype.slice,c=Array.prototype.indexOf,h=Object.prototype.toString,p=Object.prototype.hasOwnProperty,d=String.prototype.trim,v=function(e,t){return new v.fn.init(e,t,n)},m=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,g=/\S/,y=/\s+/,b=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,w=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,E=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,S=/^[\],:{}\s]*$/,x=/(?:^|:|,)(?:\s*\[)+/g,T=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,N=/"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g,C=/^-ms-/,k=/-([\da-z])/gi,L=function(e,t){return(t+"").toUpperCase()},A=function(){i.addEventListener?(i.removeEventListener("DOMContentLoaded",A,!1),v.ready()):i.readyState==="complete"&&(i.detachEvent("onreadystatechange",A),v.ready())},O={};v.fn=v.prototype={constructor:v,init:function(e,n,r){var s,o,u,a;if(!e)return this;if(e.nodeType)return this.context=this[0]=e,this.length=1,this;if(typeof e=="string"){e.charAt(0)==="<"&&e.charAt(e.length-1)===">"&&e.length>=3?s=[null,e,null]:s=w.exec(e);if(s&&(s[1]||!n)){if(s[1])return n=n instanceof v?n[0]:n,a=n&&n.nodeType?n.ownerDocument||n:i,e=v.parseHTML(s[1],a,!0),E.test(s[1])&&v.isPlainObject(n)&&this.attr.call(e,n,!0),v.merge(this,e);o=i.getElementById(s[2]);if(o&&o.parentNode){if(o.id!==s[2])return r.find(e);this.length=1,this[0]=o}return this.context=i,this.selector=e,this}return!n||n.jquery?(n||r).find(e):this.constructor(n).find(e)}return v.isFunction(e)?r.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),v.makeArray(e,this))},selector:"",jquery:"1.8.2",length:0,size:function(){return this.length},toArray:function(){return l.call(this)},get:function(e){return e==null?this.toArray():e<0?this[this.length+e]:this[e]},pushStack:function(e,t,n){var r=v.merge(this.constructor(),e);return r.prevObject=this,r.context=this.context,t==="find"?r.selector=this.selector+(this.selector?" ":"")+n:t&&(r.selector=this.selector+"."+t+"("+n+")"),r},each:function(e,t){return v.each(this,e,t)},ready:function(e){return v.ready.promise().done(e),this},eq:function(e){return e=+e,e===-1?this.slice(e):this.slice(e,e+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(l.apply(this,arguments),"slice",l.call(arguments).join(","))},map:function(e){return this.pushStack(v.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:f,sort:[].sort,splice:[].splice},v.fn.init.prototype=v.fn,v.extend=v.fn.extend=function(){var e,n,r,i,s,o,u=arguments[0]||{},a=1,f=arguments.length,l=!1;typeof u=="boolean"&&(l=u,u=arguments[1]||{},a=2),typeof u!="object"&&!v.isFunction(u)&&(u={}),f===a&&(u=this,--a);for(;a<f;a++)if((e=arguments[a])!=null)for(n in e){r=u[n],i=e[n];if(u===i)continue;l&&i&&(v.isPlainObject(i)||(s=v.isArray(i)))?(s?(s=!1,o=r&&v.isArray(r)?r:[]):o=r&&v.isPlainObject(r)?r:{},u[n]=v.extend(l,o,i)):i!==t&&(u[n]=i)}return u},v.extend({noConflict:function(t){return e.$===v&&(e.$=a),t&&e.jQuery===v&&(e.jQuery=u),v},isReady:!1,readyWait:1,holdReady:function(e){e?v.readyWait++:v.ready(!0)},ready:function(e){if(e===!0?--v.readyWait:v.isReady)return;if(!i.body)return setTimeout(v.ready,1);v.isReady=!0;if(e!==!0&&--v.readyWait>0)return;r.resolveWith(i,[v]),v.fn.trigger&&v(i).trigger("ready").off("ready")},isFunction:function(e){return v.type(e)==="function"},isArray:Array.isArray||function(e){return v.type(e)==="array"},isWindow:function(e){return e!=null&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return e==null?String(e):O[h.call(e)]||"object"},isPlainObject:function(e){if(!e||v.type(e)!=="object"||e.nodeType||v.isWindow(e))return!1;try{if(e.constructor&&!p.call(e,"constructor")&&!p.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(n){return!1}var r;for(r in e);return r===t||p.call(e,r)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw new Error(e)},parseHTML:function(e,t,n){var r;return!e||typeof e!="string"?null:(typeof t=="boolean"&&(n=t,t=0),t=t||i,(r=E.exec(e))?[t.createElement(r[1])]:(r=v.buildFragment([e],t,n?null:[]),v.merge([],(r.cacheable?v.clone(r.fragment):r.fragment).childNodes)))},parseJSON:function(t){if(!t||typeof t!="string")return null;t=v.trim(t);if(e.JSON&&e.JSON.parse)return e.JSON.parse(t);if(S.test(t.replace(T,"@").replace(N,"]").replace(x,"")))return(new Function("return "+t))();v.error("Invalid JSON: "+t)},parseXML:function(n){var r,i;if(!n||typeof n!="string")return null;try{e.DOMParser?(i=new DOMParser,r=i.parseFromString(n,"text/xml")):(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(n))}catch(s){r=t}return(!r||!r.documentElement||r.getElementsByTagName("parsererror").length)&&v.error("Invalid XML: "+n),r},noop:function(){},globalEval:function(t){t&&g.test(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(C,"ms-").replace(k,L)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,n,r){var i,s=0,o=e.length,u=o===t||v.isFunction(e);if(r){if(u){for(i in e)if(n.apply(e[i],r)===!1)break}else for(;s<o;)if(n.apply(e[s++],r)===!1)break}else if(u){for(i in e)if(n.call(e[i],i,e[i])===!1)break}else for(;s<o;)if(n.call(e[s],s,e[s++])===!1)break;return e},trim:d&&!d.call("ï»¿Â ")?function(e){return e==null?"":d.call(e)}:function(e){return e==null?"":(e+"").replace(b,"")},makeArray:function(e,t){var n,r=t||[];return e!=null&&(n=v.type(e),e.length==null||n==="string"||n==="function"||n==="regexp"||v.isWindow(e)?f.call(r,e):v.merge(r,e)),r},inArray:function(e,t,n){var r;if(t){if(c)return c.call(t,e,n);r=t.length,n=n?n<0?Math.max(0,r+n):n:0;for(;n<r;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,n){var r=n.length,i=e.length,s=0;if(typeof r=="number")for(;s<r;s++)e[i++]=n[s];else while(n[s]!==t)e[i++]=n[s++];return e.length=i,e},grep:function(e,t,n){var r,i=[],s=0,o=e.length;n=!!n;for(;s<o;s++)r=!!t(e[s],s),n!==r&&i.push(e[s]);return i},map:function(e,n,r){var i,s,o=[],u=0,a=e.length,f=e instanceof v||a!==t&&typeof a=="number"&&(a>0&&e[0]&&e[a-1]||a===0||v.isArray(e));if(f)for(;u<a;u++)i=n(e[u],u,r),i!=null&&(o[o.length]=i);else for(s in e)i=n(e[s],s,r),i!=null&&(o[o.length]=i);return o.concat.apply([],o)},guid:1,proxy:function(e,n){var r,i,s;return typeof n=="string"&&(r=e[n],n=e,e=r),v.isFunction(e)?(i=l.call(arguments,2),s=function(){return e.apply(n,i.concat(l.call(arguments)))},s.guid=e.guid=e.guid||v.guid++,s):t},access:function(e,n,r,i,s,o,u){var a,f=r==null,l=0,c=e.length;if(r&&typeof r=="object"){for(l in r)v.access(e,n,l,r[l],1,o,i);s=1}else if(i!==t){a=u===t&&v.isFunction(i),f&&(a?(a=n,n=function(e,t,n){return a.call(v(e),n)}):(n.call(e,i),n=null));if(n)for(;l<c;l++)n(e[l],r,a?i.call(e[l],l,n(e[l],r)):i,u);s=1}return s?e:f?n.call(e):c?n(e[0],r):o},now:function(){return(new Date).getTime()}}),v.ready.promise=function(t){if(!r){r=v.Deferred();if(i.readyState==="complete")setTimeout(v.ready,1);else if(i.addEventListener)i.addEventListener("DOMContentLoaded",A,!1),e.addEventListener("load",v.ready,!1);else{i.attachEvent("onreadystatechange",A),e.attachEvent("onload",v.ready);var n=!1;try{n=e.frameElement==null&&i.documentElement}catch(s){}n&&n.doScroll&&function o(){if(!v.isReady){try{n.doScroll("left")}catch(e){return setTimeout(o,50)}v.ready()}}()}}return r.promise(t)},v.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(e,t){O["[object "+t+"]"]=t.toLowerCase()}),n=v(i);var M={};v.Callbacks=function(e){e=typeof e=="string"?M[e]||_(e):v.extend({},e);var n,r,i,s,o,u,a=[],f=!e.once&&[],l=function(t){n=e.memory&&t,r=!0,u=s||0,s=0,o=a.length,i=!0;for(;a&&u<o;u++)if(a[u].apply(t[0],t[1])===!1&&e.stopOnFalse){n=!1;break}i=!1,a&&(f?f.length&&l(f.shift()):n?a=[]:c.disable())},c={add:function(){if(a){var t=a.length;(function r(t){v.each(t,function(t,n){var i=v.type(n);i==="function"&&(!e.unique||!c.has(n))?a.push(n):n&&n.length&&i!=="string"&&r(n)})})(arguments),i?o=a.length:n&&(s=t,l(n))}return this},remove:function(){return a&&v.each(arguments,function(e,t){var n;while((n=v.inArray(t,a,n))>-1)a.splice(n,1),i&&(n<=o&&o--,n<=u&&u--)}),this},has:function(e){return v.inArray(e,a)>-1},empty:function(){return a=[],this},disable:function(){return a=f=n=t,this},disabled:function(){return!a},lock:function(){return f=t,n||c.disable(),this},locked:function(){return!f},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],a&&(!r||f)&&(i?f.push(t):l(t)),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!r}};return c},v.extend({Deferred:function(e){var t=[["resolve","done",v.Callbacks("once memory"),"resolved"],["reject","fail",v.Callbacks("once memory"),"rejected"],["notify","progress",v.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return v.Deferred(function(n){v.each(t,function(t,r){var s=r[0],o=e[t];i[r[1]](v.isFunction(o)?function(){var e=o.apply(this,arguments);e&&v.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[s+"With"](this===i?n:this,[e])}:n[s])}),e=null}).promise()},promise:function(e){return e!=null?v.extend(e,r):r}},i={};return r.pipe=r.then,v.each(t,function(e,s){var o=s[2],u=s[3];r[s[1]]=o.add,u&&o.add(function(){n=u},t[e^1][2].disable,t[2][2].lock),i[s[0]]=o.fire,i[s[0]+"With"]=o.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=l.call(arguments),r=n.length,i=r!==1||e&&v.isFunction(e.promise)?r:0,s=i===1?e:v.Deferred(),o=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?l.call(arguments):r,n===u?s.notifyWith(t,n):--i||s.resolveWith(t,n)}},u,a,f;if(r>1){u=new Array(r),a=new Array(r),f=new Array(r);for(;t<r;t++)n[t]&&v.isFunction(n[t].promise)?n[t].promise().done(o(t,f,n)).fail(s.reject).progress(o(t,a,u)):--i}return i||s.resolveWith(f,n),s.promise()}}),v.support=function(){var t,n,r,s,o,u,a,f,l,c,h,p=i.createElement("div");p.setAttribute("className","t"),p.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",n=p.getElementsByTagName("*"),r=p.getElementsByTagName("a")[0],r.style.cssText="top:1px;float:left;opacity:.5";if(!n||!n.length)return{};s=i.createElement("select"),o=s.appendChild(i.createElement("option")),u=p.getElementsByTagName("input")[0],t={leadingWhitespace:p.firstChild.nodeType===3,tbody:!p.getElementsByTagName("tbody").length,htmlSerialize:!!p.getElementsByTagName("link").length,style:/top/.test(r.getAttribute("style")),hrefNormalized:r.getAttribute("href")==="/a",opacity:/^0.5/.test(r.style.opacity),cssFloat:!!r.style.cssFloat,checkOn:u.value==="on",optSelected:o.selected,getSetAttribute:p.className!=="t",enctype:!!i.createElement("form").enctype,html5Clone:i.createElement("nav").cloneNode(!0).outerHTML!=="<:nav></:nav>",boxModel:i.compatMode==="CSS1Compat",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},u.checked=!0,t.noCloneChecked=u.cloneNode(!0).checked,s.disabled=!0,t.optDisabled=!o.disabled;try{delete p.test}catch(d){t.deleteExpando=!1}!p.addEventListener&&p.attachEvent&&p.fireEvent&&(p.attachEvent("onclick",h=function(){t.noCloneEvent=!1}),p.cloneNode(!0).fireEvent("onclick"),p.detachEvent("onclick",h)),u=i.createElement("input"),u.value="t",u.setAttribute("type","radio"),t.radioValue=u.value==="t",u.setAttribute("checked","checked"),u.setAttribute("name","t"),p.appendChild(u),a=i.createDocumentFragment(),a.appendChild(p.lastChild),t.checkClone=a.cloneNode(!0).cloneNode(!0).lastChild.checked,t.appendChecked=u.checked,a.removeChild(u),a.appendChild(p);if(p.attachEvent)for(l in{submit:!0,change:!0,focusin:!0})f="on"+l,c=f in p,c||(p.setAttribute(f,"return;"),c=typeof p[f]=="function"),t[l+"Bubbles"]=c;return v(function(){var n,r,s,o,u="padding:0;margin:0;border:0;display:block;overflow:hidden;",a=i.getElementsByTagName("body")[0];if(!a)return;n=i.createElement("div"),n.style.cssText="visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px",a.insertBefore(n,a.firstChild),r=i.createElement("div"),n.appendChild(r),r.innerHTML="<table><tr><td></td><td>t</td></tr></table>",s=r.getElementsByTagName("td"),s[0].style.cssText="padding:0;margin:0;border:0;display:none",c=s[0].offsetHeight===0,s[0].style.display="",s[1].style.display="none",t.reliableHiddenOffsets=c&&s[0].offsetHeight===0,r.innerHTML="",r.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",t.boxSizing=r.offsetWidth===4,t.doesNotIncludeMarginInBodyOffset=a.offsetTop!==1,e.getComputedStyle&&(t.pixelPosition=(e.getComputedStyle(r,null)||{}).top!=="1%",t.boxSizingReliable=(e.getComputedStyle(r,null)||{width:"4px"}).width==="4px",o=i.createElement("div"),o.style.cssText=r.style.cssText=u,o.style.marginRight=o.style.width="0",r.style.width="1px",r.appendChild(o),t.reliableMarginRight=!parseFloat((e.getComputedStyle(o,null)||{}).marginRight)),typeof r.style.zoom!="undefined"&&(r.innerHTML="",r.style.cssText=u+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=r.offsetWidth===3,r.style.display="block",r.style.overflow="visible",r.innerHTML="<div></div>",r.firstChild.style.width="5px",t.shrinkWrapBlocks=r.offsetWidth!==3,n.style.zoom=1),a.removeChild(n),n=r=s=o=null}),a.removeChild(p),n=r=s=o=u=a=p=null,t}();var D=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,P=/([A-Z])/g;v.extend({cache:{},deletedIds:[],uuid:0,expando:"jQuery"+(v.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(e){return e=e.nodeType?v.cache[e[v.expando]]:e[v.expando],!!e&&!B(e)},data:function(e,n,r,i){if(!v.acceptData(e))return;var s,o,u=v.expando,a=typeof n=="string",f=e.nodeType,l=f?v.cache:e,c=f?e[u]:e[u]&&u;if((!c||!l[c]||!i&&!l[c].data)&&a&&r===t)return;c||(f?e[u]=c=v.deletedIds.pop()||v.guid++:c=u),l[c]||(l[c]={},f||(l[c].toJSON=v.noop));if(typeof n=="object"||typeof n=="function")i?l[c]=v.extend(l[c],n):l[c].data=v.extend(l[c].data,n);return s=l[c],i||(s.data||(s.data={}),s=s.data),r!==t&&(s[v.camelCase(n)]=r),a?(o=s[n],o==null&&(o=s[v.camelCase(n)])):o=s,o},removeData:function(e,t,n){if(!v.acceptData(e))return;var r,i,s,o=e.nodeType,u=o?v.cache:e,a=o?e[v.expando]:v.expando;if(!u[a])return;if(t){r=n?u[a]:u[a].data;if(r){v.isArray(t)||(t in r?t=[t]:(t=v.camelCase(t),t in r?t=[t]:t=t.split(" ")));for(i=0,s=t.length;i<s;i++)delete r[t[i]];if(!(n?B:v.isEmptyObject)(r))return}}if(!n){delete u[a].data;if(!B(u[a]))return}o?v.cleanData([e],!0):v.support.deleteExpando||u!=u.window?delete u[a]:u[a]=null},_data:function(e,t,n){return v.data(e,t,n,!0)},acceptData:function(e){var t=e.nodeName&&v.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),v.fn.extend({data:function(e,n){var r,i,s,o,u,a=this[0],f=0,l=null;if(e===t){if(this.length){l=v.data(a);if(a.nodeType===1&&!v._data(a,"parsedAttrs")){s=a.attributes;for(u=s.length;f<u;f++)o=s[f].name,o.indexOf("data-")||(o=v.camelCase(o.substring(5)),H(a,o,l[o]));v._data(a,"parsedAttrs",!0)}}return l}return typeof e=="object"?this.each(function(){v.data(this,e)}):(r=e.split(".",2),r[1]=r[1]?"."+r[1]:"",i=r[1]+"!",v.access(this,function(n){if(n===t)return l=this.triggerHandler("getData"+i,[r[0]]),l===t&&a&&(l=v.data(a,e),l=H(a,e,l)),l===t&&r[1]?this.data(r[0]):l;r[1]=n,this.each(function(){var t=v(this);t.triggerHandler("setData"+i,r),v.data(this,e,n),t.triggerHandler("changeData"+i,r)})},null,n,arguments.length>1,null,!1))},removeData:function(e){return this.each(function(){v.removeData(this,e)})}}),v.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=v._data(e,t),n&&(!r||v.isArray(n)?r=v._data(e,t,v.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=v.queue(e,t),r=n.length,i=n.shift(),s=v._queueHooks(e,t),o=function(){v.dequeue(e,t)};i==="inprogress"&&(i=n.shift(),r--),i&&(t==="fx"&&n.unshift("inprogress"),delete s.stop,i.call(e,o,s)),!r&&s&&s.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return v._data(e,n)||v._data(e,n,{empty:v.Callbacks("once memory").add(function(){v.removeData(e,t+"queue",!0),v.removeData(e,n,!0)})})}}),v.fn.extend({queue:function(e,n){var r=2;return typeof e!="string"&&(n=e,e="fx",r--),arguments.length<r?v.queue(this[0],e):n===t?this:this.each(function(){var t=v.queue(this,e,n);v._queueHooks(this,e),e==="fx"&&t[0]!=="inprogress"&&v.dequeue(this,e)})},dequeue:function(e){return this.each(function(){v.dequeue(this,e)})},delay:function(e,t){return e=v.fx?v.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){var r,i=1,s=v.Deferred(),o=this,u=this.length,a=function(){--i||s.resolveWith(o,[o])};typeof e!="string"&&(n=e,e=t),e=e||"fx";while(u--)r=v._data(o[u],e+"queueHooks"),r&&r.empty&&(i++,r.empty.add(a));return a(),s.promise(n)}});var j,F,I,q=/[\t\r\n]/g,R=/\r/g,U=/^(?:button|input)$/i,z=/^(?:button|input|object|select|textarea)$/i,W=/^a(?:rea|)$/i,X=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,V=v.support.getSetAttribute;v.fn.extend({attr:function(e,t){return v.access(this,v.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){v.removeAttr(this,e)})},prop:function(e,t){return v.access(this,v.prop,e,t,arguments.length>1)},removeProp:function(e){return e=v.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(n){}})},addClass:function(e){var t,n,r,i,s,o,u;if(v.isFunction(e))return this.each(function(t){v(this).addClass(e.call(this,t,this.className))});if(e&&typeof e=="string"){t=e.split(y);for(n=0,r=this.length;n<r;n++){i=this[n];if(i.nodeType===1)if(!i.className&&t.length===1)i.className=e;else{s=" "+i.className+" ";for(o=0,u=t.length;o<u;o++)s.indexOf(" "+t[o]+" ")<0&&(s+=t[o]+" ");i.className=v.trim(s)}}}return this},removeClass:function(e){var n,r,i,s,o,u,a;if(v.isFunction(e))return this.each(function(t){v(this).removeClass(e.call(this,t,this.className))});if(e&&typeof e=="string"||e===t){n=(e||"").split(y);for(u=0,a=this.length;u<a;u++){i=this[u];if(i.nodeType===1&&i.className){r=(" "+i.className+" ").replace(q," ");for(s=0,o=n.length;s<o;s++)while(r.indexOf(" "+n[s]+" ")>=0)r=r.replace(" "+n[s]+" "," ");i.className=e?v.trim(r):""}}}return this},toggleClass:function(e,t){var n=typeof e,r=typeof t=="boolean";return v.isFunction(e)?this.each(function(n){v(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if(n==="string"){var i,s=0,o=v(this),u=t,a=e.split(y);while(i=a[s++])u=r?u:!o.hasClass(i),o[u?"addClass":"removeClass"](i)}else if(n==="undefined"||n==="boolean")this.className&&v._data(this,"__className__",this.className),this.className=this.className||e===!1?"":v._data(this,"__className__")||""})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;n<r;n++)if(this[n].nodeType===1&&(" "+this[n].className+" ").replace(q," ").indexOf(t)>=0)return!0;return!1},val:function(e){var n,r,i,s=this[0];if(!arguments.length){if(s)return n=v.valHooks[s.type]||v.valHooks[s.nodeName.toLowerCase()],n&&"get"in n&&(r=n.get(s,"value"))!==t?r:(r=s.value,typeof r=="string"?r.replace(R,""):r==null?"":r);return}return i=v.isFunction(e),this.each(function(r){var s,o=v(this);if(this.nodeType!==1)return;i?s=e.call(this,r,o.val()):s=e,s==null?s="":typeof s=="number"?s+="":v.isArray(s)&&(s=v.map(s,function(e){return e==null?"":e+""})),n=v.valHooks[this.type]||v.valHooks[this.nodeName.toLowerCase()];if(!n||!("set"in n)||n.set(this,s,"value")===t)this.value=s})}}),v.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r,i,s=e.selectedIndex,o=[],u=e.options,a=e.type==="select-one";if(s<0)return null;n=a?s:0,r=a?s+1:u.length;for(;n<r;n++){i=u[n];if(i.selected&&(v.support.optDisabled?!i.disabled:i.getAttribute("disabled")===null)&&(!i.parentNode.disabled||!v.nodeName(i.parentNode,"optgroup"))){t=v(i).val();if(a)return t;o.push(t)}}return a&&!o.length&&u.length?v(u[s]).val():o},set:function(e,t){var n=v.makeArray(t);return v(e).find("option").each(function(){this.selected=v.inArray(v(this).val(),n)>=0}),n.length||(e.selectedIndex=-1),n}}},attrFn:{},attr:function(e,n,r,i){var s,o,u,a=e.nodeType;if(!e||a===3||a===8||a===2)return;if(i&&v.isFunction(v.fn[n]))return v(e)[n](r);if(typeof e.getAttribute=="undefined")return v.prop(e,n,r);u=a!==1||!v.isXMLDoc(e),u&&(n=n.toLowerCase(),o=v.attrHooks[n]||(X.test(n)?F:j));if(r!==t){if(r===null){v.removeAttr(e,n);return}return o&&"set"in o&&u&&(s=o.set(e,r,n))!==t?s:(e.setAttribute(n,r+""),r)}return o&&"get"in o&&u&&(s=o.get(e,n))!==null?s:(s=e.getAttribute(n),s===null?t:s)},removeAttr:function(e,t){var n,r,i,s,o=0;if(t&&e.nodeType===1){r=t.split(y);for(;o<r.length;o++)i=r[o],i&&(n=v.propFix[i]||i,s=X.test(i),s||v.attr(e,i,""),e.removeAttribute(V?i:n),s&&n in e&&(e[n]=!1))}},attrHooks:{type:{set:function(e,t){if(U.test(e.nodeName)&&e.parentNode)v.error("type property can't be changed");else if(!v.support.radioValue&&t==="radio"&&v.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}},value:{get:function(e,t){return j&&v.nodeName(e,"button")?j.get(e,t):t in e?e.value:null},set:function(e,t,n){if(j&&v.nodeName(e,"button"))return j.set(e,t,n);e.value=t}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(e,n,r){var i,s,o,u=e.nodeType;if(!e||u===3||u===8||u===2)return;return o=u!==1||!v.isXMLDoc(e),o&&(n=v.propFix[n]||n,s=v.propHooks[n]),r!==t?s&&"set"in s&&(i=s.set(e,r,n))!==t?i:e[n]=r:s&&"get"in s&&(i=s.get(e,n))!==null?i:e[n]},propHooks:{tabIndex:{get:function(e){var n=e.getAttributeNode("tabindex");return n&&n.specified?parseInt(n.value,10):z.test(e.nodeName)||W.test(e.nodeName)&&e.href?0:t}}}}),F={get:function(e,n){var r,i=v.prop(e,n);return i===!0||typeof i!="boolean"&&(r=e.getAttributeNode(n))&&r.nodeValue!==!1?n.toLowerCase():t},set:function(e,t,n){var r;return t===!1?v.removeAttr(e,n):(r=v.propFix[n]||n,r in e&&(e[r]=!0),e.setAttribute(n,n.toLowerCase())),n}},V||(I={name:!0,id:!0,coords:!0},j=v.valHooks.button={get:function(e,n){var r;return r=e.getAttributeNode(n),r&&(I[n]?r.value!=="":r.specified)?r.value:t},set:function(e,t,n){var r=e.getAttributeNode(n);return r||(r=i.createAttribute(n),e.setAttributeNode(r)),r.value=t+""}},v.each(["width","height"],function(e,t){v.attrHooks[t]=v.extend(v.attrHooks[t],{set:function(e,n){if(n==="")return e.setAttribute(t,"auto"),n}})}),v.attrHooks.contenteditable={get:j.get,set:function(e,t,n){t===""&&(t="false"),j.set(e,t,n)}}),v.support.hrefNormalized||v.each(["href","src","width","height"],function(e,n){v.attrHooks[n]=v.extend(v.attrHooks[n],{get:function(e){var r=e.getAttribute(n,2);return r===null?t:r}})}),v.support.style||(v.attrHooks.style={get:function(e){return e.style.cssText.toLowerCase()||t},set:function(e,t){return e.style.cssText=t+""}}),v.support.optSelected||(v.propHooks.selected=v.extend(v.propHooks.selected,{get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}})),v.support.enctype||(v.propFix.enctype="encoding"),v.support.checkOn||v.each(["radio","checkbox"],function(){v.valHooks[this]={get:function(e){return e.getAttribute("value")===null?"on":e.value}}}),v.each(["radio","checkbox"],function(){v.valHooks[this]=v.extend(v.valHooks[this],{set:function(e,t){if(v.isArray(t))return e.checked=v.inArray(v(e).val(),t)>=0}})});var $=/^(?:textarea|input|select)$/i,J=/^([^\.]*|)(?:\.(.+)|)$/,K=/(?:^|\s)hover(\.\S+|)\b/,Q=/^key/,G=/^(?:mouse|contextmenu)|click/,Y=/^(?:focusinfocus|focusoutblur)$/,Z=function(e){return v.event.special.hover?e:e.replace(K,"mouseenter$1 mouseleave$1")};v.event={add:function(e,n,r,i,s){var o,u,a,f,l,c,h,p,d,m,g;if(e.nodeType===3||e.nodeType===8||!n||!r||!(o=v._data(e)))return;r.handler&&(d=r,r=d.handler,s=d.selector),r.guid||(r.guid=v.guid++),a=o.events,a||(o.events=a={}),u=o.handle,u||(o.handle=u=function(e){return typeof v=="undefined"||!!e&&v.event.triggered===e.type?t:v.event.dispatch.apply(u.elem,arguments)},u.elem=e),n=v.trim(Z(n)).split(" ");for(f=0;f<n.length;f++){l=J.exec(n[f])||[],c=l[1],h=(l[2]||"").split(".").sort(),g=v.event.special[c]||{},c=(s?g.delegateType:g.bindType)||c,g=v.event.special[c]||{},p=v.extend({type:c,origType:l[1],data:i,handler:r,guid:r.guid,selector:s,needsContext:s&&v.expr.match.needsContext.test(s),namespace:h.join(".")},d),m=a[c];if(!m){m=a[c]=[],m.delegateCount=0;if(!g.setup||g.setup.call(e,i,h,u)===!1)e.addEventListener?e.addEventListener(c,u,!1):e.attachEvent&&e.attachEvent("on"+c,u)}g.add&&(g.add.call(e,p),p.handler.guid||(p.handler.guid=r.guid)),s?m.splice(m.delegateCount++,0,p):m.push(p),v.event.global[c]=!0}e=null},global:{},remove:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,m,g=v.hasData(e)&&v._data(e);if(!g||!(h=g.events))return;t=v.trim(Z(t||"")).split(" ");for(s=0;s<t.length;s++){o=J.exec(t[s])||[],u=a=o[1],f=o[2];if(!u){for(u in h)v.event.remove(e,u+t[s],n,r,!0);continue}p=v.event.special[u]||{},u=(r?p.delegateType:p.bindType)||u,d=h[u]||[],l=d.length,f=f?new RegExp("(^|\\.)"+f.split(".").sort().join("\\.(?:.*\\.|)")+"(\\.|$)"):null;for(c=0;c<d.length;c++)m=d[c],(i||a===m.origType)&&(!n||n.guid===m.guid)&&(!f||f.test(m.namespace))&&(!r||r===m.selector||r==="**"&&m.selector)&&(d.splice(c--,1),m.selector&&d.delegateCount--,p.remove&&p.remove.call(e,m));d.length===0&&l!==d.length&&((!p.teardown||p.teardown.call(e,f,g.handle)===!1)&&v.removeEvent(e,u,g.handle),delete h[u])}v.isEmptyObject(h)&&(delete g.handle,v.removeData(e,"events",!0))},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(n,r,s,o){if(!s||s.nodeType!==3&&s.nodeType!==8){var u,a,f,l,c,h,p,d,m,g,y=n.type||n,b=[];if(Y.test(y+v.event.triggered))return;y.indexOf("!")>=0&&(y=y.slice(0,-1),a=!0),y.indexOf(".")>=0&&(b=y.split("."),y=b.shift(),b.sort());if((!s||v.event.customEvent[y])&&!v.event.global[y])return;n=typeof n=="object"?n[v.expando]?n:new v.Event(y,n):new v.Event(y),n.type=y,n.isTrigger=!0,n.exclusive=a,n.namespace=b.join("."),n.namespace_re=n.namespace?new RegExp("(^|\\.)"+b.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,h=y.indexOf(":")<0?"on"+y:"";if(!s){u=v.cache;for(f in u)u[f].events&&u[f].events[y]&&v.event.trigger(n,r,u[f].handle.elem,!0);return}n.result=t,n.target||(n.target=s),r=r!=null?v.makeArray(r):[],r.unshift(n),p=v.event.special[y]||{};if(p.trigger&&p.trigger.apply(s,r)===!1)return;m=[[s,p.bindType||y]];if(!o&&!p.noBubble&&!v.isWindow(s)){g=p.delegateType||y,l=Y.test(g+y)?s:s.parentNode;for(c=s;l;l=l.parentNode)m.push([l,g]),c=l;c===(s.ownerDocument||i)&&m.push([c.defaultView||c.parentWindow||e,g])}for(f=0;f<m.length&&!n.isPropagationStopped();f++)l=m[f][0],n.type=m[f][1],d=(v._data(l,"events")||{})[n.type]&&v._data(l,"handle"),d&&d.apply(l,r),d=h&&l[h],d&&v.acceptData(l)&&d.apply&&d.apply(l,r)===!1&&n.preventDefault();return n.type=y,!o&&!n.isDefaultPrevented()&&(!p._default||p._default.apply(s.ownerDocument,r)===!1)&&(y!=="click"||!v.nodeName(s,"a"))&&v.acceptData(s)&&h&&s[y]&&(y!=="focus"&&y!=="blur"||n.target.offsetWidth!==0)&&!v.isWindow(s)&&(c=s[h],c&&(s[h]=null),v.event.triggered=y,s[y](),v.event.triggered=t,c&&(s[h]=c)),n.result}return},dispatch:function(n){n=v.event.fix(n||e.event);var r,i,s,o,u,a,f,c,h,p,d=(v._data(this,"events")||{})[n.type]||[],m=d.delegateCount,g=l.call(arguments),y=!n.exclusive&&!n.namespace,b=v.event.special[n.type]||{},w=[];g[0]=n,n.delegateTarget=this;if(b.preDispatch&&b.preDispatch.call(this,n)===!1)return;if(m&&(!n.button||n.type!=="click"))for(s=n.target;s!=this;s=s.parentNode||this)if(s.disabled!==!0||n.type!=="click"){u={},f=[];for(r=0;r<m;r++)c=d[r],h=c.selector,u[h]===t&&(u[h]=c.needsContext?v(h,this).index(s)>=0:v.find(h,this,null,[s]).length),u[h]&&f.push(c);f.length&&w.push({elem:s,matches:f})}d.length>m&&w.push({elem:this,matches:d.slice(m)});for(r=0;r<w.length&&!n.isPropagationStopped();r++){a=w[r],n.currentTarget=a.elem;for(i=0;i<a.matches.length&&!n.isImmediatePropagationStopped();i++){c=a.matches[i];if(y||!n.namespace&&!c.namespace||n.namespace_re&&n.namespace_re.test(c.namespace))n.data=c.data,n.handleObj=c,o=((v.event.special[c.origType]||{}).handle||c.handler).apply(a.elem,g),o!==t&&(n.result=o,o===!1&&(n.preventDefault(),n.stopPropagation()))}}return b.postDispatch&&b.postDispatch.call(this,n),n.result},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return e.which==null&&(e.which=t.charCode!=null?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,n){var r,s,o,u=n.button,a=n.fromElement;return e.pageX==null&&n.clientX!=null&&(r=e.target.ownerDocument||i,s=r.documentElement,o=r.body,e.pageX=n.clientX+(s&&s.scrollLeft||o&&o.scrollLeft||0)-(s&&s.clientLeft||o&&o.clientLeft||0),e.pageY=n.clientY+(s&&s.scrollTop||o&&o.scrollTop||0)-(s&&s.clientTop||o&&o.clientTop||0)),!e.relatedTarget&&a&&(e.relatedTarget=a===e.target?n.toElement:a),!e.which&&u!==t&&(e.which=u&1?1:u&2?3:u&4?2:0),e}},fix:function(e){if(e[v.expando])return e;var t,n,r=e,s=v.event.fixHooks[e.type]||{},o=s.props?this.props.concat(s.props):this.props;e=v.Event(r);for(t=o.length;t;)n=o[--t],e[n]=r[n];return e.target||(e.target=r.srcElement||i),e.target.nodeType===3&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,s.filter?s.filter(e,r):e},special:{load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(e,t,n){v.isWindow(this)&&(this.onbeforeunload=n)},teardown:function(e,t){this.onbeforeunload===t&&(this.onbeforeunload=null)}}},simulate:function(e,t,n,r){var i=v.extend(new v.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?v.event.trigger(i,null,t):v.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},v.event.handle=v.event.dispatch,v.removeEvent=i.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var r="on"+t;e.detachEvent&&(typeof e[r]=="undefined"&&(e[r]=null),e.detachEvent(r,n))},v.Event=function(e,t){if(!(this instanceof v.Event))return new v.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?tt:et):this.type=e,t&&v.extend(this,t),this.timeStamp=e&&e.timeStamp||v.now(),this[v.expando]=!0},v.Event.prototype={preventDefault:function(){this.isDefaultPrevented=tt;var e=this.originalEvent;if(!e)return;e.preventDefault?e.preventDefault():e.returnValue=!1},stopPropagation:function(){this.isPropagationStopped=tt;var e=this.originalEvent;if(!e)return;e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=tt,this.stopPropagation()},isDefaultPrevented:et,isPropagationStopped:et,isImmediatePropagationStopped:et},v.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){v.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,s=e.handleObj,o=s.selector;if(!i||i!==r&&!v.contains(r,i))e.type=s.origType,n=s.handler.apply(this,arguments),e.type=t;return n}}}),v.support.submitBubbles||(v.event.special.submit={setup:function(){if(v.nodeName(this,"form"))return!1;v.event.add(this,"click._submit keypress._submit",function(e){var n=e.target,r=v.nodeName(n,"input")||v.nodeName(n,"button")?n.form:t;r&&!v._data(r,"_submit_attached")&&(v.event.add(r,"submit._submit",function(e){e._submit_bubble=!0}),v._data(r,"_submit_attached",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&v.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){if(v.nodeName(this,"form"))return!1;v.event.remove(this,"._submit")}}),v.support.changeBubbles||(v.event.special.change={setup:function(){if($.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio")v.event.add(this,"propertychange._change",function(e){e.originalEvent.propertyName==="checked"&&(this._just_changed=!0)}),v.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),v.event.simulate("change",this,e,!0)});return!1}v.event.add(this,"beforeactivate._change",function(e){var t=e.target;$.test(t.nodeName)&&!v._data(t,"_change_attached")&&(v.event.add(t,"change._change",function(e){this.parentNode&&!e.isSimulated&&!e.isTrigger&&v.event.simulate("change",this.parentNode,e,!0)}),v._data(t,"_change_attached",!0))})},handle:function(e){var t=e.target;if(this!==t||e.isSimulated||e.isTrigger||t.type!=="radio"&&t.type!=="checkbox")return e.handleObj.handler.apply(this,arguments)},teardown:function(){return v.event.remove(this,"._change"),!$.test(this.nodeName)}}),v.support.focusinBubbles||v.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){v.event.simulate(t,e.target,v.event.fix(e),!0)};v.event.special[t]={setup:function(){n++===0&&i.addEventListener(e,r,!0)},teardown:function(){--n===0&&i.removeEventListener(e,r,!0)}}}),v.fn.extend({on:function(e,n,r,i,s){var o,u;if(typeof e=="object"){typeof n!="string"&&(r=r||n,n=t);for(u in e)this.on(u,n,r,e[u],s);return this}r==null&&i==null?(i=n,r=n=t):i==null&&(typeof n=="string"?(i=r,r=t):(i=r,r=n,n=t));if(i===!1)i=et;else if(!i)return this;return s===1&&(o=i,i=function(e){return v().off(e),o.apply(this,arguments)},i.guid=o.guid||(o.guid=v.guid++)),this.each(function(){v.event.add(this,e,i,r,n)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,n,r){var i,s;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,v(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if(typeof e=="object"){for(s in e)this.off(s,n,e[s]);return this}if(n===!1||typeof n=="function")r=n,n=t;return r===!1&&(r=et),this.each(function(){v.event.remove(this,e,r,n)})},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},live:function(e,t,n){return v(this.context).on(e,this.selector,t,n),this},die:function(e,t){return v(this.context).off(e,this.selector||"**",t),this},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return arguments.length===1?this.off(e,"**"):this.off(t,e||"**",n)},trigger:function(e,t){return this.each(function(){v.event.trigger(e,t,this)})},triggerHandler:function(e,t){if(this[0])return v.event.trigger(e,t,this[0],!0)},toggle:function(e){var t=arguments,n=e.guid||v.guid++,r=0,i=function(n){var i=(v._data(this,"lastToggle"+e.guid)||0)%r;return v._data(this,"lastToggle"+e.guid,i+1),n.preventDefault(),t[i].apply(this,arguments)||!1};i.guid=n;while(r<t.length)t[r++].guid=n;return this.click(i)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),v.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){v.fn[t]=function(e,n){return n==null&&(n=e,e=null),arguments.length>0?this.on(t,null,e,n):this.trigger(t)},Q.test(t)&&(v.event.fixHooks[t]=v.event.keyHooks),G.test(t)&&(v.event.fixHooks[t]=v.event.mouseHooks)}),function(e,t){function nt(e,t,n,r){n=n||[],t=t||g;var i,s,a,f,l=t.nodeType;if(!e||typeof e!="string")return n;if(l!==1&&l!==9)return[];a=o(t);if(!a&&!r)if(i=R.exec(e))if(f=i[1]){if(l===9){s=t.getElementById(f);if(!s||!s.parentNode)return n;if(s.id===f)return n.push(s),n}else if(t.ownerDocument&&(s=t.ownerDocument.getElementById(f))&&u(t,s)&&s.id===f)return n.push(s),n}else{if(i[2])return S.apply(n,x.call(t.getElementsByTagName(e),0)),n;if((f=i[3])&&Z&&t.getElementsByClassName)return S.apply(n,x.call(t.getElementsByClassName(f),0)),n}return vt(e.replace(j,"$1"),t,n,r,a)}function rt(e){return function(t){var n=t.nodeName.toLowerCase();return n==="input"&&t.type===e}}function it(e){return function(t){var n=t.nodeName.toLowerCase();return(n==="input"||n==="button")&&t.type===e}}function st(e){return N(function(t){return t=+t,N(function(n,r){var i,s=e([],n.length,t),o=s.length;while(o--)n[i=s[o]]&&(n[i]=!(r[i]=n[i]))})})}function ot(e,t,n){if(e===t)return n;var r=e.nextSibling;while(r){if(r===t)return-1;r=r.nextSibling}return 1}function ut(e,t){var n,r,s,o,u,a,f,l=L[d][e];if(l)return t?0:l.slice(0);u=e,a=[],f=i.preFilter;while(u){if(!n||(r=F.exec(u)))r&&(u=u.slice(r[0].length)),a.push(s=[]);n=!1;if(r=I.exec(u))s.push(n=new m(r.shift())),u=u.slice(n.length),n.type=r[0].replace(j," ");for(o in i.filter)(r=J[o].exec(u))&&(!f[o]||(r=f[o](r,g,!0)))&&(s.push(n=new m(r.shift())),u=u.slice(n.length),n.type=o,n.matches=r);if(!n)break}return t?u.length:u?nt.error(e):L(e,a).slice(0)}function at(e,t,r){var i=t.dir,s=r&&t.dir==="parentNode",o=w++;return t.first?function(t,n,r){while(t=t[i])if(s||t.nodeType===1)return e(t,n,r)}:function(t,r,u){if(!u){var a,f=b+" "+o+" ",l=f+n;while(t=t[i])if(s||t.nodeType===1){if((a=t[d])===l)return t.sizset;if(typeof a=="string"&&a.indexOf(f)===0){if(t.sizset)return t}else{t[d]=l;if(e(t,r,u))return t.sizset=!0,t;t.sizset=!1}}}else while(t=t[i])if(s||t.nodeType===1)if(e(t,r,u))return t}}function ft(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function lt(e,t,n,r,i){var s,o=[],u=0,a=e.length,f=t!=null;for(;u<a;u++)if(s=e[u])if(!n||n(s,r,i))o.push(s),f&&t.push(u);return o}function ct(e,t,n,r,i,s){return r&&!r[d]&&(r=ct(r)),i&&!i[d]&&(i=ct(i,s)),N(function(s,o,u,a){if(s&&i)return;var f,l,c,h=[],p=[],d=o.length,v=s||dt(t||"*",u.nodeType?[u]:u,[],s),m=e&&(s||!t)?lt(v,h,e,u,a):v,g=n?i||(s?e:d||r)?[]:o:m;n&&n(m,g,u,a);if(r){c=lt(g,p),r(c,[],u,a),f=c.length;while(f--)if(l=c[f])g[p[f]]=!(m[p[f]]=l)}if(s){f=e&&g.length;while(f--)if(l=g[f])s[h[f]]=!(o[h[f]]=l)}else g=lt(g===o?g.splice(d,g.length):g),i?i(null,o,g,a):S.apply(o,g)})}function ht(e){var t,n,r,s=e.length,o=i.relative[e[0].type],u=o||i.relative[" "],a=o?1:0,f=at(function(e){return e===t},u,!0),l=at(function(e){return T.call(t,e)>-1},u,!0),h=[function(e,n,r){return!o&&(r||n!==c)||((t=n).nodeType?f(e,n,r):l(e,n,r))}];for(;a<s;a++)if(n=i.relative[e[a].type])h=[at(ft(h),n)];else{n=i.filter[e[a].type].apply(null,e[a].matches);if(n[d]){r=++a;for(;r<s;r++)if(i.relative[e[r].type])break;return ct(a>1&&ft(h),a>1&&e.slice(0,a-1).join("").replace(j,"$1"),n,a<r&&ht(e.slice(a,r)),r<s&&ht(e=e.slice(r)),r<s&&e.join(""))}h.push(n)}return ft(h)}function pt(e,t){var r=t.length>0,s=e.length>0,o=function(u,a,f,l,h){var p,d,v,m=[],y=0,w="0",x=u&&[],T=h!=null,N=c,C=u||s&&i.find.TAG("*",h&&a.parentNode||a),k=b+=N==null?1:Math.E;T&&(c=a!==g&&a,n=o.el);for(;(p=C[w])!=null;w++){if(s&&p){for(d=0;v=e[d];d++)if(v(p,a,f)){l.push(p);break}T&&(b=k,n=++o.el)}r&&((p=!v&&p)&&y--,u&&x.push(p))}y+=w;if(r&&w!==y){for(d=0;v=t[d];d++)v(x,m,a,f);if(u){if(y>0)while(w--)!x[w]&&!m[w]&&(m[w]=E.call(l));m=lt(m)}S.apply(l,m),T&&!u&&m.length>0&&y+t.length>1&&nt.uniqueSort(l)}return T&&(b=k,c=N),x};return o.el=0,r?N(o):o}function dt(e,t,n,r){var i=0,s=t.length;for(;i<s;i++)nt(e,t[i],n,r);return n}function vt(e,t,n,r,s){var o,u,f,l,c,h=ut(e),p=h.length;if(!r&&h.length===1){u=h[0]=h[0].slice(0);if(u.length>2&&(f=u[0]).type==="ID"&&t.nodeType===9&&!s&&i.relative[u[1].type]){t=i.find.ID(f.matches[0].replace($,""),t,s)[0];if(!t)return n;e=e.slice(u.shift().length)}for(o=J.POS.test(e)?-1:u.length-1;o>=0;o--){f=u[o];if(i.relative[l=f.type])break;if(c=i.find[l])if(r=c(f.matches[0].replace($,""),z.test(u[0].type)&&t.parentNode||t,s)){u.splice(o,1),e=r.length&&u.join("");if(!e)return S.apply(n,x.call(r,0)),n;break}}}return a(e,h)(r,t,s,n,z.test(e)),n}function mt(){}var n,r,i,s,o,u,a,f,l,c,h=!0,p="undefined",d=("sizcache"+Math.random()).replace(".",""),m=String,g=e.document,y=g.documentElement,b=0,w=0,E=[].pop,S=[].push,x=[].slice,T=[].indexOf||function(e){var t=0,n=this.length;for(;t<n;t++)if(this[t]===e)return t;return-1},N=function(e,t){return e[d]=t==null||t,e},C=function(){var e={},t=[];return N(function(n,r){return t.push(n)>i.cacheLength&&delete e[t.shift()],e[n]=r},e)},k=C(),L=C(),A=C(),O="[\\x20\\t\\r\\n\\f]",M="(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+",_=M.replace("w","w#"),D="([*^$|!~]?=)",P="\\["+O+"*("+M+")"+O+"*(?:"+D+O+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+_+")|)|)"+O+"*\\]",H=":("+M+")(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|([^()[\\]]*|(?:(?:"+P+")|[^:]|\\\\.)*|.*))\\)|)",B=":(even|odd|eq|gt|lt|nth|first|last)(?:\\("+O+"*((?:-\\d)?\\d*)"+O+"*\\)|)(?=[^-]|$)",j=new RegExp("^"+O+"+|((?:^|[^\\\\])(?:\\\\.)*)"+O+"+$","g"),F=new RegExp("^"+O+"*,"+O+"*"),I=new RegExp("^"+O+"*([\\x20\\t\\r\\n\\f>+~])"+O+"*"),q=new RegExp(H),R=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,U=/^:not/,z=/[\x20\t\r\n\f]*[+~]/,W=/:not\($/,X=/h\d/i,V=/input|select|textarea|button/i,$=/\\(?!\\)/g,J={ID:new RegExp("^#("+M+")"),CLASS:new RegExp("^\\.("+M+")"),NAME:new RegExp("^\\[name=['\"]?("+M+")['\"]?\\]"),TAG:new RegExp("^("+M.replace("w","w*")+")"),ATTR:new RegExp("^"+P),PSEUDO:new RegExp("^"+H),POS:new RegExp(B,"i"),CHILD:new RegExp("^:(only|nth|first|last)-child(?:\\("+O+"*(even|odd|(([+-]|)(\\d*)n|)"+O+"*(?:([+-]|)"+O+"*(\\d+)|))"+O+"*\\)|)","i"),needsContext:new RegExp("^"+O+"*[>+~]|"+B,"i")},K=function(e){var t=g.createElement("div");try{return e(t)}catch(n){return!1}finally{t=null}},Q=K(function(e){return e.appendChild(g.createComment("")),!e.getElementsByTagName("*").length}),G=K(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild&&typeof e.firstChild.getAttribute!==p&&e.firstChild.getAttribute("href")==="#"}),Y=K(function(e){e.innerHTML="<select></select>";var t=typeof e.lastChild.getAttribute("multiple");return t!=="boolean"&&t!=="string"}),Z=K(function(e){return e.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",!e.getElementsByClassName||!e.getElementsByClassName("e").length?!1:(e.lastChild.className="e",e.getElementsByClassName("e").length===2)}),et=K(function(e){e.id=d+0,e.innerHTML="<a name='"+d+"'></a><div name='"+d+"'></div>",y.insertBefore(e,y.firstChild);var t=g.getElementsByName&&g.getElementsByName(d).length===2+g.getElementsByName(d+0).length;return r=!g.getElementById(d),y.removeChild(e),t});try{x.call(y.childNodes,0)[0].nodeType}catch(tt){x=function(e){var t,n=[];for(;t=this[e];e++)n.push(t);return n}}nt.matches=function(e,t){return nt(e,null,null,t)},nt.matchesSelector=function(e,t){return nt(t,null,null,[e]).length>0},s=nt.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(i===1||i===9||i===11){if(typeof e.textContent=="string")return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=s(e)}else if(i===3||i===4)return e.nodeValue}else for(;t=e[r];r++)n+=s(t);return n},o=nt.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?t.nodeName!=="HTML":!1},u=nt.contains=y.contains?function(e,t){var n=e.nodeType===9?e.documentElement:e,r=t&&t.parentNode;return e===r||!!(r&&r.nodeType===1&&n.contains&&n.contains(r))}:y.compareDocumentPosition?function(e,t){return t&&!!(e.compareDocumentPosition(t)&16)}:function(e,t){while(t=t.parentNode)if(t===e)return!0;return!1},nt.attr=function(e,t){var n,r=o(e);return r||(t=t.toLowerCase()),(n=i.attrHandle[t])?n(e):r||Y?e.getAttribute(t):(n=e.getAttributeNode(t),n?typeof e[t]=="boolean"?e[t]?t:null:n.specified?n.value:null:null)},i=nt.selectors={cacheLength:50,createPseudo:N,match:J,attrHandle:G?{}:{href:function(e){return e.getAttribute("href",2)},type:function(e){return e.getAttribute("type")}},find:{ID:r?function(e,t,n){if(typeof t.getElementById!==p&&!n){var r=t.getElementById(e);return r&&r.parentNode?[r]:[]}}:function(e,n,r){if(typeof n.getElementById!==p&&!r){var i=n.getElementById(e);return i?i.id===e||typeof i.getAttributeNode!==p&&i.getAttributeNode("id").value===e?[i]:t:[]}},TAG:Q?function(e,t){if(typeof t.getElementsByTagName!==p)return t.getElementsByTagName(e)}:function(e,t){var n=t.getElementsByTagName(e);if(e==="*"){var r,i=[],s=0;for(;r=n[s];s++)r.nodeType===1&&i.push(r);return i}return n},NAME:et&&function(e,t){if(typeof t.getElementsByName!==p)return t.getElementsByName(name)},CLASS:Z&&function(e,t,n){if(typeof t.getElementsByClassName!==p&&!n)return t.getElementsByClassName(e)}},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace($,""),e[3]=(e[4]||e[5]||"").replace($,""),e[2]==="~="&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),e[1]==="nth"?(e[2]||nt.error(e[0]),e[3]=+(e[3]?e[4]+(e[5]||1):2*(e[2]==="even"||e[2]==="odd")),e[4]=+(e[6]+e[7]||e[2]==="odd")):e[2]&&nt.error(e[0]),e},PSEUDO:function(e){var t,n;if(J.CHILD.test(e[0]))return null;if(e[3])e[2]=e[3];else if(t=e[4])q.test(t)&&(n=ut(t,!0))&&(n=t.indexOf(")",t.length-n)-t.length)&&(t=t.slice(0,n),e[0]=e[0].slice(0,n)),e[2]=t;return e.slice(0,3)}},filter:{ID:r?function(e){return e=e.replace($,""),function(t){return t.getAttribute("id")===e}}:function(e){return e=e.replace($,""),function(t){var n=typeof t.getAttributeNode!==p&&t.getAttributeNode("id");return n&&n.value===e}},TAG:function(e){return e==="*"?function(){return!0}:(e=e.replace($,"").toLowerCase(),function(t){return t.nodeName&&t.nodeName.toLowerCase()===e})},CLASS:function(e){var t=k[d][e];return t||(t=k(e,new RegExp("(^|"+O+")"+e+"("+O+"|$)"))),function(e){return t.test(e.className||typeof e.getAttribute!==p&&e.getAttribute("class")||"")}},ATTR:function(e,t,n){return function(r,i){var s=nt.attr(r,e);return s==null?t==="!=":t?(s+="",t==="="?s===n:t==="!="?s!==n:t==="^="?n&&s.indexOf(n)===0:t==="*="?n&&s.indexOf(n)>-1:t==="$="?n&&s.substr(s.length-n.length)===n:t==="~="?(" "+s+" ").indexOf(n)>-1:t==="|="?s===n||s.substr(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r){return e==="nth"?function(e){var t,i,s=e.parentNode;if(n===1&&r===0)return!0;if(s){i=0;for(t=s.firstChild;t;t=t.nextSibling)if(t.nodeType===1){i++;if(e===t)break}}return i-=r,i===n||i%n===0&&i/n>=0}:function(t){var n=t;switch(e){case"only":case"first":while(n=n.previousSibling)if(n.nodeType===1)return!1;if(e==="first")return!0;n=t;case"last":while(n=n.nextSibling)if(n.nodeType===1)return!1;return!0}}},PSEUDO:function(e,t){var n,r=i.pseudos[e]||i.setFilters[e.toLowerCase()]||nt.error("unsupported pseudo: "+e);return r[d]?r(t):r.length>1?(n=[e,e,"",t],i.setFilters.hasOwnProperty(e.toLowerCase())?N(function(e,n){var i,s=r(e,t),o=s.length;while(o--)i=T.call(e,s[o]),e[i]=!(n[i]=s[o])}):function(e){return r(e,0,n)}):r}},pseudos:{not:N(function(e){var t=[],n=[],r=a(e.replace(j,"$1"));return r[d]?N(function(e,t,n,i){var s,o=r(e,null,i,[]),u=e.length;while(u--)if(s=o[u])e[u]=!(t[u]=s)}):function(e,i,s){return t[0]=e,r(t,null,s,n),!n.pop()}}),has:N(function(e){return function(t){return nt(e,t).length>0}}),contains:N(function(e){return function(t){return(t.textContent||t.innerText||s(t)).indexOf(e)>-1}}),enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&!!e.checked||t==="option"&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},parent:function(e){return!i.pseudos.empty(e)},empty:function(e){var t;e=e.firstChild;while(e){if(e.nodeName>"@"||(t=e.nodeType)===3||t===4)return!1;e=e.nextSibling}return!0},header:function(e){return X.test(e.nodeName)},text:function(e){var t,n;return e.nodeName.toLowerCase()==="input"&&(t=e.type)==="text"&&((n=e.getAttribute("type"))==null||n.toLowerCase()===t)},radio:rt("radio"),checkbox:rt("checkbox"),file:rt("file"),password:rt("password"),image:rt("image"),submit:it("submit"),reset:it("reset"),button:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&e.type==="button"||t==="button"},input:function(e){return V.test(e.nodeName)},focus:function(e){var t=e.ownerDocument;return e===t.activeElement&&(!t.hasFocus||t.hasFocus())&&(!!e.type||!!e.href)},active:function(e){return e===e.ownerDocument.activeElement},first:st(function(e,t,n){return[0]}),last:st(function(e,t,n){return[t-1]}),eq:st(function(e,t,n){return[n<0?n+t:n]}),even:st(function(e,t,n){for(var r=0;r<t;r+=2)e.push(r);return e}),odd:st(function(e,t,n){for(var r=1;r<t;r+=2)e.push(r);return e}),lt:st(function(e,t,n){for(var r=n<0?n+t:n;--r>=0;)e.push(r);return e}),gt:st(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}},f=y.compareDocumentPosition?function(e,t){return e===t?(l=!0,0):(!e.compareDocumentPosition||!t.compareDocumentPosition?e.compareDocumentPosition:e.compareDocumentPosition(t)&4)?-1:1}:function(e,t){if(e===t)return l=!0,0;if(e.sourceIndex&&t.sourceIndex)return e.sourceIndex-t.sourceIndex;var n,r,i=[],s=[],o=e.parentNode,u=t.parentNode,a=o;if(o===u)return ot(e,t);if(!o)return-1;if(!u)return 1;while(a)i.unshift(a),a=a.parentNode;a=u;while(a)s.unshift(a),a=a.parentNode;n=i.length,r=s.length;for(var f=0;f<n&&f<r;f++)if(i[f]!==s[f])return ot(i[f],s[f]);return f===n?ot(e,s[f],-1):ot(i[f],t,1)},[0,0].sort(f),h=!l,nt.uniqueSort=function(e){var t,n=1;l=h,e.sort(f);if(l)for(;t=e[n];n++)t===e[n-1]&&e.splice(n--,1);return e},nt.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},a=nt.compile=function(e,t){var n,r=[],i=[],s=A[d][e];if(!s){t||(t=ut(e)),n=t.length;while(n--)s=ht(t[n]),s[d]?r.push(s):i.push(s);s=A(e,pt(i,r))}return s},g.querySelectorAll&&function(){var e,t=vt,n=/'|\\/g,r=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,i=[":focus"],s=[":active",":focus"],u=y.matchesSelector||y.mozMatchesSelector||y.webkitMatchesSelector||y.oMatchesSelector||y.msMatchesSelector;K(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||i.push("\\["+O+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),e.querySelectorAll(":checked").length||i.push(":checked")}),K(function(e){e.innerHTML="<p test=''></p>",e.querySelectorAll("[test^='']").length&&i.push("[*^$]="+O+"*(?:\"\"|'')"),e.innerHTML="<input type='hidden'/>",e.querySelectorAll(":enabled").length||i.push(":enabled",":disabled")}),i=new RegExp(i.join("|")),vt=function(e,r,s,o,u){if(!o&&!u&&(!i||!i.test(e))){var a,f,l=!0,c=d,h=r,p=r.nodeType===9&&e;if(r.nodeType===1&&r.nodeName.toLowerCase()!=="object"){a=ut(e),(l=r.getAttribute("id"))?c=l.replace(n,"\\$&"):r.setAttribute("id",c),c="[id='"+c+"'] ",f=a.length;while(f--)a[f]=c+a[f].join("");h=z.test(e)&&r.parentNode||r,p=a.join(",")}if(p)try{return S.apply(s,x.call(h.querySelectorAll(p),0)),s}catch(v){}finally{l||r.removeAttribute("id")}}return t(e,r,s,o,u)},u&&(K(function(t){e=u.call(t,"div");try{u.call(t,"[test!='']:sizzle"),s.push("!=",H)}catch(n){}}),s=new RegExp(s.join("|")),nt.matchesSelector=function(t,n){n=n.replace(r,"='$1']");if(!o(t)&&!s.test(n)&&(!i||!i.test(n)))try{var a=u.call(t,n);if(a||e||t.document&&t.document.nodeType!==11)return a}catch(f){}return nt(n,null,null,[t]).length>0})}(),i.pseudos.nth=i.pseudos.eq,i.filters=mt.prototype=i.pseudos,i.setFilters=new mt,nt.attr=v.attr,v.find=nt,v.expr=nt.selectors,v.expr[":"]=v.expr.pseudos,v.unique=nt.uniqueSort,v.text=nt.getText,v.isXMLDoc=nt.isXML,v.contains=nt.contains}(e);var nt=/Until$/,rt=/^(?:parents|prev(?:Until|All))/,it=/^.[^:#\[\.,]*$/,st=v.expr.match.needsContext,ot={children:!0,contents:!0,next:!0,prev:!0};v.fn.extend({find:function(e){var t,n,r,i,s,o,u=this;if(typeof e!="string")return v(e).filter(function(){for(t=0,n=u.length;t<n;t++)if(v.contains(u[t],this))return!0});o=this.pushStack("","find",e);for(t=0,n=this.length;t<n;t++){r=o.length,v.find(e,this[t],o);if(t>0)for(i=r;i<o.length;i++)for(s=0;s<r;s++)if(o[s]===o[i]){o.splice(i--,1);break}}return o},has:function(e){var t,n=v(e,this),r=n.length;return this.filter(function(){for(t=0;t<r;t++)if(v.contains(this,n[t]))return!0})},not:function(e){return this.pushStack(ft(this,e,!1),"not",e)},filter:function(e){return this.pushStack(ft(this,e,!0),"filter",e)},is:function(e){return!!e&&(typeof e=="string"?st.test(e)?v(e,this.context).index(this[0])>=0:v.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){var n,r=0,i=this.length,s=[],o=st.test(e)||typeof e!="string"?v(e,t||this.context):0;for(;r<i;r++){n=this[r];while(n&&n.ownerDocument&&n!==t&&n.nodeType!==11){if(o?o.index(n)>-1:v.find.matchesSelector(n,e)){s.push(n);break}n=n.parentNode}}return s=s.length>1?v.unique(s):s,this.pushStack(s,"closest",e)},index:function(e){return e?typeof e=="string"?v.inArray(this[0],v(e)):v.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(e,t){var n=typeof e=="string"?v(e,t):v.makeArray(e&&e.nodeType?[e]:e),r=v.merge(this.get(),n);return this.pushStack(ut(n[0])||ut(r[0])?r:v.unique(r))},addBack:function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}}),v.fn.andSelf=v.fn.addBack,v.each({parent:function(e){var t=e.parentNode;return t&&t.nodeType!==11?t:null},parents:function(e){return v.dir(e,"parentNode")},parentsUntil:function(e,t,n){return v.dir(e,"parentNode",n)},next:function(e){return at(e,"nextSibling")},prev:function(e){return at(e,"previousSibling")},nextAll:function(e){return v.dir(e,"nextSibling")},prevAll:function(e){return v.dir(e,"previousSibling")},nextUntil:function(e,t,n){return v.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return v.dir(e,"previousSibling",n)},siblings:function(e){return v.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return v.sibling(e.firstChild)},contents:function(e){return v.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:v.merge([],e.childNodes)}},function(e,t){v.fn[e]=function(n,r){var i=v.map(this,t,n);return nt.test(e)||(r=n),r&&typeof r=="string"&&(i=v.filter(r,i)),i=this.length>1&&!ot[e]?v.unique(i):i,this.length>1&&rt.test(e)&&(i=i.reverse()),this.pushStack(i,e,l.call(arguments).join(","))}}),v.extend({filter:function(e,t,n){return n&&(e=":not("+e+")"),t.length===1?v.find.matchesSelector(t[0],e)?[t[0]]:[]:v.find.matches(e,t)},dir:function(e,n,r){var i=[],s=e[n];while(s&&s.nodeType!==9&&(r===t||s.nodeType!==1||!v(s).is(r)))s.nodeType===1&&i.push(s),s=s[n];return i},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)e.nodeType===1&&e!==t&&n.push(e);return n}});var ct="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",ht=/ jQuery\d+="(?:null|\d+)"/g,pt=/^\s+/,dt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,vt=/<([\w:]+)/,mt=/<tbody/i,gt=/<|&#?\w+;/,yt=/<(?:script|style|link)/i,bt=/<(?:script|object|embed|option|style)/i,wt=new RegExp("<(?:"+ct+")[\\s/>]","i"),Et=/^(?:checkbox|radio)$/,St=/checked\s*(?:[^=]|=\s*.checked.)/i,xt=/\/(java|ecma)script/i,Tt=/^\s*<!(?:\[CDATA\[|\-\-)|[\]\-]{2}>\s*$/g,Nt={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},Ct=lt(i),kt=Ct.appendChild(i.createElement("div"));Nt.optgroup=Nt.option,Nt.tbody=Nt.tfoot=Nt.colgroup=Nt.caption=Nt.thead,Nt.th=Nt.td,v.support.htmlSerialize||(Nt._default=[1,"X<div>","</div>"]),v.fn.extend({text:function(e){return v.access(this,function(e){return e===t?v.text(this):this.empty().append((this[0]&&this[0].ownerDocument||i).createTextNode(e))},null,e,arguments.length)},wrapAll:function(e){if(v.isFunction(e))return this.each(function(t){v(this).wrapAll(e.call(this,t))});if(this[0]){var t=v(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstChild&&e.firstChild.nodeType===1)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return v.isFunction(e)?this.each(function(t){v(this).wrapInner(e.call(this,t))}):this.each(function(){var t=v(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=v.isFunction(e);return this.each(function(n){v(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){v.nodeName(this,"body")||v(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(e){(this.nodeType===1||this.nodeType===11)&&this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){(this.nodeType===1||this.nodeType===11)&&this.insertBefore(e,this.firstChild)})},before:function(){if(!ut(this[0]))return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this)});if(arguments.length){var e=v.clean(arguments);return this.pushStack(v.merge(e,this),"before",this.selector)}},after:function(){if(!ut(this[0]))return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this.nextSibling)});if(arguments.length){var e=v.clean(arguments);return this.pushStack(v.merge(this,e),"after",this.selector)}},remove:function(e,t){var n,r=0;for(;(n=this[r])!=null;r++)if(!e||v.filter(e,[n]).length)!t&&n.nodeType===1&&(v.cleanData(n.getElementsByTagName("*")),v.cleanData([n])),n.parentNode&&n.parentNode.removeChild(n);return this},empty:function(){var e,t=0;for(;(e=this[t])!=null;t++){e.nodeType===1&&v.cleanData(e.getElementsByTagName("*"));while(e.firstChild)e.removeChild(e.firstChild)}return this},clone:function(e,t){return e=e==null?!1:e,t=t==null?e:t,this.map(function(){return v.clone(this,e,t)})},html:function(e){return v.access(this,function(e){var n=this[0]||{},r=0,i=this.length;if(e===t)return n.nodeType===1?n.innerHTML.replace(ht,""):t;if(typeof e=="string"&&!yt.test(e)&&(v.support.htmlSerialize||!wt.test(e))&&(v.support.leadingWhitespace||!pt.test(e))&&!Nt[(vt.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(dt,"<$1></$2>");try{for(;r<i;r++)n=this[r]||{},n.nodeType===1&&(v.cleanData(n.getElementsByTagName("*")),n.innerHTML=e);n=0}catch(s){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(e){return ut(this[0])?this.length?this.pushStack(v(v.isFunction(e)?e():e),"replaceWith",e):this:v.isFunction(e)?this.each(function(t){var n=v(this),r=n.html();n.replaceWith(e.call(this,t,r))}):(typeof e!="string"&&(e=v(e).detach()),this.each(function(){var t=this.nextSibling,n=this.parentNode;v(this).remove(),t?v(t).before(e):v(n).append(e)}))},detach:function(e){return this.remove(e,!0)},domManip:function(e,n,r){e=[].concat.apply([],e);var i,s,o,u,a=0,f=e[0],l=[],c=this.length;if(!v.support.checkClone&&c>1&&typeof f=="string"&&St.test(f))return this.each(function(){v(this).domManip(e,n,r)});if(v.isFunction(f))return this.each(function(i){var s=v(this);e[0]=f.call(this,i,n?s.html():t),s.domManip(e,n,r)});if(this[0]){i=v.buildFragment(e,this,l),o=i.fragment,s=o.firstChild,o.childNodes.length===1&&(o=s);if(s){n=n&&v.nodeName(s,"tr");for(u=i.cacheable||c-1;a<c;a++)r.call(n&&v.nodeName(this[a],"table")?Lt(this[a],"tbody"):this[a],a===u?o:v.clone(o,!0,!0))}o=s=null,l.length&&v.each(l,function(e,t){t.src?v.ajax?v.ajax({url:t.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):v.error("no ajax"):v.globalEval((t.text||t.textContent||t.innerHTML||"").replace(Tt,"")),t.parentNode&&t.parentNode.removeChild(t)})}return this}}),v.buildFragment=function(e,n,r){var s,o,u,a=e[0];return n=n||i,n=!n.nodeType&&n[0]||n,n=n.ownerDocument||n,e.length===1&&typeof a=="string"&&a.length<512&&n===i&&a.charAt(0)==="<"&&!bt.test(a)&&(v.support.checkClone||!St.test(a))&&(v.support.html5Clone||!wt.test(a))&&(o=!0,s=v.fragments[a],u=s!==t),s||(s=n.createDocumentFragment(),v.clean(e,n,s,r),o&&(v.fragments[a]=u&&s)),{fragment:s,cacheable:o}},v.fragments={},v.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){v.fn[e]=function(n){var r,i=0,s=[],o=v(n),u=o.length,a=this.length===1&&this[0].parentNode;if((a==null||a&&a.nodeType===11&&a.childNodes.length===1)&&u===1)return o[t](this[0]),this;for(;i<u;i++)r=(i>0?this.clone(!0):this).get(),v(o[i])[t](r),s=s.concat(r);return this.pushStack(s,e,o.selector)}}),v.extend({clone:function(e,t,n){var r,i,s,o;v.support.html5Clone||v.isXMLDoc(e)||!wt.test("<"+e.nodeName+">")?o=e.cloneNode(!0):(kt.innerHTML=e.outerHTML,kt.removeChild(o=kt.firstChild));if((!v.support.noCloneEvent||!v.support.noCloneChecked)&&(e.nodeType===1||e.nodeType===11)&&!v.isXMLDoc(e)){Ot(e,o),r=Mt(e),i=Mt(o);for(s=0;r[s];++s)i[s]&&Ot(r[s],i[s])}if(t){At(e,o);if(n){r=Mt(e),i=Mt(o);for(s=0;r[s];++s)At(r[s],i[s])}}return r=i=null,o},clean:function(e,t,n,r){var s,o,u,a,f,l,c,h,p,d,m,g,y=t===i&&Ct,b=[];if(!t||typeof t.createDocumentFragment=="undefined")t=i;for(s=0;(u=e[s])!=null;s++){typeof u=="number"&&(u+="");if(!u)continue;if(typeof u=="string")if(!gt.test(u))u=t.createTextNode(u);else{y=y||lt(t),c=t.createElement("div"),y.appendChild(c),u=u.replace(dt,"<$1></$2>"),a=(vt.exec(u)||["",""])[1].toLowerCase(),f=Nt[a]||Nt._default,l=f[0],c.innerHTML=f[1]+u+f[2];while(l--)c=c.lastChild;if(!v.support.tbody){h=mt.test(u),p=a==="table"&&!h?c.firstChild&&c.firstChild.childNodes:f[1]==="<table>"&&!h?c.childNodes:[];for(o=p.length-1;o>=0;--o)v.nodeName(p[o],"tbody")&&!p[o].childNodes.length&&p[o].parentNode.removeChild(p[o])}!v.support.leadingWhitespace&&pt.test(u)&&c.insertBefore(t.createTextNode(pt.exec(u)[0]),c.firstChild),u=c.childNodes,c.parentNode.removeChild(c)}u.nodeType?b.push(u):v.merge(b,u)}c&&(u=c=y=null);if(!v.support.appendChecked)for(s=0;(u=b[s])!=null;s++)v.nodeName(u,"input")?_t(u):typeof u.getElementsByTagName!="undefined"&&v.grep(u.getElementsByTagName("input"),_t);if(n){m=function(e){if(!e.type||xt.test(e.type))return r?r.push(e.parentNode?e.parentNode.removeChild(e):e):n.appendChild(e)};for(s=0;(u=b[s])!=null;s++)if(!v.nodeName(u,"script")||!m(u))n.appendChild(u),typeof u.getElementsByTagName!="undefined"&&(g=v.grep(v.merge([],u.getElementsByTagName("script")),m),b.splice.apply(b,[s+1,0].concat(g)),s+=g.length)}return b},cleanData:function(e,t){var n,r,i,s,o=0,u=v.expando,a=v.cache,f=v.support.deleteExpando,l=v.event.special;for(;(i=e[o])!=null;o++)if(t||v.acceptData(i)){r=i[u],n=r&&a[r];if(n){if(n.events)for(s in n.events)l[s]?v.event.remove(i,s):v.removeEvent(i,s,n.handle);a[r]&&(delete a[r],f?delete i[u]:i.removeAttribute?i.removeAttribute(u):i[u]=null,v.deletedIds.push(r))}}}}),function(){var e,t;v.uaMatch=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},e=v.uaMatch(o.userAgent),t={},e.browser&&(t[e.browser]=!0,t.version=e.version),t.chrome?t.webkit=!0:t.webkit&&(t.safari=!0),v.browser=t,v.sub=function(){function e(t,n){return new e.fn.init(t,n)}v.extend(!0,e,this),e.superclass=this,e.fn=e.prototype=this(),e.fn.constructor=e,e.sub=this.sub,e.fn.init=function(r,i){return i&&i instanceof v&&!(i instanceof e)&&(i=e(i)),v.fn.init.call(this,r,i,t)},e.fn.init.prototype=e.fn;var t=e(i);return e}}();var Dt,Pt,Ht,Bt=/alpha\([^)]*\)/i,jt=/opacity=([^)]*)/,Ft=/^(top|right|bottom|left)$/,It=/^(none|table(?!-c[ea]).+)/,qt=/^margin/,Rt=new RegExp("^("+m+")(.*)$","i"),Ut=new RegExp("^("+m+")(?!px)[a-z%]+$","i"),zt=new RegExp("^([-+])=("+m+")","i"),Wt={},Xt={position:"absolute",visibility:"hidden",display:"block"},Vt={letterSpacing:0,fontWeight:400},$t=["Top","Right","Bottom","Left"],Jt=["Webkit","O","Moz","ms"],Kt=v.fn.toggle;v.fn.extend({css:function(e,n){return v.access(this,function(e,n,r){return r!==t?v.style(e,n,r):v.css(e,n)},e,n,arguments.length>1)},show:function(){return Yt(this,!0)},hide:function(){return Yt(this)},toggle:function(e,t){var n=typeof e=="boolean";return v.isFunction(e)&&v.isFunction(t)?Kt.apply(this,arguments):this.each(function(){(n?e:Gt(this))?v(this).show():v(this).hide()})}}),v.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Dt(e,"opacity");return n===""?"1":n}}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":v.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,n,r,i){if(!e||e.nodeType===3||e.nodeType===8||!e.style)return;var s,o,u,a=v.camelCase(n),f=e.style;n=v.cssProps[a]||(v.cssProps[a]=Qt(f,a)),u=v.cssHooks[n]||v.cssHooks[a];if(r===t)return u&&"get"in u&&(s=u.get(e,!1,i))!==t?s:f[n];o=typeof r,o==="string"&&(s=zt.exec(r))&&(r=(s[1]+1)*s[2]+parseFloat(v.css(e,n)),o="number");if(r==null||o==="number"&&isNaN(r))return;o==="number"&&!v.cssNumber[a]&&(r+="px");if(!u||!("set"in u)||(r=u.set(e,r,i))!==t)try{f[n]=r}catch(l){}},css:function(e,n,r,i){var s,o,u,a=v.camelCase(n);return n=v.cssProps[a]||(v.cssProps[a]=Qt(e.style,a)),u=v.cssHooks[n]||v.cssHooks[a],u&&"get"in u&&(s=u.get(e,!0,i)),s===t&&(s=Dt(e,n)),s==="normal"&&n in Vt&&(s=Vt[n]),r||i!==t?(o=parseFloat(s),r||v.isNumeric(o)?o||0:s):s},swap:function(e,t,n){var r,i,s={};for(i in t)s[i]=e.style[i],e.style[i]=t[i];r=n.call(e);for(i in t)e.style[i]=s[i];return r}}),e.getComputedStyle?Dt=function(t,n){var r,i,s,o,u=e.getComputedStyle(t,null),a=t.style;return u&&(r=u[n],r===""&&!v.contains(t.ownerDocument,t)&&(r=v.style(t,n)),Ut.test(r)&&qt.test(n)&&(i=a.width,s=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=r,r=u.width,a.width=i,a.minWidth=s,a.maxWidth=o)),r}:i.documentElement.currentStyle&&(Dt=function(e,t){var n,r,i=e.currentStyle&&e.currentStyle[t],s=e.style;return i==null&&s&&s[t]&&(i=s[t]),Ut.test(i)&&!Ft.test(t)&&(n=s.left,r=e.runtimeStyle&&e.runtimeStyle.left,r&&(e.runtimeStyle.left=e.currentStyle.left),s.left=t==="fontSize"?"1em":i,i=s.pixelLeft+"px",s.left=n,r&&(e.runtimeStyle.left=r)),i===""?"auto":i}),v.each(["height","width"],function(e,t){v.cssHooks[t]={get:function(e,n,r){if(n)return e.offsetWidth===0&&It.test(Dt(e,"display"))?v.swap(e,Xt,function(){return tn(e,t,r)}):tn(e,t,r)},set:function(e,n,r){return Zt(e,n,r?en(e,t,r,v.support.boxSizing&&v.css(e,"boxSizing")==="border-box"):0)}}}),v.support.opacity||(v.cssHooks.opacity={get:function(e,t){return jt.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,r=e.currentStyle,i=v.isNumeric(t)?"alpha(opacity="+t*100+")":"",s=r&&r.filter||n.filter||"";n.zoom=1;if(t>=1&&v.trim(s.replace(Bt,""))===""&&n.removeAttribute){n.removeAttribute("filter");if(r&&!r.filter)return}n.filter=Bt.test(s)?s.replace(Bt,i):s+" "+i}}),v(function(){v.support.reliableMarginRight||(v.cssHooks.marginRight={get:function(e,t){return v.swap(e,{display:"inline-block"},function(){if(t)return Dt(e,"marginRight")})}}),!v.support.pixelPosition&&v.fn.position&&v.each(["top","left"],function(e,t){v.cssHooks[t]={get:function(e,n){if(n){var r=Dt(e,t);return Ut.test(r)?v(e).position()[t]+"px":r}}}})}),v.expr&&v.expr.filters&&(v.expr.filters.hidden=function(e){return e.offsetWidth===0&&e.offsetHeight===0||!v.support.reliableHiddenOffsets&&(e.style&&e.style.display||Dt(e,"display"))==="none"},v.expr.filters.visible=function(e){return!v.expr.filters.hidden(e)}),v.each({margin:"",padding:"",border:"Width"},function(e,t){v.cssHooks[e+t]={expand:function(n){var r,i=typeof n=="string"?n.split(" "):[n],s={};for(r=0;r<4;r++)s[e+$t[r]+t]=i[r]||i[r-2]||i[0];return s}},qt.test(e)||(v.cssHooks[e+t].set=Zt)});var rn=/%20/g,sn=/\[\]$/,on=/\r?\n/g,un=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,an=/^(?:select|textarea)/i;v.fn.extend({serialize:function(){return v.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?v.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||an.test(this.nodeName)||un.test(this.type))}).map(function(e,t){var n=v(this).val();return n==null?null:v.isArray(n)?v.map(n,function(e,n){return{name:t.name,value:e.replace(on,"\r\n")}}):{name:t.name,value:n.replace(on,"\r\n")}}).get()}}),v.param=function(e,n){var r,i=[],s=function(e,t){t=v.isFunction(t)?t():t==null?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};n===t&&(n=v.ajaxSettings&&v.ajaxSettings.traditional);if(v.isArray(e)||e.jquery&&!v.isPlainObject(e))v.each(e,function(){s(this.name,this.value)});else for(r in e)fn(r,e[r],n,s);return i.join("&").replace(rn,"+")};var ln,cn,hn=/#.*$/,pn=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,dn=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,vn=/^(?:GET|HEAD)$/,mn=/^\/\//,gn=/\?/,yn=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,bn=/([?&])_=[^&]*/,wn=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,En=v.fn.load,Sn={},xn={},Tn=["*/"]+["*"];try{cn=s.href}catch(Nn){cn=i.createElement("a"),cn.href="",cn=cn.href}ln=wn.exec(cn.toLowerCase())||[],v.fn.load=function(e,n,r){if(typeof e!="string"&&En)return En.apply(this,arguments);if(!this.length)return this;var i,s,o,u=this,a=e.indexOf(" ");return a>=0&&(i=e.slice(a,e.length),e=e.slice(0,a)),v.isFunction(n)?(r=n,n=t):n&&typeof n=="object"&&(s="POST"),v.ajax({url:e,type:s,dataType:"html",data:n,complete:function(e,t){r&&u.each(r,o||[e.responseText,t,e])}}).done(function(e){o=arguments,u.html(i?v("<div>").append(e.replace(yn,"")).find(i):e)}),this},v.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(e,t){v.fn[t]=function(e){return this.on(t,e)}}),v.each(["get","post"],function(e,n){v[n]=function(e,r,i,s){return v.isFunction(r)&&(s=s||i,i=r,r=t),v.ajax({type:n,url:e,data:r,success:i,dataType:s})}}),v.extend({getScript:function(e,n){return v.get(e,t,n,"script")},getJSON:function(e,t,n){return v.get(e,t,n,"json")},ajaxSetup:function(e,t){return t?Ln(e,v.ajaxSettings):(t=e,e=v.ajaxSettings),Ln(e,t),e},ajaxSettings:{url:cn,isLocal:dn.test(ln[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":Tn},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":e.String,"text html":!0,"text json":v.parseJSON,"text xml":v.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:Cn(Sn),ajaxTransport:Cn(xn),ajax:function(e,n){function T(e,n,s,a){var l,y,b,w,S,T=n;if(E===2)return;E=2,u&&clearTimeout(u),o=t,i=a||"",x.readyState=e>0?4:0,s&&(w=An(c,x,s));if(e>=200&&e<300||e===304)c.ifModified&&(S=x.getResponseHeader("Last-Modified"),S&&(v.lastModified[r]=S),S=x.getResponseHeader("Etag"),S&&(v.etag[r]=S)),e===304?(T="notmodified",l=!0):(l=On(c,w),T=l.state,y=l.data,b=l.error,l=!b);else{b=T;if(!T||e)T="error",e<0&&(e=0)}x.status=e,x.statusText=(n||T)+"",l?d.resolveWith(h,[y,T,x]):d.rejectWith(h,[x,T,b]),x.statusCode(g),g=t,f&&p.trigger("ajax"+(l?"Success":"Error"),[x,c,l?y:b]),m.fireWith(h,[x,T]),f&&(p.trigger("ajaxComplete",[x,c]),--v.active||v.event.trigger("ajaxStop"))}typeof e=="object"&&(n=e,e=t),n=n||{};var r,i,s,o,u,a,f,l,c=v.ajaxSetup({},n),h=c.context||c,p=h!==c&&(h.nodeType||h instanceof v)?v(h):v.event,d=v.Deferred(),m=v.Callbacks("once memory"),g=c.statusCode||{},b={},w={},E=0,S="canceled",x={readyState:0,setRequestHeader:function(e,t){if(!E){var n=e.toLowerCase();e=w[n]=w[n]||e,b[e]=t}return this},getAllResponseHeaders:function(){return E===2?i:null},getResponseHeader:function(e){var n;if(E===2){if(!s){s={};while(n=pn.exec(i))s[n[1].toLowerCase()]=n[2]}n=s[e.toLowerCase()]}return n===t?null:n},overrideMimeType:function(e){return E||(c.mimeType=e),this},abort:function(e){return e=e||S,o&&o.abort(e),T(0,e),this}};d.promise(x),x.success=x.done,x.error=x.fail,x.complete=m.add,x.statusCode=function(e){if(e){var t;if(E<2)for(t in e)g[t]=[g[t],e[t]];else t=e[x.status],x.always(t)}return this},c.url=((e||c.url)+"").replace(hn,"").replace(mn,ln[1]+"//"),c.dataTypes=v.trim(c.dataType||"*").toLowerCase().split(y),c.crossDomain==null&&(a=wn.exec(c.url.toLowerCase())||!1,c.crossDomain=a&&a.join(":")+(a[3]?"":a[1]==="http:"?80:443)!==ln.join(":")+(ln[3]?"":ln[1]==="http:"?80:443)),c.data&&c.processData&&typeof c.data!="string"&&(c.data=v.param(c.data,c.traditional)),kn(Sn,c,n,x);if(E===2)return x;f=c.global,c.type=c.type.toUpperCase(),c.hasContent=!vn.test(c.type),f&&v.active++===0&&v.event.trigger("ajaxStart");if(!c.hasContent){c.data&&(c.url+=(gn.test(c.url)?"&":"?")+c.data,delete c.data),r=c.url;if(c.cache===!1){var N=v.now(),C=c.url.replace(bn,"$1_="+N);c.url=C+(C===c.url?(gn.test(c.url)?"&":"?")+"_="+N:"")}}(c.data&&c.hasContent&&c.contentType!==!1||n.contentType)&&x.setRequestHeader("Content-Type",c.contentType),c.ifModified&&(r=r||c.url,v.lastModified[r]&&x.setRequestHeader("If-Modified-Since",v.lastModified[r]),v.etag[r]&&x.setRequestHeader("If-None-Match",v.etag[r])),x.setRequestHeader("Accept",c.dataTypes[0]&&c.accepts[c.dataTypes[0]]?c.accepts[c.dataTypes[0]]+(c.dataTypes[0]!=="*"?", "+Tn+"; q=0.01":""):c.accepts["*"]);for(l in c.headers)x.setRequestHeader(l,c.headers[l]);if(!c.beforeSend||c.beforeSend.call(h,x,c)!==!1&&E!==2){S="abort";for(l in{success:1,error:1,complete:1})x[l](c[l]);o=kn(xn,c,n,x);if(!o)T(-1,"No Transport");else{x.readyState=1,f&&p.trigger("ajaxSend",[x,c]),c.async&&c.timeout>0&&(u=setTimeout(function(){x.abort("timeout")},c.timeout));try{E=1,o.send(b,T)}catch(k){if(!(E<2))throw k;T(-1,k)}}return x}return x.abort()},active:0,lastModified:{},etag:{}});var Mn=[],_n=/\?/,Dn=/(=)\?(?=&|$)|\?\?/,Pn=v.now();v.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Mn.pop()||v.expando+"_"+Pn++;return this[e]=!0,e}}),v.ajaxPrefilter("json jsonp",function(n,r,i){var s,o,u,a=n.data,f=n.url,l=n.jsonp!==!1,c=l&&Dn.test(f),h=l&&!c&&typeof a=="string"&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&Dn.test(a);if(n.dataTypes[0]==="jsonp"||c||h)return s=n.jsonpCallback=v.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,o=e[s],c?n.url=f.replace(Dn,"$1"+s):h?n.data=a.replace(Dn,"$1"+s):l&&(n.url+=(_n.test(f)?"&":"?")+n.jsonp+"="+s),n.converters["script json"]=function(){return u||v.error(s+" was not called"),u[0]},n.dataTypes[0]="json",e[s]=function(){u=arguments},i.always(function(){e[s]=o,n[s]&&(n.jsonpCallback=r.jsonpCallback,Mn.push(s)),u&&v.isFunction(o)&&o(u[0]),u=o=t}),"script"}),v.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(e){return v.globalEval(e),e}}}),v.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),v.ajaxTransport("script",function(e){if(e.crossDomain){var n,r=i.head||i.getElementsByTagName("head")[0]||i.documentElement;return{send:function(s,o){n=i.createElement("script"),n.async="async",e.scriptCharset&&(n.charset=e.scriptCharset),n.src=e.url,n.onload=n.onreadystatechange=function(e,i){if(i||!n.readyState||/loaded|complete/.test(n.readyState))n.onload=n.onreadystatechange=null,r&&n.parentNode&&r.removeChild(n),n=t,i||o(200,"success")},r.insertBefore(n,r.firstChild)},abort:function(){n&&n.onload(0,1)}}}});var Hn,Bn=e.ActiveXObject?function(){for(var e in Hn)Hn[e](0,1)}:!1,jn=0;v.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&Fn()||In()}:Fn,function(e){v.extend(v.support,{ajax:!!e,cors:!!e&&"withCredentials"in e})}(v.ajaxSettings.xhr()),v.support.ajax&&v.ajaxTransport(function(n){if(!n.crossDomain||v.support.cors){var r;return{send:function(i,s){var o,u,a=n.xhr();n.username?a.open(n.type,n.url,n.async,n.username,n.password):a.open(n.type,n.url,n.async);if(n.xhrFields)for(u in n.xhrFields)a[u]=n.xhrFields[u];n.mimeType&&a.overrideMimeType&&a.overrideMimeType(n.mimeType),!n.crossDomain&&!i["X-Requested-With"]&&(i["X-Requested-With"]="XMLHttpRequest");try{for(u in i)a.setRequestHeader(u,i[u])}catch(f){}a.send(n.hasContent&&n.data||null),r=function(e,i){var u,f,l,c,h;try{if(r&&(i||a.readyState===4)){r=t,o&&(a.onreadystatechange=v.noop,Bn&&delete Hn[o]);if(i)a.readyState!==4&&a.abort();else{u=a.status,l=a.getAllResponseHeaders(),c={},h=a.responseXML,h&&h.documentElement&&(c.xml=h);try{c.text=a.responseText}catch(e){}try{f=a.statusText}catch(p){f=""}!u&&n.isLocal&&!n.crossDomain?u=c.text?200:404:u===1223&&(u=204)}}}catch(d){i||s(-1,d)}c&&s(u,f,c,l)},n.async?a.readyState===4?setTimeout(r,0):(o=++jn,Bn&&(Hn||(Hn={},v(e).unload(Bn)),Hn[o]=r),a.onreadystatechange=r):r()},abort:function(){r&&r(0,1)}}}});var qn,Rn,Un=/^(?:toggle|show|hide)$/,zn=new RegExp("^(?:([-+])=|)("+m+")([a-z%]*)$","i"),Wn=/queueHooks$/,Xn=[Gn],Vn={"*":[function(e,t){var n,r,i=this.createTween(e,t),s=zn.exec(t),o=i.cur(),u=+o||0,a=1,f=20;if(s){n=+s[2],r=s[3]||(v.cssNumber[e]?"":"px");if(r!=="px"&&u){u=v.css(i.elem,e,!0)||n||1;do a=a||".5",u/=a,v.style(i.elem,e,u+r);while(a!==(a=i.cur()/o)&&a!==1&&--f)}i.unit=r,i.start=u,i.end=s[1]?u+(s[1]+1)*n:n}return i}]};v.Animation=v.extend(Kn,{tweener:function(e,t){v.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;r<i;r++)n=e[r],Vn[n]=Vn[n]||[],Vn[n].unshift(t)},prefilter:function(e,t){t?Xn.unshift(e):Xn.push(e)}}),v.Tween=Yn,Yn.prototype={constructor:Yn,init:function(e,t,n,r,i,s){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=s||(v.cssNumber[n]?"":"px")},cur:function(){var e=Yn.propHooks[this.prop];return e&&e.get?e.get(this):Yn.propHooks._default.get(this)},run:function(e){var t,n=Yn.propHooks[this.prop];return this.options.duration?this.pos=t=v.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Yn.propHooks._default.set(this),this}},Yn.prototype.init.prototype=Yn.prototype,Yn.propHooks={_default:{get:function(e){var t;return e.elem[e.prop]==null||!!e.elem.style&&e.elem.style[e.prop]!=null?(t=v.css(e.elem,e.prop,!1,""),!t||t==="auto"?0:t):e.elem[e.prop]},set:function(e){v.fx.step[e.prop]?v.fx.step[e.prop](e):e.elem.style&&(e.elem.style[v.cssProps[e.prop]]!=null||v.cssHooks[e.prop])?v.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},Yn.propHooks.scrollTop=Yn.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},v.each(["toggle","show","hide"],function(e,t){var n=v.fn[t];v.fn[t]=function(r,i,s){return r==null||typeof r=="boolean"||!e&&v.isFunction(r)&&v.isFunction(i)?n.apply(this,arguments):this.animate(Zn(t,!0),r,i,s)}}),v.fn.extend({fadeTo:function(e,t,n,r){return this.filter(Gt).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=v.isEmptyObject(e),s=v.speed(t,n,r),o=function(){var t=Kn(this,v.extend({},e),s);i&&t.stop(!0)};return i||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(e,n,r){var i=function(e){var t=e.stop;delete e.stop,t(r)};return typeof e!="string"&&(r=n,n=e,e=t),n&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=e!=null&&e+"queueHooks",s=v.timers,o=v._data(this);if(n)o[n]&&o[n].stop&&i(o[n]);else for(n in o)o[n]&&o[n].stop&&Wn.test(n)&&i(o[n]);for(n=s.length;n--;)s[n].elem===this&&(e==null||s[n].queue===e)&&(s[n].anim.stop(r),t=!1,s.splice(n,1));(t||!r)&&v.dequeue(this,e)})}}),v.each({slideDown:Zn("show"),slideUp:Zn("hide"),slideToggle:Zn("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){v.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),v.speed=function(e,t,n){var r=e&&typeof e=="object"?v.extend({},e):{complete:n||!n&&t||v.isFunction(e)&&e,duration:e,easing:n&&t||t&&!v.isFunction(t)&&t};r.duration=v.fx.off?0:typeof r.duration=="number"?r.duration:r.duration in v.fx.speeds?v.fx.speeds[r.duration]:v.fx.speeds._default;if(r.queue==null||r.queue===!0)r.queue="fx";return r.old=r.complete,r.complete=function(){v.isFunction(r.old)&&r.old.call(this),r.queue&&v.dequeue(this,r.queue)},r},v.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},v.timers=[],v.fx=Yn.prototype.init,v.fx.tick=function(){var e,t=v.timers,n=0;for(;n<t.length;n++)e=t[n],!e()&&t[n]===e&&t.splice(n--,1);t.length||v.fx.stop()},v.fx.timer=function(e){e()&&v.timers.push(e)&&!Rn&&(Rn=setInterval(v.fx.tick,v.fx.interval))},v.fx.interval=13,v.fx.stop=function(){clearInterval(Rn),Rn=null},v.fx.speeds={slow:600,fast:200,_default:400},v.fx.step={},v.expr&&v.expr.filters&&(v.expr.filters.animated=function(e){return v.grep(v.timers,function(t){return e===t.elem}).length});var er=/^(?:body|html)$/i;v.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){v.offset.setOffset(this,e,t)});var n,r,i,s,o,u,a,f={top:0,left:0},l=this[0],c=l&&l.ownerDocument;if(!c)return;return(r=c.body)===l?v.offset.bodyOffset(l):(n=c.documentElement,v.contains(n,l)?(typeof l.getBoundingClientRect!="undefined"&&(f=l.getBoundingClientRect()),i=tr(c),s=n.clientTop||r.clientTop||0,o=n.clientLeft||r.clientLeft||0,u=i.pageYOffset||n.scrollTop,a=i.pageXOffset||n.scrollLeft,{top:f.top+u-s,left:f.left+a-o}):f)},v.offset={bodyOffset:function(e){var t=e.offsetTop,n=e.offsetLeft;return v.support.doesNotIncludeMarginInBodyOffset&&(t+=parseFloat(v.css(e,"marginTop"))||0,n+=parseFloat(v.css(e,"marginLeft"))||0),{top:t,left:n}},setOffset:function(e,t,n){var r=v.css(e,"position");r==="static"&&(e.style.position="relative");var i=v(e),s=i.offset(),o=v.css(e,"top"),u=v.css(e,"left"),a=(r==="absolute"||r==="fixed")&&v.inArray("auto",[o,u])>-1,f={},l={},c,h;a?(l=i.position(),c=l.top,h=l.left):(c=parseFloat(o)||0,h=parseFloat(u)||0),v.isFunction(t)&&(t=t.call(e,n,s)),t.top!=null&&(f.top=t.top-s.top+c),t.left!=null&&(f.left=t.left-s.left+h),"using"in t?t.using.call(e,f):i.css(f)}},v.fn.extend({position:function(){if(!this[0])return;var e=this[0],t=this.offsetParent(),n=this.offset(),r=er.test(t[0].nodeName)?{top:0,left:0}:t.offset();return n.top-=parseFloat(v.css(e,"marginTop"))||0,n.left-=parseFloat(v.css(e,"marginLeft"))||0,r.top+=parseFloat(v.css(t[0],"borderTopWidth"))||0,r.left+=parseFloat(v.css(t[0],"borderLeftWidth"))||0,{top:n.top-r.top,left:n.left-r.left}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||i.body;while(e&&!er.test(e.nodeName)&&v.css(e,"position")==="static")e=e.offsetParent;return e||i.body})}}),v.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var r=/Y/.test(n);v.fn[e]=function(i){return v.access(this,function(e,i,s){var o=tr(e);if(s===t)return o?n in o?o[n]:o.document.documentElement[i]:e[i];o?o.scrollTo(r?v(o).scrollLeft():s,r?s:v(o).scrollTop()):e[i]=s},e,i,arguments.length,null)}}),v.each({Height:"height",Width:"width"},function(e,n){v.each({padding:"inner"+e,content:n,"":"outer"+e},function(r,i){v.fn[i]=function(i,s){var o=arguments.length&&(r||typeof i!="boolean"),u=r||(i===!0||s===!0?"margin":"border");return v.access(this,function(n,r,i){var s;return v.isWindow(n)?n.document.documentElement["client"+e]:n.nodeType===9?(s=n.documentElement,Math.max(n.body["scroll"+e],s["scroll"+e],n.body["offset"+e],s["offset"+e],s["client"+e])):i===t?v.css(n,r,i,u):v.style(n,r,i,u)},n,o?i:t,o,null)}})}),e.jQuery=e.$=v,typeof define=="function"&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return v})}(window),function(){var e=this,t=e.Backbone,n=Array.prototype.slice,r=Array.prototype.splice,i;typeof exports!="undefined"?i=exports:i=e.Backbone={},i.VERSION="0.9.2";var s=e._;!s&&typeof require!="undefined"&&(s=require("underscore"));var o=e.jQuery||e.Zepto||e.ender;i.setDomLibrary=function(e){o=e},i.noConflict=function(){return e.Backbone=t,this},i.emulateHTTP=!1,i.emulateJSON=!1;var u=/\s+/,a=i.Events={on:function(e,t,n){var r,i,s,o,a;if(!t)return this;e=e.split(u),r=this._callbacks||(this._callbacks={});while(i=e.shift())a=r[i],s=a?a.tail:{},s.next=o={},s.context=n,s.callback=t,r[i]={tail:o,next:a?a.next:s};return this},off:function(e,t,n){var r,i,o,a,f,l;if(!(i=this._callbacks))return;if(!(e||t||n))return delete this._callbacks,this;e=e?e.split(u):s.keys(i);while(r=e.shift()){o=i[r],delete i[r];if(!o||!t&&!n)continue;a=o.tail;while((o=o.next)!==a)f=o.callback,l=o.context,(t&&f!==t||n&&l!==n)&&this.on(r,f,l)}return this},trigger:function(e){var t,r,i,s,o,a,f;if(!(i=this._callbacks))return this;a=i.all,e=e.split(u),f=n.call(arguments,1);while(t=e.shift()){if(r=i[t]){s=r.tail;while((r=r.next)!==s)r.callback.apply(r.context||this,f)}if(r=a){s=r.tail,o=[t].concat(f);while((r=r.next)!==s)r.callback.apply(r.context||this,o)}}return this}};a.bind=a.on,a.unbind=a.off;var f=i.Model=function(e,t){var n;e||(e={}),t&&t.parse&&(e=this.parse(e));if(n=C(this,"defaults"))e=s.extend({},n,e);t&&t.collection&&(this.collection=t.collection),this.attributes={},this._escapedAttributes={},this.cid=s.uniqueId("c"),this.changed={},this._silent={},this._pending={},this.set(e,{silent:!0}),this.changed={},this._silent={},this._pending={},this._previousAttributes=s.clone(this.attributes),this.initialize.apply(this,arguments)};s.extend(f.prototype,a,{changed:null,_silent:null,_pending:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return s.clone(this.attributes)},get:function(e){return this.attributes[e]},escape:function(e){var t;if(t=this._escapedAttributes[e])return t;var n=this.get(e);return this._escapedAttributes[e]=s.escape(n==null?"":""+n)},has:function(e){return this.get(e)!=null},set:function(e,t,n){var r,i,o;s.isObject(e)||e==null?(r=e,n=t):(r={},r[e]=t),n||(n={});if(!r)return this;r instanceof f&&(r=r.attributes);if(n.unset)for(i in r)r[i]=void 0;if(!this._validate(r,n))return!1;this.idAttribute in r&&(this.id=r[this.idAttribute]);var u=n.changes={},a=this.attributes,l=this._escapedAttributes,c=this._previousAttributes||{};for(i in r){o=r[i];if(!s.isEqual(a[i],o)||n.unset&&s.has(a,i))delete l[i],(n.silent?this._silent:u)[i]=!0;n.unset?delete a[i]:a[i]=o,!s.isEqual(c[i],o)||s.has(a,i)!=s.has(c,i)?(this.changed[i]=o,n.silent||(this._pending[i]=!0)):(delete this.changed[i],delete this._pending[i])}return n.silent||this.change(n),this},unset:function(e,t){return(t||(t={})).unset=!0,this.set(e,null,t)},clear:function(e){return(e||(e={})).unset=!0,this.set(s.clone(this.attributes),e)},fetch:function(e){e=e?s.clone(e):{};var t=this,n=e.success;return e.success=function(r,i,s){if(!t.set(t.parse(r,s),e))return!1;n&&n(t,r)},e.error=i.wrapError(e.error,t,e),(this.sync||i.sync).call(this,"read",this,e)},save:function(e,t,n){var r,o;s.isObject(e)||e==null?(r=e,n=t):(r={},r[e]=t),n=n?s.clone(n):{};if(n.wait){if(!this._validate(r,n))return!1;o=s.clone(this.attributes)}var u=s.extend({},n,{silent:!0});if(r&&!this.set(r,n.wait?u:n))return!1;var a=this,f=n.success;n.success=function(e,t,i){var o=a.parse(e,i);n.wait&&(delete n.wait,o=s.extend(r||{},o));if(!a.set(o,n))return!1;f?f(a,e):a.trigger("sync",a,e,n)},n.error=i.wrapError(n.error,a,n);var l=this.isNew()?"create":"update",c=(this.sync||i.sync).call(this,l,this,n);return n.wait&&this.set(o,u),c},destroy:function(e){e=e?s.clone(e):{};var t=this,n=e.success,r=function(){t.trigger("destroy",t,t.collection,e)};if(this.isNew())return r(),!1;e.success=function(i){e.wait&&r(),n?n(t,i):t.trigger("sync",t,i,e)},e.error=i.wrapError(e.error,t,e);var o=(this.sync||i.sync).call(this,"delete",this,e);return e.wait||r(),o},url:function(){var e=C(this,"urlRoot")||C(this.collection,"url")||k();return this.isNew()?e:e+(e.charAt(e.length-1)=="/"?"":"/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},change:function(e){e||(e={});var t=this._changing;this._changing=!0;for(var n in this._silent)this._pending[n]=!0;var r=s.extend({},e.changes,this._silent);this._silent={};for(var n in r)this.trigger("change:"+n,this,this.get(n),e);if(t)return this;while(!s.isEmpty(this._pending)){this._pending={},this.trigger("change",this,e);for(var n in this.changed){if(this._pending[n]||this._silent[n])continue;delete this.changed[n]}this._previousAttributes=s.clone(this.attributes)}return this._changing=!1,this},hasChanged:function(e){return arguments.length?s.has(this.changed,e):!s.isEmpty(this.changed)},changedAttributes:function(e){if(!e)return this.hasChanged()?s.clone(this.changed):!1;var t,n=!1,r=this._previousAttributes;for(var i in e){if(s.isEqual(r[i],t=e[i]))continue;(n||(n={}))[i]=t}return n},previous:function(e){return!arguments.length||!this._previousAttributes?null:this._previousAttributes[e]},previousAttributes:function(){return s.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},_validate:function(e,t){if(t.silent||!this.validate)return!0;e=s.extend({},this.attributes,e);var n=this.validate(e,t);return n?(t&&t.error?t.error(this,n,t):this.trigger("error",this,n,t),!1):!0}});var l=i.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,{silent:!0,parse:t.parse})};s.extend(l.prototype,a,{model:f,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},add:function(e,t){var n,i,o,u,a,f,l={},c={},h=[];t||(t={}),e=s.isArray(e)?e.slice():[e];for(n=0,o=e.length;n<o;n++){if(!(u=e[n]=this._prepareModel(e[n],t)))throw new Error("Can't add an invalid model to a collection");a=u.cid,f=u.id;if(l[a]||this._byCid[a]||f!=null&&(c[f]||this._byId[f])){h.push(n);continue}l[a]=c[f]=u}n=h.length;while(n--)e.splice(h[n],1);for(n=0,o=e.length;n<o;n++)(u=e[n]).on("all",this._onModelEvent,this),this._byCid[u.cid]=u,u.id!=null&&(this._byId[u.id]=u);this.length+=o,i=t.at!=null?t.at:this.models.length,r.apply(this.models,[i,0].concat(e)),this.comparator&&this.sort({silent:!0});if(t.silent)return this;for(n=0,o=this.models.length;n<o;n++){if(!l[(u=this.models[n]).cid])continue;t.index=n,u.trigger("add",u,this,t)}return this},remove:function(e,t){var n,r,i,o;t||(t={}),e=s.isArray(e)?e.slice():[e];for(n=0,r=e.length;n<r;n++){o=this.getByCid(e[n])||this.get(e[n]);if(!o)continue;delete this._byId[o.id],delete this._byCid[o.cid],i=this.indexOf(o),this.models.splice(i,1),this.length--,t.silent||(t.index=i,o.trigger("remove",o,this,t)),this._removeReference(o)}return this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,t),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,s.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},get:function(e){return e==null?void 0:this._byId[e.id!=null?e.id:e]},getByCid:function(e){return e&&this._byCid[e.cid||e]},at:function(e){return this.models[e]},where:function(e){return s.isEmpty(e)?[]:this.filter(function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},sort:function(e){e||(e={});if(!this.comparator)throw new Error("Cannot sort a set without a comparator");var t=s.bind(this.comparator,this);return this.comparator.length==1?this.models=this.sortBy(t):this.models.sort(t),e.silent||this.trigger("reset",this,e),this},pluck:function(e){return s.map(this.models,function(t){return t.get(e)})},reset:function(e,t){e||(e=[]),t||(t={});for(var n=0,r=this.models.length;n<r;n++)this._removeReference(this.models[n]);return this._reset(),this.add(e,s.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},fetch:function(e){e=e?s.clone(e):{},e.parse===undefined&&(e.parse=!0);var t=this,n=e.success;return e.success=function(r,i,s){t[e.add?"add":"reset"](t.parse(r,s),e),n&&n(t,r)},e.error=i.wrapError(e.error,t,e),(this.sync||i.sync).call(this,"read",this,e)},create:function(e,t){var n=this;t=t?s.clone(t):{},e=this._prepareModel(e,t);if(!e)return!1;t.wait||n.add(e,t);var r=t.success;return t.success=function(i,s,o){t.wait&&n.add(i,t),r?r(i,s):i.trigger("sync",e,s,t)},e.save(null,t),e},parse:function(e,t){return e},chain:function(){return s(this.models).chain()},_reset:function(e){this.length=0,this.models=[],this._byId={},this._byCid={}},_prepareModel:function(e,t){t||(t={});if(e instanceof f)e.collection||(e.collection=this);else{var n=e;t.collection=this,e=new this.model(n,t),e._validate(e.attributes,t)||(e=!1)}return e},_removeReference:function(e){this==e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if((e=="add"||e=="remove")&&n!=this)return;e=="destroy"&&this.remove(t,r),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],this._byId[t.id]=t),this.trigger.apply(this,arguments)}});var c=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","initial","rest","last","without","indexOf","shuffle","lastIndexOf","isEmpty","groupBy"];s.each(c,function(e){l.prototype[e]=function(){return s[e].apply(s,[this.models].concat(s.toArray(arguments)))}});var h=i.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},p=/:\w+/g,d=/\*\w+/g,v=/[-[\]{}()+?.,\\^$|#\s]/g;s.extend(h.prototype,a,{initialize:function(){},route:function(e,t,n){return i.history||(i.history=new m),s.isRegExp(e)||(e=this._routeToRegExp(e)),n||(n=this[t]),i.history.route(e,s.bind(function(r){var s=this._extractParameters(e,r);n&&n.apply(this,s),this.trigger.apply(this,["route:"+t].concat(s)),i.history.trigger("route",this,t,s)},this)),this},navigate:function(e,t){i.history.navigate(e,t)},_bindRoutes:function(){if(!this.routes)return;var e=[];for(var t in this.routes)e.unshift([t,this.routes[t]]);for(var n=0,r=e.length;n<r;n++)this.route(e[n][0],e[n][1],this[e[n][1]])},_routeToRegExp:function(e){return e=e.replace(v,"\\$&").replace(p,"([^/]+)").replace(d,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){return e.exec(t).slice(1)}});var m=i.History=function(){this.handlers=[],s.bindAll(this,"checkUrl")},g=/^[#\/]/,y=/msie [\w.]+/;m.started=!1,s.extend(m.prototype,a,{interval:50,getHash:function(e){var t=e?e.location:window.location,n=t.href.match(/#(.*)$/);return n?n[1]:""},getFragment:function(e,t){if(e==null)if(this._hasPushState||t){e=window.location.pathname;var n=window.location.search;n&&(e+=n)}else e=this.getHash();return e.indexOf(this.options.root)||(e=e.substr(this.options.root.length)),e.replace(g,"")},start:function(e){if(m.started)throw new Error("Backbone.history has already been started");m.started=!0,this.options=s.extend({},{root:"/"},this.options,e),this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&window.history&&window.history.pushState);var t=this.getFragment(),n=document.documentMode,r=y.exec(navigator.userAgent.toLowerCase())&&(!n||n<=7);r&&(this.iframe=o('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(t)),this._hasPushState?o(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?o(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=t;var i=window.location,u=i.pathname==this.options.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!u)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&u&&i.hash&&(this.fragment=this.getHash().replace(g,""),window.history.replaceState({},document.title,i.protocol+"//"+i.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},stop:function(){o(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),m.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();t==this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe)));if(t==this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(e){var t=this.fragment=this.getFragment(e),n=s.any(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0});return n},navigate:function(e,t){if(!m.started)return!1;if(!t||t===!0)t={trigger:t};var n=(e||"").replace(g,"");if(this.fragment==n)return;this._hasPushState?(n.indexOf(this.options.root)!=0&&(n=this.options.root+n),this.fragment=n,window.history[t.replace?"replaceState":"pushState"]({},document.title,n)):this._wantsHashChange?(this.fragment=n,this._updateHash(window.location,n,t.replace),this.iframe&&n!=this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,n,t.replace))):window.location.assign(this.options.root+e),t.trigger&&this.loadUrl(e)},_updateHash:function(e,t,n){n?e.replace(e.toString().replace(/(javascript:|#).*$/,"")+"#"+t):e.hash=t}});var b=i.View=function(e){this.cid=s.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},w=/^(\S+)\s*(.*)$/,E=["model","collection","el","id","attributes","className","tagName"];s.extend(b.prototype,a,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this},make:function(e,t,n){var r=document.createElement(e);return t&&o(r).attr(t),n&&o(r).html(n),r},setElement:function(e,t){return this.$el&&this.undelegateEvents(),this.$el=e instanceof o?e:o(e),this.el=this.$el[0],t!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=C(this,"events")))return;this.undelegateEvents();for(var t in e){var n=e[t];s.isFunction(n)||(n=this[e[t]]);if(!n)throw new Error('Method "'+e[t]+'" does not exist');var r=t.match(w),i=r[1],o=r[2];n=s.bind(n,this),i+=".delegateEvents"+this.cid,o===""?this.$el.bind(i,n):this.$el.delegate(o,i,n)}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(e){this.options&&(e=s.extend({},this.options,e));for(var t=0,n=E.length;t<n;t++){var r=E[t];e[r]&&(this[r]=e[r])}this.options=e},_ensureElement:function(){if(!this.el){var e=C(this,"attributes")||{};this.id&&(e.id=this.id),this.className&&(e["class"]=this.className),this.setElement(this.make(this.tagName,e),!1)}else this.setElement(this.el,!1)}});var S=function(e,t){var n=N(this,e,t);return n.extend=this.extend,n};f.extend=l.extend=h.extend=b.extend=S;var x={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};i.sync=function(e,t,n){var r=x[e];n||(n={});var u={type:r,dataType:"json"};return n.url||(u.url=C(t,"url")||k()),!n.data&&t&&(e=="create"||e=="update")&&(u.contentType="application/json",u.data=JSON.stringify(t.toJSON())),i.emulateJSON&&(u.contentType="application/x-www-form-urlencoded",u.data=u.data?{model:u.data}:{}),i.emulateHTTP&&(r==="PUT"||r==="DELETE")&&(i.emulateJSON&&(u.data._method=r),u.type="POST",u.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",r)}),u.type!=="GET"&&!i.emulateJSON&&(u.processData=!1),o.ajax(s.extend(u,n))},i.wrapError=function(e,t,n){return function(r,i){i=r===t?i:r,e?e(t,i,n):t.trigger("error",t,i,n)}};var T=function(){},N=function(e,t,n){var r;return t&&t.hasOwnProperty("constructor")?r=t.constructor:r=function(){e.apply(this,arguments)},s.extend(r,e),T.prototype=e.prototype,r.prototype=new T,t&&s.extend(r.prototype,t),n&&s.extend(r,n),r.prototype.constructor=r,r.__super__=e.prototype,r},C=function(e,t){return!e||!e[t]?null:s.isFunction(e[t])?e[t]():e[t]},k=function(){throw new Error('A "url" property or function must be specified')}}.call(this),define("backbone",["underscore","jquery"],function(e){return function(){var t,n;return t||e.Backbone}}(this)),define("text",["module"],function(e){var t,n,r=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],i=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,s=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,o=typeof location!="undefined"&&location.href,u=o&&location.protocol&&location.protocol.replace(/\:/,""),a=o&&location.hostname,f=o&&(location.port||undefined),l=[],c=e.config&&e.config()||{};t={version:"2.0.3",strip:function(e){if(e){e=e.replace(i,"");var t=e.match(s);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:c.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=r[t];try{e=new ActiveXObject(n)}catch(i){}if(e){r=[n];break}}return e},parseName:function(e){var t=!1,n=e.indexOf("."),r=e.substring(0,n),i=e.substring(n+1,e.length);return n=i.indexOf("!"),n!==-1&&(t=i.substring(n+1,i.length),t=t==="strip",i=i.substring(0,n)),{moduleName:r,ext:i,strip:t}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,c.isBuild&&(l[e]=r),i(r)},load:function(e,n,r,i){if(i.isBuild&&!i.inlineText){r();return}c.isBuild=i.isBuild;var s=t.parseName(e),l=s.moduleName+"."+s.ext,h=n.toUrl(l),p=c.useXhr||t.useXhr;!o||p(h,u,a,f)?t.get(h,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([l],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(l.hasOwnProperty(n)){var s=t.jsEscape(l[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.moduleName+"."+o.ext,a=r.toUrl(o.moduleName+"."+o.ext)+".js";t.load(u,r,function(n){var r=function(e){return i(a,e)};r.asModule=function(e,t){return i.asModule(e,a,t)},t.write(e,u,r,s)},s)}};if(c.env==="node"||!c.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node)n=require.nodeRequire("fs"),t.get=function(e,t){var r=n.readFileSync(e,"utf8");r.indexOf("ï»¿")===0&&(r=r.substring(1)),t(r)};else if(c.env==="xhr"||!c.env&&t.createXhr())t.get=function(e,n,r){var i=t.createXhr();i.open("GET",e,!0),c.onXhr&&c.onXhr(i,e),i.onreadystatechange=function(t){var s,o;i.readyState===4&&(s=i.status,s>399&&s<600?(o=new Error(e+" HTTP status: "+s),o.xhr=i,r(o)):n(i.responseText))},i.send(null)};else if(c.env==="rhino"||!c.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};return t}),define("text!ui/css/views.css",[],function(){return"/**\n * Main\n */\n@font-face {\n	font-family: 'SourceCodeProSemibold';\n	src: url('data:application/x-font-ttf;base64,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') format('truetype');\n	font-weight: normal;\n	font-style: normal;\n}\n\n#viewport-ui {\n	font-family: 'SourceCodeProSemibold', sans-serif;\n	/**\n	 * Don't let people accidently highlight text.\n	 */\n	-webkit-touch-callout: none;\n	-webkit-user-select: none;\n	-khtml-user-select: none;\n	-moz-user-select: none;\n	-ms-user-select: none;\n	user-select: none;\n\n}\n\n#viewport-ui .pointer {\n	display: none;\n	position: absolute;\n	top: 0;\n	left: 0;\n	width: 1em;\n	height: 1em;\n	background: #f00;\n	z-index: 1;\n	/* Don't let elementFromPoint() return the actual pointer */\n	pointer-events: none;\n}\n\n#viewport-ui.active .pointer {\n	display: inline-block;\n}\n\n/**\n * Views\n */\n#hud {\n	display: none;\n}\n\n#hud .fps {\n	position: absolute;\n	top: 1em;\n	right: 1em;\n}\n\n#scoreboard {\n	position: absolute;\n	top: 25%;\n	left: 25%;\n	width: 50%;\n	height: 50%;\n}\n\n/**\n * Menus\n */\n.menu {\n	position: relative;\n	width: 40%;\n	margin: 10em auto 0;\n	padding: 1.6em;\n	background: #111;\n	color: #bfbfbf;\n	border-radius: 1em;\n	word-break: break-all;\n	overflow: hidden;\n}\n\n.menu .close {\n	position: absolute;\n	width: 1.4em;\n	height: 1.4em;\n	top: 0;\n	right: 0;\n	font-size: 1.4em;\n	color: #999999;\n	text-align: center;\n}\n\n.menu .close.hover {\n	color: #bfbfbf;\n}\n\n.menu h1 {\n	font-size: 1.2em;\n	padding-bottom: .2em;\n	border-bottom: 1px solid #222;\n}\n\n.menu .menu-item {\n	margin-bottom: .5em;\n	padding: .5em;\n	background: #222;\n}\n\n.menu .menu-item.hover {\n	background: #333;\n}\n\n.menu .control-group {\n	margin-bottom: .5em;\n}\n\n.menu .control-label {\n	float: left;\n	padding: .5em 0;\n	width: 10em;\n	color: #A6E22E;\n	text-align: right\n}\n\n.menu .control-input {\n	margin-left: 11em;\n	padding: .5em;\n	background: #222;\n	border: 1px solid transparent;\n}\n\n.menu .control-input.hover {\n	background: #333;\n}\n\n.menu .control-input.focus {\n	border: 1px solid #0f0;\n}\n\n.menu .button {\n	float: left;\n	margin-bottom: .5em;\n	padding: .5em;\n	background-color: #222;\n	background-image: -moz-linear-gradient(top, #333, #222);\n	background-image: -webkit-gradient(linear, 0 0, 0 100%, from(#333), to(#222));\n	background-image: -webkit-linear-gradient(top, #333, #222);\n	background-image: linear-gradient(to bottom, #303030, #222);\n}\n\n.menu .button.hover {\n	background: #333;\n}\n\n.menu .form-horizontal .form-actions {\n	margin-left: 11em;\n}\n\n/**\n * Ingame menu\n */\n#ingame .menu-item {\n	text-align: center;\n}\n\n#ingame .settings.menu-item {\n	margin-bottom: 0;\n}\n\n/**\n * Singleplayer menu\n */\n#singleplayer .levels {\n	list-style: none;\n	margin: 0 11em 0 0;\n	padding: 0;\n}\n\n#singleplayer .preview {\n	float: right;\n	width: 10em;\n	height: 10em;\n}\n\n#singleplayer .preview img {\n	display: block;\n	width: 100%;\n	height: 100%;\n}"}),define("text!ui/templates/hud.tpl",[],function(){return'<div class="fps"><span class="fps-value"><%- fps %></span> FPS</div>'}),define("ui/views/HudView",["underscore","backbone","text!ui/templates/hud.tpl"],function(e,t,n){var r,i=t.View.extend({id:"hud",template:e.template(n),model:{fps:0},fpsEl:null,initialize:function(e){r=e.ui,this.render()},setFPS:function(e){this.fpsEl||(this.fpsEl=this.$el.find(".fps-value")),this.model.fps=e,this.fpsEl.text(this.model.fps)},render:function(){return this.$el.html(this.template(this.model)),this}});return i}),define("text!ui/templates/scoreboard.tpl",[],function(){return"<table>\n	<thead>\n		<tr>\n			<th>Name</th>\n		</tr>\n	</thead>\n	<tbody>\n	<% _.each(players, function (player) { %>\n		<tr>\n			<td><%- player.name %></td>\n		</tr>\n	<% }); %>\n</table>"}),define("ui/views/ScoreboardView",["underscore","backbone","text!ui/templates/scoreboard.tpl"],function(e,t,n){var r,i=t.View.extend({id:"scoreboard",template:e.template(n),initialize:function(e){r=e.ui,this.render()},update:function(e){var t=JSON.stringify(this.model);return t!==this.oldModelJson&&$(this.el).html(this.template(this.model)),this.oldModelJson=t,this},render:function(){return $(this.el).html(this.template(this.model)),this}});return i}),define("text!ui/templates/ingame.tpl",[],function(){return'<div class="close">Ã</div>\n<div class="singleplayer menu-item">Single player game</div>\n<div class="multiplayer menu-item">Multi player game</div>\n<div class="settings menu-item">Settings</div>'}),define("ui/views/IngameMenu",["underscore","backbone","text!ui/templates/ingame.tpl"],function(e,t,n){var r,i=t.View.extend({id:"ingame",className:"menu",model:{},template:e.template(n),events:{"click .singleplayer":"openSinglePlayerMenu","click .multiplayer":"openMultiPlayerMenu","click .settings":"openSettingsMenu","click .close":"closeMenu"},initialize:function(e){r=e.ui,this.render()},openSinglePlayerMenu:function(){r.SetActiveMenu("singleplayer")},openMultiPlayerMenu:function(){r.SetActiveMenu("multiplayer")},openSettingsMenu:function(){r.SetActiveMenu("settings")},closeMenu:function(){r.CloseActiveMenu()},update:function(e){},render:function(){return $(this.el).html(this.template(this.model)),this}});return i}),define("text!ui/templates/singleplayer.tpl",[],function(){return'<div class="close">Ã</div>\n<h1>Choose a level</h1>\n<div class="preview">\n	<% if (defaultImg) { %><img src="<%= defaultImg %>" /><% } else { %>&nbsp;<% } %>\n</div>\n<ul class="levels">\n<% _.each(levels, function (level, i) { %>\n	<li data-idx="<%- i %>" class="menu-item"><%- level.name %></li>\n<% }); %>\n</ul>'}),define("ui/views/SinglePlayerMenu",["underscore","backbone","text!ui/templates/singleplayer.tpl"],function(e,t,n){var r,i,s,o=t.View.extend({id:"singleplayer",className:"menu",model:{defaultImg:null,levels:[]},template:e.template(n),events:{"mouseenter .levels li":"levelPreview","click .levels li":"levelSelect","click .close":"closeMenu"},initialize:function(e){var t=this;r=e.sys,i=e.com,s=e.ui;var n=["q3dm7","q3dm17","q3tourney2"],o=0;for(var u=0;u<n.length;u++)(function(e){var r=n[e],i="levelshots/"+r;s.FindImage(i,function(i,s){t.model.defaultImg||(t.model.defaultImg=s.data),t.model.levels[e]={name:r,url:s.data},++o===n.length&&t.render()})})(u)},levelPreview:function(e){var t=$(e.target),n=this.$el.find(".preview"),r=t.data("idx"),i=this.model.levels[r];n.html($("<img>",{src:i.url}))},levelSelect:function(e){var t=$(e.target),n=t.data("idx"),r=this.model.levels[n];i.ExecuteCmdText("map "+r.name)},closeMenu:function(){s.CloseActiveMenu()},render:function(){return this.$el.html(this.template(this.model)),this}});return o}),define("text!ui/templates/multiplayer.tpl",[],function(){return'<div class="close">Ã</div>\n<div class="form-horizontal">\n	<h1>Connect to a server</h1>\n	<div class="address control-group">\n		<div class="control-label">Address:</div><div class="control-input"><%- address %></div>\n	</div>\n	<div class="form-actions">\n		<div class="connect button">Connect</div>\n	</div>\n</div>'}),define("ui/views/MultiPlayerMenu",["underscore","backbone","text!ui/templates/multiplayer.tpl"],function(e,t,n){var r,i,s,o=t.View.extend({id:"multiplayer",className:"menu",template:e.template(n),model:{address:"192.168.0.102:9001"},addressEl:null,events:{"keypress .address":"updateAddress","click .connect":"connect","click .close":"closeMenu"},initialize:function(e){var t=this;r=e.sys,i=e.com,s=e.ui,this.render()},updateAddress:function(e,t){var n=s.ProcessTextInput(this.addressEl.text(),t);this.addressEl.text(n)},connect:function(){var e=this.addressEl.text();i.ExecuteCmdText("connect "+e)},closeMenu:function(){s.CloseActiveMenu()},render:function(){return this.$el.html(this.template(this.model)),this.addressEl=this.$el.find(".address .control-input"),this}});return o}),define("text!ui/templates/settings.tpl",[],function(){return'<div class="close">Ã</div>\n<div class="form-horizontal">\n	<h1>Settings</h1>\n	<div class="name control-group">\n		<div class="control-label">Name:</div><div class="control-input"><%- name %></div>\n	</div>\n	\n	<h1>Controls</h1>\n	<div class="forward-key control-group">\n		<div class="control-label">Move forward:</div><div class="control-input"><%- forwardKey %></div>\n	</div>\n	<div class="left-key control-group">\n		<div class="control-label">Move left:</div><div class="control-input"><%- leftKey %></div>\n	</div>\n	<div class="back-key control-group">\n		<div class="control-label">Move back:</div><div class="control-input"><%- backKey %></div>\n	</div>\n	<div class="right-key control-group">\n		<div class="control-label">Move right:</div><div class="control-input"><%- rightKey %></div>\n	</div>\n	<div class="up-key control-group">\n		<div class="control-label">Jump:</div><div class="control-input"><%- upKey %></div>\n	</div>\n</div>'}),define("ui/views/SettingsMenu",["underscore","backbone","text!ui/templates/settings.tpl"],function(e,t,n){var r,i,s,o=t.View.extend({id:"settings",className:"menu",template:e.template(n),model:{name:"",forwardKey:"",leftKey:"",backKey:"",rightKey:"",upKey:""},nameEl:null,forwardKeyEl:null,leftKeyEl:null,backKeyEl:null,rightKeyEl:null,upKeyEl:null,events:{"keypress .name":"updateName","keypress .forward-key":"updateForwardKey","keypress .left-key":"updateLeftKey","keypress .back-key":"updateBackKey","keypress .right-key":"updateRightKey","keypress .up-key":"updateUpKey","blur .control-input":"saveConfig","click .close":"closeMenu"},initialize:function(e){r=e.com,i=e.cl,s=e.ui,this.model.name=r.GetCvarVal("name");var t;if(t=i.GetKeyNamesForCmd("+forward"))this.model.forwardKey=t[0];if(t=i.GetKeyNamesForCmd("+left"))this.model.leftKey=t[0];if(t=i.GetKeyNamesForCmd("+back"))this.model.backKey=t[0];if(t=i.GetKeyNamesForCmd("+right"))this.model.rightKey=t[0];if(t=i.GetKeyNamesForCmd("+jump"))this.model.upKey=t[0];this.render()},updateName:function(e,t){var n=s.ProcessTextInput(this.nameEl.text(),t);this.nameEl.text(n)},updateForwardKey:function(e,t){var n=s.ProcessKeyBindInput(t);this.forwardKeyEl.text(n)},updateLeftKey:function(e,t){var n=s.ProcessKeyBindInput(t);this.leftKeyEl.text(n)},updateBackKey:function(e,t){var n=s.ProcessKeyBindInput(t);this.backKeyEl.text(n)},updateRightKey:function(e,t){var n=s.ProcessKeyBindInput(t);this.rightKeyEl.text(n)},updateUpKey:function(e,t){var n=s.ProcessKeyBindInput(t);this.upKeyEl.text(n)},saveConfig:function(){this.model.name=this.nameEl.text(),this.model.forwardKey=this.forwardKeyEl.text(),this.model.leftKey=this.leftKeyEl.text(),this.model.backKey=this.backKeyEl.text(),this.model.rightKey=this.rightKeyEl.text(),this.model.upKey=this.upKeyEl.text(),r.SetCvarVal("name",this.model.name),i.Bind(this.model.forwardKey,"+forward"),i.Bind(this.model.leftKey,"+left"),i.Bind(this.model.backKey,"+back"),i.Bind(this.model.rightKey,"+right"),i.Bind(this.model.upKey,"+jump"),r.SaveConfig(function(e){if(e)throw new Error("Error saving configuration");r.LoadConfig()})},closeMenu:function(){s.CloseActiveMenu()},render:function(){return this.$el.html(this.template(this.model)),this.nameEl=this.$el.find(".name .control-input"),this.forwardKeyEl=this.$el.find(".forward-key .control-input"),this.leftKeyEl=this.$el.find(".left-key .control-input"),this.backKeyEl=this.$el.find(".back-key .control-input"),this.rightKeyEl=this.$el.find(".right-key .control-input"),this.upKeyEl=this.$el.find(".up-key .control-input"),this}});return o}),define("ui/ui",["underscore","backbone","text!ui/css/views.css","ui/views/HudView","ui/views/ScoreboardView","ui/views/IngameMenu","ui/views/SinglePlayerMenu","ui/views/MultiPlayerMenu","ui/views/SettingsMenu"],function(e,t,n,r,i,s,o,u,a){function c(e,t,c,h){function I(e,t,n){return t-e>180&&(t-=360),t-e<-180&&(t+=360),e+n*(t-e)}function q(e,t,n,r){var i,s,o,u,a,f,l;i=e[j]*(Math.PI*2/360),u=Math.sin(i),l=Math.cos(i),i=e[B]*(Math.PI*2/360),o=Math.sin(i),f=Math.cos(i),i=e[F]*(Math.PI*2/360),s=Math.sin(i),a=Math.cos(i),t&&(t[0]=f*l,t[1]=f*u,t[2]=-o),n&&(n[0]=-1*s*o*l+ -1*a*-u,n[1]=-1*s*o*u+ -1*a*l,n[2]=-1*s*f),r&&(r[0]=a*o*l+ -s*-u,r[1]=a*o*u+ -s*l,r[2]=a*f)}function R(e,t){var n=[0,0,0];q(e,t[0],n,t[2]),vec3.subtract([0,0,0],n,t[1])}function Q(e){return e[0]==1?W:e[1]==1?X:e[2]==1?V:J}function G(e){var t=0;for(var n=0;n<3;n++)e.normal[n]<0&&(t|=1<<n);return t}function Y(e,t,n){if(n.type<J)return n.dist<=e[n.type]?1:n.dist>=t[n.type]?2:3;var r=[0,0];if(n.signbits<8)for(var i=0;i<3;i++){var s=n.signbits>>i&1;r[s]+=n.normal[i]*t[i],r[s^1]+=n.normal[i]*e[i]}var o=0;return r[0]>=n.dist&&(o=1),r[1]<n.dist&&(o|=2),o}function et(e,t,n){var r=new Array(n),i=[].concat(Z),s=[].concat(Z),o=[].concat(Z),u=[].concat(Z),a=0,f,l=0,c,h=0,p,d=0,v,m;for(m=0;m<n;m++)f=e[m][t]&255,c=e[m][t]>>8&255,p=e[m][t]>>16&255,v=e[m][t]>>24&255^128,i[f]++,s[c]++,o[p]++,u[v]++;for(m=0;m<256;m++)f=a+i[m],c=l+s[m],p=h+o[m],v=d+u[m],i[m]=a,s[m]=l,o[m]=h,u[m]=d,a=f,l=c,h=p,d=v;for(m=0;m<n;m++)f=e[m][t]&255,r[i[f]]=e[m],i[f]++;for(m=0;m<n;m++)c=r[m][t]>>8&255,e[s[c]]=r[m],s[c]++;for(m=0;m<n;m++)p=e[m][t]>>16&255,r[o[p]]=e[m],o[p]++;for(m=0;m<n;m++)v=r[m][t]>>24&255^128,e[u[v]]=r[m],u[v]++;return e}function gt(e){return e<-128?-128:e>127?127:e}function bt(e){var t=65536,n=e.length,r=e.slice||e.subarray,i;if(n<t)i=String.fromCharCode.apply(String,e);else{var s=[],o=0;while(o<n)s.push(String.fromCharCode.apply(String,r.call(e,o,o+t))),o+=t;i=s.join("")}return btoa(i)}function Tt(){var t=e.GetUIRenderContext();wt=new f,document.addEventListener("fullscreenchange",qt),window.addEventListener("resize",qt),Et=$(t.handle),qt();var r=$("<style>",{type:"text/css"}).append(n);r.appendTo("head"),St=$("<span>",{"class":"pointer"}),Et.append(St)}function Nt(e){if(e==="mouse0"){Pt(),$(wt.focusEl).trigger("click");return}wt.focusEl&&$(wt.focusEl).trigger("keypress",[e])}function Ct(e,t){if(wt.mouseCallback){wt.mouseCallback(e,t);return}wt.mx+=e,wt.my+=t,wt.mx=Math.max(0,Math.min(wt.mx,wt.vw)),wt.my=Math.max(0,Math.min(wt.my,wt.vh)),St.css({top:wt.my+"px",left:wt.mx+"px"}),wt.activeMenu&&_t()}function kt(e,t,n){var r=document.elementFromPoint(t,n);if(!r)return null;if(!$.contains(e.el,r))return[r];var i=$(r).parentsUntil(e.el,function(){var e=$(this),r=e.offset(),i={x:[r.left,r.left+e.outerWidth()],y:[r.top,r.top+e.outerHeight()]};return t>=i.x[0]&&t<=i.x[1]&&n>=i.y[0]&&n<=i.y[1]}),s=i.toArray();return s.splice(0,0,r),s}function Lt(n){var r=wt.views[n]=new xt[n]({sys:e,com:t,cl:c,ui:{SetActiveMenu:Ot,CloseActiveMenu:Mt,FindImage:zt,ProcessTextInput:Wt,ProcessKeyBindInput:Xt}});return Et.append(r.$el),Ft(r),r}function At(e){var t=wt.views[e];return t||(t=Lt(e)),t}function Ot(e){Et.addClass("active"),wt.activeMenu=At(e),c.CaptureInput(Nt,Ct)}function Mt(){Et.removeClass("active"),wt.activeMenu=null,c.CaptureInput(null,null),Dt(),Ht()}function _t(){var e=kt(wt.activeMenu,wt.mx,wt.my);if(wt.hoverEls)for(var t=0;t<wt.hoverEls.length;t++){var n=wt.hoverEls[t];if(!e||e.indexOf(n)===-1)$(n).removeClass("hover"),$(n).trigger("mouseleave")}if(e)for(var t=0;t<e.length;t++){var r=e[t];if(!wt.hoverEls||wt.hoverEls.indexOf(r)===-1)$(r).addClass("hover"),$(r).trigger("mouseenter")}wt.hoverEls=e}function Dt(){wt.hoverEls&&$(wt.hoverEls).removeClass("hover"),wt.hoverEls=[]}function Pt(){var e=wt.hoverEls&&wt.hoverEls.length>0?wt.hoverEls[0]:null;if(wt.focusEl===e)return;Ht(),wt.focusEl=e,$(e).addClass("focus")}function Ht(){$(wt.focusEl).trigger("blur"),$(wt.focusEl).removeClass("focus"),wt.focusEl=null}function Bt(){var e=wt.views;wt.activeMenu&&jt(wt.activeMenu);for(var t in e){if(!e.hasOwnProperty(t))continue;var n=e[t];if(n.visFrame!==wt.frameCount){Ft(n);continue}It(n)&&Ut(n)}wt.frameCount++}function jt(e){e.visFrame=wt.frameCount}function Ft(e){return e.$el.is(":visible")?(e.$el.hide(),!0):!1}function It(e){return e.$el.is(":visible")?!1:(e.$el.show(),!0)}function qt(){wt.vw=Et.width(),wt.vh=Et.height(),Rt()}function Rt(){var e=wt.views;for(var t in e){if(!e.hasOwnProperty(t))continue;Ut(e[t])}}function Ut(e){e.$el.css("font-size",wt.vw/100+"px")}function zt(t,n){var r;return t=t.replace(/\.[^/.]+$/,""),t+=".png",(r=wt.images[t])?r:(r=wt.images[t]=new l,r.data="data:image/png;base64,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",e.ReadFile(t,"binary",function(e,i){e?console.log("Failed to load image '"+t+"'"):r.data="data:image/png;base64,"+bt(new Uint8Array(i)),n&&n(e,r)}),r)}function Wt(e,t){return t==="enter"&&Ht(),t.length===1?e+=t:t==="space"?e+=" ":t==="backspace"&&(e=e.slice(0,-1)),e}function Xt(e){return e==="backspace"?"":(Ht(),e)}var p="baseq3",d=1,v=2,m=4,g=64,y=64,b=1024,w=b-1,E=b-2,S=b-2,x=256,T=256,N={NAD:0,LOOPBACK:1,IP:2},C={CLIENT:0,SERVER:1},k=function(e,t,n){this.type=e,this.ip=t,this.port=n},L=function(e,t){var n=e,r=function(t){if(!arguments.length)return n;var r=n;typeof e=="string"?n=t.toString():e%1===0?n=parseInt(t):n=parseFloat(t)};return r.flags=t,r},A={ARCHIVE:1,USERINFO:2,SERVERINFO:4,SYSTEMINFO:8},O=function(){this.serverTime=0,this.angles=[0,0,0],this.forwardmove=0,this.rightmove=0,this.upmove=0};O.prototype.clone=function(e){return typeof e=="undefined"&&(e=new O),e.serverTime=this.serverTime,vec3.set(this.angles,e.angles),e.forwardmove=this.forwardmove,e.rightmove=this.rightmove,e.upmove=this.upmove,e};var M=6,_=function(){this.clientNum=0,this.commandTime=0,this.pm_type=0,this.pm_flags=0,this.origin=[0,0,0],this.velocity=[0,0,0],this.viewangles=[0,0,0],this.delta_angles=[0,0,0],this.speed=0,this.gravity=0,this.groundEntityNum=w,this.jumppad_ent=0,this.jumppad_frame=0,this.pmove_framecount=0};_.prototype.clone=function(e){return typeof e=="undefined"&&(e=new _),e.clientNum=this.clientNum,e.commandTime=this.commandTime,e.pm_type=this.pm_type,e.pm_flags=this.pm_flags,vec3.set(this.origin,e.origin),vec3.set(this.velocity,e.velocity),vec3.set(this.viewangles,e.viewangles),vec3.set(this.delta_angles,e.delta_angles),e.speed=this.speed,e.gravity=this.gravity,e.groundEntityNum=this.groundEntityNum,e.jumppad_ent=this.jumppad_ent,e.jumppad_frame=this.jumppad_frame,e.pmove_framecount=this.pmove_framecount,e};var D={STATIONARY:0,INTERPOLATE:1,LINEAR:2,LINEAR_STOP:3,SINE:4,GRAVITY:5},P=function(){this.trType=0,this.trTime=0,this.trDuration=0,this.trBase=[0,0,0],this.trDelta=[0,0,0]};P.prototype.clone=function(e){return typeof e=="undefined"&&(e=new P),e.trType=this.trType,e.trTime=this.trTime,e.trDuration=this.trDuration,vec3.set(this.trBase,e.trBase),vec3.set(this.trDelta,e.trDelta),e};var H=function(){this.number=0,this.eType=0,this.eFlags=0,this.pos=new P,this.apos=new P,this.time=0,this.time2=0,this.origin=[0,0,0],this.origin2=[0,0,0],this.angles=[0,0,0],this.angles2=[0,0,0],this.groundEntityNum=w,this.modelIndex=0,this.modelIndex2=0,this.clientNum=0,this.frame=0,this.solid=0,this.event=0,this.eventParm=0};H.prototype.clone=function(e){return typeof e=="undefined"&&(e=new H),e.number=this.number,e.eType=this.eType,e.eFlags=this.eFlags,this.pos.clone(e.pos),this.apos.clone(e.apos),e.time=this.time,e.time2=this.time2,vec3.set(this.origin,e.origin),vec3.set(this.origin2,e.origin2),vec3.set(this.angles,e.angles),vec3.set(this.angles2,e.angles2),e.groundEntityNum=this.groundEntityNum,e.modelIndex=this.modelIndex,e.modelindex2=this.modelIndex2,e.clientNum=this.clientNum,e.frame=this.frame,e.solid=this.solid,e.event=this.event,e.eventParm=this.eventParm,e};var B=0,j=1,F=2,U=function(e){return e*65536/360&65535},z=function(e){return e*(360/65536)},W=0,X=1,V=2,J=3,K=function(){this.normal=vec3.create(),this.dist=0,this.type=0,this.signbits=0},Z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],tt={NODAMAGE:1,SLICK:2,SKY:4,LADDER:8,NOIMPACT:16,NOMARKS:32,FLESH:64,NODRAW:128,HINT:256,SKIP:512,NOLIGHTMAP:1024,POINTLIGHT:2048,METALSTEPS:4096,NOSTEPS:8192,NONSOLID:16384,LIGHTFILTER:32768,ALPHASHADOW:65536,NODLIGHT:131072,DUST:262144},nt={ENTITIES:0,SHADERS:1,PLANES:2,NODES:3,LEAFS:4,LEAFSURFACES:5,LEAFBRUSHES:6,MODELS:7,BRUSHES:8,BRUSHSIDES:9,DRAWVERTS:10,DRAWINDEXES:11,FOGS:12,SURFACES:13,LIGHTMAPS:14,LIGHTGRID:15,VISIBILITY:16,NUM_LUMPS:17},rt=64,it=function(){this.fileofs=0,this.filelen=0},st=function(){this.ident=null,this.version=0,this.lumps=new Array(nt.NUM_LUMPS);for(var e=0;e<nt.NUM_LUMPS;e++)this.lumps[e]=new it},ot=function(){this.mins=[0,0,0],this.maxs=[0,0,0],this.firstSurface=0,this.numSurfaces=0,this.firstBrush=0,this.numBrushes=0};ot.size=40;var ut=function(){this.shaderName=null,this.flags=0,this.contents=0};ut.size=72;var at=function(){this.normal=[0,0,0],this.dist=0};at.size=16;var ft=function(){this.planeNum=0,this.childrenNum=[0,0],this.mins=[0,0,0],this.maxs=[0,0,0]};ft.size=36;var lt=function(){this.cluster=0,this.area=0,this.mins=[0,0,0],this.maxs=[0,0,0],this.firstLeafSurface=0,this.numLeafSurfaces=0,this.firstLeafBrush=0,this.numLeafBrushes=0};lt.size=48;var ct=function(){this.planeNum=0,this.shader=0};ct.size=8;var ht=function(){this.side=0,this.numsides=0,this.shader=0};ht.size=12;var pt=function(){this.shader=null,this.brushNum=0,this.visibleSide=0};pt.size=72;var dt=function(){this.pos=[0,0,0],this.texCoord=[0,0],this.lmCoord=[0,0],this.normal=[0,0,0],this.color=[0,0,0,0]};dt.size=44;var vt={BAD:0,PLANAR:1,PATCH:2,TRIANGLE_SOUP:3,FLARE:4},mt=function(){this.shaderNum=0,this.fogNum=0,this.surfaceType=0,this.vertex=0,this.vertCount=0,this.meshVert=0,this.meshVertCount=0,this.lightmapNum=0,this.lmStart=[0,0],this.lmSize=[0,0],this.lmOrigin=[0,0,0],this.lmVecs=[[0,0,0],[0,0,0],[0,0,0]],this.patchWidth=0,this.patchHeight=0};mt.size=104;var yt=function(){this.gl=null,this.handle=null},wt,Et,St,xt={hud:r,scoreboard:i,ingame:s,singleplayer:o,multiplayer:u,settings:a};return{Init:Tt,RegisterView:Lt,SetActiveMenu:Ot,CloseActiveMenu:Mt,KeyPressEvent:Nt,MouseMoveEvent:Ct,RenderView:jt,Render:Bt}}var f=function(){this.frameCount=0,this.views={},this.activeMenu=null,this.hoverEls=null,this.focusEl=null,this.mx=0,this.my=0,this.vw=0,this.vh=0,this.images={}},l=function(){this.b64=null};return{CreateInstance:function(e,t,n){return new c(e,t,n)}}}),define("client/cl",["underscore","glmatrix","ByteBuffer","cgame/cg","clipmap/cm","renderer/re","ui/ui"],function(e,t,n,r,i,s,o){function D(e,t,n){return t-e>180&&(t-=360),t-e<-180&&(t+=360),e+n*(t-e)}function P(e,t,n,r){var i,s,o,u,a,f,l;i=e[M]*(Math.PI*2/360),u=Math.sin(i),l=Math.cos(i),i=e[O]*(Math.PI*2/360),o=Math.sin(i),f=Math.cos(i),i=e[_]*(Math.PI*2/360),s=Math.sin(i),a=Math.cos(i),t&&(t[0]=f*l,t[1]=f*u,t[2]=-o),n&&(n[0]=-1*s*o*l+ -1*a*-u,n[1]=-1*s*o*u+ -1*a*l,n[2]=-1*s*f),r&&(r[0]=a*o*l+ -s*-u,r[1]=a*o*u+ -s*l,r[2]=a*f)}function H(e,t){var n=[0,0,0];P(e,t[0],n,t[2]),vec3.subtract([0,0,0],n,t[1])}function z(e){return e[0]==1?F:e[1]==1?I:e[2]==1?q:R}function W(e){var t=0;for(var n=0;n<3;n++)e.normal[n]<0&&(t|=1<<n);return t}function X(e,t,n){if(n.type<R)return n.dist<=e[n.type]?1:n.dist>=t[n.type]?2:3;var r=[0,0];if(n.signbits<8)for(var i=0;i<3;i++){var s=n.signbits>>i&1;r[s]+=n.normal[i]*t[i],r[s^1]+=n.normal[i]*e[i]}var o=0;return r[0]>=n.dist&&(o=1),r[1]<n.dist&&(o|=2),o}function $(e,t,n){var r=new Array(n),i=[].concat(V),s=[].concat(V),o=[].concat(V),u=[].concat(V),a=0,f,l=0,c,h=0,p,d=0,v,m;for(m=0;m<n;m++)f=e[m][t]&255,c=e[m][t]>>8&255,p=e[m][t]>>16&255,v=e[m][t]>>24&255^128,i[f]++,s[c]++,o[p]++,u[v]++;for(m=0;m<256;m++)f=a+i[m],c=l+s[m],p=h+o[m],v=d+u[m],i[m]=a,s[m]=l,o[m]=h,u[m]=d,a=f,l=c,h=p,d=v;for(m=0;m<n;m++)f=e[m][t]&255,r[i[f]]=e[m],i[f]++;for(m=0;m<n;m++)c=r[m][t]>>8&255,e[s[c]]=r[m],s[c]++;for(m=0;m<n;m++)p=e[m][t]>>16&255,r[o[p]]=e[m],o[p]++;for(m=0;m<n;m++)v=r[m][t]>>24&255^128,e[u[v]]=r[m],u[v]++;return e}function lt(e){return e<-128?-128:e>127?127:e}function ht(e){var t=65536,n=e.length,r=e.slice||e.subarray,i;if(n<t)i=String.fromCharCode.apply(String,e);else{var s=[],o=0;while(o<n)s.push(String.fromCharCode.apply(String,r.call(e,o,o+t))),o+=t;i=s.join("")}return btoa(i)}function Kt(e,t){console.log("--------- CL Init ---------");var n={Bind:wn,GetKeyNamesForCmd:kn,GetGameState:function(){return Ut.gameState},GetCurrentUserCommandNumber:ln,GetUserCommand:cn,GetCurrentSnapshotNumber:mn,GetSnapshot:gn,CaptureInput:Nn};jt=e,Ft=t,It=i.CreateInstance(jt),qt=o.CreateInstance(jt,Ft,n),Rt=r.CreateInstance(jt,Ft,n,It,s,qt),Qt(),zt=new Pt,Wt=new _t,Wt.realtime=0,Xt=Ft.AddCvar("name","UnnamedPlayer",x.ARCHIVE|x.USERINFO),Vt=Ft.AddCvar("model","sarge",x.ARCHIVE|x.USERINFO),$t=Ft.AddCvar("cl_sensitivity",2,x.ARCHIVE),Jt=Ft.AddCvar("cl_showTimeDelta",0,x.ARCHIVE),yn(),bn(),Zt(),qt.Init(),Wt.initialized=!0}function Qt(){console.log("Clearing client state"),Ut=new Mt}function Gt(){zt.state=Dt.LOADING,Rt.Init(zt.serverMessageSequence,zt.lastExecutedServerCommand,zt.clientNum),zt.state=Dt.PRIMED}function Yt(){Rt.Shutdown()}function Zt(){s.Init(jt,Ft)}function en(){s.Shutdown()}function tn(e,t){Wt.frameTime=e;if(!Wt.initialized)return;Wt.frameDelta=t,Wt.realTime+=Wt.frameDelta,Pn(),un(),dn(),nn()}function nn(){switch(zt.state){case Dt.DISCONNECTED:case Dt.CONNECTING:case Dt.CHALLENGING:case Dt.CONNECTED:case Dt.LOADING:case Dt.PRIMED:break;case Dt.ACTIVE:Rt.Frame(Ut.serverTime)}qt.Render()}function rn(){zt.state>=Dt.CONNECTED?zt.state=Dt.CONNECTED:(sn(),zt.serverName="localhost:9000",zt.serverAddress=Tn(zt.serverName),zt.state=Dt.CHALLENGING,zt.connectTime=-99999,un())}function sn(e){zt.state>=Dt.CONNECTED&&(on("disconnect"),In()),Qt(),zt=new Pt,zt.state=Dt.DISCONNECTED}function on(e){zt.reliableCommands[++zt.reliableSequence%gt]=e}function un(){if(zt.state!==Dt.CONNECTING&&zt.state!==Dt.CHALLENGING)return;if(Wt.realTime-zt.connectTime<At)return;zt.netchan||(zt.netchan=Ft.NetchanSetup(w.CLIENT,zt.serverAddress)),zt.connectTime=Wt.realTime,zt.connectPacketCount++;switch(zt.state){case Dt.CHALLENGING:var e="connect"+JSON.stringify(Ft.GetCvarKeyValues(x.USERINFO));Ft.NetchanPrint(zt.netchan,e);break;default:throw new Error("CheckForResend: bad clc.state")}}function an(e,t){if(!Wt.initialized)return;var r=new n(t,n.LITTLE_ENDIAN);if(t.byteLength>4&&r.view.getInt32(0,!!n.LITTLE_ENDIAN)===-1){fn(e,r);return}if(!Ft.NetchanProcess(zt.netchan,r))return;zt.serverMessageSequence=zt.netchan.incomingSequence,qn(r)}function fn(e,t){t.readInt();var n=t.readCString();if(n==="connectResponse"){if(zt.state>=Dt.CONNECTED){console.warn("Dup connect received. Ignored.");return}if(zt.state!=Dt.CHALLENGING){console.warn("connectResponse packet while not connecting. Ignored.");return}console.log("Got connection response"),zt.state=Dt.CONNECTED,zt.lastPacketSentTime=-9999}}function ln(){return Ut.cmdNumber}function cn(e){if(e>Ut.cmdNumber)throw new Error("GetUserCommandd: "+e+" >= "+Ut.cmdNumber);return e<=Ut.cmdNumber-St?null:Ut.cmds[e&xt]}function pn(){Ut.newSnapshots=!1;var e=Ut.snap.serverTime-Wt.realTime,t=Math.abs(e-Ut.serverTimeDelta);t>hn?(Ut.serverTimeDelta=e,Ut.oldServerTime=Ut.snap.serverTime,Ut.serverTime=Ut.snap.serverTime,Jt()&&console.log("AdjustTimeDelta: <RESET>")):t>100?(Ut.serverTimeDelta=Ut.serverTimeDelta+e>>1,Jt()&&console.log("AdjustTimeDelta: <FAST>")):Ut.extrapolatedSnapshot?(Ut.extrapolatedSnapshot=!1,Ut.serverTimeDelta-=2):Ut.serverTimeDelta++,Jt()&&console.log("AdjustTimeDelta: "+Ut.serverTimeDelta)}function dn(){if(zt.state!==Dt.ACTIVE){if(zt.state!==Dt.PRIMED)return;Ut.newSnapshots&&(Ut.newSnapshots=!1,vn());if(zt.state!==Dt.ACTIVE)return}if(!Ut.snap.valid)throw new Error("SetCGameTime: !cl.snap.valid");if(Ut.snap.serverTime<Ut.oldFrameServerTime)throw new Error("cl.snap.serverTime < cl.oldFrameServerTime");Ut.oldFrameServerTime=Ut.snap.serverTime,Ut.serverTime=Wt.realTime+Ut.serverTimeDelta,Ut.serverTime<Ut.oldServerTime&&(Ut.serverTime=Ut.oldServerTime),Ut.oldServerTime=Ut.serverTime,Wt.realTime+Ut.serverTimeDelta>=Ut.snap.serverTime-5&&(Ut.extrapolatedSnapshot=!0),Ut.newSnapshots&&pn()}function vn(){if(Ut.snap.snapFlags&f)return;zt.state=Dt.ACTIVE,Ut.serverTimeDelta=Ut.snap.serverTime-Wt.realTime,Ut.oldServerTime=Ut.snap.serverTime}function mn(){return{snapshotNumber:Ut.snap.messageNum,serverTime:Ut.snap.serverTime}}function gn(e){if(e>Ut.snap.messageNum)throw new Error("GetSnapshot: snapshotNumber > cl.snapshot.messageNum");if(Ut.snap.messageNum-e>=vt)return null;var t=Ut.snapshots[e%vt];if(!t.valid)return null;if(Ut.parseEntitiesNum-t.parseEntitiesNum>=Ot)return null;t.entities=new Array(t.numEntities);for(var n=0;n<t.numEntities;n++)t.entities[n]=Ut.parseEntities[t.parseEntitiesNum+n&Ot-1];return t}function yn(){Ft.AddCmd("bind",wn),Ft.AddCmd("unbind",En),Ft.AddCmd("unbindall",Sn),Ft.AddCmd("connect",xn),Ft.AddCmd("+forward",function(e){Wt.forwardKey=e}),Ft.AddCmd("+left",function(e){Wt.leftKey=e}),Ft.AddCmd("+back",function(e){Wt.backKey=e}),Ft.AddCmd("+right",function(e){Wt.rightKey=e}),Ft.AddCmd("+jump",function(e){Wt.upKey=e})}function bn(){wn("w","+forward"),wn("a","+left"),wn("s","+back"),wn("d","+right"),wn("space","+jump"),wn("tab","+scores")}function wn(e,t){var n=Cn(e);n.binding=t}function En(e,t){var n=Cn(e);delete n.binding}function Sn(){for(var e in Wt.keys){if(!Wt.keys.hasOwnProperty(e))continue;delete Wt.keys[e].binding}}function xn(e){var t=e.split(":"),n=t[0],r=t[1];sn(!1),zt.serverName=e,zt.serverAddress=Tn(zt.serverName),zt.state=Dt.CHALLENGING,zt.connectTime=-99999,zt.connectPacketCount=0}function Tn(e){var t=new E;e.indexOf("localhost")!==-1?t.type=b.LOOPBACK:t.type=b.IP;var n=e.split(":");return n.length?(t.ip=n[0],t.port=n[1]):(t.ip=n[0],t.port=9e3),t}function Nn(e,t){Wt.keyCallback=e,Wt.mouseMoveCallback=t}function Cn(e){var t=Wt.keys[e];return t||(t=Wt.keys[e]=new Bt,t.chr=e),t}function kn(e){var t;for(var n in Wt.keys){if(!Wt.keys.hasOwnProperty(n))continue;var r=Wt.keys[n];r.binding===e&&(t||(t=[]),t.push(n))}return t}function Ln(e,t){var n=Cn(t);if(n.active)return;if(t==="graveaccent"){Wt.keyCallback?qt.CloseActiveMenu():qt.SetActiveMenu("ingame");return}Wt.keyCallback?Wt.keyCallback(t):(n.downtime=e,n.active=!0,_n(n))}function An(e,t){var n=Cn(t);Wt.keyCallback||(n.partial+=e-n.downtime),n.active=!1,_n(n)}function On(e,t,n){Wt.mouseMoveCallback?Wt.mouseMoveCallback(t,n):(Ut.mouseX+=t,Ut.mouseY+=n)}function Mn(e){var t=e.partial;e.partial=0,e.active&&(t+=Wt.frameTime-e.downtime),e.downtime=Wt.frameTime;var n=t/Wt.frameDelta;return n<0&&(n=0),n>1&&(n=1),n}function _n(e){var t=e.binding;if(!t)return;!e.active&&t.charAt(0)==="+"&&(t="-"+t.substr(1));var n=Ft.GetCmd(t);n&&n.call(this,e)}function Dn(e){for(var t in Wt.keys){if(!Wt.keys.hasOwnProperty(t))continue;var n=Cn(t);n.binding&&(e+="bind "+t+" "+n.binding+"\n")}return e}function Pn(){if(zt.state<Dt.CONNECTED)return;Hn(),In()}function Hn(){if(zt.state<Dt.PRIMED)return;Ut.cmdNumber++,Ut.cmds[Ut.cmdNumber&xt]=Bn()}function Bn(){var e=new T;return jn(e),Fn(e),e.serverTime=Ut.serverTime,e}function jn(e){var t=127,n=0,r=0,i=0;Wt.forwardKey&&(n+=t*Mn(Wt.forwardKey)),Wt.backKey&&(n-=t*Mn(Wt.backKey)),Wt.rightKey&&(r+=t*Mn(Wt.rightKey)),Wt.leftKey&&(r-=t*Mn(Wt.leftKey)),Wt.upKey&&(i+=t*Mn(Wt.upKey)),e.forwardmove=lt(n),e.rightmove=lt(r),e.upmove=i}function Fn(e){var t=vec3.create(Ut.viewangles),n=Ut.mouseX*$t(),r=Ut.mouseY*$t();Ut.viewangles[M]-=n*.022,Ut.viewangles[O]+=r*.022,Ut.viewangles[O]-t[O]>90?Ut.viewangles[O]=t[O]+90:t[O]-Ut.viewangles[O]>90&&(Ut.viewangles[O]=t[O]-90),Ut.mouseX=0,Ut.mouseY=0,e.angles[0]=B(Ut.viewangles[0]),e.angles[1]=B(Ut.viewangles[1]),e.angles[2]=B(Ut.viewangles[2])}function In(){var e=new n(yt,n.LITTLE_ENDIAN),t=parseInt(Ut.serverId);e.writeInt(t),e.writeInt(zt.serverMessageSequence),e.writeInt(zt.serverCommandSequence);for(var r=zt.reliableAcknowledge+1;r<=zt.reliableSequence;r++)e.writeByte(wt.clientCommand),e.writeInt(r),e.writeCString(zt.reliableCommands[r%gt]);var i=Ut.cmds[Ut.cmdNumber&xt];e.writeByte(wt.moveNoDelta),e.writeInt(i.serverTime),e.writeUnsignedShort(i.angles[0]),e.writeUnsignedShort(i.angles[1]),e.writeUnsignedShort(i.angles[2]),e.writeByte(i.forwardmove),e.writeByte(i.rightmove),e.writeByte(i.upmove),e.writeByte(wt.EOF),Ft.NetchanSend(zt.netchan,e.buffer,e.index)}function qn(e){zt.reliableAcknowledge=e.readInt(),zt.reliableAcknowledge<zt.reliableSequence-gt&&(zt.reliableAcknowledge=zt.reliableSequence);var t=e.readByte();t===Et.gamestate?Rn(e):t===Et.snapshot&&Wn(e)}function Rn(e){Qt();for(;;){var t=e.readByte();if(t===Et.EOF)break;if(t!==Et.configstring)throw new Error("ParseGamestate: bad command byte");var n=e.readCString(),r=e.readCString();Ut.gameState[n]=JSON.parse(r)}zt.clientNum=e.readInt(),Un(),zn(),Gt()}function Un(){var e=Ut.gameState.systemInfo;Ut.serverId=e.sv_serverid}function zn(){var e=Ut.gameState.serverInfo;Ut.mapname=e.sv_mapname}function Wn(e){var t=new Ht;t.messageNum=zt.serverMessageSequence,t.serverCommandNum=zt.serverCommandSequence,t.serverTime=e.readUnsignedInt(),t.snapFlags=e.readUnsignedInt(),t.valid=!0,Xn(e,t),Vn(e,t),Ut.snap=t,Ut.snapshots[Ut.snap.messageNum%vt]=Ut.snap,Ut.newSnapshots=!0}function Xn(e,t){t.ps.clientNum=e.readInt(),t.ps.commandTime=e.readInt(),t.ps.pm_type=e.readInt(),t.ps.pm_flags=e.readInt(),t.ps.pm_time=e.readInt(),t.ps.gravity=e.readInt(),t.ps.speed=e.readInt(),t.ps.origin[0]=e.readFloat(),t.ps.origin[1]=e.readFloat(),t.ps.origin[2]=e.readFloat(),t.ps.velocity[0]=e.readFloat(),t.ps.velocity[1]=e.readFloat(),t.ps.velocity[2]=e.readFloat(),t.ps.viewangles[0]=e.readFloat(),t.ps.viewangles[1]=e.readFloat(),t.ps.viewangles[2]=e.readFloat(),t.ps.delta_angles[0]=e.readShort(),t.ps.delta_angles[1]=e.readShort(),t.ps.delta_angles[2]=e.readShort()}function Vn(e,t){t.parseEntitiesNum=Ut.parseEntitiesNum;for(;;){var n=e.readInt();if(n===p-1)break;var r=Ut.parseEntities[Ut.parseEntitiesNum&Ot-1];r.number=n,r.eType=e.readInt(),r.eFlags=e.readInt(),r.pos.trType=e.readInt(),r.pos.trTime=e.readInt(),r.pos.trDuration=e.readInt(),r.pos.trBase[0]=e.readFloat(),r.pos.trBase[1]=e.readFloat(),r.pos.trBase[2]=e.readFloat(),r.pos.trDelta[0]=e.readFloat(),r.pos.trDelta[1]=e.readFloat(),r.pos.trDelta[2]=e.readFloat(),r.apos.trType=e.readInt(),r.apos.trTime=e.readInt(),r.apos.trDuration=e.readInt(),r.apos.trBase[0]=e.readFloat(),r.apos.trBase[1]=e.readFloat(),r.apos.trBase[2]=e.readFloat(),r.apos.trDelta[0]=e.readFloat(),r.apos.trDelta[1]=e.readFloat(),r.apos.trDelta[2]=e.readFloat(),r.origin[0]=e.readFloat(),r.origin[1]=e.readFloat(),r.origin[2]=e.readFloat(),r.groundEntityNum=e.readInt(),r.modelIndex=e.readInt(),Ut.parseEntitiesNum++,t.numEntities++}}var u="baseq3",a=1,f=2,l=4,c=64,h=64,p=1024,d=p-1,v=p-2,m=p-2,g=256,y=256,b={NAD:0,LOOPBACK:1,IP:2},w={CLIENT:0,SERVER:1},E=function(e,t,n){this.type=e,this.ip=t,this.port=n},S=function(e,t){var n=e,r=function(t){if(!arguments.length)return n;var r=n;typeof e=="string"?n=t.toString():e%1===0?n=parseInt(t):n=parseFloat(t)};return r.flags=t,r},x={ARCHIVE:1,USERINFO:2,SERVERINFO:4,SYSTEMINFO:8},T=function(){this.serverTime=0,this.angles=[0,0,0],this.forwardmove=0,this.rightmove=0,this.upmove=0};T.prototype.clone=function(e){return typeof e=="undefined"&&(e=new T),e.serverTime=this.serverTime,vec3.set(this.angles,e.angles),e.forwardmove=this.forwardmove,e.rightmove=this.rightmove,e.upmove=this.upmove,e};var N=6,C=function(){this.clientNum=0,this.commandTime=0,this.pm_type=0,this.pm_flags=0,this.origin=[0,0,0],this.velocity=[0,0,0],this.viewangles=[0,0,0],this.delta_angles=[0,0,0],this.speed=0,this.gravity=0,this.groundEntityNum=d,this.jumppad_ent=0,this.jumppad_frame=0,this.pmove_framecount=0};C.prototype.clone=function(e){return typeof e=="undefined"&&(e=new C),e.clientNum=this.clientNum,e.commandTime=this.commandTime,e.pm_type=this.pm_type,e.pm_flags=this.pm_flags,vec3.set(this.origin,e.origin),vec3.set(this.velocity,e.velocity),vec3.set(this.viewangles,e.viewangles),vec3.set(this.delta_angles,e.delta_angles),e.speed=this.speed,e.gravity=this.gravity,e.groundEntityNum=this.groundEntityNum,e.jumppad_ent=this.jumppad_ent,e.jumppad_frame=this.jumppad_frame,e.pmove_framecount=this.pmove_framecount,e};var k={STATIONARY:0,INTERPOLATE:1,LINEAR:2,LINEAR_STOP:3,SINE:4,GRAVITY:5},L=function(){this.trType=0,this.trTime=0,this.trDuration=0,this.trBase=[0,0,0],this.trDelta=[0,0,0]};L.prototype.clone=function(e){return typeof e=="undefined"&&(e=new L),e.trType=this.trType,e.trTime=this.trTime,e.trDuration=this.trDuration,vec3.set(this.trBase,e.trBase),vec3.set(this.trDelta,e.trDelta),e};var A=function(){this.number=0,this.eType=0,this.eFlags=0,this.pos=new L,this.apos=new L,this.time=0,this.time2=0,this.origin=[0,0,0],this.origin2=[0,0,0],this.angles=[0,0,0],this.angles2=[0,0,0],this.groundEntityNum=d,this.modelIndex=0,this.modelIndex2=0,this.clientNum=0,this.frame=0,this.solid=0,this.event=0,this.eventParm=0};A.prototype.clone=function(e){return typeof e=="undefined"&&(e=new A),e.number=this.number,e.eType=this.eType,e.eFlags=this.eFlags,this.pos.clone(e.pos),this.apos.clone(e.apos),e.time=this.time,e.time2=this.time2,vec3.set(this.origin,e.origin),vec3.set(this.origin2,e.origin2),vec3.set(this.angles,e.angles),vec3.set(this.angles2,e.angles2),e.groundEntityNum=this.groundEntityNum,e.modelIndex=this.modelIndex,e.modelindex2=this.modelIndex2,e.clientNum=this.clientNum,e.frame=this.frame,e.solid=this.solid,e.event=this.event,e.eventParm=this.eventParm,e};var O=0,M=1,_=2,B=function(e){return e*65536/360&65535},j=function(e){return e*(360/65536)},F=0,I=1,q=2,R=3,U=function(){this.normal=vec3.create(),this.dist=0,this.type=0,this.signbits=0},V=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],J={NODAMAGE:1,SLICK:2,SKY:4,LADDER:8,NOIMPACT:16,NOMARKS:32,FLESH:64,NODRAW:128,HINT:256,SKIP:512,NOLIGHTMAP:1024,POINTLIGHT:2048,METALSTEPS:4096,NOSTEPS:8192,NONSOLID:16384,LIGHTFILTER:32768,ALPHASHADOW:65536,NODLIGHT:131072,DUST:262144},K={ENTITIES:0,SHADERS:1,PLANES:2,NODES:3,LEAFS:4,LEAFSURFACES:5,LEAFBRUSHES:6,MODELS:7,BRUSHES:8,BRUSHSIDES:9,DRAWVERTS:10,DRAWINDEXES:11,FOGS:12,SURFACES:13,LIGHTMAPS:14,LIGHTGRID:15,VISIBILITY:16,NUM_LUMPS:17},Q=64,G=function(){this.fileofs=0,this.filelen=0},Y=function(){this.ident=null,this.version=0,this.lumps=new Array(K.NUM_LUMPS);for(var e=0;e<K.NUM_LUMPS;e++)this.lumps[e]=new G},Z=function(){this.mins=[0,0,0],this.maxs=[0,0,0],this.firstSurface=0,this.numSurfaces=0,this.firstBrush=0,this.numBrushes=0};Z.size=40;var et=function(){this.shaderName=null,this.flags=0,this.contents=0};et.size=72;var tt=function(){this.normal=[0,0,0],this.dist=0};tt.size=16;var nt=function(){this.planeNum=0,this.childrenNum=[0,0],this.mins=[0,0,0],this.maxs=[0,0,0]};nt.size=36;var rt=function(){this.cluster=0,this.area=0,this.mins=[0,0,0],this.maxs=[0,0,0],this.firstLeafSurface=0,this.numLeafSurfaces=0,this.firstLeafBrush=0,this.numLeafBrushes=0};rt.size=48;var it=function(){this.planeNum=0,this.shader=0};it.size=8;var st=function(){this.side=0,this.numsides=0,this.shader=0};st.size=12;var ot=function(){this.shader=null,this.brushNum=0,this.visibleSide=0};ot.size=72;var ut=function(){this.pos=[0,0,0],this.texCoord=[0,0],this.lmCoord=[0,0],this.normal=[0,0,0],this.color=[0,0,0,0]};ut.size=44;var at={BAD:0,PLANAR:1,PATCH:2,TRIANGLE_SOUP:3,FLARE:4},ft=function(){this.shaderNum=0,this.fogNum=0,this.surfaceType=0,this.vertex=0,this.vertCount=0,this.meshVert=0,this.meshVertCount=0,this.lightmapNum=0,this.lmStart=[0,0],this.lmSize=[0,0],this.lmOrigin=[0,0,0],this.lmVecs=[[0,0,0],[0,0,0],[0,0,0]],this.patchWidth=0,this.patchHeight=0};ft.size=104;var ct=function(){this.gl=null,this.handle=null},pt=32,dt={NETCLMESSAGE:0,NETSVMESSAGE:3,KEYDOWN:4,KEYUP:5,MOUSEMOVE:6},vt=32,mt=32,gt=64,yt=16384,bt=function(){this.src=0,this.remoteAddress=null,this.socket=null,this.incomingSequence=0,this.outgoingSequence=0},wt={nop:0,move:1,moveNoDelta:2,clientCommand:3,EOF:4},Et={gamestate:0,configstring:1,baseline:2,serverCommand:3,snapshot:4,EOF:5},St=64,xt=St-1,Tt=function(){this.initialized=!1,this.frameInterpolation=0,this.thisFrameTeleport=!1,this.nextFrameTeleport=!1,this.time=0,this.physicsTime=0,this.latestSnapshotNum=0,this.latestSnapshotTime=0,this.snap=null,this.nextSnap=null,this.entities=new Array(p),this.hyperspace=!1,this.validPPS=!1,this.predictedErrorTime=0,this.predictedError=[0,0,0],this.predictedPlayerState=null,this.itemInfo=new Array,this.autoAngles=[0,0,0],this.autoAnglesFast=[0,0,0],this.refdef=new RefDef,this.showScores=!1;for(var e=0;e<p;e++)this.entities[e]=new Ct},Nt=function(){this.gameState=null,this.mapname=null,this.processedSnapshotNum=0,this.clientInfo=new Array(c)},Ct=function(){this.currentState=new A,this.nextState=new A,this.interpolate=!1,this.currentValid=!1,this.snapShotTime=0,this.extrapolated=!1,this.rawOrigin=[0,0,0],this.rawAngles=[0,0,0],this.lerpOrigin=[0,0,0],this.lerpAngles=[0,0,0]},kt=function(){this.infoValid=!1,this.name=null,this.modelName=null,this.skinName=null,this.headModelName=null,this.headSkinName=null,this.legsModel=-1,this.legsSkin=-1,this.torsoModel=-1,this.torsoSkin=-1,this.headModel=-1,this.headSkin=-1},Lt=function(){this.modelHandles=[],this.icon=-1},At=3e3,Ot=2048,Mt=function(){this.snap=null,this.serverTime=0,this.oldServerTime=0,this.oldFrameServerTime=0,this.serverTimeDelta=0,this.extrapolatedSnapshot=!1,this.newSnapshots=!1,this.gameState=[],this.mouseX=0,this.mouseY=0,this.viewangles=[0,0,0],this.serverId=0,this.cmds=new Array(St),this.cmdNumber=0,this.snapshots=new Array(vt),this.entityBaselines=new Array(p),this.parseEntities=new Array(Ot),this.parseEntitiesNum=0;for(var e=0;e<vt;e++)this.snapshots[e]=new Ht;for(var e=0;e<St;e++)this.cmds[e]=new T;for(var e=0;e<Ot;e++)this.parseEntities[e]=new A},_t=function(){this.initialized=!1,this.realTime=0,this.keyCallback=!1,this.mouseMoveCallback=!1,this.keys={},this.forwardKey=null,this.leftKey=null,this.backKey=null,this.rightKey=null,this.upKey=null},Dt={UNINITIALIZED:0,DISCONNECTED:1,CONNECTING:2,CHALLENGING:3,CONNECTED:4,LOADING:5,PRIMED:6,ACTIVE:7},Pt=function(){this.state=Dt.UNINITIALIZED,this.clientNum=-1,this.lastPacketSentTime=0,this.lastPacketTime=0,this.servername=null,this.serverAddress=null,this.connectTime=0,this.connectPacketCount=0,this.reliableSequence=0,this.reliableAcknowledge=0,this.reliableCommands=new Array(gt),this.serverMessageSequence=0,this.serverCommandSequence=0,this.lastExecutedServerCommand=0,this.serverCommands=new Array(gt),this.netchan=null},Ht=function(){this.valid=!1,this.snapFlags=0,this.serverTime=0,this.messageNum=0,this.deltaNum=0,this.ping=0,this.areamask=new Array(pt),this.cmdNum=0,this.ps=new C,this.numEntities=0,this.parseEntitiesNum=0,this.serverCommandNum=0},Bt=function(){this.chr=null,this.active=!1,this.downtime=0,this.partial=0,this.binding=null},jt,Ft,It,qt,Rt,Ut,zt,Wt,Xt,Vt,$t,Jt,hn=500;return{Init:Kt,InitCGame:Gt,ShutdownCGame:Yt,InitRenderer:Zt,ShutdownRenderer:en,Frame:tn,MapLoading:rn,PacketEvent:an,KeyDownEvent:Ln,KeyUpEvent:An,MouseMoveEvent:On,WriteBindings:Dn}}),define("server/sv",["underscore","ByteBuffer","game/gm","client/cl","clipmap/cm"],function(e,t,n,r,s){function _(e,t,n){return t-e>180&&(t-=360),t-e<-180&&(t+=360),e+n*(t-e)}function D(e,t,n,r){var i,s,o,u,a,f,l;i=e[O]*(Math.PI*2/360),u=Math.sin(i),l=Math.cos(i),i=e[A]*(Math.PI*2/360),o=Math.sin(i),f=Math.cos(i),i=e[M]*(Math.PI*2/360),s=Math.sin(i),a=Math.cos(i),t&&(t[0]=f*l,t[1]=f*u,t[2]=-o),n&&(n[0]=-1*s*o*l+ -1*a*-u,n[1]=-1*s*o*u+ -1*a*l,n[2]=-1*s*f),r&&(r[0]=a*o*l+ -s*-u,r[1]=a*o*u+ -s*l,r[2]=a*f)}function P(e,t){var n=[0,0,0];D(e,t[0],n,t[2]),vec3.subtract([0,0,0],n,t[1])}function U(e){return e[0]==1?j:e[1]==1?F:e[2]==1?I:q}function z(e){var t=0;for(var n=0;n<3;n++)e.normal[n]<0&&(t|=1<<n);return t}function W(e,t,n){if(n.type<q)return n.dist<=e[n.type]?1:n.dist>=t[n.type]?2:3;var r=[0,0];if(n.signbits<8)for(var i=0;i<3;i++){var s=n.signbits>>i&1;r[s]+=n.normal[i]*t[i],r[s^1]+=n.normal[i]*e[i]}var o=0;return r[0]>=n.dist&&(o=1),r[1]<n.dist&&(o|=2),o}function V(e,t,n){var r=new Array(n),i=[].concat(X),s=[].concat(X),o=[].concat(X),u=[].concat(X),a=0,f,l=0,c,h=0,p,d=0,v,m;for(m=0;m<n;m++)f=e[m][t]&255,c=e[m][t]>>8&255,p=e[m][t]>>16&255,v=e[m][t]>>24&255^128,i[f]++,s[c]++,o[p]++,u[v]++;for(m=0;m<256;m++)f=a+i[m],c=l+s[m],p=h+o[m],v=d+u[m],i[m]=a,s[m]=l,o[m]=h,u[m]=d,a=f,l=c,h=p,d=v;for(m=0;m<n;m++)f=e[m][t]&255,r[i[f]]=e[m],i[f]++;for(m=0;m<n;m++)c=r[m][t]>>8&255,e[s[c]]=r[m],s[c]++;for(m=0;m<n;m++)p=e[m][t]>>16&255,r[o[p]]=e[m],o[p]++;for(m=0;m<n;m++)v=r[m][t]>>24&255^128,e[u[v]]=r[m],u[v]++;return e}function ft(e){return e<-128?-128:e>127?127:e}function ct(e){var t=65536,n=e.length,r=e.slice||e.subarray,i;if(n<t)i=String.fromCharCode.apply(String,e);else{var s=[],o=0;while(o<n)s.push(String.fromCharCode.apply(String,r.call(e,o,o+t))),o+=t;i=s.join("")}return btoa(i)}function Wt(e,t,n){console.log("--------- SV Init ---------"),Ht=e,Bt=t,jt=n,Ft=new Ot,It=new Lt,qt=s.CreateInstance(Ht),Rt=Bt.AddCvar("sv_serverid",0,S.SYSTEMINFO),Ut=Bt.AddCvar("sv_mapname","nomap",S.SERVERINFO),zt=Bt.AddCvar("sv_fps",20),pn(),setTimeout(function(){dn("q3tourney2")},50)}function Xt(){var e=zt(),t=1e3/e;return t<1&&(t=1),t}function Vt(e,t){It.frameTime=e;if(!It.initialized)return;var r=Xt();Ft.timeResidual+=t;var i=0;while(Ft.timeResidual>=r)Ft.timeResidual-=r,It.time+=r,Ft.time+=r,n.Frame(Ft.time),i++;i>0&&Nn()}function $t(n,r,s){if(!It.initialized)return;var o=new t(s,t.LITTLE_ENDIAN);if(s.byteLength>4&&o.view.getInt32(0,!!t.LITTLE_ENDIAN)===-1){Jt(n,r,o);return}for(i=0;i<It.clients.length;i++){var u=It.clients[i];if(u.state===_t.FREE)continue;if(!e.isEqual(u.netchan.addr,n))continue;Bt.NetchanProcess(u,o)&&ln(u,o);return}}function Jt(e,t,n){n.readInt();var r=n.readCString();r.indexOf("connect")===0&&en(e,t,r.substr(7))}function Kt(e){console.log("--------- SV SpawnServer ---------"),console.log("Spawning new server for "+e),It.initialized=!1,n.Shutdown(),jt||(r.MapLoading(),r.ShutdownCGame(),r.ShutdownRenderer(),r.InitRenderer()),It.snapFlagServerBit^=f;var t=Ft.time;Ft=new Ot,qt.LoadMap(e,function(){Ut(e),Rt(It.frameTime),On(),Ft.state=At.LOADING;var t={GetEntityDefs:qt.EntityDefs,LocateGameData:yn,GetUserCommand:bn,SetBrushModel:wn,LinkEntity:Pn,UnlinkEntity:Hn,FindEntitiesInBox:_n,Trace:qt.Trace};n.Init(Bt,t);for(var r=0;r<l;r++){var i=It.clients[r];if(!i||i.state<_t.CONNECTED)continue;i.gentity=null;var s=n.ClientConnect(r,!1);s&&tn(i,s),i.state=_t.CONNECTED}Qt("systemInfo",Bt.GetCvarKeyValues(S.SYSTEMINFO)),Qt("serverInfo",Bt.GetCvarKeyValues(S.SERVERINFO)),Ft.state=At.GAME,It.initialized=!0})}function Qt(t,n){if(e.isEqual(n,Ft.configstrings[t]))return;Ft.configstrings[t]=n;if(Ft.state===At.GAME||Ft.restarting)for(var r=0;r<l;r++){var i=It.clients[r];if(i.state<_t.ACTIVE){i.state===_t.PRIMED&&(i.csUpdated[t]=!0);continue}Yt(i,t)}}function Gt(e){return Ft.configstrings[e]}function Yt(e,t){SendServerCommand(e,"cs "+t+" "+JSON.stringify(Ft.configstrings[t])+"\n")}function Zt(e){for(var t in Ft.configstrings){if(!Ft.configstrings.hasOwnProperty(t))continue;if(!e.csUpdated[t])continue;Yt(e,t),e.csUpdated[t]=!1}}function en(e,t,r){if(!It.initialized)return;console.log("SV: A client is connecting");var i;for(var s=0;s<l;s++)if(It.clients[s].state==_t.FREE){i=s;break}if(i===undefined)throw new Error("Server is full");var o=It.clients[i];o.state=_t.CONNECTED,o.netchan=Bt.NetchanSetup(b.SERVER,e,t),o.userInfo=JSON.parse(r);var u=n.ClientConnect(i,!0);if(u)return;un(o),Bt.NetchanPrint(o.netchan,"connectResponse"),o.gamestateMessageNum=-1}function tn(e,t){if(e.state===_t.ZOMBIE)return;var r=an(e);n.ClientDisconnect(r),e.state=_t.ZOMBIE}function nn(e){var t=It.clients.indexOf(e);e.state=_t.ACTIVE,Zt(e),n.ClientBegin(t),e.gentity=vn(t)}function rn(e,t,n){var r=new x;r.serverTime=t.readInt(),r.angles[0]=t.readUnsignedShort(),r.angles[1]=t.readUnsignedShort(),r.angles[2]=t.readUnsignedShort(),r.forwardmove=t.readByte(),r.rightmove=t.readByte(),r.upmove=t.readByte(),e.state===_t.PRIMED&&nn(e);if(e.state!==_t.ACTIVE)return;sn(e,r)}function sn(e,t){var r=an(e);t.clone(e.lastUserCmd),n.ClientThink(r)}function on(e){e.state=_t.PRIMED,e.gamestateMessageNum=e.netchan.outgoingSequence;var n=new t(It.msgBuffer,t.LITTLE_ENDIAN);n.writeInt(e.lastClientCommand),n.writeByte(wt.gamestate);for(var r in Ft.configstrings){if(!Ft.configstrings.hasOwnProperty(r))continue;var i=Ft.configstrings[r];n.writeByte(wt.configstring),n.writeCString(r),n.writeCString(JSON.stringify(i))}n.writeByte(wt.EOF),n.writeInt(an(e)),Bt.NetchanSend(e.netchan,n.buffer,n.index)}function un(e){e.name=e.userInfo[name];var t=20;t<1?t=1:t>zt()&&(t=zt()),t=1e3/t,t!=e.snapshotMsec&&(e.lastSnapshotTime=0,e.snapshotMsec=t)}function an(e){return It.clients.indexOf(e)}function fn(e){tn(e,"disconnected")}function ln(e,t){var n=t.readInt();e.messageAcknowledge=t.readInt();if(e.messageAcknowledge<0)return;e.reliableAcknowledge=t.readInt();if(e.reliableAcknowledge<e.reliableSequence-mt){e.reliableAcknowledge=e.reliableSequence;return}if(n!==Rt()){e.messageAcknowledge>e.gamestateMessageNum&&on(e);return}e.oldServerTime&&n===Rt()&&(e.oldServerTime=0);var r;for(;;){r=t.readUnsignedByte();if(r===bt.EOF)break;if(r!==bt.clientCommand)break;if(!cn(e,t))return;if(e.state===_t.ZOMBIE)return}switch(r){case bt.move:rn(e,t,!0);break;case bt.moveNoDelta:rn(e,t,!1)}}function cn(e,t){var n=t.readInt(),r=t.readCString();return e.lastClientCommand>=n?!0:n>e.lastClientCommand+1?(tn(e,"Lost reliable commands"),!1):(e.nextReliableTime=It.time+1e3,hn(e,r),e.lastClientCommand=n,e.lastClientCommandString=r,!0)}function hn(e,t){t==="disconnect"&&fn(e)}function pn(){Bt.AddCmd("map",dn),Bt.AddCmd("sectorlist",An)}function dn(e){Kt(e)}function vn(e){return Ft.gameEntities[e]}function mn(e){var t=e.s.number;if(!e||t<0||t>=h)throw new Error("SvEntityForSharedEntity: bad game entity");var n=Ft.svEntities[t];return n||(n=Ft.svEntities[t]=new Mt(t)),n}function gn(e){var t=e.number;if(!e||t<0||t>=h)throw new Error("SharedEntityForSvEntity: bad sv entity");return Ft.gameEntities[t]}function yn(e,t){Ft.gameEntities=e,Ft.gameClients=t}function bn(e,t){if(e<0||e>=l)throw new Error("GetUsercmd: bad clientNum: "+e);It.clients[e].lastUserCmd.clone(t)}function wn(e,t){if(!t)throw new Error("SV: SetBrushModel: null");if(t.charAt(0)!=="*")throw new Error("SV: SetBrushModel: "+t+"isn't a brush model");e.s.modelindex=parseInt(t.substr(1));var n=qt.InlineModel(e.s.modelindex);qt.ModelBounds(n,e.mins,e.maxs),e.bmodel=!0,e.contents=-1}function En(e,t){var r=e.gentity;if(!r||e.state===_t.ZOMBIE)return!1;Ft.snapshotCounter++;var i=e.frames[e.netchan.outgoingSequence%dt],s=an(e);i.ps=n.GetClientPlayerstate(s);var o=[];Sn(i.ps.origin,i,o,!1),i.numEntities=0,i.firstEntity=It.nextSnapshotEntities;for(var u=0;u<o.length;u++){var a=vn(o[u]),f=It.snapshotEntities[It.nextSnapshotEntities%kt];a.s.clone(f),It.nextSnapshotEntities++,i.numEntities++}return!0}function Sn(e,t,n,r){for(var i=0;i<h;i++){var s=vn(i);if(!s||!s.linked)continue;if(s.s.number!==i)throw new Error("Entity number does not match.. WTF");if(s.svFlags&xt.NOCLIENT)continue;if(s.svFlags&xt.SINGLECLIENT&&s.singleClient!=t.ps.clientNum)continue;if(s.svFlags&xt.NOTSINGLECLIENT&&s.singleClient===t.ps.clientNum)continue;var o=mn(s);if(o.snapshotCounter===Ft.snapshotCounter)continue;if(s.svFlags&xt.BROADCAST){xn(o,s,n);continue}xn(o,s,n)}}function xn(e,t,n){if(e.snapshotCounter===Ft.snapshotCounter)return;e.snapshotCounter=Ft.snapshotCounter,n.push(t.s.number)}function Tn(e){if(!En(e))return;var n=e.frames[e.netchan.outgoingSequence%dt],r=new t(It.msgBuffer,t.LITTLE_ENDIAN);r.writeInt(e.lastClientCommand),r.writeUnsignedByte(wt.snapshot);var i=Ft.time;e.oldServerTime&&(i=Ft.time+e.oldServerTime),r.writeInt(i);var s=It.snapFlagServerBit;e.state!==_t.ACTIVE&&(s|=a),r.writeInt(s),r.writeInt(n.ps.clientNum),r.writeInt(n.ps.commandTime),r.writeInt(n.ps.pm_type),r.writeInt(n.ps.pm_flags),r.writeInt(n.ps.pm_time),r.writeInt(n.ps.gravity),r.writeInt(n.ps.speed),r.writeFloat(n.ps.origin[0]),r.writeFloat(n.ps.origin[1]),r.writeFloat(n.ps.origin[2]),r.writeFloat(n.ps.velocity[0]),r.writeFloat(n.ps.velocity[1]),r.writeFloat(n.ps.velocity[2]),r.writeFloat(n.ps.viewangles[0]),r.writeFloat(n.ps.viewangles[1]),r.writeFloat(n.ps.viewangles[2]),r.writeShort(n.ps.delta_angles[0]),r.writeShort(n.ps.delta_angles[1]),r.writeShort(n.ps.delta_angles[2]);for(var o=0;o<n.numEntities;o++){var u=It.snapshotEntities[(n.firstEntity+o)%kt];r.writeInt(u.number),r.writeInt(u.eType),r.writeInt(u.eFlags),r.writeInt(u.pos.trType),r.writeInt(u.pos.trTime),r.writeInt(u.pos.trDuration),r.writeFloat(u.pos.trBase[0]),r.writeFloat(u.pos.trBase[1]),r.writeFloat(u.pos.trBase[2]),r.writeFloat(u.pos.trDelta[0]),r.writeFloat(u.pos.trDelta[1]),r.writeFloat(u.pos.trDelta[2]),r.writeInt(u.apos.trType),r.writeInt(u.apos.trTime),r.writeInt(u.apos.trDuration),r.writeFloat(u.apos.trBase[0]),r.writeFloat(u.apos.trBase[1]),r.writeFloat(u.apos.trBase[2]),r.writeFloat(u.apos.trDelta[0]),r.writeFloat(u.apos.trDelta[1]),r.writeFloat(u.apos.trDelta[2]),r.writeFloat(u.origin[0]),r.writeFloat(u.origin[1]),r.writeFloat(u.origin[2]),r.writeInt(u.groundEntityNum),r.writeInt(u.modelIndex)}r.writeUnsignedInt(h-1),Bt.NetchanSend(e.netchan,r.buffer,r.index)}function Nn(){for(var e=0;e<It.clients.length;e++){var t=It.clients[e];if(!t)continue;if(!t.state)continue;if(It.time-t.lastSnapshotTime<t.snapshotMsec)continue;Tn(t),t.lastSnapshotTime=It.time}}function An(){for(var t=0;t<kn.length;t++){var n=kn[t];console.log("sector "+t+": "+e.keys(n.entities).length+" entities")}}function On(){kn=[];var e=qt.InlineModel(0),t=[0,0,0],n=[0,0,0];qt.ModelBounds(e,t,n),Mn(0,t,n)}function Mn(e,t,n){var r=kn[kn.length]=new Ln;if(e===Cn)return r.axis=-1,r.children[0]=r.children[1]=null,r;var i=vec3.subtract(n,t,[0,0,0]);i[0]>i[1]?r.axis=0:r.axis=1;var s=vec3.create(t),o=vec3.create(t),u=vec3.create(n),a=vec3.create(n);return r.dist=.5*(n[r.axis]+t[r.axis]),u[r.axis]=o[r.axis]=r.dist,r.children[0]=Mn(e+1,o,a),r.children[1]=Mn(e+1,s,u),r}function _n(e,t){var n=[],r=function(i){for(var s in i.entities){if(!i.entities.hasOwnProperty(s))continue;var o=i.entities[s],u=gn(o);if(u.absmin[0]>t[0]||u.absmin[1]>t[1]||u.absmin[2]>t[2]||u.absmax[0]<e[0]||u.absmax[1]<e[1]||u.absmax[2]<e[2])continue;n.push(u.s.number)}if(i.axis==-1)return;t[i.axis]>i.dist&&r(i.children[0]),e[i.axis]<i.dist&&r(i.children[1])};return r(kn[0]),n}function Dn(e,t){var n=[0,0,0];for(var r=0;r<3;r++){var i=Math.abs(e[r]),s=Math.abs(t[r]);n[r]=i>s?i:s}return vec3.length(n)}function Pn(e){var t=mn(e);t.worldSector&&Hn(e);var n=e.currentOrigin,r=e.currentAngles;vec3.add(n,e.mins,e.absmin),vec3.add(n,e.maxs,e.absmax),e.absmin[0]-=1,e.absmin[1]-=1,e.absmin[2]-=1,e.absmax[0]+=1,e.absmax[1]+=1,e.absmax[2]+=1;var i=kn[0];for(;;){if(i.axis==-1)break;if(e.absmin[i.axis]>i.dist)i=i.children[0];else{if(!(e.absmax[i.axis]<i.dist))break;i=i.children[1]}}e.linked=!0,t.worldSector=i,i.entities[t.number]=t}function Hn(e){var t=mn(e),n=t.worldSector;if(!n)return;e.linked=!1,delete n.entities[t.number],t.worldSector=null}var o="baseq3",u=1,a=2,f=4,l=64,c=64,h=1024,p=h-1,d=h-2,v=h-2,m=256,g=256,y={NAD:0,LOOPBACK:1,IP:2},b={CLIENT:0,SERVER:1},w=function(e,t,n){this.type=e,this.ip=t,this.port=n},E=function(e,t){var n=e,r=function(t){if(!arguments.length)return n;var r=n;typeof e=="string"?n=t.toString():e%1===0?n=parseInt(t):n=parseFloat(t)};return r.flags=t,r},S={ARCHIVE:1,USERINFO:2,SERVERINFO:4,SYSTEMINFO:8},x=function(){this.serverTime=0,this.angles=[0,0,0],this.forwardmove=0,this.rightmove=0,this.upmove=0};x.prototype.clone=function(e){return typeof e=="undefined"&&(e=new x),e.serverTime=this.serverTime,vec3.set(this.angles,e.angles),e.forwardmove=this.forwardmove,e.rightmove=this.rightmove,e.upmove=this.upmove,e};var T=6,N=function(){this.clientNum=0,this.commandTime=0,this.pm_type=0,this.pm_flags=0,this.origin=[0,0,0],this.velocity=[0,0,0],this.viewangles=[0,0,0],this.delta_angles=[0,0,0],this.speed=0,this.gravity=0,this.groundEntityNum=p,this.jumppad_ent=0,this.jumppad_frame=0,this.pmove_framecount=0};N.prototype.clone=function(e){return typeof e=="undefined"&&(e=new N),e.clientNum=this.clientNum,e.commandTime=this.commandTime,e.pm_type=this.pm_type,e.pm_flags=this.pm_flags,vec3.set(this.origin,e.origin),vec3.set(this.velocity,e.velocity),vec3.set(this.viewangles,e.viewangles),vec3.set(this.delta_angles,e.delta_angles),e.speed=this.speed,e.gravity=this.gravity,e.groundEntityNum=this.groundEntityNum,e.jumppad_ent=this.jumppad_ent,e.jumppad_frame=this.jumppad_frame,e.pmove_framecount=this.pmove_framecount,e};var C={STATIONARY:0,INTERPOLATE:1,LINEAR:2,LINEAR_STOP:3,SINE:4,GRAVITY:5},k=function(){this.trType=0,this.trTime=0,this.trDuration=0,this.trBase=[0,0,0],this.trDelta=[0,0,0]};k.prototype.clone=function(e){return typeof e=="undefined"&&(e=new k),e.trType=this.trType,e.trTime=this.trTime,e.trDuration=this.trDuration,vec3.set(this.trBase,e.trBase),vec3.set(this.trDelta,e.trDelta),e};var L=function(){this.number=0,this.eType=0,this.eFlags=0,this.pos=new k,this.apos=new k,this.time=0,this.time2=0,this.origin=[0,0,0],this.origin2=[0,0,0],this.angles=[0,0,0],this.angles2=[0,0,0],this.groundEntityNum=p,this.modelIndex=0,this.modelIndex2=0,this.clientNum=0,this.frame=0,this.solid=0,this.event=0,this.eventParm=0};L.prototype.clone=function(e){return typeof e=="undefined"&&(e=new L),e.number=this.number,e.eType=this.eType,e.eFlags=this.eFlags,this.pos.clone(e.pos),this.apos.clone(e.apos),e.time=this.time,e.time2=this.time2,vec3.set(this.origin,e.origin),vec3.set(this.origin2,e.origin2),vec3.set(this.angles,e.angles),vec3.set(this.angles2,e.angles2),e.groundEntityNum=this.groundEntityNum,e.modelIndex=this.modelIndex,e.modelindex2=this.modelIndex2,e.clientNum=this.clientNum,e.frame=this.frame,e.solid=this.solid,e.event=this.event,e.eventParm=this.eventParm,e};var A=0,O=1,M=2,H=function(e){return e*65536/360&65535},B=function(e){return e*(360/65536)},j=0,F=1,I=2,q=3,R=function(){this.normal=vec3.create(),this.dist=0,this.type=0,this.signbits=0},X=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],$={NODAMAGE:1,SLICK:2,SKY:4,LADDER:8,NOIMPACT:16,NOMARKS:32,FLESH:64,NODRAW:128,HINT:256,SKIP:512,NOLIGHTMAP:1024,POINTLIGHT:2048,METALSTEPS:4096,NOSTEPS:8192,NONSOLID:16384,LIGHTFILTER:32768,ALPHASHADOW:65536,NODLIGHT:131072,DUST:262144},J={ENTITIES:0,SHADERS:1,PLANES:2,NODES:3,LEAFS:4,LEAFSURFACES:5,LEAFBRUSHES:6,MODELS:7,BRUSHES:8,BRUSHSIDES:9,DRAWVERTS:10,DRAWINDEXES:11,FOGS:12,SURFACES:13,LIGHTMAPS:14,LIGHTGRID:15,VISIBILITY:16,NUM_LUMPS:17},K=64,Q=function(){this.fileofs=0,this.filelen=0},G=function(){this.ident=null,this.version=0,this.lumps=new Array(J.NUM_LUMPS);for(var e=0;e<J.NUM_LUMPS;e++)this.lumps[e]=new Q},Y=function(){this.mins=[0,0,0],this.maxs=[0,0,0],this.firstSurface=0,this.numSurfaces=0,this.firstBrush=0,this.numBrushes=0};Y.size=40;var Z=function(){this.shaderName=null,this.flags=0,this.contents=0};Z.size=72;var et=function(){this.normal=[0,0,0],this.dist=0};et.size=16;var tt=function(){this.planeNum=0,this.childrenNum=[0,0],this.mins=[0,0,0],this.maxs=[0,0,0]};tt.size=36;var nt=function(){this.cluster=0,this.area=0,this.mins=[0,0,0],this.maxs=[0,0,0],this.firstLeafSurface=0,this.numLeafSurfaces=0,this.firstLeafBrush=0,this.numLeafBrushes=0};nt.size=48;var rt=function(){this.planeNum=0,this.shader=0};rt.size=8;var it=function(){this.side=0,this.numsides=0,this.shader=0};it.size=12;var st=function(){this.shader=null,this.brushNum=0,this.visibleSide=0};st.size=72;var ot=function(){this.pos=[0,0,0],this.texCoord=[0,0],this.lmCoord=[0,0],this.normal=[0,0,0],this.color=[0,0,0,0]};ot.size=44;var ut={BAD:0,PLANAR:1,PATCH:2,TRIANGLE_SOUP:3,FLARE:4},at=function(){this.shaderNum=0,this.fogNum=0,this.surfaceType=0,this.vertex=0,this.vertCount=0,this.meshVert=0,this.meshVertCount=0,this.lightmapNum=0,this.lmStart=[0,0],this.lmSize=[0,0],this.lmOrigin=[0,0,0],this.lmVecs=[[0,0,0],[0,0,0],[0,0,0]],this.patchWidth=0,this.patchHeight=0};at.size=104;var lt=function(){this.gl=null,this.handle=null},ht=32,pt={NETCLMESSAGE:0,NETSVMESSAGE:3,KEYDOWN:4,KEYUP:5,MOUSEMOVE:6},dt=32,vt=32,mt=64,gt=16384,yt=function(){this.src=0,this.remoteAddress=null,this.socket=null,this.incomingSequence=0,this.outgoingSequence=0},bt={nop:0,move:1,moveNoDelta:2,clientCommand:3,EOF:4},wt={gamestate:0,configstring:1,baseline:2,serverCommand:3,snapshot:4,EOF:5},Et=100,St=function(){this.framenum=0,this.previousTime=0,this.time=0,this.clients=new Array(l),this.gentities=new Array(h)},xt={NOCLIENT:1,BOT:2,BROADCAST:8,PORTAL:32,USE_CURRENT_ORIGIN:64,SINGLECLIENT:128,NOTSINGLECLIENT:256},Tt=function(){this.s=new L,this.linked=!1,this.svFlags=0,this.singleClient=0,this.bmodel=!1,this.mins=[0,0,0],this.maxs=[0,0,0],this.contents=0,this.absmin=[0,0,0],this.absmax=[0,0,0],this.currentOrigin=[0,0,0],this.currentAngles=[0,0,0],this.client=null,this.classname="noclass",this.spawnflags=0,this.model=null,this.model2=null,this.target=null,this.targetname=null,this.nextthink=0},Nt=function(){this.ps=new N,this.pers=new Ct},Ct=function(){this.cmd=new x,this.netname=null},kt=l*dt*64,Lt=function(){this.initialized=!1,this.time=0,this.snapFlagServerBit=0,this.clients=new Array(l),this.nextSnapshotEntities=0,this.snapshotEntities=new Array(kt),this.msgBuffer=new ArrayBuffer(gt);for(var e=0;e<l;e++)this.clients[e]=new Dt;for(var e=0;e<kt;e++)this.snapshotEntities[e]=new L},At={DEAD:0,LOADING:1,GAME:2},Ot=function(){this.state=At.DEAD,this.restarting=!1,this.serverId=0,this.snapshotCounter=0,this.time=0,this.timeResidual=0,this.configstrings={},this.svEntities=new Array(h),this.gameEntities=null,this.gameClients=null},Mt=function(e){this.worldSector=null,this.baseline=new L,this.number=e,this.snapshotCounter=0},_t={FREE:0,ZOMBIE:1,CONNECTED:2,PRIMED:3,ACTIVE:4},Dt=function(){this.state=_t.FREE,this.userInfo={},this.messageAcknowledge=0,this.reliableCommands=new Array(mt),this.reliableSequence=0,this.reliableAcknowledge=0,this.reliableSent=0,this.gamestateMessageNum=-1,this.lastUserCmd=new x,this.lastMessageNum=0,this.lastClientCommand=0,this.lastClientCommandString=null,this.name=null,this.deltaMessage=-1,this.nextReliableTime=0,this.lastSnapshotTime=0,this.snapshotMsec=0,this.frames=new Array(dt),this.netchan=null,this.oldServerTime=0,this.csUpdated={};for(var e=0;e<dt;e++)this.frames[e]=new N},Pt=function(){this.ps=new N,this.numEntities=0,this.firstEntity=0},Ht,Bt,jt,Ft,It,qt,Rt,Ut,zt,Cn=4,kn,Ln=function(){this.axis=0,this.dist=0,this.children=[null,null],this.entities={}};return{Init:Wt,Frame:Vt,PacketEvent:$t,ClientConnect:en}}),define("common/com",["underscore","ByteBuffer","server/sv","client/cl"],function(e,t,n,r){function O(e,t,n){return t-e>180&&(t-=360),t-e<-180&&(t+=360),e+n*(t-e)}function M(e,t,n,r){var i,s,o,u,a,f,l;i=e[L]*(Math.PI*2/360),u=Math.sin(i),l=Math.cos(i),i=e[k]*(Math.PI*2/360),o=Math.sin(i),f=Math.cos(i),i=e[A]*(Math.PI*2/360),s=Math.sin(i),a=Math.cos(i),t&&(t[0]=f*l,t[1]=f*u,t[2]=-o),n&&(n[0]=-1*s*o*l+ -1*a*-u,n[1]=-1*s*o*u+ -1*a*l,n[2]=-1*s*f),r&&(r[0]=a*o*l+ -s*-u,r[1]=a*o*u+ -s*l,r[2]=a*f)}function _(e,t){var n=[0,0,0];M(e,t[0],n,t[2]),vec3.subtract([0,0,0],n,t[1])}function q(e){return e[0]==1?H:e[1]==1?B:e[2]==1?j:F}function R(e){var t=0;for(var n=0;n<3;n++)e.normal[n]<0&&(t|=1<<n);return t}function U(e,t,n){if(n.type<F)return n.dist<=e[n.type]?1:n.dist>=t[n.type]?2:3;var r=[0,0];if(n.signbits<8)for(var i=0;i<3;i++){var s=n.signbits>>i&1;r[s]+=n.normal[i]*t[i],r[s^1]+=n.normal[i]*e[i]}var o=0;return r[0]>=n.dist&&(o=1),r[1]<n.dist&&(o|=2),o}function W(e,t,n){var r=new Array(n),i=[].concat(z),s=[].concat(z),o=[].concat(z),u=[].concat(z),a=0,f,l=0,c,h=0,p,d=0,v,m;for(m=0;m<n;m++)f=e[m][t]&255,c=e[m][t]>>8&255,p=e[m][t]>>16&255,v=e[m][t]>>24&255^128,i[f]++,s[c]++,o[p]++,u[v]++;for(m=0;m<256;m++)f=a+i[m],c=l+s[m],p=h+o[m],v=d+u[m],i[m]=a,s[m]=l,o[m]=h,u[m]=d,a=f,l=c,h=p,d=v;for(m=0;m<n;m++)f=e[m][t]&255,r[i[f]]=e[m],i[f]++;for(m=0;m<n;m++)c=r[m][t]>>8&255,e[s[c]]=r[m],s[c]++;for(m=0;m<n;m++)p=e[m][t]>>16&255,r[o[p]]=e[m],o[p]++;for(m=0;m<n;m++)v=r[m][t]>>24&255^128,e[u[v]]=r[m],u[v]++;return e}function ut(e){return e<-128?-128:e>127?127:e}function ft(e){var t=65536,n=e.length,r=e.slice||e.subarray,i;if(n<t)i=String.fromCharCode.apply(String,e);else{var s=[],o=0;while(o<n)s.push(String.fromCharCode.apply(String,r.call(e,o,o+t))),o+=t;i=s.join("")}return btoa(i)}function wt(){Et("exec",xt)}function Et(e,t){bt[e]=t}function St(e){return bt[e]}function xt(e){Mt.ReadFile(e,"utf8",function(t,n){if(t){console.warn("Failed to execute '"+e+"'");return}n=n.replace(/^\s+|\s+$/g,"");var r=n.split(/\r\n|\r|\n/);for(var i=0;i<r.length;i++)qt(r[i])})}function Nt(e,t,n){var r=new b(t,n||0);return Tt[e]=r,r}function Ct(e){return Tt[e]}function kt(e){var t=Tt[e];return t?t():(console.warn("COM: No cvar found for '"+e+"'"),null)}function Lt(e,t){var n=Tt[e];if(!n){console.warn("COM: No cvar found for '"+e+"'");return}n(t)}function At(e){var t={};for(var n in Tt){if(!Tt.hasOwnProperty(n))continue;var r=Tt[n];if(!(r.flags&e))continue;t[n]=r()}return t}function Ot(e){for(var t in Tt){if(!Tt.hasOwnProperty(t))continue;var n=Tt[t];if(!(n.flags&w.ARCHIVE))continue;e+=t+" "+n()+"\n"}return e}function Bt(e,t){Mt=e,_t=t,Dt=[],Pt=Ht=Mt.GetMilliseconds(),wt();var i={ExecuteCmdText:qt,LoadConfig:Rt,SaveConfig:Ut,AddCvar:Nt,GetCvarVal:kt,SetCvarVal:Lt,GetCvarKeyValues:At,AddCmd:Et,GetCmd:St,NetchanSetup:$t,NetchanDestroy:Jt,NetchanSend:Qt,NetchanPrint:Gt,NetchanProcess:Yt};n.Init(Mt,i,_t),_t||r.Init(Mt,i),Rt()}function jt(){Ht=Pt,Pt=Mt.GetMilliseconds();var e=Pt-Ht;Ft(),n.Frame(Pt,e),_t||r.Frame(Pt,e)}function Ft(){var e=Dt.shift();while(e){switch(e.type){case ct.NETCLMESSAGE:r.PacketEvent(e.addr,e.buffer);break;case ct.NETSVMESSAGE:n.PacketEvent(e.addr,e.socket,e.buffer);break;case ct.KEYDOWN:r.KeyDownEvent(e.time,e.keyName);break;case ct.KEYUP:r.KeyUpEvent(e.time,e.keyName);break;case ct.MOUSEMOVE:r.MouseMoveEvent(e.time,e.deltaX,e.deltaY)}e=Dt.shift()}}function It(e){e.time=Mt.GetMilliseconds(),Dt.push(e)}function qt(e){var t=e.split(" "),n=t[0],r=t.slice(1),i,s;(i=St(n))?i.apply(this,r):(s=Ct(n))&&s(r[0])}function Rt(){qt("exec default.cfg")}function Ut(e){var t="unbindall\n";t=r.WriteBindings(t),t=Ot(t),Mt.WriteFile("default.cfg",t,"utf8",e)}function $t(e,t,n){var r=new mt;return r.src=e,r.addr=t,typeof n!="undefined"?r.socket=n:t.type!==m.LOOPBACK&&(r.socket=Mt.NetConnectToServer(t)),r}function Jt(e){e.addr.type!==m.LOOPBACK&&Mt.NetClose(e.socket)}function Kt(e,t,n){var r=Xt[e.src];t=t.slice(0,n),r.msgs[r.send++%Wt]=t,It({type:e.src===g.CLIENT?ct.NETSVMESSAGE:ct.NETCLMESSAGE,socket:null,addr:e.addr,buffer:t,length:n})}function Qt(e,n,r){var i=new t(Vt,t.LITTLE_ENDIAN),s=new Uint8Array(n);i.writeInt(e.outgoingSequence++);for(var o=0;o<r;o++)i.writeUnsignedByte(s[o]);if(e.addr.type===m.LOOPBACK){Kt(e,i.buffer,i.index);return}Mt.NetSend(e.socket,i.buffer,i.index)}function Gt(e,n){var r=new t(Vt,t.LITTLE_ENDIAN);r.writeInt(-1),r.writeCString(n);if(e.addr.type===m.LOOPBACK){Kt(e,r.buffer,r.index);return}Mt.NetSend(e.socket,r.buffer,r.index)}function Yt(e,t){var n=t.readInt();return e.incomingSequence=n,!0}var i="baseq3",s=1,o=2,u=4,a=64,f=64,l=1024,c=l-1,h=l-2,p=l-2,d=256,v=256,m={NAD:0,LOOPBACK:1,IP:2},g={CLIENT:0,SERVER:1},y=function(e,t,n){this.type=e,this.ip=t,this.port=n},b=function(e,t){var n=e,r=function(t){if(!arguments.length)return n;var r=n;typeof e=="string"?n=t.toString():e%1===0?n=parseInt(t):n=parseFloat(t)};return r.flags=t,r},w={ARCHIVE:1,USERINFO:2,SERVERINFO:4,SYSTEMINFO:8},E=function(){this.serverTime=0,this.angles=[0,0,0],this.forwardmove=0,this.rightmove=0,this.upmove=0};E.prototype.clone=function(e){return typeof e=="undefined"&&(e=new E),e.serverTime=this.serverTime,vec3.set(this.angles,e.angles),e.forwardmove=this.forwardmove,e.rightmove=this.rightmove,e.upmove=this.upmove,e};var S=6,x=function(){this.clientNum=0,this.commandTime=0,this.pm_type=0,this.pm_flags=0,this.origin=[0,0,0],this.velocity=[0,0,0],this.viewangles=[0,0,0],this.delta_angles=[0,0,0],this.speed=0,this.gravity=0,this.groundEntityNum=c,this.jumppad_ent=0,this.jumppad_frame=0,this.pmove_framecount=0};x.prototype.clone=function(e){return typeof e=="undefined"&&(e=new x),e.clientNum=this.clientNum,e.commandTime=this.commandTime,e.pm_type=this.pm_type,e.pm_flags=this.pm_flags,vec3.set(this.origin,e.origin),vec3.set(this.velocity,e.velocity),vec3.set(this.viewangles,e.viewangles),vec3.set(this.delta_angles,e.delta_angles),e.speed=this.speed,e.gravity=this.gravity,e.groundEntityNum=this.groundEntityNum,e.jumppad_ent=this.jumppad_ent,e.jumppad_frame=this.jumppad_frame,e.pmove_framecount=this.pmove_framecount,e};var T={STATIONARY:0,INTERPOLATE:1,LINEAR:2,LINEAR_STOP:3,SINE:4,GRAVITY:5},N=function(){this.trType=0,this.trTime=0,this.trDuration=0,this.trBase=[0,0,0],this.trDelta=[0,0,0]};N.prototype.clone=function(e){return typeof e=="undefined"&&(e=new N),e.trType=this.trType,e.trTime=this.trTime,e.trDuration=this.trDuration,vec3.set(this.trBase,e.trBase),vec3.set(this.trDelta,e.trDelta),e};var C=function(){this.number=0,this.eType=0,this.eFlags=0,this.pos=new N,this.apos=new N,this.time=0,this.time2=0,this.origin=[0,0,0],this.origin2=[0,0,0],this.angles=[0,0,0],this.angles2=[0,0,0],this.groundEntityNum=c,this.modelIndex=0,this.modelIndex2=0,this.clientNum=0,this.frame=0,this.solid=0,this.event=0,this.eventParm=0};C.prototype.clone=function(e){return typeof e=="undefined"&&(e=new C),e.number=this.number,e.eType=this.eType,e.eFlags=this.eFlags,this.pos.clone(e.pos),this.apos.clone(e.apos),e.time=this.time,e.time2=this.time2,vec3.set(this.origin,e.origin),vec3.set(this.origin2,e.origin2),vec3.set(this.angles,e.angles),vec3.set(this.angles2,e.angles2),e.groundEntityNum=this.groundEntityNum,e.modelIndex=this.modelIndex,e.modelindex2=this.modelIndex2,e.clientNum=this.clientNum,e.frame=this.frame,e.solid=this.solid,e.event=this.event,e.eventParm=this.eventParm,e};var k=0,L=1,A=2,D=function(e){return e*65536/360&65535},P=function(e){return e*(360/65536)},H=0,B=1,j=2,F=3,I=function(){this.normal=vec3.create(),this.dist=0,this.type=0,this.signbits=0},z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],X={NODAMAGE:1,SLICK:2,SKY:4,LADDER:8,NOIMPACT:16,NOMARKS:32,FLESH:64,NODRAW:128,HINT:256,SKIP:512,NOLIGHTMAP:1024,POINTLIGHT:2048,METALSTEPS:4096,NOSTEPS:8192,NONSOLID:16384,LIGHTFILTER:32768,ALPHASHADOW:65536,NODLIGHT:131072,DUST:262144},V={ENTITIES:0,SHADERS:1,PLANES:2,NODES:3,LEAFS:4,LEAFSURFACES:5,LEAFBRUSHES:6,MODELS:7,BRUSHES:8,BRUSHSIDES:9,DRAWVERTS:10,DRAWINDEXES:11,FOGS:12,SURFACES:13,LIGHTMAPS:14,LIGHTGRID:15,VISIBILITY:16,NUM_LUMPS:17},$=64,J=function(){this.fileofs=0,this.filelen=0},K=function(){this.ident=null,this.version=0,this.lumps=new Array(V.NUM_LUMPS);for(var e=0;e<V.NUM_LUMPS;e++)this.lumps[e]=new J},Q=function(){this.mins=[0,0,0],this.maxs=[0,0,0],this.firstSurface=0,this.numSurfaces=0,this.firstBrush=0,this.numBrushes=0};Q.size=40;var G=function(){this.shaderName=null,this.flags=0,this.contents=0};G.size=72;var Y=function(){this.normal=[0,0,0],this.dist=0};Y.size=16;var Z=function(){this.planeNum=0,this.childrenNum=[0,0],this.mins=[0,0,0],this.maxs=[0,0,0]};Z.size=36;var et=function(){this.cluster=0,this.area=0,this.mins=[0,0,0],this.maxs=[0,0,0],this.firstLeafSurface=0,this.numLeafSurfaces=0,this.firstLeafBrush=0,this.numLeafBrushes=0};et.size=48;var tt=function(){this.planeNum=0,this.shader=0};tt.size=8;var nt=function(){this.side=0,this.numsides=0,this.shader=0};nt.size=12;var rt=function(){this.shader=null,this.brushNum=0,this.visibleSide=0};rt.size=72;var it=function(){this.pos=[0,0,0],this.texCoord=[0,0],this.lmCoord=[0,0],this.normal=[0,0,0],this.color=[0,0,0,0]};it.size=44;var st={BAD:0,PLANAR:1,PATCH:2,TRIANGLE_SOUP:3,FLARE:4},ot=function(){this.shaderNum=0,this.fogNum=0,this.surfaceType=0,this.vertex=0,this.vertCount=0,this.meshVert=0,this.meshVertCount=0,this.lightmapNum=0,this.lmStart=[0,0],this.lmSize=[0,0],this.lmOrigin=[0,0,0],this.lmVecs=[[0,0,0],[0,0,0],[0,0,0]],this.patchWidth=0,this.patchHeight=0};ot.size=104;var at=function(){this.gl=null,this.handle=null},lt=32,ct={NETCLMESSAGE:0,NETSVMESSAGE:3,KEYDOWN:4,KEYUP:5,MOUSEMOVE:6},ht=32,pt=32,dt=64,vt=16384,mt=function(){this.src=0,this.remoteAddress=null,this.socket=null,this.incomingSequence=0,this.outgoingSequence=0},gt={nop:0,move:1,moveNoDelta:2,clientCommand:3,EOF:4},yt={gamestate:0,configstring:1,baseline:2,serverCommand:3,snapshot:4,EOF:5},bt={},Tt={},Mt,_t=!1,Dt,Pt,Ht,zt=1400,Wt=16,Xt=[{msgs:new Array(Wt),send:0},{msgs:new Array(Wt),send:0}],Vt=new ArrayBuffer(vt);return{EventTypes:ct,Init:Bt,Frame:jt,QueueEvent:It,NetchanSetup:$t}}),define("system/browser/sys",["common/com"],function(e){function k(e,t,n){return t-e>180&&(t-=360),t-e<-180&&(t+=360),e+n*(t-e)}function L(e,t,n,r){var i,s,o,u,a,f,l;i=e[N]*(Math.PI*2/360),u=Math.sin(i),l=Math.cos(i),i=e[T]*(Math.PI*2/360),o=Math.sin(i),f=Math.cos(i),i=e[C]*(Math.PI*2/360),s=Math.sin(i),a=Math.cos(i),t&&(t[0]=f*l,t[1]=f*u,t[2]=-o),n&&(n[0]=-1*s*o*l+ -1*a*-u,n[1]=-1*s*o*u+ -1*a*l,n[2]=-1*s*f),r&&(r[0]=a*o*l+ -s*-u,r[1]=a*o*u+ -s*l,r[2]=a*f)}function A(e,t){var n=[0,0,0];L(e,t[0],n,t[2]),vec3.subtract([0,0,0],n,t[1])}function j(e){return e[0]==1?_:e[1]==1?D:e[2]==1?P:H}function F(e){var t=0;for(var n=0;n<3;n++)e.normal[n]<0&&(t|=1<<n);return t}function I(e,t,n){if(n.type<H)return n.dist<=e[n.type]?1:n.dist>=t[n.type]?2:3;var r=[0,0];if(n.signbits<8)for(var i=0;i<3;i++){var s=n.signbits>>i&1;r[s]+=n.normal[i]*t[i],r[s^1]+=n.normal[i]*e[i]}var o=0;return r[0]>=n.dist&&(o=1),r[1]<n.dist&&(o|=2),o}function R(e,t,n){var r=new Array(n),i=[].concat(q),s=[].concat(q),o=[].concat(q),u=[].concat(q),a=0,f,l=0,c,h=0,p,d=0,v,m;for(m=0;m<n;m++)f=e[m][t]&255,c=e[m][t]>>8&255,p=e[m][t]>>16&255,v=e[m][t]>>24&255^128,i[f]++,s[c]++,o[p]++,u[v]++;for(m=0;m<256;m++)f=a+i[m],c=l+s[m],p=h+o[m],v=d+u[m],i[m]=a,s[m]=l,o[m]=h,u[m]=d,a=f,l=c,h=p,d=v;for(m=0;m<n;m++)f=e[m][t]&255,r[i[f]]=e[m],i[f]++;for(m=0;m<n;m++)c=r[m][t]>>8&255,e[s[c]]=r[m],s[c]++;for(m=0;m<n;m++)p=e[m][t]>>16&255,r[o[p]]=e[m],o[p]++;for(m=0;m<n;m++)v=r[m][t]>>24&255^128,e[u[v]]=r[m],u[v]++;return e}function it(e){return e<-128?-128:e>127?127:e}function ot(e){var t=65536,n=e.length,r=e.slice||e.subarray,i;if(n<t)i=String.fromCharCode.apply(String,e);else{var s=[],o=0;while(o<n)s.push(String.fromCharCode.apply(String,r.call(e,o,o+t))),o+=t;i=s.join("")}return btoa(i)}function ht(){function t(n){window.requestAnimationFrame(t,lt),e.Frame()}at=pt(lt,["webgl","experimental-webgl"]);if(!at){document.getElementById("webgl-error").style.display="block";return}lt.width=ft.offsetWidth,lt.height=ft.offsetHeight,document.addEventListener("fullscreenchange",dt),window.addEventListener("resize",dt),kt(),e.Init(Rt,!1),window.requestAnimationFrame(t,lt)}function pt(e,t){if(e.getContext)for(var n=0;n<t.length;++n)try{var r=e.getContext(t[n],{antialias:!1});if(r!==null)return r}catch(i){}return null}function dt(){document.fullscreenEnabled?(lt.width=screen.width,lt.height=screen.height,lt.requestPointerLock()):(lt.width=ft.offsetWidth,lt.height=ft.offsetHeight)}function vt(){var e=new st;return e.handle=lt,e.gl=at,e}function mt(){var e=new st;return e.handle=ct,e}function gt(){return window.performance.now?parseInt(window.performance.now()):window.performance.webkitNow?parseInt(window.performance.webkitNow()):Date.now()}function wt(e,t){if(yt)return e(yt);window.webkitStorageInfo.requestQuota(PERSISTENT,1048576,function(n){window.requestFileSystem(window.PERSISTENT,n,function(t){return yt=t,e(t)},t)},t)}function Et(e){switch(e.code){case FileError.NOT_FOUND_ERR:return"File or directory not found";case FileError.NOT_READABLE_ERR:return"File or directory not readable";case FileError.PATH_EXISTS_ERR:return"File or directory already exists";case FileError.TYPE_MISMATCH_ERR:return"Invalid filetype";default:return"Unknown Error"}}function St(e,t,n){var r=bt.indexOf(e)>-1;r?xt(e,t,n):Tt(e,t,n)}function xt(e,t,n){var r=function(t){return console.log("Couldn't read '"+e+"'",Et(t)),n(t)};wt(function(t){t.root.getFile(e,{},function(e){e.file(function(e){var t=new FileReader;t.onabort=r,t.onerror=r,t.onloadend=function(){if(n)return n(null,this.result)},t.readAsText(e)},r)},r)},r)}function Tt(e,n,r){var i=n==="binary",s=new XMLHttpRequest;s.open("GET",t+"/"+e,!0),i?(s.setRequestHeader("Content-Type","application/octet-stream"),s.responseType="arraybuffer"):s.setRequestHeader("Content-Type","text/plain"),s.addEventListener("load",function(){return s.readyState!==4||s.status!==200?r(new Error("ReadFile received response code "+s.readyState)):r(null,i?s.response:s.responseText)}),s.send(null)}function Nt(e,t,n,r){var i=bt.indexOf(e)>-1;if(!i)throw new Error("Browser can't write to remote files");Ct(e,t,n,r)}function Ct(e,t,n,r){var i=function(t){return console.log("Couldn't write to '"+e+"'",Et(t)),r(t)};wt(function(n){n.root.getFile(e,{create:!0},function(e){e.createWriter(function(e){var n=new Blob([t],{type:"text/plain"});e.write(n);if(r)return r(null)},i)},i)},i)}function kt(){ft.addEventListener("keydown",Ot),ft.addEventListener("keyup",Mt),ft.addEventListener("mousedown",_t),ft.addEventListener("mouseup",Dt),ft.addEventListener("mousemove",Bt)}function Lt(e){var t=ut.us;for(var n in t){if(!t.hasOwnProperty(n))continue;if(t[n]==e)return n}}function At(e){return"mouse"+e}function Ot(t){document.pointerLockElement&&t.preventDefault();var n=Lt(t.keyCode);t.altKey&&n=="enter"&&ft.requestFullscreen(),e.QueueEvent({type:e.EventTypes.KEYDOWN,keyName:n})}function Mt(t){document.pointerLockElement&&t.preventDefault();var n=Lt(t.keyCode);e.QueueEvent({type:e.EventTypes.KEYUP,keyName:n})}function _t(t){var n=At(t.button);!document.pointerLockElement&&t.button===0&&lt.requestPointerLock(),e.QueueEvent({type:e.EventTypes.KEYDOWN,keyName:n})}function Dt(t){var n=At(t.button);e.QueueEvent({type:e.EventTypes.KEYUP,keyName:n})}function Bt(t){var n,r;document.pointerLockElement?(n=t.movementX,r=t.movementY):(n=t.pageX-Pt,r=t.pageY-Ht,Pt=t.pageX,Ht=t.pageY),e.QueueEvent({type:e.EventTypes.MOUSEMOVE,deltaX:n,deltaY:r})}function jt(){throw new Error("Should not happen")}function Ft(t){var n;return n=new WebSocket("ws://"+t.ip+":"+t.port,["q3js"]),n.binaryType="arraybuffer",n.onopen=function(){},n.onmessage=function(n){e.QueueEvent({type:e.EventTypes.NETCLMESSAGE,addr:t,buffer:n.data})},n.onerror=function(e){},n}function It(e,t,n){if(e.readyState!==1)return;t.byteLength!==n&&(t=t.slice(0,n)),e.send(t)}function qt(e){e.close()}var t="baseq3",n=1,r=2,i=4,s=64,o=64,u=1024,a=u-1,f=u-2,l=u-2,c=256,h=256,p={NAD:0,LOOPBACK:1,IP:2},d={CLIENT:0,SERVER:1},v=function(e,t,n){this.type=e,this.ip=t,this.port=n},m=function(e,t){var n=e,r=function(t){if(!arguments.length)return n;var r=n;typeof e=="string"?n=t.toString():e%1===0?n=parseInt(t):n=parseFloat(t)};return r.flags=t,r},g={ARCHIVE:1,USERINFO:2,SERVERINFO:4,SYSTEMINFO:8},y=function(){this.serverTime=0,this.angles=[0,0,0],this.forwardmove=0,this.rightmove=0,this.upmove=0};y.prototype.clone=function(e){return typeof e=="undefined"&&(e=new y),e.serverTime=this.serverTime,vec3.set(this.angles,e.angles),e.forwardmove=this.forwardmove,e.rightmove=this.rightmove,e.upmove=this.upmove,e};var b=6,w=function(){this.clientNum=0,this.commandTime=0,this.pm_type=0,this.pm_flags=0,this.origin=[0,0,0],this.velocity=[0,0,0],this.viewangles=[0,0,0],this.delta_angles=[0,0,0],this.speed=0,this.gravity=0,this.groundEntityNum=a,this.jumppad_ent=0,this.jumppad_frame=0,this.pmove_framecount=0};w.prototype.clone=function(e){return typeof e=="undefined"&&(e=new w),e.clientNum=this.clientNum,e.commandTime=this.commandTime,e.pm_type=this.pm_type,e.pm_flags=this.pm_flags,vec3.set(this.origin,e.origin),vec3.set(this.velocity,e.velocity),vec3.set(this.viewangles,e.viewangles),vec3.set(this.delta_angles,e.delta_angles),e.speed=this.speed,e.gravity=this.gravity,e.groundEntityNum=this.groundEntityNum,e.jumppad_ent=this.jumppad_ent,e.jumppad_frame=this.jumppad_frame,e.pmove_framecount=this.pmove_framecount,e};var E={STATIONARY:0,INTERPOLATE:1,LINEAR:2,LINEAR_STOP:3,SINE:4,GRAVITY:5},S=function(){this.trType=0,this.trTime=0,this.trDuration=0,this.trBase=[0,0,0],this.trDelta=[0,0,0]};S.prototype.clone=function(e){return typeof e=="undefined"&&(e=new S),e.trType=this.trType,e.trTime=this.trTime,e.trDuration=this.trDuration,vec3.set(this.trBase,e.trBase),vec3.set(this.trDelta,e.trDelta),e};var x=function(){this.number=0,this.eType=0,this.eFlags=0,this.pos=new S,this.apos=new S,this.time=0,this.time2=0,this.origin=[0,0,0],this.origin2=[0,0,0],this.angles=[0,0,0],this.angles2=[0,0,0],this.groundEntityNum=a,this.modelIndex=0,this.modelIndex2=0,this.clientNum=0,this.frame=0,this.solid=0,this.event=0,this.eventParm=0};x.prototype.clone=function(e){return typeof e=="undefined"&&(e=new x),e.number=this.number,e.eType=this.eType,e.eFlags=this.eFlags,this.pos.clone(e.pos),this.apos.clone(e.apos),e.time=this.time,e.time2=this.time2,vec3.set(this.origin,e.origin),vec3.set(this.origin2,e.origin2),vec3.set(this.angles,e.angles),vec3.set(this.angles2,e.angles2),e.groundEntityNum=this.groundEntityNum,e.modelIndex=this.modelIndex,e.modelindex2=this.modelIndex2,e.clientNum=this.clientNum,e.frame=this.frame,e.solid=this.solid,e.event=this.event,e.eventParm=this.eventParm,e};var T=0,N=1,C=2,O=function(e){return e*65536/360&65535},M=function(e){return e*(360/65536)},_=0,D=1,P=2,H=3,B=function(){this.normal=vec3.create(),this.dist=0,this.type=0,this.signbits=0},q=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],U={NODAMAGE:1,SLICK:2,SKY:4,LADDER:8,NOIMPACT:16,NOMARKS:32,FLESH:64,NODRAW:128,HINT:256,SKIP:512,NOLIGHTMAP:1024,POINTLIGHT:2048,METALSTEPS:4096,NOSTEPS:8192,NONSOLID:16384,LIGHTFILTER:32768,ALPHASHADOW:65536,NODLIGHT:131072,DUST:262144},z={ENTITIES:0,SHADERS:1,PLANES:2,NODES:3,LEAFS:4,LEAFSURFACES:5,LEAFBRUSHES:6,MODELS:7,BRUSHES:8,BRUSHSIDES:9,DRAWVERTS:10,DRAWINDEXES:11,FOGS:12,SURFACES:13,LIGHTMAPS:14,LIGHTGRID:15,VISIBILITY:16,NUM_LUMPS:17},W=64,X=function(){this.fileofs=0,this.filelen=0},V=function(){this.ident=null,this.version=0,this.lumps=new Array(z.NUM_LUMPS);for(var e=0;e<z.NUM_LUMPS;e++)this.lumps[e]=new X},$=function(){this.mins=[0,0,0],this.maxs=[0,0,0],this.firstSurface=0,this.numSurfaces=0,this.firstBrush=0,this.numBrushes=0};$.size=40;var J=function(){this.shaderName=null,this.flags=0,this.contents=0};J.size=72;var K=function(){this.normal=[0,0,0],this.dist=0};K.size=16;var Q=function(){this.planeNum=0,this.childrenNum=[0,0],this.mins=[0,0,0],this.maxs=[0,0,0]};Q.size=36;var G=function(){this.cluster=0,this.area=0,this.mins=[0,0,0],this.maxs=[0,0,0],this.firstLeafSurface=0,this.numLeafSurfaces=0,this.firstLeafBrush=0,this.numLeafBrushes=0};G.size=48;var Y=function(){this.planeNum=0,this.shader=0};Y.size=8;var Z=function(){this.side=0,this.numsides=0,this.shader=0};Z.size=12;var et=function(){this.shader=null,this.brushNum=0,this.visibleSide=0};et.size=72;var tt=function(){this.pos=[0,0,0],this.texCoord=[0,0],this.lmCoord=[0,0],this.normal=[0,0,0],this.color=[0,0,0,0]};tt.size=44;var nt={BAD:0,PLANAR:1,PATCH:2,TRIANGLE_SOUP:3,FLARE:4},rt=function(){this.shaderNum=0,this.fogNum=0,this.surfaceType=0,this.vertex=0,this.vertCount=0,this.meshVert=0,this.meshVertCount=0,this.lightmapNum=0,this.lmStart=[0,0],this.lmSize=[0,0],this.lmOrigin=[0,0,0],this.lmVecs=[[0,0,0],[0,0,0],[0,0,0]],this.patchWidth=0,this.patchHeight=0};rt.size=104;var st=function(){this.gl=null,this.handle=null},ut={us:{backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,"break":19,capslock:20,escape:27,esc:27,space:32,spacebar:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,"delete":46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,meta:91,command:91,windows:91,win:91,_91:92,select:93,num0:96,num1:97,num2:98,num3:99,num4:100,num5:101,num6:102,num7:103,num8:104,num9:105,multiply:106,add:107,subtract:109,decimal:110,divide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numlock:144,num:144,scrolllock:145,scroll:145,semicolon:186,equal:187,equalsign:187,comma:188,dash:189,period:190,slash:191,forwardslash:191,graveaccent:192,openbracket:219,backslash:220,closebracket:221,singlequote:222}},at,ft=document.getElementById("viewport-frame"),lt=document.getElementById("viewport"),ct=document.getElementById("viewport-ui"),yt,bt=["default.cfg"];window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem;var Pt=0,Ht=0,Rt={GetMilliseconds:gt,ReadFile:St,WriteFile:Nt,GetGameRenderContext:vt,GetUIRenderContext:mt,NetCreateServer:jt,NetConnectToServer:Ft,NetSend:It,NetClose:qt};return{Init:ht}})